
/* /web/static/lib/qunit/qunit-2.9.1.js defined in bundle 'web.tests_assets' */
(function(global$1){'use strict';global$1=global$1&&global$1.hasOwnProperty('default')?global$1['default']:global$1;const debug=odoo.debug;var window$1=global$1.window;var self$1=global$1.self;var console=global$1.console;var setTimeout$1=global$1.setTimeout;var clearTimeout=global$1.clearTimeout;var document$1=window$1&&window$1.document;var navigator=window$1&&window$1.navigator;var lastError=null;var localSessionStorage=function(){var x="qunit-test-string";try{global$1.sessionStorage.setItem(x,x);global$1.sessionStorage.removeItem(x);return global$1.sessionStorage;}catch(e){return undefined;}}();function consoleProxy(method){return function(){if(console){console[method].apply(console,arguments);}};}
var Logger={warn:consoleProxy("warn")};var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};var classCallCheck=function(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}};var createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var toConsumableArray=function(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2;}else{return Array.from(arr);}};var toString=Object.prototype.toString;var hasOwn=Object.prototype.hasOwnProperty;var now=Date.now||function(){return new Date().getTime();};var hasPerformanceApi=detectPerformanceApi();var performance=hasPerformanceApi?window$1.performance:undefined;var performanceNow=hasPerformanceApi?performance.now.bind(performance):now;function detectPerformanceApi(){return window$1&&typeof window$1.performance!=="undefined"&&typeof window$1.performance.mark==="function"&&typeof window$1.performance.measure==="function";}
function measure(comment,startMark,endMark){try{performance.measure(comment,startMark,endMark);}catch(ex){Logger.warn("performance.measure could not be executed because of ",ex.message);}}
var defined={document:window$1&&window$1.document!==undefined,setTimeout:setTimeout$1!==undefined};function diff(a,b){var i,j,result=a.slice();for(i=0;i<result.length;i++){for(j=0;j<b.length;j++){if(result[i]===b[j]){result.splice(i,1);i--;break;}}}
return result;}
function inArray(elem,array){return array.indexOf(elem)!==-1;}
function objectValues(obj){var key,val,vals=is("array",obj)?[]:{};for(key in obj){if(hasOwn.call(obj,key)){val=obj[key];vals[key]=val===Object(val)?objectValues(val):val;}}
return vals;}
function extend(a,b,undefOnly){for(var prop in b){if(hasOwn.call(b,prop)){if(b[prop]===undefined){delete a[prop];}else if(!(undefOnly&&typeof a[prop]!=="undefined")){a[prop]=b[prop];}}}
return a;}
function objectType(obj){if(typeof obj==="undefined"){return"undefined";}
if(obj===null){return"null";}
var match=toString.call(obj).match(/^\[object\s(.*)\]$/),type=match&&match[1];switch(type){case"Number":if(isNaN(obj)){return"nan";}
return"number";case"String":case"Boolean":case"Array":case"Set":case"Map":case"Date":case"RegExp":case"Function":case"Symbol":return type.toLowerCase();default:return typeof obj==="undefined"?"undefined":_typeof(obj);}}
function is(type,obj){return objectType(obj)===type;}
function generateHash(module,testName){var str=module+"\x1C"+testName;var hash=0;for(var i=0;i<str.length;i++){hash=(hash<<5)-hash+str.charCodeAt(i);hash|=0;}
var hex=(0x100000000+hash).toString(16);if(hex.length<8){hex="0000000"+hex;}
return hex.slice(-8);}
var equiv=(function(){var pairs=[];var getProto=Object.getPrototypeOf||function(obj){return obj.__proto__;};function useStrictEquality(a,b){if((typeof a==="undefined"?"undefined":_typeof(a))==="object"){a=a.valueOf();}
if((typeof b==="undefined"?"undefined":_typeof(b))==="object"){b=b.valueOf();}
return a===b;}
function compareConstructors(a,b){var protoA=getProto(a);var protoB=getProto(b);if(a.constructor===b.constructor){return true;}
if(protoA&&protoA.constructor===null){protoA=null;}
if(protoB&&protoB.constructor===null){protoB=null;}
if(protoA===null&&protoB===Object.prototype||protoB===null&&protoA===Object.prototype){return true;}
return false;}
function getRegExpFlags(regexp){return"flags"in regexp?regexp.flags:regexp.toString().match(/[gimuy]*$/)[0];}
function isContainer(val){return["object","array","map","set"].indexOf(objectType(val))!==-1;}
function breadthFirstCompareChild(a,b){if(a===b){return true;}
if(!isContainer(a)){return typeEquiv(a,b);}
if(pairs.every(function(pair){return pair.a!==a||pair.b!==b;})){pairs.push({a:a,b:b});}
return true;}
var callbacks={"string":useStrictEquality,"boolean":useStrictEquality,"number":useStrictEquality,"null":useStrictEquality,"undefined":useStrictEquality,"symbol":useStrictEquality,"date":useStrictEquality,"nan":function nan(){return true;},"regexp":function regexp(a,b){return a.source===b.source&&getRegExpFlags(a)===getRegExpFlags(b);},"function":function _function(){return false;},"array":function array(a,b){var i,len;len=a.length;if(len!==b.length){return false;}
for(i=0;i<len;i++){if(!breadthFirstCompareChild(a[i],b[i])){return false;}}
return true;},"set":function set$$1(a,b){var innerEq,outerEq=true;if(a.size!==b.size){return false;}
a.forEach(function(aVal){if(!outerEq){return;}
innerEq=false;b.forEach(function(bVal){var parentPairs;if(innerEq){return;}
parentPairs=pairs;if(innerEquiv(bVal,aVal)){innerEq=true;}
pairs=parentPairs;});if(!innerEq){outerEq=false;}});return outerEq;},"map":function map(a,b){var innerEq,outerEq=true;if(a.size!==b.size){return false;}
a.forEach(function(aVal,aKey){if(!outerEq){return;}
innerEq=false;b.forEach(function(bVal,bKey){var parentPairs;if(innerEq){return;}
parentPairs=pairs;if(innerEquiv([bVal,bKey],[aVal,aKey])){innerEq=true;}
pairs=parentPairs;});if(!innerEq){outerEq=false;}});return outerEq;},"object":function object(a,b){var i,aProperties=[],bProperties=[];if(compareConstructors(a,b)===false){return false;}
for(i in a){aProperties.push(i);if(a.constructor!==Object&&typeof a.constructor!=="undefined"&&typeof a[i]==="function"&&typeof b[i]==="function"&&a[i].toString()===b[i].toString()){continue;}
if(!breadthFirstCompareChild(a[i],b[i])){return false;}}
for(i in b){bProperties.push(i);}
return typeEquiv(aProperties.sort(),bProperties.sort());}};function typeEquiv(a,b){var type=objectType(a);return objectType(b)===type&&callbacks[type](a,b);}
function innerEquiv(a,b){var i,pair;if(arguments.length<2){return true;}
pairs=[{a:a,b:b}];for(i=0;i<pairs.length;i++){pair=pairs[i];if(pair.a!==pair.b&&!typeEquiv(pair.a,pair.b)){return false;}}
return arguments.length===2||innerEquiv.apply(this,[].slice.call(arguments,1));}
return function(){var result=innerEquiv.apply(undefined,arguments);pairs.length=0;return result;};})();var config={queue:[],blocking:true,reorder:true,altertitle:true,collapse:true,scrolltop:true,maxDepth:5,requireExpects:false,urlConfig:[],modules:[],currentModule:{name:"",tests:[],childModules:[],testsRun:0,unskippedTestsRun:0,hooks:{before:[],beforeEach:[],afterEach:[],after:[]}},callbacks:{},storage:localSessionStorage};var globalConfig=window$1&&window$1.QUnit&&window$1.QUnit.config;if(window$1&&window$1.QUnit&&!window$1.QUnit.version){extend(config,globalConfig);}
config.modules.push(config.currentModule);var dump=(function(){function quote(str){return"\""+str.toString().replace(/\\/g,"\\\\").replace(/"/g,"\\\"")+"\"";}
function literal(o){return o+"";}
function join(pre,arr,post){var s=dump.separator(),base=dump.indent(),inner=dump.indent(1);if(arr.join){arr=arr.join(","+s+inner);}
if(!arr){return pre+post;}
return[pre,inner+arr,base+post].join(s);}
function array(arr,stack){var i=arr.length,ret=new Array(i);if(dump.maxDepth&&dump.depth>dump.maxDepth){return"[object Array]";}
this.up();while(i--){ret[i]=this.parse(arr[i],undefined,stack);}
this.down();return join("[",ret,"]");}
function isArray(obj){return(toString.call(obj)==="[object Array]"||typeof obj.length==="number"&&obj.item!==undefined&&(obj.length?obj.item(0)===obj[0]:obj.item(0)===null&&obj[0]===undefined));}
var reName=/^function (\w+)/,dump={parse:function parse(obj,objType,stack){stack=stack||[];var res,parser,parserType,objIndex=stack.indexOf(obj);if(objIndex!==-1){return"recursion("+(objIndex-stack.length)+")";}
objType=objType||this.typeOf(obj);parser=this.parsers[objType];parserType=typeof parser==="undefined"?"undefined":_typeof(parser);if(parserType==="function"){stack.push(obj);res=parser.call(this,obj,stack);stack.pop();return res;}
return parserType==="string"?parser:this.parsers.error;},typeOf:function typeOf(obj){var type;if(obj===null){type="null";}else if(typeof obj==="undefined"){type="undefined";}else if(is("regexp",obj)){type="regexp";}else if(is("date",obj)){type="date";}else if(is("function",obj)){type="function";}else if(obj.setInterval!==undefined&&obj.document!==undefined&&obj.nodeType===undefined){type="window";}else if(obj.nodeType===9){type="document";}else if(obj.nodeType){type="node";}else if(isArray(obj)){type="array";}else if(obj.constructor===Error.prototype.constructor){type="error";}else{type=typeof obj==="undefined"?"undefined":_typeof(obj);}
return type;},separator:function separator(){if(this.multiline){return this.HTML?"<br />":"\n";}else{return this.HTML?"&#160;":" ";}},indent:function indent(extra){if(!this.multiline){return"";}
var chr=this.indentChar;if(this.HTML){chr=chr.replace(/\t/g,"   ").replace(/ /g,"&#160;");}
return new Array(this.depth+(extra||0)).join(chr);},up:function up(a){this.depth+=a||1;},down:function down(a){this.depth-=a||1;},setParser:function setParser(name,parser){this.parsers[name]=parser;},quote:quote,literal:literal,join:join,depth:1,maxDepth:config.maxDepth,parsers:{window:"[Window]",document:"[Document]",error:function error(_error){return"Error(\""+_error.message+"\")";},unknown:"[Unknown]","null":"null","undefined":"undefined","function":function _function(fn){var ret="function",name="name"in fn?fn.name:(reName.exec(fn)||[])[1];if(name){ret+=" "+name;}
ret+="(";ret=[ret,dump.parse(fn,"functionArgs"),"){"].join("");return join(ret,dump.parse(fn,"functionCode"),"}");},array:array,nodelist:array,"arguments":array,object:function object(map,stack){var keys,key,val,i,nonEnumerableProperties,ret=[];if(dump.maxDepth&&dump.depth>dump.maxDepth){return"[object Object]";}
dump.up();keys=[];for(key in map){keys.push(key);}
nonEnumerableProperties=["message","name"];for(i in nonEnumerableProperties){key=nonEnumerableProperties[i];if(key in map&&!inArray(key,keys)){keys.push(key);}}
keys.sort();for(i=0;i<keys.length;i++){key=keys[i];val=map[key];ret.push(dump.parse(key,"key")+": "+dump.parse(val,undefined,stack));}
dump.down();return join("{",ret,"}");},node:function node(_node){var len,i,val,open=dump.HTML?"&lt;":"<",close=dump.HTML?"&gt;":">",tag=_node.nodeName.toLowerCase(),ret=open+tag,attrs=_node.attributes;if(attrs){for(i=0,len=attrs.length;i<len;i++){val=attrs[i].nodeValue;if(val&&val!=="inherit"){ret+=" "+attrs[i].nodeName+"="+dump.parse(val,"attribute");}}}
ret+=close;if(_node.nodeType===3||_node.nodeType===4){ret+=_node.nodeValue;}
return ret+open+"/"+tag+close;},functionArgs:function functionArgs(fn){var args,l=fn.length;if(!l){return"";}
args=new Array(l);while(l--){args[l]=String.fromCharCode(97+l);}
return" "+args.join(", ")+" ";},key:quote,functionCode:"[code]",attribute:quote,string:quote,date:quote,regexp:literal,number:literal,"boolean":literal,symbol:function symbol(sym){return sym.toString();}},HTML:false,indentChar:"  ",multiline:true};return dump;})();var SuiteReport=function(){function SuiteReport(name,parentSuite){classCallCheck(this,SuiteReport);this.name=name;this.fullName=parentSuite?parentSuite.fullName.concat(name):[];this.tests=[];this.childSuites=[];if(parentSuite){parentSuite.pushChildSuite(this);}}
createClass(SuiteReport,[{key:"start",value:function start(recordTime){if(recordTime){this._startTime=performanceNow();if(performance){var suiteLevel=this.fullName.length;performance.mark("qunit_suite_"+suiteLevel+"_start");}}
return{name:this.name,fullName:this.fullName.slice(),tests:this.tests.map(function(test){return test.start();}),childSuites:this.childSuites.map(function(suite){return suite.start();}),testCounts:{total:this.getTestCounts().total}};}},{key:"end",value:function end(recordTime){if(recordTime){this._endTime=performanceNow();if(performance){var suiteLevel=this.fullName.length;performance.mark("qunit_suite_"+suiteLevel+"_end");var suiteName=this.fullName.join(" – ");measure(suiteLevel===0?"QUnit Test Run":"QUnit Test Suite: "+suiteName,"qunit_suite_"+suiteLevel+"_start","qunit_suite_"+suiteLevel+"_end");}}
return{name:this.name,fullName:this.fullName.slice(),tests:this.tests.map(function(test){return test.end();}),childSuites:this.childSuites.map(function(suite){return suite.end();}),testCounts:this.getTestCounts(),runtime:this.getRuntime(),status:this.getStatus()};}},{key:"pushChildSuite",value:function pushChildSuite(suite){this.childSuites.push(suite);}},{key:"pushTest",value:function pushTest(test){this.tests.push(test);}},{key:"getRuntime",value:function getRuntime(){return this._endTime-this._startTime;}},{key:"getTestCounts",value:function getTestCounts(){var counts=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{passed:0,failed:0,skipped:0,todo:0,total:0};counts=this.tests.reduce(function(counts,test){if(test.valid){counts[test.getStatus()]++;counts.total++;}
return counts;},counts);return this.childSuites.reduce(function(counts,suite){return suite.getTestCounts(counts);},counts);}},{key:"getStatus",value:function getStatus(){var _getTestCounts=this.getTestCounts(),total=_getTestCounts.total,failed=_getTestCounts.failed,skipped=_getTestCounts.skipped,todo=_getTestCounts.todo;if(failed){return"failed";}else{if(skipped===total){return"skipped";}else if(todo===total){return"todo";}else{return"passed";}}}}]);return SuiteReport;}();var focused=false;var moduleStack=[];function createModule(name,testEnvironment,modifiers){var parentModule=moduleStack.length?moduleStack.slice(-1)[0]:null;var moduleName=parentModule!==null?[parentModule.name,name].join(" > "):name;var parentSuite=parentModule?parentModule.suiteReport:globalSuite;var skip=parentModule!==null&&parentModule.skip||modifiers.skip;var todo=parentModule!==null&&parentModule.todo||modifiers.todo;var module={name:moduleName,parentModule:parentModule,tests:[],moduleId:generateHash(moduleName),testsRun:0,unskippedTestsRun:0,childModules:[],suiteReport:new SuiteReport(name,parentSuite),skip:skip,todo:skip?false:todo};var env={};if(parentModule){parentModule.childModules.push(module);extend(env,parentModule.testEnvironment);}
extend(env,testEnvironment);module.testEnvironment=env;config.modules.push(module);return module;}
function processModule(name,options,executeNow){var modifiers=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};if(objectType(options)==="function"){executeNow=options;options=undefined;}
var module=createModule(name,options,modifiers);var testEnvironment=module.testEnvironment;var hooks=module.hooks={};setHookFromEnvironment(hooks,testEnvironment,"before");setHookFromEnvironment(hooks,testEnvironment,"beforeEach");setHookFromEnvironment(hooks,testEnvironment,"afterEach");setHookFromEnvironment(hooks,testEnvironment,"after");var moduleFns={before:setHookFunction(module,"before"),beforeEach:setHookFunction(module,"beforeEach"),afterEach:setHookFunction(module,"afterEach"),after:setHookFunction(module,"after")};var currentModule=config.currentModule;if(objectType(executeNow)==="function"){moduleStack.push(module);config.currentModule=module;executeNow.call(module.testEnvironment,moduleFns);moduleStack.pop();module=module.parentModule||currentModule;}
config.currentModule=module;function setHookFromEnvironment(hooks,environment,name){var potentialHook=environment[name];hooks[name]=typeof potentialHook==="function"?[potentialHook]:[];delete environment[name];}
function setHookFunction(module,hookName){return function setHook(callback){module.hooks[hookName].push(callback);};}}
function module$1(name,options,executeNow){if(focused){return;}
processModule(name,options,executeNow);}
module$1.only=function(){if(focused){return;}
config.modules.length=0;config.queue.length=0;module$1.apply(undefined,arguments);focused=true;};module$1.skip=function(name,options,executeNow){if(focused){return;}
processModule(name,options,executeNow,{skip:true});};module$1.todo=function(name,options,executeNow){if(focused){return;}
processModule(name,options,executeNow,{todo:true});};var LISTENERS=Object.create(null);var SUPPORTED_EVENTS=["runStart","suiteStart","testStart","assertion","testEnd","suiteEnd","runEnd"];SUPPORTED_EVENTS.push("OdooBeforeTestHook","OdooAfterTestHook");function emit(eventName,data){if(objectType(eventName)!=="string"){throw new TypeError("eventName must be a string when emitting an event");}
var originalCallbacks=LISTENERS[eventName];var callbacks=originalCallbacks?[].concat(toConsumableArray(originalCallbacks)):[];for(var i=0;i<callbacks.length;i++){callbacks[i](data);}}
function on(eventName,callback){if(objectType(eventName)!=="string"){throw new TypeError("eventName must be a string when registering a listener");}else if(!inArray(eventName,SUPPORTED_EVENTS)){var events=SUPPORTED_EVENTS.join(", ");throw new Error("\""+eventName+"\" is not a valid event; must be one of: "+events+".");}else if(objectType(callback)!=="function"){throw new TypeError("callback must be a function when registering a listener");}
if(!LISTENERS[eventName]){LISTENERS[eventName]=[];}
if(!inArray(callback,LISTENERS[eventName])){LISTENERS[eventName].push(callback);}}
function objectOrFunction(x){var type=typeof x==='undefined'?'undefined':_typeof(x);return x!==null&&(type==='object'||type==='function');}
function isFunction(x){return typeof x==='function';}
var _isArray=void 0;if(Array.isArray){_isArray=Array.isArray;}else{_isArray=function _isArray(x){return Object.prototype.toString.call(x)==='[object Array]';};}
var isArray=_isArray;var len=0;var vertxNext=void 0;var customSchedulerFn=void 0;var asap=function asap(callback,arg){queue[len]=callback;queue[len+1]=arg;len+=2;if(len===2){if(customSchedulerFn){customSchedulerFn(flush);}else{scheduleFlush();}}};function setScheduler(scheduleFn){customSchedulerFn=scheduleFn;}
function setAsap(asapFn){asap=asapFn;}
var browserWindow=typeof window!=='undefined'?window:undefined;var browserGlobal=browserWindow||{};var BrowserMutationObserver=browserGlobal.MutationObserver||browserGlobal.WebKitMutationObserver;var isNode=typeof self==='undefined'&&typeof process!=='undefined'&&{}.toString.call(process)==='[object process]';var isWorker=typeof Uint8ClampedArray!=='undefined'&&typeof importScripts!=='undefined'&&typeof MessageChannel!=='undefined';function useNextTick(){return function(){return process.nextTick(flush);};}
function useVertxTimer(){if(typeof vertxNext!=='undefined'){return function(){vertxNext(flush);};}
return useSetTimeout();}
function useMutationObserver(){var iterations=0;var observer=new BrowserMutationObserver(flush);var node=document.createTextNode('');observer.observe(node,{characterData:true});return function(){node.data=iterations=++iterations%2;};}
function useMessageChannel(){var channel=new MessageChannel();channel.port1.onmessage=flush;return function(){return channel.port2.postMessage(0);};}
function useSetTimeout(){var globalSetTimeout=setTimeout;return function(){return globalSetTimeout(flush,1);};}
var queue=new Array(1000);function flush(){for(var i=0;i<len;i+=2){var callback=queue[i];var arg=queue[i+1];callback(arg);queue[i]=undefined;queue[i+1]=undefined;}
len=0;}
function attemptVertx(){try{var vertx=Function('return this')().require('vertx');vertxNext=vertx.runOnLoop||vertx.runOnContext;return useVertxTimer();}catch(e){return useSetTimeout();}}
var scheduleFlush=void 0;if(isNode){scheduleFlush=useNextTick();}else if(BrowserMutationObserver){scheduleFlush=useMutationObserver();}else if(isWorker){scheduleFlush=useMessageChannel();}else if(browserWindow===undefined&&typeof require==='function'){scheduleFlush=attemptVertx();}else{scheduleFlush=useSetTimeout();}
function then(onFulfillment,onRejection){var parent=this;var child=new this.constructor(noop);if(child[PROMISE_ID]===undefined){makePromise(child);}
var _state=parent._state;if(_state){var callback=arguments[_state-1];asap(function(){return invokeCallback(_state,child,callback,parent._result);});}else{subscribe(parent,child,onFulfillment,onRejection);}
return child;}
function resolve$1(object){var Constructor=this;if(object&&(typeof object==='undefined'?'undefined':_typeof(object))==='object'&&object.constructor===Constructor){return object;}
var promise=new Constructor(noop);resolve(promise,object);return promise;}
var PROMISE_ID=Math.random().toString(36).substring(2);function noop(){}
var PENDING=void 0;var FULFILLED=1;var REJECTED=2;var TRY_CATCH_ERROR={error:null};function selfFulfillment(){return new TypeError("You cannot resolve a promise with itself");}
function cannotReturnOwn(){return new TypeError('A promises callback cannot return that same promise.');}
function getThen(promise){try{return promise.then;}catch(error){TRY_CATCH_ERROR.error=error;return TRY_CATCH_ERROR;}}
function tryThen(then$$1,value,fulfillmentHandler,rejectionHandler){try{then$$1.call(value,fulfillmentHandler,rejectionHandler);}catch(e){return e;}}
function handleForeignThenable(promise,thenable,then$$1){asap(function(promise){var sealed=false;var error=tryThen(then$$1,thenable,function(value){if(sealed){return;}
sealed=true;if(thenable!==value){resolve(promise,value);}else{fulfill(promise,value);}},function(reason){if(sealed){return;}
sealed=true;reject(promise,reason);},'Settle: '+(promise._label||' unknown promise'));if(!sealed&&error){sealed=true;reject(promise,error);}},promise);}
function handleOwnThenable(promise,thenable){if(thenable._state===FULFILLED){fulfill(promise,thenable._result);}else if(thenable._state===REJECTED){reject(promise,thenable._result);}else{subscribe(thenable,undefined,function(value){return resolve(promise,value);},function(reason){return reject(promise,reason);});}}
function handleMaybeThenable(promise,maybeThenable,then$$1){if(maybeThenable.constructor===promise.constructor&&then$$1===then&&maybeThenable.constructor.resolve===resolve$1){handleOwnThenable(promise,maybeThenable);}else{if(then$$1===TRY_CATCH_ERROR){reject(promise,TRY_CATCH_ERROR.error);TRY_CATCH_ERROR.error=null;}else if(then$$1===undefined){fulfill(promise,maybeThenable);}else if(isFunction(then$$1)){handleForeignThenable(promise,maybeThenable,then$$1);}else{fulfill(promise,maybeThenable);}}}
function resolve(promise,value){if(promise===value){reject(promise,selfFulfillment());}else if(objectOrFunction(value)){handleMaybeThenable(promise,value,getThen(value));}else{fulfill(promise,value);}}
function publishRejection(promise){if(promise._onerror){promise._onerror(promise._result);}
publish(promise);}
function fulfill(promise,value){if(promise._state!==PENDING){return;}
promise._result=value;promise._state=FULFILLED;if(promise._subscribers.length!==0){asap(publish,promise);}}
function reject(promise,reason){if(promise._state!==PENDING){return;}
promise._state=REJECTED;promise._result=reason;asap(publishRejection,promise);}
function subscribe(parent,child,onFulfillment,onRejection){var _subscribers=parent._subscribers;var length=_subscribers.length;parent._onerror=null;_subscribers[length]=child;_subscribers[length+FULFILLED]=onFulfillment;_subscribers[length+REJECTED]=onRejection;if(length===0&&parent._state){asap(publish,parent);}}
function publish(promise){var subscribers=promise._subscribers;var settled=promise._state;if(subscribers.length===0){return;}
var child=void 0,callback=void 0,detail=promise._result;for(var i=0;i<subscribers.length;i+=3){child=subscribers[i];callback=subscribers[i+settled];if(child){invokeCallback(settled,child,callback,detail);}else{callback(detail);}}
promise._subscribers.length=0;}
function tryCatch(callback,detail){try{return callback(detail);}catch(e){TRY_CATCH_ERROR.error=e;return TRY_CATCH_ERROR;}}
function invokeCallback(settled,promise,callback,detail){var hasCallback=isFunction(callback),value=void 0,error=void 0,succeeded=void 0,failed=void 0;if(hasCallback){value=tryCatch(callback,detail);if(value===TRY_CATCH_ERROR){failed=true;error=value.error;value.error=null;}else{succeeded=true;}
if(promise===value){reject(promise,cannotReturnOwn());return;}}else{value=detail;succeeded=true;}
if(promise._state!==PENDING){}else if(hasCallback&&succeeded){resolve(promise,value);}else if(failed){reject(promise,error);}else if(settled===FULFILLED){fulfill(promise,value);}else if(settled===REJECTED){reject(promise,value);}}
function initializePromise(promise,resolver){try{resolver(function resolvePromise(value){resolve(promise,value);},function rejectPromise(reason){reject(promise,reason);});}catch(e){reject(promise,e);}}
var id=0;function nextId(){return id++;}
function makePromise(promise){promise[PROMISE_ID]=id++;promise._state=undefined;promise._result=undefined;promise._subscribers=[];}
function validationError(){return new Error('Array Methods must be provided an Array');}
var Enumerator=function(){function Enumerator(Constructor,input){classCallCheck(this,Enumerator);this._instanceConstructor=Constructor;this.promise=new Constructor(noop);if(!this.promise[PROMISE_ID]){makePromise(this.promise);}
if(isArray(input)){this.length=input.length;this._remaining=input.length;this._result=new Array(this.length);if(this.length===0){fulfill(this.promise,this._result);}else{this.length=this.length||0;this._enumerate(input);if(this._remaining===0){fulfill(this.promise,this._result);}}}else{reject(this.promise,validationError());}}
createClass(Enumerator,[{key:'_enumerate',value:function _enumerate(input){for(var i=0;this._state===PENDING&&i<input.length;i++){this._eachEntry(input[i],i);}}},{key:'_eachEntry',value:function _eachEntry(entry,i){var c=this._instanceConstructor;var resolve$$1=c.resolve;if(resolve$$1===resolve$1){var _then=getThen(entry);if(_then===then&&entry._state!==PENDING){this._settledAt(entry._state,i,entry._result);}else if(typeof _then!=='function'){this._remaining--;this._result[i]=entry;}else if(c===Promise$2){var promise=new c(noop);handleMaybeThenable(promise,entry,_then);this._willSettleAt(promise,i);}else{this._willSettleAt(new c(function(resolve$$1){return resolve$$1(entry);}),i);}}else{this._willSettleAt(resolve$$1(entry),i);}}},{key:'_settledAt',value:function _settledAt(state,i,value){var promise=this.promise;if(promise._state===PENDING){this._remaining--;if(state===REJECTED){reject(promise,value);}else{this._result[i]=value;}}
if(this._remaining===0){fulfill(promise,this._result);}}},{key:'_willSettleAt',value:function _willSettleAt(promise,i){var enumerator=this;subscribe(promise,undefined,function(value){return enumerator._settledAt(FULFILLED,i,value);},function(reason){return enumerator._settledAt(REJECTED,i,reason);});}}]);return Enumerator;}();function all(entries){return new Enumerator(this,entries).promise;}
function race(entries){var Constructor=this;if(!isArray(entries)){return new Constructor(function(_,reject){return reject(new TypeError('You must pass an array to race.'));});}else{return new Constructor(function(resolve,reject){var length=entries.length;for(var i=0;i<length;i++){Constructor.resolve(entries[i]).then(resolve,reject);}});}}
function reject$1(reason){var Constructor=this;var promise=new Constructor(noop);reject(promise,reason);return promise;}
function needsResolver(){throw new TypeError('You must pass a resolver function as the first argument to the promise constructor');}
function needsNew(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");}
var Promise$2=function(){function Promise(resolver){classCallCheck(this,Promise);this[PROMISE_ID]=nextId();this._result=this._state=undefined;this._subscribers=[];if(noop!==resolver){typeof resolver!=='function'&&needsResolver();this instanceof Promise?initializePromise(this,resolver):needsNew();}}
createClass(Promise,[{key:'catch',value:function _catch(onRejection){return this.then(null,onRejection);}},{key:'finally',value:function _finally(callback){var promise=this;var constructor=promise.constructor;if(isFunction(callback)){return promise.then(function(value){return constructor.resolve(callback()).then(function(){return value;});},function(reason){return constructor.resolve(callback()).then(function(){throw reason;});});}
return promise.then(callback,callback);}}]);return Promise;}();Promise$2.prototype.then=then;Promise$2.all=all;Promise$2.race=race;Promise$2.resolve=resolve$1;Promise$2.reject=reject$1;Promise$2._setScheduler=setScheduler;Promise$2._setAsap=setAsap;Promise$2._asap=asap;function polyfill(){var local=void 0;if(typeof global!=='undefined'){local=global;}else if(typeof self!=='undefined'){local=self;}else{try{local=Function('return this')();}catch(e){throw new Error('polyfill failed because global object is unavailable in this environment');}}
var P=local.Promise;if(P){var promiseToString=null;try{promiseToString=Object.prototype.toString.call(P.resolve());}catch(e){}
if(promiseToString==='[object Promise]'&&!P.cast){return;}}
local.Promise=Promise$2;}
Promise$2.polyfill=polyfill;Promise$2.Promise=Promise$2;var Promise$1=typeof Promise!=="undefined"?Promise:Promise$2;function registerLoggingCallbacks(obj){var i,l,key,callbackNames=["begin","done","log","testStart","testDone","moduleStart","moduleDone"];function registerLoggingCallback(key){var loggingCallback=function loggingCallback(callback){if(objectType(callback)!=="function"){throw new Error("QUnit logging methods require a callback function as their first parameters.");}
config.callbacks[key].push(callback);};return loggingCallback;}
for(i=0,l=callbackNames.length;i<l;i++){key=callbackNames[i];if(objectType(config.callbacks[key])==="undefined"){config.callbacks[key]=[];}
obj[key]=registerLoggingCallback(key);}}
function runLoggingCallbacks(key,args){var callbacks=config.callbacks[key];if(key==="log"){callbacks.map(function(callback){return callback(args);});return;}
return callbacks.reduce(function(promiseChain,callback){return promiseChain.then(function(){return Promise$1.resolve(callback(args));});},Promise$1.resolve([]));}
var fileName=(sourceFromStacktrace(0)||"").replace(/(:\d+)+\)?/,"").replace(/.+\//,"");function extractStacktrace(e,offset){offset=offset===undefined?4:offset;var stack,include,i;if(e&&e.stack){stack=e.stack.split("\n");if(/^error$/i.test(stack[0])){stack.shift();}
if(fileName){include=[];for(i=offset;i<stack.length;i++){if(stack[i].indexOf(fileName)!==-1){break;}
include.push(stack[i]);}
if(include.length){return include.join("\n");}}
return stack[offset];}}
function sourceFromStacktrace(offset){var error=new Error();if(!error.stack){try{throw error;}catch(err){error=err;}}
return extractStacktrace(error,offset);}
var priorityCount=0;var unitSampler=void 0;var taskQueue=[];function advance(){advanceTaskQueue();if(!taskQueue.length&&!config.blocking&&!config.current){advanceTestQueue();}}
function advanceTaskQueue(){var start=now();config.depth=(config.depth||0)+1;processTaskQueue(start);config.depth--;}
function processTaskQueue(start){if(taskQueue.length&&!config.blocking){var elapsedTime=now()-start;if(!defined.setTimeout||config.updateRate<=0||elapsedTime<config.updateRate){var task=taskQueue.shift();Promise$1.resolve(task()).then(function(){if(!taskQueue.length){advance();}else{processTaskQueue(start);}});}else{setTimeout$1(advance);}}}
function advanceTestQueue(){if(!config.blocking&&!config.queue.length&&config.depth===0){done();return;}
var testTasks=config.queue.shift();addToTaskQueue(testTasks());if(priorityCount>0){priorityCount--;}
advance();}
function addToTaskQueue(tasksArray){taskQueue.push.apply(taskQueue,toConsumableArray(tasksArray));}
function taskQueueLength(){return taskQueue.length;}
function addToTestQueue(testTasksFunc,prioritize,seed){if(prioritize){config.queue.splice(priorityCount++,0,testTasksFunc);}else if(seed){if(!unitSampler){unitSampler=unitSamplerGenerator(seed);}
var index=Math.floor(unitSampler()*(config.queue.length-priorityCount+1));config.queue.splice(priorityCount+index,0,testTasksFunc);}else{config.queue.push(testTasksFunc);}}
function unitSamplerGenerator(seed){var sample=parseInt(generateHash(seed),16)||-1;return function(){sample^=sample<<13;sample^=sample>>>17;sample^=sample<<5;if(sample<0){sample+=0x100000000;}
return sample/0x100000000;};}
function done(){var storage=config.storage;ProcessingQueue.finished=true;var runtime=now()-config.started;var passed=config.stats.all-config.stats.bad;if(config.stats.all===0){if(config.filter&&config.filter.length){throw new Error("No tests matched the filter \""+config.filter+"\".");}
if(config.module&&config.module.length){throw new Error("No tests matched the module \""+config.module+"\".");}
if(config.moduleId&&config.moduleId.length){throw new Error("No tests matched the moduleId \""+config.moduleId+"\".");}
if(config.testId&&config.testId.length){throw new Error("No tests matched the testId \""+config.testId+"\".");}
throw new Error("No tests were run.");}
emit("runEnd",globalSuite.end(true));runLoggingCallbacks("done",{passed:passed,failed:config.stats.bad,total:config.stats.all,runtime:runtime}).then(function(){if(storage&&config.stats.bad===0){for(var i=storage.length-1;i>=0;i--){var key=storage.key(i);if(key.indexOf("qunit-test-")===0){storage.removeItem(key);}}}});}
var ProcessingQueue={finished:false,add:addToTestQueue,advance:advance,taskCount:taskQueueLength};var TestReport=function(){function TestReport(name,suite,options){classCallCheck(this,TestReport);this.name=name;this.suiteName=suite.name;this.fullName=suite.fullName.concat(name);this.runtime=0;this.assertions=[];this.skipped=!!options.skip;this.todo=!!options.todo;this.valid=options.valid;this._startTime=0;this._endTime=0;suite.pushTest(this);}
createClass(TestReport,[{key:"start",value:function start(recordTime){if(recordTime){this._startTime=performanceNow();if(performance){performance.mark("qunit_test_start");}}
return{name:this.name,suiteName:this.suiteName,fullName:this.fullName.slice()};}},{key:"end",value:function end(recordTime){if(recordTime){this._endTime=performanceNow();if(performance){performance.mark("qunit_test_end");var testName=this.fullName.join(" – ");measure("QUnit Test: "+testName,"qunit_test_start","qunit_test_end");}}
return extend(this.start(),{runtime:this.getRuntime(),status:this.getStatus(),errors:this.getFailedAssertions(),assertions:this.getAssertions()});}},{key:"pushAssertion",value:function pushAssertion(assertion){this.assertions.push(assertion);}},{key:"getRuntime",value:function getRuntime(){return this._endTime-this._startTime;}},{key:"getStatus",value:function getStatus(){if(this.skipped){return"skipped";}
var testPassed=this.getFailedAssertions().length>0?this.todo:!this.todo;if(!testPassed){return"failed";}else if(this.todo){return"todo";}else{return"passed";}}},{key:"getFailedAssertions",value:function getFailedAssertions(){return this.assertions.filter(function(assertion){return!assertion.passed;});}},{key:"getAssertions",value:function getAssertions(){return this.assertions.slice();}},{key:"slimAssertions",value:function slimAssertions(){this.assertions=this.assertions.map(function(assertion){delete assertion.actual;delete assertion.expected;return assertion;});}}]);return TestReport;}();var focused$1=false;function Test(settings){var i,l;++Test.count;this.expected=null;this.assertions=[];this.semaphore=0;this.module=config.currentModule;this.stack=sourceFromStacktrace(3);this.steps=[];this.timeout=undefined;if(this.module.skip){settings.skip=true;settings.todo=false;}else if(this.module.todo&&!settings.skip){settings.todo=true;}
extend(this,settings);this.testReport=new TestReport(settings.testName,this.module.suiteReport,{todo:settings.todo,skip:settings.skip,valid:this.valid()});for(i=0,l=this.module.tests;i<l.length;i++){if(this.module.tests[i].name===this.testName){this.testName+=" ";}}
this.testId=generateHash(this.module.name,this.testName);this.module.tests.push({name:this.testName,testId:this.testId,skip:!!settings.skip});if(settings.skip){this.callback=function(){};this.async=false;this.expected=0;}else{if(typeof this.callback!=="function"){var method=this.todo?"todo":"test";throw new TypeError("You must provide a function as a test callback to QUnit."+method+"(\""+settings.testName+"\")");}
this.assert=new Assert(this);}}
Test.count=0;function getNotStartedModules(startModule){var module=startModule,modules=[];while(module&&module.testsRun===0){modules.push(module);module=module.parentModule;}
return modules.reverse();}
Test.prototype={get moduleName(){return this.module.name;},before:function before(){var _this=this;var module=this.module,notStartedModules=getNotStartedModules(module);var callbackPromises=notStartedModules.reduce(function(promiseChain,startModule){return promiseChain.then(function(){startModule.stats={all:0,bad:0,started:now()};emit("suiteStart",startModule.suiteReport.start(true));return runLoggingCallbacks("moduleStart",{name:startModule.name,tests:startModule.tests});});},Promise$1.resolve([]));return callbackPromises.then(function(){config.current=_this;_this.testEnvironment=extend({},module.testEnvironment);_this.started=now();emit("testStart",_this.testReport.start(true));emit("OdooBeforeTestHook");return runLoggingCallbacks("testStart",{name:_this.testName,module:module.name,testId:_this.testId,previousFailure:_this.previousFailure}).then(function(){if(!config.pollution){saveGlobal();}});});},run:function run(){var promise;config.current=this;this.callbackStarted=now();if(config.notrycatch){runTest(this);return;}
try{runTest(this);}catch(e){lastError=e;this.pushFailure("Died on test #"+(this.assertions.length+1)+" "+this.stack+": "+(e.message||e),extractStacktrace(e,0));saveGlobal();if(config.blocking){internalRecover(this);}}
function runTest(test){promise=test.callback.call(test.testEnvironment,test.assert);test.resolvePromise(promise);if(test.timeout===0&&test.semaphore!==0){pushFailure("Test did not finish synchronously even though assert.timeout( 0 ) was used.",sourceFromStacktrace(2));}}},after:function after(){checkPollution();},queueHook:function queueHook(hook,hookName,hookOwner){var _this2=this;var callHook=function callHook(){var promise=hook.call(_this2.testEnvironment,_this2.assert);_this2.resolvePromise(promise,hookName);};var runHook=function runHook(){if(hookName==="before"){if(hookOwner.unskippedTestsRun!==0){return;}
_this2.preserveEnvironment=true;}
if(hookName==="after"&&hookOwner.unskippedTestsRun!==numberOfUnskippedTests(hookOwner)-1&&(config.queue.length>0||ProcessingQueue.taskCount()>2)){return;}
config.current=_this2;if(config.notrycatch){callHook();return;}
try{callHook();}catch(error){_this2.pushFailure(hookName+" failed on "+_this2.testName+": "+(error.message||error),extractStacktrace(error,0));}};return runHook;},hooks:function hooks(handler){var hooks=[];function processHooks(test,module){if(module.parentModule){processHooks(test,module.parentModule);}
if(module.hooks[handler].length){for(var i=0;i<module.hooks[handler].length;i++){hooks.push(test.queueHook(module.hooks[handler][i],handler,module));}}}
if(!this.skip){processHooks(this,this.module);}
return hooks;},finish:function finish(){config.current=this;this.callback=undefined;if(this.steps.length){var stepsList=this.steps.join(", ");this.pushFailure("Expected assert.verifySteps() to be called before end of test "+("after using assert.step(). Unverified steps: "+stepsList),this.stack);}
if(config.requireExpects&&this.expected===null){this.pushFailure("Expected number of assertions to be defined, but expect() was "+"not called.",this.stack);}else if(this.expected!==null&&this.expected!==this.assertions.length){this.pushFailure("Expected "+this.expected+" assertions, but "+this.assertions.length+" were run",this.stack);}else if(this.expected===null&&!this.assertions.length){this.pushFailure("Expected at least one assertion, but none were run - call "+"expect(0) to accept zero assertions.",this.stack);}
emit("OdooAfterTestHook",this);var i,module=this.module,moduleName=module.name,testName=this.testName,skipped=!!this.skip,todo=!!this.todo,bad=0,storage=config.storage;this.runtime=now()-this.started;config.stats.all+=this.assertions.length;module.stats.all+=this.assertions.length;for(i=0;i<this.assertions.length;i++){if(!this.assertions[i].result){bad++;config.stats.bad++;module.stats.bad++;}}
notifyTestsRan(module,skipped);if(storage){if(bad){storage.setItem("qunit-test-"+moduleName+"-"+testName,bad);}else{storage.removeItem("qunit-test-"+moduleName+"-"+testName);}}
emit("testEnd",this.testReport.end(true));this.testReport.slimAssertions();return runLoggingCallbacks("testDone",{name:testName,module:moduleName,skipped:skipped,todo:todo,failed:bad,passed:this.assertions.length-bad,total:this.assertions.length,runtime:skipped?0:this.runtime,assertions:this.assertions,testId:this.testId,source:this.stack}).then(function(){if(module.testsRun===numberOfTests(module)){var completedModules=[module];var parent=module.parentModule;while(parent&&parent.testsRun===numberOfTests(parent)){completedModules.push(parent);parent=parent.parentModule;}
return completedModules.reduce(function(promiseChain,completedModule){return promiseChain.then(function(){return logSuiteEnd(completedModule);});},Promise$1.resolve([]));}}).then(function(){config.current=undefined;});function logSuiteEnd(module){module.hooks={};emit("suiteEnd",module.suiteReport.end(true));return runLoggingCallbacks("moduleDone",{name:module.name,tests:module.tests,failed:module.stats.bad,passed:module.stats.all-module.stats.bad,total:module.stats.all,runtime:now()-module.stats.started});}},preserveTestEnvironment:function preserveTestEnvironment(){if(this.preserveEnvironment){this.module.testEnvironment=this.testEnvironment;this.testEnvironment=extend({},this.module.testEnvironment);}},queue:function queue(){var test=this;if(!this.valid()){return;}
function runTest(){return[function(){return test.before();}].concat(toConsumableArray(test.hooks("before")),[function(){test.preserveTestEnvironment();}],toConsumableArray(test.hooks("beforeEach")),[function(){test.run();}],toConsumableArray(test.hooks("afterEach").reverse()),toConsumableArray(test.hooks("after").reverse()),[function(){test.after();},function(){return test.finish();}]);}
var previousFailCount=config.storage&&+config.storage.getItem("qunit-test-"+this.module.name+"-"+this.testName);var prioritize=config.reorder&&!!previousFailCount;this.previousFailure=!!previousFailCount;ProcessingQueue.add(runTest,prioritize,config.seed);if(ProcessingQueue.finished){ProcessingQueue.advance();}},pushResult:function pushResult(resultInfo){if(this!==config.current){throw new Error("Assertion occurred after test had finished.");}
var source,details={module:this.module.name,name:this.testName,result:resultInfo.result,message:resultInfo.message,actual:resultInfo.actual,testId:this.testId,negative:resultInfo.negative||false,runtime:now()-this.started,todo:!!this.todo};if(hasOwn.call(resultInfo,"expected")){details.expected=resultInfo.expected;}
if(!resultInfo.result){source=resultInfo.source||sourceFromStacktrace();if(source){details.source=source;}}
this.logAssertion(details);this.assertions.push({result:!!resultInfo.result,message:resultInfo.message});},pushFailure:function pushFailure(message,source,actual){if(!(this instanceof Test)){throw new Error("pushFailure() assertion outside test context, was "+sourceFromStacktrace(2));}
this.pushResult({result:false,message:message||"error",actual:actual||null,source:source});},logAssertion:function logAssertion(details){runLoggingCallbacks("log",details);var assertion={passed:details.result,actual:details.actual,expected:details.expected,message:details.message,stack:details.source,todo:details.todo};this.testReport.pushAssertion(assertion);emit("assertion",assertion);},resolvePromise:function resolvePromise(promise,phase){var then,resume,message,test=this;if(promise!=null){then=promise.then;if(objectType(then)==="function"){resume=internalStop(test);if(config.notrycatch){then.call(promise,function(){resume();});}else{then.call(promise,function(){resume();},function(error){lastError=error;message="Promise rejected "+(!phase?"during":phase.replace(/Each$/,""))+" \""+test.testName+"\": "+(error&&error.message||error);test.pushFailure(message,extractStacktrace(error,0));saveGlobal();internalRecover(test);});}}}},valid:function valid(){var filter=config.filter,regexFilter=/^(!?)\/([\w\W]*)\/(i?$)/.exec(filter),module=config.module&&config.module.toLowerCase(),fullName=this.module.name+": "+this.testName;function moduleChainNameMatch(testModule){var testModuleName=testModule.name?testModule.name.toLowerCase():null;if(testModuleName===module){return true;}else if(testModule.parentModule){return moduleChainNameMatch(testModule.parentModule);}else{return false;}}
function moduleChainIdMatch(testModule){return inArray(testModule.moduleId,config.moduleId)||testModule.parentModule&&moduleChainIdMatch(testModule.parentModule);}
if(this.callback&&this.callback.validTest){return true;}
if(config.moduleId&&config.moduleId.length>0&&!moduleChainIdMatch(this.module)){return false;}
if(config.testId&&config.testId.length>0&&!inArray(this.testId,config.testId)){return false;}
if(module&&!moduleChainNameMatch(this.module)){return false;}
if(!filter){return true;}
return regexFilter?this.regexFilter(!!regexFilter[1],regexFilter[2],regexFilter[3],fullName):this.stringFilter(filter,fullName);},regexFilter:function regexFilter(exclude,pattern,flags,fullName){var regex=new RegExp(pattern,flags);var match=regex.test(fullName);return match!==exclude;},stringFilter:function stringFilter(filter,fullName){filter=filter.toLowerCase();fullName=fullName.toLowerCase();var include=filter.charAt(0)!=="!";if(!include){filter=filter.slice(1);}
if(fullName.indexOf(filter)!==-1){return include;}
return!include;}};function pushFailure(){if(!config.current){throw new Error("pushFailure() assertion outside test context, in "+sourceFromStacktrace(2));}
var currentTest=config.current;return currentTest.pushFailure.apply(currentTest,arguments);}
function saveGlobal(){config.pollution=[];if(config.noglobals){for(var key in global$1){if(hasOwn.call(global$1,key)){if(/^qunit-test-output/.test(key)){continue;}
config.pollution.push(key);}}}}
function checkPollution(){var newGlobals,deletedGlobals,old=config.pollution;saveGlobal();newGlobals=diff(config.pollution,old);if(newGlobals.length>0){pushFailure("Introduced global variable(s): "+newGlobals.join(", "));}
deletedGlobals=diff(old,config.pollution);if(deletedGlobals.length>0){pushFailure("Deleted global variable(s): "+deletedGlobals.join(", "));}}
function test(testName,callback){if(focused$1){return;}
var newTest=new Test({testName:testName,callback:callback});newTest.queue();}
function todo(testName,callback){if(focused$1){return;}
var newTest=new Test({testName:testName,callback:callback,todo:true});newTest.queue();}
function skip(testName){if(focused$1){return;}
var test=new Test({testName:testName,skip:true});test.queue();}
function only(testName,callback){if(focused$1){return;}
config.queue.length=0;focused$1=true;var newTest=new Test({testName:testName,callback:callback});newTest.queue();}
function internalStop(test){test.semaphore+=1;config.blocking=true;if(defined.setTimeout){var timeoutDuration=void 0;if(typeof test.timeout==="number"){timeoutDuration=test.timeout;}else if(typeof config.testTimeout==="number"){timeoutDuration=config.testTimeout;}
if(typeof timeoutDuration==="number"&&timeoutDuration>0){clearTimeout(config.timeout);config.timeout=setTimeout$1(function(){pushFailure("Test took longer than "+timeoutDuration+"ms; test timed out.",sourceFromStacktrace(2));internalRecover(test);},timeoutDuration);}}
var released=false;return function resume(){if(released){return;}
released=true;test.semaphore-=1;internalStart(test);};}
function internalRecover(test){test.semaphore=0;internalStart(test);}
function internalStart(test){if(isNaN(test.semaphore)){test.semaphore=0;pushFailure("Invalid value on test.semaphore",sourceFromStacktrace(2));return;}
if(test.semaphore>0){return;}
if(test.semaphore<0){test.semaphore=0;pushFailure("Tried to restart test while already started (test's semaphore was 0 already)",sourceFromStacktrace(2));return;}
if(defined.setTimeout){if(config.timeout){clearTimeout(config.timeout);}
config.timeout=setTimeout$1(function(){if(test.semaphore>0){return;}
if(config.timeout){clearTimeout(config.timeout);}
begin();});}else{begin();}}
function collectTests(module){var tests=[].concat(module.tests);var modules=[].concat(toConsumableArray(module.childModules));while(modules.length){var nextModule=modules.shift();tests.push.apply(tests,nextModule.tests);modules.push.apply(modules,toConsumableArray(nextModule.childModules));}
return tests;}
function numberOfTests(module){return collectTests(module).length;}
function numberOfUnskippedTests(module){return collectTests(module).filter(function(test){return!test.skip;}).length;}
function notifyTestsRan(module,skipped){module.testsRun++;if(!skipped){module.unskippedTestsRun++;}
while(module=module.parentModule){module.testsRun++;if(!skipped){module.unskippedTestsRun++;}}}
var Assert=function(){function Assert(testContext){classCallCheck(this,Assert);this.test=testContext;}
createClass(Assert,[{key:"timeout",value:function timeout(duration){if(typeof duration!=="number"){throw new Error("You must pass a number as the duration to assert.timeout");}
this.test.timeout=duration;}},{key:"step",value:function step(message){var assertionMessage=message;var result=!!message;this.test.steps.push(message);if(objectType(message)==="undefined"||message===""){assertionMessage="You must provide a message to assert.step";}else if(objectType(message)!=="string"){assertionMessage="You must provide a string value to assert.step";result=false;}
this.pushResult({result:result,message:assertionMessage});}},{key:"verifySteps",value:function verifySteps(steps,message){var actualStepsClone=this.test.steps.slice();this.deepEqual(actualStepsClone,steps,message);this.test.steps.length=0;}},{key:"expect",value:function expect(asserts){if(arguments.length===1){this.test.expected=asserts;}else{return this.test.expected;}}},{key:"async",value:function async(count){var test$$1=this.test;var popped=false,acceptCallCount=count;if(typeof acceptCallCount==="undefined"){acceptCallCount=1;}
var resume=internalStop(test$$1);return function done(){if(config.current!==test$$1){throw Error("assert.async callback called after test finished.");}
if(popped){test$$1.pushFailure("Too many calls to the `assert.async` callback",sourceFromStacktrace(2));return;}
acceptCallCount-=1;if(acceptCallCount>0){return;}
popped=true;resume();};}},{key:"push",value:function push(result,actual,expected,message,negative){Logger.warn("assert.push is deprecated and will be removed in QUnit 3.0."+" Please use assert.pushResult instead (https://api.qunitjs.com/assert/pushResult).");var currentAssert=this instanceof Assert?this:config.current.assert;return currentAssert.pushResult({result:result,actual:actual,expected:expected,message:message,negative:negative});}},{key:"pushResult",value:function pushResult(resultInfo){var assert=this;var currentTest=assert instanceof Assert&&assert.test||config.current;if(!currentTest){throw new Error("assertion outside test context, in "+sourceFromStacktrace(2));}
if(!(assert instanceof Assert)){assert=currentTest.assert;}
return assert.test.pushResult(resultInfo);}},{key:"ok",value:function ok(result,message){if(!message){message=result?"okay":"failed, expected argument to be truthy, was: "+dump.parse(result);}
this.pushResult({result:!!result,actual:result,expected:true,message:message});}},{key:"notOk",value:function notOk(result,message){if(!message){message=!result?"okay":"failed, expected argument to be falsy, was: "+dump.parse(result);}
this.pushResult({result:!result,actual:result,expected:false,message:message});}},{key:"equal",value:function equal(actual,expected,message){var result=expected==actual;this.pushResult({result:result,actual:actual,expected:expected,message:message});}},{key:"notEqual",value:function notEqual(actual,expected,message){var result=expected!=actual;this.pushResult({result:result,actual:actual,expected:expected,message:message,negative:true});}},{key:"propEqual",value:function propEqual(actual,expected,message){actual=objectValues(actual);expected=objectValues(expected);this.pushResult({result:equiv(actual,expected),actual:actual,expected:expected,message:message});}},{key:"notPropEqual",value:function notPropEqual(actual,expected,message){actual=objectValues(actual);expected=objectValues(expected);this.pushResult({result:!equiv(actual,expected),actual:actual,expected:expected,message:message,negative:true});}},{key:"deepEqual",value:function deepEqual(actual,expected,message){this.pushResult({result:equiv(actual,expected),actual:actual,expected:expected,message:message});}},{key:"notDeepEqual",value:function notDeepEqual(actual,expected,message){this.pushResult({result:!equiv(actual,expected),actual:actual,expected:expected,message:message,negative:true});}},{key:"strictEqual",value:function strictEqual(actual,expected,message){this.pushResult({result:expected===actual,actual:actual,expected:expected,message:message});}},{key:"notStrictEqual",value:function notStrictEqual(actual,expected,message){this.pushResult({result:expected!==actual,actual:actual,expected:expected,message:message,negative:true});}},{key:"throws",value:function throws(block,expected,message){var actual=void 0,result=false;var currentTest=this instanceof Assert&&this.test||config.current;if(objectType(expected)==="string"){if(message==null){message=expected;expected=null;}else{throw new Error("throws/raises does not accept a string value for the expected argument.\n"+"Use a non-string object value (e.g. regExp) instead if it's necessary.");}}
currentTest.ignoreGlobalErrors=true;try{block.call(currentTest.testEnvironment);}catch(e){actual=e;}
currentTest.ignoreGlobalErrors=false;if(actual){var expectedType=objectType(expected);if(!expected){result=true;}else if(expectedType==="regexp"){result=expected.test(errorString(actual));expected=String(expected);}else if(expectedType==="function"&&actual instanceof expected){result=true;}else if(expectedType==="object"){result=actual instanceof expected.constructor&&actual.name===expected.name&&actual.message===expected.message;expected=errorString(expected);}else if(expectedType==="function"&&expected.call({},actual)===true){expected=null;result=true;}}
currentTest.assert.pushResult({result:result,actual:actual&&errorString(actual),expected:expected,message:message});}},{key:"rejects",value:function rejects(promise,expected,message){var result=false;var currentTest=this instanceof Assert&&this.test||config.current;if(objectType(expected)==="string"){if(message===undefined){message=expected;expected=undefined;}else{message="assert.rejects does not accept a string value for the expected "+"argument.\nUse a non-string object value (e.g. validator function) instead "+"if necessary.";currentTest.assert.pushResult({result:false,message:message});return;}}
var then=promise&&promise.then;if(objectType(then)!=="function"){var _message="The value provided to `assert.rejects` in "+"\""+currentTest.testName+"\" was not a promise.";currentTest.assert.pushResult({result:false,message:_message,actual:promise});return;}
var done=this.async();return then.call(promise,function handleFulfillment(){var message="The promise returned by the `assert.rejects` callback in "+"\""+currentTest.testName+"\" did not reject.";currentTest.assert.pushResult({result:false,message:message,actual:promise});done();},function handleRejection(actual){var expectedType=objectType(expected);if(expected===undefined){result=true;}else if(expectedType==="regexp"){result=expected.test(errorString(actual));expected=String(expected);}else if(expectedType==="function"&&actual instanceof expected){result=true;}else if(expectedType==="object"){result=actual instanceof expected.constructor&&actual.name===expected.name&&actual.message===expected.message;expected=errorString(expected);}else{if(expectedType==="function"){result=expected.call({},actual)===true;expected=null;}else{result=false;message="invalid expected value provided to `assert.rejects` "+"callback in \""+currentTest.testName+"\": "+expectedType+".";}}
currentTest.assert.pushResult({result:result,actual:actual&&errorString(actual),expected:expected,message:message});done();});}}]);return Assert;}();Assert.prototype.raises=Assert.prototype["throws"];function errorString(error){var resultErrorString=error.toString();if(resultErrorString.substring(0,7)==="[object"){var name=error.name?error.name.toString():"Error";var message=error.message?error.message.toString():"";if(name&&message){return name+": "+message;}else if(name){return name;}else if(message){return message;}else{return"Error";}}else{return resultErrorString;}}
function exportQUnit(QUnit){if(defined.document){if(window$1.QUnit&&window$1.QUnit.version){throw new Error("QUnit has already been defined.");}
window$1.QUnit=QUnit;}
if(typeof module!=="undefined"&&module&&module.exports){module.exports=QUnit;module.exports.QUnit=QUnit;}
if(typeof exports!=="undefined"&&exports){exports.QUnit=QUnit;}
if(typeof define==="function"&&define.amd){define(function(){return QUnit;});QUnit.config.autostart=false;}
if(self$1&&self$1.WorkerGlobalScope&&self$1 instanceof self$1.WorkerGlobalScope){self$1.QUnit=QUnit;}}
function onError(error){for(var _len=arguments.length,args=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){args[_key-1]=arguments[_key];}
if(config.current){if(config.current.ignoreGlobalErrors){return true;}
pushFailure.apply(undefined,[error.message,error.stacktrace||error.fileName+":"+error.lineNumber].concat(args));}else{test("global failure",extend(function(){pushFailure.apply(undefined,[error.message,error.stacktrace||error.fileName+":"+error.lineNumber].concat(args));},{validTest:true}));}
return false;}
function onUnhandledRejection(reason){var resultInfo={result:false,message:reason.message||"error",actual:reason,source:reason.stack||sourceFromStacktrace(3)};var currentTest=config.current;if(currentTest){currentTest.assert.pushResult(resultInfo);}else{test("global failure",extend(function(assert){assert.pushResult(resultInfo);},{validTest:true}));}}
var QUnit={};var globalSuite=new SuiteReport();config.currentModule.suiteReport=globalSuite;var globalStartCalled=false;var runStarted=false;QUnit.isLocal=!(defined.document&&window$1.location.protocol!=="file:");QUnit.version="2.9.1";extend(QUnit,{on:on,module:module$1,test:test,todo:todo,skip:skip,only:only,start:function start(count){var globalStartAlreadyCalled=globalStartCalled;if(!config.current){globalStartCalled=true;if(runStarted){throw new Error("Called start() while test already started running");}else if(globalStartAlreadyCalled||count>1){throw new Error("Called start() outside of a test context too many times");}else if(config.autostart){throw new Error("Called start() outside of a test context when "+"QUnit.config.autostart was true");}else if(!config.pageLoaded){config.autostart=true;if(!defined.document){QUnit.load();}
return;}}else{throw new Error("QUnit.start cannot be called inside a test context.");}
scheduleBegin();},config:config,is:is,objectType:objectType,extend:extend,load:function load(){config.pageLoaded=true;extend(config,{stats:{all:0,bad:0},started:0,updateRate:1000,autostart:true,filter:""},true);if(!runStarted){config.blocking=false;if(config.autostart){scheduleBegin();}}},stack:function stack(offset){offset=(offset||0)+2;return sourceFromStacktrace(offset);},onError:onError,onUnhandledRejection:onUnhandledRejection});QUnit.pushFailure=pushFailure;QUnit.assert=Assert.prototype;QUnit.equiv=equiv;QUnit.dump=dump;registerLoggingCallbacks(QUnit);function scheduleBegin(){runStarted=true;if(defined.setTimeout){setTimeout$1(function(){begin();});}else{begin();}}
function unblockAndAdvanceQueue(){config.blocking=false;ProcessingQueue.advance();}
function begin(){var i,l,modulesLog=[];if(!config.started){config.started=now();if(config.modules[0].name===""&&config.modules[0].tests.length===0){config.modules.shift();}
for(i=0,l=config.modules.length;i<l;i++){modulesLog.push({name:config.modules[i].name,tests:config.modules[i].tests});}
emit("runStart",globalSuite.start(true));runLoggingCallbacks("begin",{totalTests:Test.count,modules:modulesLog}).then(unblockAndAdvanceQueue);}else{unblockAndAdvanceQueue();}}
exportQUnit(QUnit);(function(){if(typeof window$1==="undefined"||typeof document$1==="undefined"){return;}
var config=QUnit.config,hasOwn=Object.prototype.hasOwnProperty;function storeFixture(){if(hasOwn.call(config,"fixture")){return;}
var fixture=document$1.getElementById("qunit-fixture");if(fixture){config.fixture=fixture.cloneNode(true);}}
QUnit.begin(storeFixture);function resetFixture(){if(config.fixture==null){return;}
var fixture=document$1.getElementById("qunit-fixture");var resetFixtureType=_typeof(config.fixture);if(resetFixtureType==="string"){var newFixture=document$1.createElement("div");newFixture.setAttribute("id","qunit-fixture");newFixture.innerHTML=config.fixture;fixture.parentNode.replaceChild(newFixture,fixture);}else{var clonedFixture=config.fixture.cloneNode(true);fixture.parentNode.replaceChild(clonedFixture,fixture);}}
QUnit.testStart(resetFixture);})();(function(){var location=typeof window$1!=="undefined"&&window$1.location;if(!location){return;}
var urlParams=getUrlParams();QUnit.urlParams=urlParams;QUnit.config.moduleId=[].concat(urlParams.moduleId||[]);QUnit.config.testId=[].concat(urlParams.testId||[]);QUnit.config.module=urlParams.module;QUnit.config.filter=urlParams.filter;if(urlParams.seed===true){QUnit.config.seed=Math.random().toString(36).slice(2);}else if(urlParams.seed){QUnit.config.seed=urlParams.seed;}
QUnit.config.urlConfig.push({id:"hidepassed",label:"Hide passed tests",tooltip:"Only show tests and assertions that fail. Stored as query-strings."},{id:"noglobals",label:"Check for Globals",tooltip:"Enabling this will test if any test introduces new properties on the "+"global object (`window` in Browsers). Stored as query-strings."},{id:"notrycatch",label:"No try-catch",tooltip:"Enabling this will run tests outside of a try-catch block. Makes debugging "+"exceptions in IE reasonable. Stored as query-strings."});QUnit.begin(function(){var i,option,urlConfig=QUnit.config.urlConfig;for(i=0;i<urlConfig.length;i++){option=QUnit.config.urlConfig[i];if(typeof option!=="string"){option=option.id;}
if(QUnit.config[option]===undefined){QUnit.config[option]=urlParams[option];}}});function getUrlParams(){var i,param,name,value;var urlParams=Object.create(null);var params=location.search.slice(1).split("&");var length=params.length;for(i=0;i<length;i++){if(params[i]){param=params[i].split("=");name=decodeQueryParam(param[0]);value=param.length===1||decodeQueryParam(param.slice(1).join("="));if(name in urlParams){urlParams[name]=[].concat(urlParams[name],value);}else{urlParams[name]=value;}}}
return urlParams;}
function decodeQueryParam(param){return decodeURIComponent(param.replace(/\+/g,"%20"));}})();var stats={passedTests:0,failedTests:0,skippedTests:0,todoTests:0};function escapeText(s){if(!s){return"";}
s=s+"";return s.replace(/['"<>&]/g,function(s){switch(s){case"'":return"&#039;";case"\"":return"&quot;";case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";}});}
(function(){if(typeof window$1==="undefined"||!window$1.document){return;}
var config=QUnit.config,hiddenTests=[],document=window$1.document,collapseNext=false,hasOwn=Object.prototype.hasOwnProperty,unfilteredUrl=setUrl({filter:undefined,module:undefined,moduleId:undefined,testId:undefined}),modulesList=[];function addEvent(elem,type,fn){elem.addEventListener(type,fn,false);}
function removeEvent(elem,type,fn){elem.removeEventListener(type,fn,false);}
function addEvents(elems,type,fn){var i=elems.length;while(i--){addEvent(elems[i],type,fn);}}
function hasClass(elem,name){return(" "+elem.className+" ").indexOf(" "+name+" ")>=0;}
function addClass(elem,name){if(!hasClass(elem,name)){elem.className+=(elem.className?" ":"")+name;}}
function toggleClass(elem,name,force){if(force||typeof force==="undefined"&&!hasClass(elem,name)){addClass(elem,name);}else{removeClass(elem,name);}}
function removeClass(elem,name){var set=" "+elem.className+" ";while(set.indexOf(" "+name+" ")>=0){set=set.replace(" "+name+" "," ");}
elem.className=typeof set.trim==="function"?set.trim():set.replace(/^\s+|\s+$/g,"");}
function id(name){return document.getElementById&&document.getElementById(name);}
function abortTests(){var abortButton=id("qunit-abort-tests-button");if(abortButton){abortButton.disabled=true;abortButton.innerHTML="Aborting...";}
QUnit.config.queue.length=0;return false;}
function interceptNavigation(ev){applyUrlParams();if(ev&&ev.preventDefault){ev.preventDefault();}
return false;}
function getUrlConfigHtml(){var i,j,val,escaped,escapedTooltip,selection=false,urlConfig=config.urlConfig,urlConfigHtml="";for(i=0;i<urlConfig.length;i++){val=config.urlConfig[i];if(typeof val==="string"){val={id:val,label:val};}
escaped=escapeText(val.id);escapedTooltip=escapeText(val.tooltip);if(!val.value||typeof val.value==="string"){urlConfigHtml+="<label for='qunit-urlconfig-"+escaped+"' title='"+escapedTooltip+"'><input id='qunit-urlconfig-"+escaped+"' name='"+escaped+"' type='checkbox'"+(val.value?" value='"+escapeText(val.value)+"'":"")+(config[val.id]?" checked='checked'":"")+" title='"+escapedTooltip+"' />"+escapeText(val.label)+"</label>";}else{urlConfigHtml+="<label for='qunit-urlconfig-"+escaped+"' title='"+escapedTooltip+"'>"+val.label+": </label><select id='qunit-urlconfig-"+escaped+"' name='"+escaped+"' title='"+escapedTooltip+"'><option></option>";if(QUnit.is("array",val.value)){for(j=0;j<val.value.length;j++){escaped=escapeText(val.value[j]);urlConfigHtml+="<option value='"+escaped+"'"+(config[val.id]===val.value[j]?(selection=true)&&" selected='selected'":"")+">"+escaped+"</option>";}}else{for(j in val.value){if(hasOwn.call(val.value,j)){urlConfigHtml+="<option value='"+escapeText(j)+"'"+(config[val.id]===j?(selection=true)&&" selected='selected'":"")+">"+escapeText(val.value[j])+"</option>";}}}
if(config[val.id]&&!selection){escaped=escapeText(config[val.id]);urlConfigHtml+="<option value='"+escaped+"' selected='selected' disabled='disabled'>"+escaped+"</option>";}
urlConfigHtml+="</select>";}}
return urlConfigHtml;}
function toolbarChanged(){var updatedUrl,value,tests,field=this,params={};if("selectedIndex"in field){value=field.options[field.selectedIndex].value||undefined;}else{value=field.checked?field.defaultValue||true:undefined;}
params[field.name]=value;updatedUrl=setUrl(params);if("hidepassed"===field.name&&"replaceState"in window$1.history){QUnit.urlParams[field.name]=value;config[field.name]=value||false;tests=id("qunit-tests");if(tests){var length=tests.children.length;var children=tests.children;if(field.checked){for(var i=0;i<length;i++){var test=children[i];if(test&&test.className.indexOf("pass")>-1){hiddenTests.push(test);}}
var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=hiddenTests[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var hiddenTest=_step.value;tests.removeChild(hiddenTest);}}catch(err){_didIteratorError=true;_iteratorError=err;}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return();}}finally{if(_didIteratorError){throw _iteratorError;}}}}else{while((test=hiddenTests.pop())!=null){tests.appendChild(test);}}}
window$1.history.replaceState(null,"",updatedUrl);}else{window$1.location=updatedUrl;}}
function setUrl(params){var key,arrValue,i,querystring="?",location=window$1.location;params=QUnit.extend(QUnit.extend({},QUnit.urlParams),params);for(key in params){if(hasOwn.call(params,key)&&params[key]!==undefined){arrValue=[].concat(params[key]);for(i=0;i<arrValue.length;i++){querystring+=encodeURIComponent(key);if(arrValue[i]!==true){querystring+="="+encodeURIComponent(arrValue[i]);}
querystring+="&";}}}
return location.protocol+"//"+location.host+location.pathname+querystring.slice(0,-1);}
function applyUrlParams(){var i,selectedModules=[],modulesList=id("qunit-modulefilter-dropdown-list").getElementsByTagName("input"),filter=id("qunit-filter-input").value;for(i=0;i<modulesList.length;i++){if(modulesList[i].checked){selectedModules.push(modulesList[i].value);}}
window$1.location=setUrl({filter:filter===""?undefined:filter,moduleId:selectedModules.length===0?undefined:selectedModules,module:undefined,testId:undefined});}
function toolbarUrlConfigContainer(){var urlConfigContainer=document.createElement("span");urlConfigContainer.innerHTML=getUrlConfigHtml();addClass(urlConfigContainer,"qunit-url-config");addEvents(urlConfigContainer.getElementsByTagName("input"),"change",toolbarChanged);addEvents(urlConfigContainer.getElementsByTagName("select"),"change",toolbarChanged);return urlConfigContainer;}
function abortTestsButton(){var button=document.createElement("button");button.id="qunit-abort-tests-button";button.innerHTML="Abort";addEvent(button,"click",abortTests);return button;}
function toolbarLooseFilter(){var filter=document.createElement("form"),label=document.createElement("label"),input=document.createElement("input"),button=document.createElement("button");addClass(filter,"qunit-filter");label.innerHTML="Filter: ";input.type="text";input.value=config.filter||"";input.name="filter";input.id="qunit-filter-input";button.innerHTML="Go";label.appendChild(input);filter.appendChild(label);filter.appendChild(document.createTextNode(" "));filter.appendChild(button);addEvent(filter,"submit",interceptNavigation);return filter;}
function moduleListHtml(){var i,checked,html="";for(i=0;i<config.modules.length;i++){if(config.modules[i].name!==""){checked=config.moduleId.indexOf(config.modules[i].moduleId)>-1;html+="<li><label class='clickable"+(checked?" checked":"")+"'><input type='checkbox' "+"value='"+config.modules[i].moduleId+"'"+(checked?" checked='checked'":"")+" />"+escapeText(config.modules[i].name)+"</label></li>";}}
return html;}
function toolbarModuleFilter(){var allCheckbox,commit,reset,moduleFilter=document.createElement("form"),label=document.createElement("label"),moduleSearch=document.createElement("input"),dropDown=document.createElement("div"),actions=document.createElement("span"),dropDownList=document.createElement("ul"),dirty=false;moduleSearch.id="qunit-modulefilter-search";moduleSearch.autocomplete="off";addEvent(moduleSearch,"input",searchInput);addEvent(moduleSearch,"input",searchFocus);addEvent(moduleSearch,"focus",searchFocus);addEvent(moduleSearch,"click",searchFocus);label.id="qunit-modulefilter-search-container";label.innerHTML="Module: ";label.appendChild(moduleSearch);actions.id="qunit-modulefilter-actions";actions.innerHTML="<button style='display:none'>Apply</button>"+"<button type='reset' style='display:none'>Reset</button>"+"<label class='clickable"+(config.moduleId.length?"":" checked")+"'><input type='checkbox'"+(config.moduleId.length?"":" checked='checked'")+" />All modules</label>";allCheckbox=actions.lastChild.firstChild;commit=actions.firstChild;reset=commit.nextSibling;addEvent(commit,"click",applyUrlParams);dropDownList.id="qunit-modulefilter-dropdown-list";dropDownList.innerHTML=moduleListHtml();dropDown.id="qunit-modulefilter-dropdown";dropDown.style.display="none";dropDown.appendChild(actions);dropDown.appendChild(dropDownList);addEvent(dropDown,"change",selectionChange);selectionChange();moduleFilter.id="qunit-modulefilter";moduleFilter.appendChild(label);moduleFilter.appendChild(dropDown);addEvent(moduleFilter,"submit",interceptNavigation);addEvent(moduleFilter,"reset",function(){window$1.setTimeout(selectionChange);});function searchFocus(){if(dropDown.style.display!=="none"){return;}
dropDown.style.display="block";addEvent(document,"click",hideHandler);addEvent(document,"keydown",hideHandler);function hideHandler(e){var inContainer=moduleFilter.contains(e.target);if(e.keyCode===27||!inContainer){if(e.keyCode===27&&inContainer){moduleSearch.focus();}
dropDown.style.display="none";removeEvent(document,"click",hideHandler);removeEvent(document,"keydown",hideHandler);moduleSearch.value="";searchInput();}}}
function searchInput(){var i,item,searchText=moduleSearch.value.toLowerCase(),listItems=dropDownList.children;for(i=0;i<listItems.length;i++){item=listItems[i];if(!searchText||item.textContent.toLowerCase().indexOf(searchText)>-1){item.style.display="";}else{item.style.display="none";}}}
function selectionChange(evt){var i,item,checkbox=evt&&evt.target||allCheckbox,modulesList=dropDownList.getElementsByTagName("input"),selectedNames=[];toggleClass(checkbox.parentNode,"checked",checkbox.checked);dirty=false;if(checkbox.checked&&checkbox!==allCheckbox){allCheckbox.checked=false;removeClass(allCheckbox.parentNode,"checked");}
for(i=0;i<modulesList.length;i++){item=modulesList[i];if(!evt){toggleClass(item.parentNode,"checked",item.checked);}else if(checkbox===allCheckbox&&checkbox.checked){item.checked=false;removeClass(item.parentNode,"checked");}
dirty=dirty||item.checked!==item.defaultChecked;if(item.checked){selectedNames.push(item.parentNode.textContent);}}
commit.style.display=reset.style.display=dirty?"":"none";moduleSearch.placeholder=selectedNames.join(", ")||allCheckbox.parentNode.textContent;moduleSearch.title="Type to filter list. Current selection:\n"+(selectedNames.join("\n")||allCheckbox.parentNode.textContent);}
return moduleFilter;}
function appendToolbar(){var toolbar=id("qunit-testrunner-toolbar");if(toolbar){toolbar.appendChild(toolbarUrlConfigContainer());toolbar.appendChild(toolbarModuleFilter());toolbar.appendChild(toolbarLooseFilter());toolbar.appendChild(document.createElement("div")).className="clearfix";}}
function appendHeader(){var header=id("qunit-header");if(header){header.innerHTML="<a href='"+escapeText(unfilteredUrl)+"'>"+header.innerHTML+"</a> ";}}
function appendBanner(){var banner=id("qunit-banner");if(banner){banner.className="";}}
function appendTestResults(){var tests=id("qunit-tests"),result=id("qunit-testresult"),controls;if(result){result.parentNode.removeChild(result);}
if(tests){tests.innerHTML="";result=document.createElement("p");result.id="qunit-testresult";result.className="result";tests.parentNode.insertBefore(result,tests);result.innerHTML="<div id=\"qunit-testresult-display\">Running...<br />&#160;</div>"+"<div id=\"qunit-testresult-controls\"></div>"+"<div class=\"clearfix\"></div>";controls=id("qunit-testresult-controls");}
if(controls){controls.appendChild(abortTestsButton());}}
function appendFilteredTest(){var testId=QUnit.config.testId;if(!testId||testId.length<=0){return"";}
return"<div id='qunit-filteredTest'>Rerunning selected tests: "+escapeText(testId.join(", "))+" <a id='qunit-clearFilter' href='"+escapeText(unfilteredUrl)+"'>Run all tests</a></div>";}
function appendUserAgent(){var userAgent=id("qunit-userAgent");if(userAgent){userAgent.innerHTML="";userAgent.appendChild(document.createTextNode("QUnit "+QUnit.version+"; "+navigator.userAgent));}}
function appendInterface(){var qunit=id("qunit");if(qunit){qunit.innerHTML="<h1 id='qunit-header'>"+escapeText(document.title)+"</h1>"+"<h2 id='qunit-banner'></h2>"+"<div id='qunit-testrunner-toolbar'></div>"+appendFilteredTest()+"<h2 id='qunit-userAgent'></h2>"+"<ol id='qunit-tests'></ol>";}
appendHeader();appendBanner();appendTestResults();appendUserAgent();appendToolbar();}
function appendTest(name,testId,moduleName){var title,rerunTrigger,testBlock,assertList,tests=id("qunit-tests");if(!tests){return;}
title=document.createElement("strong");title.innerHTML=getNameHtml(name,moduleName);rerunTrigger=document.createElement("a");rerunTrigger.innerHTML="Rerun";rerunTrigger.href=setUrl({testId:testId});testBlock=document.createElement("li");testBlock.appendChild(title);testBlock.appendChild(rerunTrigger);testBlock.id="qunit-test-output-"+testId;assertList=document.createElement("ol");assertList.className="qunit-assert-list";testBlock.appendChild(assertList);tests.appendChild(testBlock);}
QUnit.begin(function(details){var i,moduleObj;for(i=0;i<details.modules.length;i++){moduleObj=details.modules[i];if(moduleObj.name){modulesList.push(moduleObj.name);}}
modulesList.sort(function(a,b){return a.localeCompare(b);});appendInterface();});QUnit.done(function(details){var banner=id("qunit-banner"),tests=id("qunit-tests"),abortButton=id("qunit-abort-tests-button"),totalTests=stats.passedTests+stats.skippedTests+stats.todoTests+stats.failedTests,html=[totalTests," tests completed in ",details.runtime," milliseconds, with ",stats.failedTests," failed, ",stats.skippedTests," skipped, and ",stats.todoTests," todo.<br />","<span class='passed'>",details.passed,"</span> assertions of <span class='total'>",details.total,"</span> passed, <span class='failed'>",details.failed,"</span> failed."].join(""),test,assertLi,assertList;if(abortButton&&abortButton.disabled){html="Tests aborted after "+details.runtime+" milliseconds.";for(var i=0;i<tests.children.length;i++){test=tests.children[i];if(test.className===""||test.className==="running"){test.className="aborted";assertList=test.getElementsByTagName("ol")[0];assertLi=document.createElement("li");assertLi.className="fail";assertLi.innerHTML="Test aborted.";assertList.appendChild(assertLi);}}}
if(banner&&(!abortButton||abortButton.disabled===false)){banner.className=stats.failedTests?"qunit-fail":"qunit-pass";}
if(abortButton){abortButton.parentNode.removeChild(abortButton);}
if(tests){id("qunit-testresult-display").innerHTML=html;}
if(config.altertitle&&document.title){document.title=[stats.failedTests?"\u2716":"\u2714",document.title.replace(/^[\u2714\u2716] /i,"")].join(" ");}
if(config.scrolltop&&window$1.scrollTo){window$1.scrollTo(0,0);}});function getNameHtml(name,module){var nameHtml="";if(module){nameHtml="<span class='module-name'>"+escapeText(module)+"</span>: ";}
nameHtml+="<span class='test-name'>"+escapeText(name)+"</span>";return nameHtml;}
QUnit.testStart(function(details){var running,bad;appendTest(details.name,details.testId,details.module);running=id("qunit-testresult-display");if(running){addClass(running,"running");bad=QUnit.config.reorder&&details.previousFailure;running.innerHTML=[bad?"Rerunning previously failed test: <br />":"Running: <br />",getNameHtml(details.name,details.module)].join("");}});function stripHtml(string){return string.replace(/<\/?[^>]+(>|$)/g,"").replace(/&quot;/g,"").replace(/\s+/g,"");}
QUnit.log(function(details){var assertList,assertLi,message,expected,actual,diff,showDiff=false,testItem=id("qunit-test-output-"+details.testId);if(!testItem){return;}
message=escapeText(details.message)||(details.result?"okay":"failed");message="<span class='test-message'>"+message+"</span>";message+="<span class='runtime'>@ "+details.runtime+" ms</span>";if(!details.result&&hasOwn.call(details,"expected")){if(details.negative){expected="NOT "+QUnit.dump.parse(details.expected);}else{expected=QUnit.dump.parse(details.expected);}
actual=QUnit.dump.parse(details.actual);message+="<table><tr class='test-expected'><th>Expected: </th><td><pre>"+escapeText(expected)+"</pre></td></tr>";if(actual!==expected){message+="<tr class='test-actual'><th>Result: </th><td><pre>"+escapeText(actual)+"</pre></td></tr>";if(typeof details.actual==="number"&&typeof details.expected==="number"){if(!isNaN(details.actual)&&!isNaN(details.expected)){showDiff=true;diff=details.actual-details.expected;diff=(diff>0?"+":"")+diff;}}else if(typeof details.actual!=="boolean"&&typeof details.expected!=="boolean"){diff=QUnit.diff(expected,actual);showDiff=stripHtml(diff).length!==stripHtml(expected).length+stripHtml(actual).length;}
if(showDiff){message+="<tr class='test-diff'><th>Diff: </th><td><pre>"+diff+"</pre></td></tr>";}}else if(expected.indexOf("[object Array]")!==-1||expected.indexOf("[object Object]")!==-1){message+="<tr class='test-message'><th>Message: </th><td>"+"Diff suppressed as the depth of object is more than current max depth ("+QUnit.config.maxDepth+").<p>Hint: Use <code>QUnit.dump.maxDepth</code> to "+" run with a higher max depth or <a href='"+escapeText(setUrl({maxDepth:-1}))+"'>"+"Rerun</a> without max depth.</p></td></tr>";}else{message+="<tr class='test-message'><th>Message: </th><td>"+"Diff suppressed as the expected and actual results have an equivalent"+" serialization</td></tr>";}
if(details.source){message+="<tr class='test-source'><th>Source: </th><td><pre>"+escapeText(details.source)+"</pre></td></tr>";}
message+="</table>";}else if(!details.result&&details.source){message+="<table>"+"<tr class='test-source'><th>Source: </th><td><pre>"+escapeText(details.source)+"</pre></td></tr>"+"</table>";}
assertList=testItem.getElementsByTagName("ol")[0];assertLi=document.createElement("li");assertLi.className=details.result?"pass":"fail";assertLi.innerHTML=message;assertList.appendChild(assertLi);if(lastError&&QUnit.annotateTraceback&&debug&&debug.includes("assets")){const pre=assertLi.querySelector("pre");QUnit.annotateTraceback(lastError).then(traceback=>{pre.innerText=traceback;});lastError=null;}});QUnit.testDone(function(details){var testTitle,time,testItem,assertList,status,good,bad,testCounts,skipped,sourceName,tests=id("qunit-tests");if(!tests){return;}
testItem=id("qunit-test-output-"+details.testId);removeClass(testItem,"running");if(details.failed>0){status="failed";}else if(details.todo){status="todo";}else{status=details.skipped?"skipped":"passed";}
assertList=testItem.getElementsByTagName("ol")[0];good=details.passed;bad=details.failed;var testPassed=details.failed>0?details.todo:!details.todo;if(testPassed){addClass(assertList,"qunit-collapsed");}else if(config.collapse){if(!collapseNext){collapseNext=true;}else{addClass(assertList,"qunit-collapsed");}}
testTitle=testItem.firstChild;testCounts=bad?"<b class='failed'>"+bad+"</b>, "+"<b class='passed'>"+good+"</b>, ":"";testTitle.innerHTML+=" <b class='counts'>("+testCounts+details.assertions.length+")</b>";if(details.skipped){stats.skippedTests++;testItem.className="skipped";skipped=document.createElement("em");skipped.className="qunit-skipped-label";skipped.innerHTML="skipped";testItem.insertBefore(skipped,testTitle);}else{addEvent(testTitle,"click",function(){toggleClass(assertList,"qunit-collapsed");});testItem.className=testPassed?"pass":"fail";if(details.todo){var todoLabel=document.createElement("em");todoLabel.className="qunit-todo-label";todoLabel.innerHTML="todo";testItem.className+=" todo";testItem.insertBefore(todoLabel,testTitle);}
time=document.createElement("span");time.className="runtime";time.innerHTML=details.runtime+" ms";testItem.insertBefore(time,assertList);if(!testPassed){stats.failedTests++;}else if(details.todo){stats.todoTests++;}else{stats.passedTests++;}}
if(details.source){sourceName=document.createElement("p");sourceName.innerHTML="<strong>Source: </strong>"+escapeText(details.source);addClass(sourceName,"qunit-source");if(testPassed){addClass(sourceName,"qunit-collapsed");}
addEvent(testTitle,"click",function(){toggleClass(sourceName,"qunit-collapsed");});testItem.appendChild(sourceName);}
if(config.hidepassed&&status==="passed"){hiddenTests.push(testItem);tests.removeChild(testItem);}});var notPhantom=function(p){return!(p&&p.version&&p.version.major>0);}(window$1.phantom);if(notPhantom&&document.readyState==="complete"){QUnit.load();}else{addEvent(window$1,"load",QUnit.load);}
var originalWindowOnError=window$1.onerror;window$1.onerror=function(message,fileName,lineNumber,columnNumber,errorObj){var ret=false;if(originalWindowOnError){for(var _len=arguments.length,args=Array(_len>5?_len-5:0),_key=5;_key<_len;_key++){args[_key-5]=arguments[_key];}
ret=originalWindowOnError.call.apply(originalWindowOnError,[this,message,fileName,lineNumber,columnNumber,errorObj].concat(args));}
if(ret!==true){var error={message:message,fileName:fileName,lineNumber:lineNumber};if(errorObj&&errorObj.stack){error.stacktrace=extractStacktrace(errorObj,0);}
ret=QUnit.onError(error);}
return ret;};window$1.addEventListener("unhandledrejection",function(event){QUnit.onUnhandledRejection(event.reason);});})();QUnit.diff=function(){function DiffMatchPatch(){}
var DIFF_DELETE=-1,DIFF_INSERT=1,DIFF_EQUAL=0;DiffMatchPatch.prototype.DiffMain=function(text1,text2,optChecklines){var deadline,checklines,commonlength,commonprefix,commonsuffix,diffs;deadline=new Date().getTime()+1000;if(text1===null||text2===null){throw new Error("Null input. (DiffMain)");}
if(text1===text2){if(text1){return[[DIFF_EQUAL,text1]];}
return[];}
if(typeof optChecklines==="undefined"){optChecklines=true;}
checklines=optChecklines;commonlength=this.diffCommonPrefix(text1,text2);commonprefix=text1.substring(0,commonlength);text1=text1.substring(commonlength);text2=text2.substring(commonlength);commonlength=this.diffCommonSuffix(text1,text2);commonsuffix=text1.substring(text1.length-commonlength);text1=text1.substring(0,text1.length-commonlength);text2=text2.substring(0,text2.length-commonlength);diffs=this.diffCompute(text1,text2,checklines,deadline);if(commonprefix){diffs.unshift([DIFF_EQUAL,commonprefix]);}
if(commonsuffix){diffs.push([DIFF_EQUAL,commonsuffix]);}
this.diffCleanupMerge(diffs);return diffs;};DiffMatchPatch.prototype.diffCleanupEfficiency=function(diffs){var changes,equalities,equalitiesLength,lastequality,pointer,preIns,preDel,postIns,postDel;changes=false;equalities=[];equalitiesLength=0;lastequality=null;pointer=0;preIns=false;preDel=false;postIns=false;postDel=false;while(pointer<diffs.length){if(diffs[pointer][0]===DIFF_EQUAL){if(diffs[pointer][1].length<4&&(postIns||postDel)){equalities[equalitiesLength++]=pointer;preIns=postIns;preDel=postDel;lastequality=diffs[pointer][1];}else{equalitiesLength=0;lastequality=null;}
postIns=postDel=false;}else{if(diffs[pointer][0]===DIFF_DELETE){postDel=true;}else{postIns=true;}
if(lastequality&&(preIns&&preDel&&postIns&&postDel||lastequality.length<2&&preIns+preDel+postIns+postDel===3)){diffs.splice(equalities[equalitiesLength-1],0,[DIFF_DELETE,lastequality]);diffs[equalities[equalitiesLength-1]+1][0]=DIFF_INSERT;equalitiesLength--;lastequality=null;if(preIns&&preDel){postIns=postDel=true;equalitiesLength=0;}else{equalitiesLength--;pointer=equalitiesLength>0?equalities[equalitiesLength-1]:-1;postIns=postDel=false;}
changes=true;}}
pointer++;}
if(changes){this.diffCleanupMerge(diffs);}};DiffMatchPatch.prototype.diffPrettyHtml=function(diffs){var op,data,x,html=[];for(x=0;x<diffs.length;x++){op=diffs[x][0];data=diffs[x][1];switch(op){case DIFF_INSERT:html[x]="<ins>"+escapeText(data)+"</ins>";break;case DIFF_DELETE:html[x]="<del>"+escapeText(data)+"</del>";break;case DIFF_EQUAL:html[x]="<span>"+escapeText(data)+"</span>";break;}}
return html.join("");};DiffMatchPatch.prototype.diffCommonPrefix=function(text1,text2){var pointermid,pointermax,pointermin,pointerstart;if(!text1||!text2||text1.charAt(0)!==text2.charAt(0)){return 0;}
pointermin=0;pointermax=Math.min(text1.length,text2.length);pointermid=pointermax;pointerstart=0;while(pointermin<pointermid){if(text1.substring(pointerstart,pointermid)===text2.substring(pointerstart,pointermid)){pointermin=pointermid;pointerstart=pointermin;}else{pointermax=pointermid;}
pointermid=Math.floor((pointermax-pointermin)/2+pointermin);}
return pointermid;};DiffMatchPatch.prototype.diffCommonSuffix=function(text1,text2){var pointermid,pointermax,pointermin,pointerend;if(!text1||!text2||text1.charAt(text1.length-1)!==text2.charAt(text2.length-1)){return 0;}
pointermin=0;pointermax=Math.min(text1.length,text2.length);pointermid=pointermax;pointerend=0;while(pointermin<pointermid){if(text1.substring(text1.length-pointermid,text1.length-pointerend)===text2.substring(text2.length-pointermid,text2.length-pointerend)){pointermin=pointermid;pointerend=pointermin;}else{pointermax=pointermid;}
pointermid=Math.floor((pointermax-pointermin)/2+pointermin);}
return pointermid;};DiffMatchPatch.prototype.diffCompute=function(text1,text2,checklines,deadline){var diffs,longtext,shorttext,i,hm,text1A,text2A,text1B,text2B,midCommon,diffsA,diffsB;if(!text1){return[[DIFF_INSERT,text2]];}
if(!text2){return[[DIFF_DELETE,text1]];}
longtext=text1.length>text2.length?text1:text2;shorttext=text1.length>text2.length?text2:text1;i=longtext.indexOf(shorttext);if(i!==-1){diffs=[[DIFF_INSERT,longtext.substring(0,i)],[DIFF_EQUAL,shorttext],[DIFF_INSERT,longtext.substring(i+shorttext.length)]];if(text1.length>text2.length){diffs[0][0]=diffs[2][0]=DIFF_DELETE;}
return diffs;}
if(shorttext.length===1){return[[DIFF_DELETE,text1],[DIFF_INSERT,text2]];}
hm=this.diffHalfMatch(text1,text2);if(hm){text1A=hm[0];text1B=hm[1];text2A=hm[2];text2B=hm[3];midCommon=hm[4];diffsA=this.DiffMain(text1A,text2A,checklines,deadline);diffsB=this.DiffMain(text1B,text2B,checklines,deadline);return diffsA.concat([[DIFF_EQUAL,midCommon]],diffsB);}
if(checklines&&text1.length>100&&text2.length>100){return this.diffLineMode(text1,text2,deadline);}
return this.diffBisect(text1,text2,deadline);};DiffMatchPatch.prototype.diffHalfMatch=function(text1,text2){var longtext,shorttext,dmp,text1A,text2B,text2A,text1B,midCommon,hm1,hm2,hm;longtext=text1.length>text2.length?text1:text2;shorttext=text1.length>text2.length?text2:text1;if(longtext.length<4||shorttext.length*2<longtext.length){return null;}
dmp=this;function diffHalfMatchI(longtext,shorttext,i){var seed,j,bestCommon,prefixLength,suffixLength,bestLongtextA,bestLongtextB,bestShorttextA,bestShorttextB;seed=longtext.substring(i,i+Math.floor(longtext.length/4));j=-1;bestCommon="";while((j=shorttext.indexOf(seed,j+1))!==-1){prefixLength=dmp.diffCommonPrefix(longtext.substring(i),shorttext.substring(j));suffixLength=dmp.diffCommonSuffix(longtext.substring(0,i),shorttext.substring(0,j));if(bestCommon.length<suffixLength+prefixLength){bestCommon=shorttext.substring(j-suffixLength,j)+shorttext.substring(j,j+prefixLength);bestLongtextA=longtext.substring(0,i-suffixLength);bestLongtextB=longtext.substring(i+prefixLength);bestShorttextA=shorttext.substring(0,j-suffixLength);bestShorttextB=shorttext.substring(j+prefixLength);}}
if(bestCommon.length*2>=longtext.length){return[bestLongtextA,bestLongtextB,bestShorttextA,bestShorttextB,bestCommon];}else{return null;}}
hm1=diffHalfMatchI(longtext,shorttext,Math.ceil(longtext.length/4));hm2=diffHalfMatchI(longtext,shorttext,Math.ceil(longtext.length/2));if(!hm1&&!hm2){return null;}else if(!hm2){hm=hm1;}else if(!hm1){hm=hm2;}else{hm=hm1[4].length>hm2[4].length?hm1:hm2;}
if(text1.length>text2.length){text1A=hm[0];text1B=hm[1];text2A=hm[2];text2B=hm[3];}else{text2A=hm[0];text2B=hm[1];text1A=hm[2];text1B=hm[3];}
midCommon=hm[4];return[text1A,text1B,text2A,text2B,midCommon];};DiffMatchPatch.prototype.diffLineMode=function(text1,text2,deadline){var a,diffs,linearray,pointer,countInsert,countDelete,textInsert,textDelete,j;a=this.diffLinesToChars(text1,text2);text1=a.chars1;text2=a.chars2;linearray=a.lineArray;diffs=this.DiffMain(text1,text2,false,deadline);this.diffCharsToLines(diffs,linearray);this.diffCleanupSemantic(diffs);diffs.push([DIFF_EQUAL,""]);pointer=0;countDelete=0;countInsert=0;textDelete="";textInsert="";while(pointer<diffs.length){switch(diffs[pointer][0]){case DIFF_INSERT:countInsert++;textInsert+=diffs[pointer][1];break;case DIFF_DELETE:countDelete++;textDelete+=diffs[pointer][1];break;case DIFF_EQUAL:if(countDelete>=1&&countInsert>=1){diffs.splice(pointer-countDelete-countInsert,countDelete+countInsert);pointer=pointer-countDelete-countInsert;a=this.DiffMain(textDelete,textInsert,false,deadline);for(j=a.length-1;j>=0;j--){diffs.splice(pointer,0,a[j]);}
pointer=pointer+a.length;}
countInsert=0;countDelete=0;textDelete="";textInsert="";break;}
pointer++;}
diffs.pop();return diffs;};DiffMatchPatch.prototype.diffBisect=function(text1,text2,deadline){var text1Length,text2Length,maxD,vOffset,vLength,v1,v2,x,delta,front,k1start,k1end,k2start,k2end,k2Offset,k1Offset,x1,x2,y1,y2,d,k1,k2;text1Length=text1.length;text2Length=text2.length;maxD=Math.ceil((text1Length+text2Length)/2);vOffset=maxD;vLength=2*maxD;v1=new Array(vLength);v2=new Array(vLength);for(x=0;x<vLength;x++){v1[x]=-1;v2[x]=-1;}
v1[vOffset+1]=0;v2[vOffset+1]=0;delta=text1Length-text2Length;front=delta%2!==0;k1start=0;k1end=0;k2start=0;k2end=0;for(d=0;d<maxD;d++){if(new Date().getTime()>deadline){break;}
for(k1=-d+k1start;k1<=d-k1end;k1+=2){k1Offset=vOffset+k1;if(k1===-d||k1!==d&&v1[k1Offset-1]<v1[k1Offset+1]){x1=v1[k1Offset+1];}else{x1=v1[k1Offset-1]+1;}
y1=x1-k1;while(x1<text1Length&&y1<text2Length&&text1.charAt(x1)===text2.charAt(y1)){x1++;y1++;}
v1[k1Offset]=x1;if(x1>text1Length){k1end+=2;}else if(y1>text2Length){k1start+=2;}else if(front){k2Offset=vOffset+delta-k1;if(k2Offset>=0&&k2Offset<vLength&&v2[k2Offset]!==-1){x2=text1Length-v2[k2Offset];if(x1>=x2){return this.diffBisectSplit(text1,text2,x1,y1,deadline);}}}}
for(k2=-d+k2start;k2<=d-k2end;k2+=2){k2Offset=vOffset+k2;if(k2===-d||k2!==d&&v2[k2Offset-1]<v2[k2Offset+1]){x2=v2[k2Offset+1];}else{x2=v2[k2Offset-1]+1;}
y2=x2-k2;while(x2<text1Length&&y2<text2Length&&text1.charAt(text1Length-x2-1)===text2.charAt(text2Length-y2-1)){x2++;y2++;}
v2[k2Offset]=x2;if(x2>text1Length){k2end+=2;}else if(y2>text2Length){k2start+=2;}else if(!front){k1Offset=vOffset+delta-k2;if(k1Offset>=0&&k1Offset<vLength&&v1[k1Offset]!==-1){x1=v1[k1Offset];y1=vOffset+x1-k1Offset;x2=text1Length-x2;if(x1>=x2){return this.diffBisectSplit(text1,text2,x1,y1,deadline);}}}}}
return[[DIFF_DELETE,text1],[DIFF_INSERT,text2]];};DiffMatchPatch.prototype.diffBisectSplit=function(text1,text2,x,y,deadline){var text1a,text1b,text2a,text2b,diffs,diffsb;text1a=text1.substring(0,x);text2a=text2.substring(0,y);text1b=text1.substring(x);text2b=text2.substring(y);diffs=this.DiffMain(text1a,text2a,false,deadline);diffsb=this.DiffMain(text1b,text2b,false,deadline);return diffs.concat(diffsb);};DiffMatchPatch.prototype.diffCleanupSemantic=function(diffs){var changes,equalities,equalitiesLength,lastequality,pointer,lengthInsertions2,lengthDeletions2,lengthInsertions1,lengthDeletions1,deletion,insertion,overlapLength1,overlapLength2;changes=false;equalities=[];equalitiesLength=0;lastequality=null;pointer=0;lengthInsertions1=0;lengthDeletions1=0;lengthInsertions2=0;lengthDeletions2=0;while(pointer<diffs.length){if(diffs[pointer][0]===DIFF_EQUAL){equalities[equalitiesLength++]=pointer;lengthInsertions1=lengthInsertions2;lengthDeletions1=lengthDeletions2;lengthInsertions2=0;lengthDeletions2=0;lastequality=diffs[pointer][1];}else{if(diffs[pointer][0]===DIFF_INSERT){lengthInsertions2+=diffs[pointer][1].length;}else{lengthDeletions2+=diffs[pointer][1].length;}
if(lastequality&&lastequality.length<=Math.max(lengthInsertions1,lengthDeletions1)&&lastequality.length<=Math.max(lengthInsertions2,lengthDeletions2)){diffs.splice(equalities[equalitiesLength-1],0,[DIFF_DELETE,lastequality]);diffs[equalities[equalitiesLength-1]+1][0]=DIFF_INSERT;equalitiesLength--;equalitiesLength--;pointer=equalitiesLength>0?equalities[equalitiesLength-1]:-1;lengthInsertions1=0;lengthDeletions1=0;lengthInsertions2=0;lengthDeletions2=0;lastequality=null;changes=true;}}
pointer++;}
if(changes){this.diffCleanupMerge(diffs);}
pointer=1;while(pointer<diffs.length){if(diffs[pointer-1][0]===DIFF_DELETE&&diffs[pointer][0]===DIFF_INSERT){deletion=diffs[pointer-1][1];insertion=diffs[pointer][1];overlapLength1=this.diffCommonOverlap(deletion,insertion);overlapLength2=this.diffCommonOverlap(insertion,deletion);if(overlapLength1>=overlapLength2){if(overlapLength1>=deletion.length/2||overlapLength1>=insertion.length/2){diffs.splice(pointer,0,[DIFF_EQUAL,insertion.substring(0,overlapLength1)]);diffs[pointer-1][1]=deletion.substring(0,deletion.length-overlapLength1);diffs[pointer+1][1]=insertion.substring(overlapLength1);pointer++;}}else{if(overlapLength2>=deletion.length/2||overlapLength2>=insertion.length/2){diffs.splice(pointer,0,[DIFF_EQUAL,deletion.substring(0,overlapLength2)]);diffs[pointer-1][0]=DIFF_INSERT;diffs[pointer-1][1]=insertion.substring(0,insertion.length-overlapLength2);diffs[pointer+1][0]=DIFF_DELETE;diffs[pointer+1][1]=deletion.substring(overlapLength2);pointer++;}}
pointer++;}
pointer++;}};DiffMatchPatch.prototype.diffCommonOverlap=function(text1,text2){var text1Length,text2Length,textLength,best,length,pattern,found;text1Length=text1.length;text2Length=text2.length;if(text1Length===0||text2Length===0){return 0;}
if(text1Length>text2Length){text1=text1.substring(text1Length-text2Length);}else if(text1Length<text2Length){text2=text2.substring(0,text1Length);}
textLength=Math.min(text1Length,text2Length);if(text1===text2){return textLength;}
best=0;length=1;while(true){pattern=text1.substring(textLength-length);found=text2.indexOf(pattern);if(found===-1){return best;}
length+=found;if(found===0||text1.substring(textLength-length)===text2.substring(0,length)){best=length;length++;}}};DiffMatchPatch.prototype.diffLinesToChars=function(text1,text2){var lineArray,lineHash,chars1,chars2;lineArray=[];lineHash={};lineArray[0]="";function diffLinesToCharsMunge(text){var chars,lineStart,lineEnd,lineArrayLength,line;chars="";lineStart=0;lineEnd=-1;lineArrayLength=lineArray.length;while(lineEnd<text.length-1){lineEnd=text.indexOf("\n",lineStart);if(lineEnd===-1){lineEnd=text.length-1;}
line=text.substring(lineStart,lineEnd+1);lineStart=lineEnd+1;var lineHashExists=lineHash.hasOwnProperty?lineHash.hasOwnProperty(line):lineHash[line]!==undefined;if(lineHashExists){chars+=String.fromCharCode(lineHash[line]);}else{chars+=String.fromCharCode(lineArrayLength);lineHash[line]=lineArrayLength;lineArray[lineArrayLength++]=line;}}
return chars;}
chars1=diffLinesToCharsMunge(text1);chars2=diffLinesToCharsMunge(text2);return{chars1:chars1,chars2:chars2,lineArray:lineArray};};DiffMatchPatch.prototype.diffCharsToLines=function(diffs,lineArray){var x,chars,text,y;for(x=0;x<diffs.length;x++){chars=diffs[x][1];text=[];for(y=0;y<chars.length;y++){text[y]=lineArray[chars.charCodeAt(y)];}
diffs[x][1]=text.join("");}};DiffMatchPatch.prototype.diffCleanupMerge=function(diffs){var pointer,countDelete,countInsert,textInsert,textDelete,commonlength,changes,diffPointer,position;diffs.push([DIFF_EQUAL,""]);pointer=0;countDelete=0;countInsert=0;textDelete="";textInsert="";while(pointer<diffs.length){switch(diffs[pointer][0]){case DIFF_INSERT:countInsert++;textInsert+=diffs[pointer][1];pointer++;break;case DIFF_DELETE:countDelete++;textDelete+=diffs[pointer][1];pointer++;break;case DIFF_EQUAL:if(countDelete+countInsert>1){if(countDelete!==0&&countInsert!==0){commonlength=this.diffCommonPrefix(textInsert,textDelete);if(commonlength!==0){if(pointer-countDelete-countInsert>0&&diffs[pointer-countDelete-countInsert-1][0]===DIFF_EQUAL){diffs[pointer-countDelete-countInsert-1][1]+=textInsert.substring(0,commonlength);}else{diffs.splice(0,0,[DIFF_EQUAL,textInsert.substring(0,commonlength)]);pointer++;}
textInsert=textInsert.substring(commonlength);textDelete=textDelete.substring(commonlength);}
commonlength=this.diffCommonSuffix(textInsert,textDelete);if(commonlength!==0){diffs[pointer][1]=textInsert.substring(textInsert.length-commonlength)+diffs[pointer][1];textInsert=textInsert.substring(0,textInsert.length-commonlength);textDelete=textDelete.substring(0,textDelete.length-commonlength);}}
if(countDelete===0){diffs.splice(pointer-countInsert,countDelete+countInsert,[DIFF_INSERT,textInsert]);}else if(countInsert===0){diffs.splice(pointer-countDelete,countDelete+countInsert,[DIFF_DELETE,textDelete]);}else{diffs.splice(pointer-countDelete-countInsert,countDelete+countInsert,[DIFF_DELETE,textDelete],[DIFF_INSERT,textInsert]);}
pointer=pointer-countDelete-countInsert+(countDelete?1:0)+(countInsert?1:0)+1;}else if(pointer!==0&&diffs[pointer-1][0]===DIFF_EQUAL){diffs[pointer-1][1]+=diffs[pointer][1];diffs.splice(pointer,1);}else{pointer++;}
countInsert=0;countDelete=0;textDelete="";textInsert="";break;}}
if(diffs[diffs.length-1][1]===""){diffs.pop();}
changes=false;pointer=1;while(pointer<diffs.length-1){if(diffs[pointer-1][0]===DIFF_EQUAL&&diffs[pointer+1][0]===DIFF_EQUAL){diffPointer=diffs[pointer][1];position=diffPointer.substring(diffPointer.length-diffs[pointer-1][1].length);if(position===diffs[pointer-1][1]){diffs[pointer][1]=diffs[pointer-1][1]+diffs[pointer][1].substring(0,diffs[pointer][1].length-diffs[pointer-1][1].length);diffs[pointer+1][1]=diffs[pointer-1][1]+diffs[pointer+1][1];diffs.splice(pointer-1,1);changes=true;}else if(diffPointer.substring(0,diffs[pointer+1][1].length)===diffs[pointer+1][1]){diffs[pointer-1][1]+=diffs[pointer+1][1];diffs[pointer][1]=diffs[pointer][1].substring(diffs[pointer+1][1].length)+diffs[pointer+1][1];diffs.splice(pointer+1,1);changes=true;}}
pointer++;}
if(changes){this.diffCleanupMerge(diffs);}};return function(o,n){var diff,output,text;diff=new DiffMatchPatch();output=diff.DiffMain(o,n);diff.diffCleanupEfficiency(output);text=diff.diffPrettyHtml(output);return text;};}();}((function(){return this;}())));;

/* /web/static/tests/legacy/helpers/mock_server.js defined in bundle 'web.tests_assets' */
odoo.define('web.MockServer',function(require){"use strict";var Class=require('web.Class');var Domain=require('web.Domain');var pyUtils=require('web.py_utils');var MockServer=Class.extend({init:function(data,options){options=options||{};this.data=data;for(var modelName in this.data){var model=this.data[modelName];if(!('id'in model.fields)){model.fields.id={string:"ID",type:"integer"};}
if(!('display_name'in model.fields)){model.fields.display_name={string:"Display Name",type:"char"};}
if(!('__last_update'in model.fields)){model.fields.__last_update={string:"Last Modified on",type:"datetime"};}
if(!('name'in model.fields)){model.fields.name={string:"Name",type:"char",default:"name"};}
model.records=model.records||[];for(var i=0;i<model.records.length;i++){const values=model.records[i];const id=values.id===undefined?this._getUnusedID(modelName):values.id;model.records[i]={id};this._applyDefaults(model,values);this._writeRecord(modelName,values,id,{ensureIntegrity:false,});}}
this.debug=options.debug;this.currentDate=options.currentDate||moment().format("YYYY-MM-DD");this.actions=options.actions||[];this.archs=options.archs||{};},fieldsGet:function(model){return this.data[model].fields;},fieldsViewGet:function(params){var model=params.model;var toolbar=params.toolbar;var viewId=params.view_id;var viewOptions=params.viewOptions||{};if(!(model in this.data)){throw new Error('Model '+model+' was not defined in mock server data');}
var fields=$.extend(true,{},this.data[model].fields);var fvg=this._fieldsViewGet(params.arch,model,fields,viewOptions.context||{});if(toolbar){fvg.toolbar=toolbar;}
if(viewId){fvg.view_id=viewId;}
return fvg;},async performFetch(resource,init){if(this.debug){console.log('%c[fetch] request '+resource,'color: blue; font-weight: bold;',JSON.parse(JSON.stringify(init)));}
const res=await this._performFetch(resource,init);if(this.debug){console.log('%c[fetch] response'+resource,'color: blue; font-weight: bold;',res);}
return res;},performRpc:function(route,args){var debug=this.debug;args=JSON.parse(JSON.stringify(args));if(debug){console.log('%c[rpc] request '+route,'color: blue; font-weight: bold;',args);args=JSON.parse(JSON.stringify(args));}
var def=this._performRpc(route,args);var abort=def.abort||def.reject;if(abort){abort=abort.bind(def);}else{abort=function(rejectError=true){if(rejectError){throw new Error("XmlHttpRequestError abort");}}}
def=def.then(function(result){var resultString=JSON.stringify(result||false);if(debug){console.log('%c[rpc] response'+route,'color: blue; font-weight: bold;',JSON.parse(resultString));}
return JSON.parse(resultString);},function(result){var message=result&&result.message;var event=result&&result.event;var errorString=typeof message!=="string"?JSON.stringify(message||false):message;if(debug){console.warn('%c[rpc] response (error) %s%s, during test %s','color: orange; font-weight: bold;',route,message!=null&&` -> ${errorString}`,JSON.stringify(QUnit.config.current.testName));}
return Promise.reject({message:errorString,event:event||$.Event()});});def.abort=abort;return def;},_applyDefaults:function(model,record){record.display_name=record.display_name||record.name;for(var fieldName in model.fields){if(fieldName==='id'){continue;}
if(!(fieldName in record)){if('default'in model.fields[fieldName]){const def=model.fields[fieldName].default;record[fieldName]=typeof def==='function'?def.call(this):def;}else if(_.contains(['one2many','many2many'],model.fields[fieldName].type)){record[fieldName]=[];}else{record[fieldName]=false;}}}},_convertToOnChange(model,values){Object.entries(values).forEach(([fname,val])=>{const field=this.data[model].fields[fname];if(field.type==='many2one'&&typeof val==='number'){const m2oRecord=this.data[field.relation].records.find(r=>r.id===val);values[fname]=[val,m2oRecord.display_name];}else if(field.type==='one2many'||field.type==='many2many'){const isCommandList=val.length&&Array.isArray(val[0]);if(!isCommandList){values[fname]=[[6,false,val]];}else{val.forEach(cmd=>{if(cmd[0]===0||cmd[0]===1){cmd[2]=this._convertToOnChange(field.relation,cmd[2]);}});}}});return values;},_evaluateDomain:function(domain,fieldValues){return new Domain(domain).compute(fieldValues);},_fieldsViewGet:function(arch,model,fields,context){var self=this;var modifiersNames=['invisible','readonly','required'];var onchanges=this.data[model].onchanges||{};var fieldNodes={};var groupbyNodes={};var doc;if(typeof arch==='string'){doc=$.parseXML(arch).documentElement;}else{doc=arch;}
var inTreeView=(doc.tagName==='tree');const isBaseModel=!context.base_model_name||(model===context.base_model_name);var views=['kanban','tree','form','gantt','activity'];if(isBaseModel&&views.indexOf(doc.tagName)!==-1){for(let action of['create','delete','edit','write']){if(!doc.getAttribute(action)&&action in context&&!context[action]){doc.setAttribute(action,'false');}}}
this._traverse(doc,function(node){if(node.nodeType===Node.TEXT_NODE){return false;}
var modifiers={};var isField=(node.tagName==='field');var isGroupby=(node.tagName==='groupby');if(isField){var fieldName=node.getAttribute('name');fieldNodes[fieldName]=node;var field=fields[fieldName];if(!field){throw new Error("Field "+fieldName+" does not exist");}
var defaultValues={};var stateExceptions={};_.each(modifiersNames,function(attr){stateExceptions[attr]=[];defaultValues[attr]=!!field[attr];});_.each(field.states||{},function(modifs,state){_.each(modifs,function(modif){if(defaultValues[modif[0]]!==modif[1]){stateExceptions[modif[0]].append(state);}});});_.each(defaultValues,function(defaultValue,attr){if(stateExceptions[attr].length){modifiers[attr]=[("state",defaultValue?"not in":"in",stateExceptions[attr])];}else{modifiers[attr]=defaultValue;}});}else if(isGroupby&&!node._isProcessed){var groupbyName=node.getAttribute('name');fieldNodes[groupbyName]=node;groupbyNodes[groupbyName]=node;}
var attrs=node.getAttribute('attrs');if(attrs){attrs=pyUtils.py_eval(attrs);_.extend(modifiers,attrs);}
var states=node.getAttribute('states');if(states){if(!modifiers.invisible){modifiers.invisible=[];}
modifiers.invisible.push(["state","not in",states.split(",")]);}
const inListHeader=inTreeView&&node.closest('header');_.each(modifiersNames,function(a){var mod=node.getAttribute(a);if(mod){var pyevalContext=window.py.dict.fromJSON(context||{});var v=pyUtils.py_eval(mod,{context:pyevalContext})?true:false;if(inTreeView&&!inListHeader&&a==='invisible'){modifiers.column_invisible=v;}else if(v||!(a in modifiers)||!_.isArray(modifiers[a])){modifiers[a]=v;}}});_.each(modifiersNames,function(a){if(a in modifiers&&(!!modifiers[a]===false||(_.isArray(modifiers[a])&&!modifiers[a].length))){delete modifiers[a];}});if(Object.keys(modifiers).length){node.setAttribute('modifiers',JSON.stringify(modifiers));}
if(isGroupby&&!node._isProcessed){return false;}
return!isField;});var relModel,relFields;_.each(fieldNodes,function(node,name){var field=fields[name];if(field.type==="many2one"||field.type==="many2many"){var canCreate=node.getAttribute('can_create');node.setAttribute('can_create',canCreate||"true");var canWrite=node.getAttribute('can_write');node.setAttribute('can_write',canWrite||"true");}
if(field.type==="one2many"||field.type==="many2many"){field.views={};_.each(node.childNodes,function(children){if(children.tagName){relModel=field.relation;relFields=$.extend(true,{},self.data[relModel].fields);field.views[children.tagName]=self._fieldsViewGet(children,relModel,relFields,_.extend({},context,{base_model_name:model}));}});}
if(name in onchanges){node.setAttribute('on_change',"1");}});_.each(groupbyNodes,function(node,name){var field=fields[name];if(field.type!=='many2one'){throw new Error('groupby can only target many2one');}
field.views={};relModel=field.relation;relFields=$.extend(true,{},self.data[relModel].fields);node._isProcessed=true;field.views.groupby=self._fieldsViewGet(node,relModel,relFields,context);while(node.firstChild){node.removeChild(node.firstChild);}});var xmlSerializer=new XMLSerializer();var processedArch=xmlSerializer.serializeToString(doc);return{arch:processedArch,fields:_.pick(fields,_.keys(fieldNodes)),model:model,type:doc.tagName==='tree'?'list':doc.tagName,};},_getRecords:function(model,domain,{active_test=true}={}){if(!_.isArray(domain)){throw new Error("MockServer._getRecords: given domain has to be an array.");}
var self=this;var records=this.data[model].records;if(active_test&&'active'in this.data[model].fields){var activeInDomain=false;_.each(domain,function(subdomain){activeInDomain=activeInDomain||subdomain[0]==='active';});if(!activeInDomain){domain=[['active','=',true]].concat(domain);}}
if(domain.length){domain=domain.map((criterion)=>{if(criterion[1]==='child_of'){var oldLength=0;var childIDs=[criterion[2]];while(childIDs.length>oldLength){oldLength=childIDs.length;_.each(records,function(r){if(childIDs.indexOf(r.parent_id)>=0){childIDs.push(r.id);}});}
criterion=[criterion[0],'in',childIDs];}
const field=this.data[model].fields[criterion[0]]||{};if(field.type==="many2many"&&criterion[1]==="="){if(criterion[2]===false){criterion=[criterion[0],"=",[]];}else{criterion=[criterion[0],"in",[criterion[2]]];}}
return criterion;});records=_.filter(records,function(record){return self._evaluateDomain(domain,record);});}
return records;},_getUnusedID:function(modelName){var model=this.data[modelName];return model.records.reduce((max,record)=>{if(!Number.isInteger(record.id)){return max;}
return Math.max(record.id,max);},0)+1;},_mockCallButton({args,kwargs,method,model}){throw new Error(`Unimplemented mocked call button on "${model}"/"${method}"`);},_mockCopy:function(modelName,id){var model=this.data[modelName];var newID=this._getUnusedID(modelName);var originalRecord=_.findWhere(model.records,{id:id});var duplicateRecord=_.extend({},originalRecord,{id:newID});duplicateRecord.display_name=originalRecord.display_name+' (copy)';model.records.push(duplicateRecord);return newID;},_mockCreate:function(modelName,values){if('id'in values){throw new Error("Cannot create a record with a predefinite id");}
var model=this.data[modelName];var id=this._getUnusedID(modelName);var record={id:id};model.records.push(record);this._applyDefaults(model,values);this._writeRecord(modelName,values,id);return id;},_mockDefaultGet:function(modelName,args,kwargs={}){const fields=args[0];const model=this.data[modelName];const result={};for(const fieldName of fields){const key="default_"+fieldName;if(kwargs.context&&key in kwargs.context){result[fieldName]=kwargs.context[key];continue;}
const field=model.fields[fieldName];if('default'in field){result[fieldName]=field.default;continue;}}
for(const fieldName in result){const field=model.fields[fieldName];if(field.type==="many2one"){const recordExists=this.data[field.relation].records.some((r)=>r.id===result[fieldName]);if(!recordExists){delete result[fieldName];}}}
return result;},_mockFieldsGet:function(modelName,args){var modelFields=this.data[modelName].fields;if(args[0]&&args[0].length){modelFields=_.pick.apply(_,[modelFields].concat(args[0]));}
if(args[1]&&args[1].length){modelFields=_.mapObject(modelFields,function(field){return _.pick.apply(_,[field].concat(args[1]));});}
return modelFields;},_mockSearchPanelFieldImage(model,fieldName,kwargs){const enableCounters=kwargs.enable_counters;const onlyCounters=kwargs.only_counters;const extraDomain=kwargs.extra_domain||[];const normalizedExtra=Domain.prototype.normalizeArray(extraDomain);const noExtra=JSON.stringify(normalizedExtra)==="[]";const modelDomain=kwargs.model_domain||[];const countDomain=Domain.prototype.normalizeArray([...modelDomain,...extraDomain,]);const limit=kwargs.limit;const setLimit=kwargs.set_limit;if(onlyCounters){return this._mockSearchPanelDomainImage(model,fieldName,countDomain,true);}
const modelDomainImage=this._mockSearchPanelDomainImage(model,fieldName,modelDomain,enableCounters&&noExtra,setLimit&&limit);if(enableCounters&&!noExtra){const countDomainImage=this._mockSearchPanelDomainImage(model,fieldName,countDomain,true);for(const[id,values]of modelDomainImage.entries()){const element=countDomainImage.get(id);values.__count=element?element.__count:0;}}
return modelDomainImage;},_mockSearchPanelDomainImage:function(model,fieldName,domain,setCount=false,limit=false){const field=this.data[model].fields[fieldName];let groupIdName;if(field.type==='many2one'){groupIdName=value=>value||[false,undefined];}else if(field.type==='selection'){const selection={};for(const[value,label]of this.data[model].fields[fieldName].selection){selection[value]=label;}
groupIdName=value=>[value,selection[value]];}
domain=Domain.prototype.normalizeArray([...domain,[fieldName,'!=',false],]);const groups=this._mockReadGroup(model,{domain,fields:[fieldName],groupby:[fieldName],limit,});const domainImage=new Map();for(const group of groups){const[id,display_name]=groupIdName(group[fieldName]);const values={id,display_name};if(setCount){values.__count=group[fieldName+'_count'];}
domainImage.set(id,values);}
return domainImage;},_mockSearchPanelGlobalCounters:function(valuesRange,parentName){const localCounters=[...valuesRange.keys()].map(id=>valuesRange.get(id).__count);for(let[id,values]of valuesRange.entries()){const count=localCounters[id];if(count){let parent_id=values[parentName];while(parent_id){values=valuesRange.get(parent_id);values.__count+=count;parent_id=values[parentName];}}}},_mockSearchPanelSanitizedParentHierarchy:function(records,parentName,ids){const getParentId=record=>record[parentName]&&record[parentName][0];const allowedRecords={};for(const record of records){allowedRecords[record.id]=record;}
const recordsToKeep={};for(const id of ids){const ancestorChain={};let recordId=id;let chainIsFullyIncluded=true;while(chainIsFullyIncluded&&recordId){const knownStatus=recordsToKeep[recordId];if(knownStatus!==undefined){chainIsFullyIncluded=knownStatus;break;}
const record=allowedRecords[recordId];if(record){ancestorChain[recordId]=record;recordId=getParentId(record);}else{chainIsFullyIncluded=false;}}
for(const id in ancestorChain){recordsToKeep[id]=chainIsFullyIncluded;}}
return records.filter(rec=>recordsToKeep[rec.id]);},_mockSearchPanelSelectionRange:function(model,fieldName,kwargs){const enableCounters=kwargs.enable_counters;const expand=kwargs.expand;let domainImage;if(enableCounters||!expand){const newKwargs=Object.assign({},kwargs,{only_counters:expand,});domainImage=this._mockSearchPanelFieldImage(model,fieldName,newKwargs);}
if(!expand){return[...domainImage.values()];}
const selection=this.data[model].fields[fieldName].selection;const selectionRange=[];for(const[value,label]of selection){const values={id:value,display_name:label,};if(enableCounters){values.__count=domainImage.get(value)?domainImage.get(value).__count:0;}
selectionRange.push(values);}
return selectionRange;},_mockSearchPanelSelectRange:function(model,[fieldName],kwargs){const field=this.data[model].fields[fieldName];const supportedTypes=['many2one','selection'];if(!supportedTypes.includes(field.type)){throw new Error(`Only types ${supportedTypes} are supported for category (found type ${field.type})`);}
const modelDomain=kwargs.search_domain||[];const extraDomain=Domain.prototype.normalizeArray([...(kwargs.category_domain||[]),...(kwargs.filter_domain||[]),]);if(field.type==='selection'){const newKwargs=Object.assign({},kwargs,{model_domain:modelDomain,extra_domain:extraDomain,});kwargs.model_domain=modelDomain;return{parent_field:false,values:this._mockSearchPanelSelectionRange(model,fieldName,newKwargs),};}
const fieldNames=['display_name'];let hierarchize='hierarchize'in kwargs?kwargs.hierarchize:true;let getParentId;let parentName=false;if(hierarchize&&this.data[field.relation].fields.parent_id){parentName='parent_id';fieldNames.push(parentName);getParentId=record=>record.parent_id&&record.parent_id[0];}else{hierarchize=false;}
let comodelDomain=kwargs.comodel_domain||[];const enableCounters=kwargs.enable_counters;const expand=kwargs.expand;const limit=kwargs.limit;let domainImage;if(enableCounters||!expand){const newKwargs=Object.assign({},kwargs,{model_domain:modelDomain,extra_domain:extraDomain,only_counters:expand,set_limit:limit&&!(expand||hierarchize||comodelDomain),});domainImage=this._mockSearchPanelFieldImage(model,fieldName,newKwargs);}
if(!expand&&!hierarchize&&!comodelDomain.length){if(limit&&domainImage.size===limit){return{error_msg:"Too many items to display."};}
return{parent_field:parentName,values:[...domainImage.values()],};}
let imageElementIds;if(!expand){imageElementIds=[...domainImage.keys()].map(Number);let condition;if(hierarchize){const records=this.data[field.relation].records;const ancestorIds=new Set();for(const id of imageElementIds){let recordId=id;let record;while(recordId){ancestorIds.add(recordId);record=records.find(rec=>rec.id===recordId);recordId=record[parentName];}}
condition=['id','in',[...new Set(ancestorIds)]];}else{condition=['id','in',imageElementIds];}
comodelDomain=Domain.prototype.normalizeArray([...comodelDomain,condition,]);}
let comodelRecords=this._mockSearchRead(field.relation,[comodelDomain,fieldNames],{limit});if(hierarchize){const ids=expand?comodelRecords.map(rec=>rec.id):imageElementIds;comodelRecords=this._mockSearchPanelSanitizedParentHierarchy(comodelRecords,parentName,ids);}
if(limit&&comodelRecords.length===limit){return{error_msg:"Too many items to display."};}
const fieldRange=new Map();for(const record of comodelRecords){const values={id:record.id,display_name:record.display_name,};if(hierarchize){values[parentName]=getParentId(record);}
if(enableCounters){values.__count=domainImage.get(record.id)?domainImage.get(record.id).__count:0;}
fieldRange.set(record.id,values);}
if(hierarchize&&enableCounters){this._mockSearchPanelGlobalCounters(fieldRange,parentName);}
return{parent_field:parentName,values:[...fieldRange.values()],};},_mockSearchPanelSelectMultiRange:function(model,[fieldName],kwargs){const field=this.data[model].fields[fieldName];const supportedTypes=['many2one','many2many','selection'];if(!supportedTypes.includes(field.type)){throw new Error(`Only types ${supportedTypes} are supported for filter (found type ${field.type})`);}
let modelDomain=kwargs.search_domain||[];let extraDomain=Domain.prototype.normalizeArray([...(kwargs.category_domain||[]),...(kwargs.filter_domain||[]),]);if(field.type==='selection'){const newKwargs=Object.assign({},kwargs,{model_domain:modelDomain,extra_domain:extraDomain,});return{values:this._mockSearchPanelSelectionRange(model,fieldName,newKwargs),};}
const fieldNames=['display_name'];const groupBy=kwargs.group_by;let groupIdName;if(groupBy){const groupByField=this.data[field.relation].fields[groupBy];fieldNames.push(groupBy);if(groupByField.type==='many2one'){groupIdName=value=>value||[false,"Not set"];}else if(groupByField.type==='selection'){const groupBySelection=Object.assign({},this.data[field.relation].fields[groupBy].selection);groupBySelection[false]="Not Set";groupIdName=value=>[value,groupBySelection[value]];}else{groupIdName=value=>value?[value,value]:[false,"Not set"];}}
let comodelDomain=kwargs.comodel_domain||[];const enableCounters=kwargs.enable_counters;const expand=kwargs.expand;const limit=kwargs.limit;if(field.type==='many2many'){const comodelRecords=this._mockSearchRead(field.relation,[comodelDomain,fieldNames],{limit});if(expand&&limit&&comodelRecords.length===limit){return{error_msg:"Too many items to display."};}
const groupDomain=kwargs.group_domain;const fieldRange=[];for(const record of comodelRecords){const values={id:record.id,display_name:record.display_name,};let groupId;if(groupBy){const[gId,gName]=groupIdName(record[groupBy]);values.group_id=groupId=gId;values.group_name=gName;}
let count;let inImage;if(enableCounters||!expand){const searchDomain=Domain.prototype.normalizeArray([...modelDomain,[fieldName,"in",record.id]]);let localExtraDomain=extraDomain;if(groupBy&&groupDomain){localExtraDomain=Domain.prototype.normalizeArray([...localExtraDomain,...(groupDomain[JSON.stringify(groupId)]||[]),]);}
const searchCountDomain=Domain.prototype.normalizeArray([...searchDomain,...localExtraDomain,]);if(enableCounters){count=this._mockSearchCount(model,[searchCountDomain]);}
if(!expand){if(enableCounters&&JSON.stringify(localExtraDomain)==="[]"){inImage=count;}else{inImage=(this._mockSearch(model,[searchDomain],{limit:1})).length;}}}
if(expand||inImage){if(enableCounters){values.__count=count;}
fieldRange.push(values);}}
if(!expand&&limit&&fieldRange.length===limit){return{error_msg:"Too many items to display."};}
return{values:fieldRange};}
if(field.type==='many2one'){let domainImage;if(enableCounters||!expand){extraDomain=Domain.prototype.normalizeArray([...extraDomain,...(kwargs.group_domain||[]),]);modelDomain=Domain.prototype.normalizeArray([...modelDomain,...(kwargs.group_domain||[]),]);const newKwargs=Object.assign({},kwargs,{model_domain:modelDomain,extra_domain:extraDomain,only_counters:expand,set_limit:limit&&!(expand||groupBy||comodelDomain),});domainImage=this._mockSearchPanelFieldImage(model,fieldName,newKwargs);}
if(!expand&&!groupBy&&!comodelDomain.length){if(limit&&domainImage.size===limit){return{error_msg:"Too many items to display."};}
return{values:[...domainImage.values()]};}
if(!expand){const imageElementIds=[...domainImage.keys()].map(Number);comodelDomain=Domain.prototype.normalizeArray([...comodelDomain,['id','in',imageElementIds],]);}
const comodelRecords=this._mockSearchRead(field.relation,[comodelDomain,fieldNames],{limit});if(limit&&comodelRecords.length===limit){return{error_msg:"Too many items to display."};}
const fieldRange=[];for(const record of comodelRecords){const values={id:record.id,display_name:record.display_name,};if(groupBy){const[groupId,groupName]=groupIdName(record[groupBy]);values.group_id=groupId;values.group_name=groupName;}
if(enableCounters){values.__count=domainImage.get(record.id)?domainImage.get(record.id).__count:0;}
fieldRange.push(values);}
return{values:fieldRange};}},_mockLoadAction:function(kwargs){var action=_.findWhere(this.actions,{id:parseInt(kwargs.action_id)});if(!action){console.warn(`No action found for ID ${kwargs.action_id} during test ${QUnit.config.current.testName} (legacy)`);}
return action||false;},_mockLoadViews:function(model,kwargs){var self=this;var views={};_.each(kwargs.views,function(view_descr){var viewID=view_descr[0]||false;var viewType=view_descr[1];if(!viewID){var contextKey=(viewType==='list'?'tree':viewType)+'_view_ref';if(contextKey in kwargs.context){viewID=kwargs.context[contextKey];}}
var key=[model,viewID,viewType].join(',');var arch=self.archs[key]||_.find(self.archs,function(_v,k){var ka=k.split(',');viewID=parseInt(ka[1],10);return ka[0]===model&&ka[2]===viewType;});if(!arch){throw new Error('No arch found for key '+key);}
views[viewType]={arch:arch,view_id:viewID,model:model,viewOptions:{context:kwargs.context,},};});return views;},_mockNameGet:function(model,args){var ids=args[0];if(!args.length){throw new Error("name_get: expected one argument");}
else if(!ids){return[]}
if(!_.isArray(ids)){ids=[ids];}
var records=this.data[model].records;var names=_.map(ids,function(id){return id?[id,_.findWhere(records,{id:id}).display_name]:[null,"False"];});return names;},_mockNameCreate:function(model,args){var name=args[0];var values={name:name,display_name:name,};var id=this._mockCreate(model,values);return[id,name];},_mockNameSearch:function(model,args,_kwargs){var str=args&&typeof args[0]==='string'?args[0]:_kwargs.name;const limit=_kwargs.limit||100;var domain=(args&&args[1])||_kwargs.args||[];var records=this._getRecords(model,domain);if(str.length){records=_.filter(records,function(record){return record.display_name.indexOf(str)!==-1;});}
var result=_.map(records,function(record){return[record.id,record.display_name];});return result.slice(0,limit);},_mockOnchange:function(model,args,kwargs){const currentData=args[1];let fields=args[2];const onChangeSpec=args[3];var onchanges=this.data[model].onchanges||{};if(fields&&!(fields instanceof Array)){fields=[fields];}
const firstOnChange=!fields||!fields.length;const onchangeVals={};let defaultVals;let nullValues;if(firstOnChange){const fieldsFromView=Object.keys(onChangeSpec).reduce((acc,fname)=>{fname=fname.split('.',1)[0];if(!acc.includes(fname)){acc.push(fname);}
return acc;},[]);const defaultingFields=fieldsFromView.filter(fname=>!(fname in currentData));defaultVals=this._mockDefaultGet(model,[defaultingFields],kwargs);fields=fieldsFromView;nullValues={};fields.filter(fName=>!Object.keys(defaultVals).includes(fName)).forEach(fName=>{nullValues[fName]=false;});}
Object.assign(currentData,defaultVals);fields.forEach(field=>{if(field in onchanges){const changes=Object.assign({},nullValues,currentData);onchanges[field](changes);Object.entries(changes).forEach(([key,value])=>{if(currentData[key]!==value){onchangeVals[key]=value;}});}});return{value:this._convertToOnChange(model,Object.assign({},defaultVals,onchangeVals)),};},_mockRead:function(model,args,_kwargs){var self=this;var ids=args[0];if(!_.isArray(ids)){ids=[ids];}
var fields=args[1]&&args[1].length?_.uniq(args[1].concat(['id'])):Object.keys(this.data[model].fields);var records=_.reduce(ids,function(records,id){if(!id){throw new Error("mock read: falsy value given as id, would result in an access error in actual server !");}
var record=_.findWhere(self.data[model].records,{id:id});return record?records.concat(record):records;},[]);var results=_.map(records,function(record){var result={};for(var i=0;i<fields.length;i++){var field=self.data[model].fields[fields[i]];if(!field){continue;}
if(field.type==='float'||field.type==='integer'||field.type==='monetary'){result[fields[i]]=record[fields[i]]||0;}else if(field.type==='many2one'){var relatedRecord=_.findWhere(self.data[field.relation].records,{id:record[fields[i]]});if(relatedRecord){result[fields[i]]=[record[fields[i]],relatedRecord.display_name];}else{result[fields[i]]=false;}}else if(field.type==='one2many'||field.type==='many2many'){result[fields[i]]=record[fields[i]]||[];}else{result[fields[i]]=record[fields[i]]||false;}}
return result;});return results;},_mockReadGroup:function(model,kwargs){if(!('lazy'in kwargs)){kwargs.lazy=true;}
var self=this;var fields=this.data[model].fields;var aggregatedFields=[];_.each(kwargs.fields,function(field){var split=field.split(":");var fieldName=split[0];if(kwargs.groupby.indexOf(fieldName)>0){return;}
if(fields[fieldName]&&(fields[fieldName].type==='many2one')&&split[1]!=='count_distinct'){return;}
aggregatedFields.push(fieldName);});var groupBy=[];if(kwargs.groupby.length){groupBy=kwargs.lazy?[kwargs.groupby[0]]:kwargs.groupby;}
var records=this._getRecords(model,kwargs.domain);if(kwargs.fields.length===0){aggregatedFields=_.keys(this.data[model].fields);}
var groupByFieldNames=_.map(groupBy,function(groupByField){return groupByField.split(":")[0];});aggregatedFields=_.filter(aggregatedFields,function(name){return name in self.data[model].fields&&!(_.contains(groupByFieldNames,name));});function aggregateFields(group,records){var type;for(var i=0;i<aggregatedFields.length;i++){type=fields[aggregatedFields[i]].type;if(type==='float'||type==='integer'){group[aggregatedFields[i]]=null;for(var j=0;j<records.length;j++){var value=group[aggregatedFields[i]]||0;group[aggregatedFields[i]]=value+records[j][aggregatedFields[i]];}}
if(type==='many2one'){var ids=_.pluck(records,aggregatedFields[i]);group[aggregatedFields[i]]=_.uniq(ids).length||null;}}}
function formatValue(groupByField,val){if(val===false||val===undefined){return false;}
const[fieldName,aggregateFunction="month"]=groupByField.split(':');const{type}=fields[fieldName];if(type==="date"){if(aggregateFunction==='day'){return moment(val).format('YYYY-MM-DD');}else if(aggregateFunction==='week'){return moment(val).format('[W]WW GGGG');}else if(aggregateFunction==='quarter'){return moment(val).format('[Q]Q YYYY');}else if(aggregateFunction==='year'){return moment(val).format('Y');}else{return moment(val).format('MMMM YYYY');}}else if(type==="datetime"){if(aggregateFunction==='hour'){return moment(val).format('HH[:00] DD MMM');}else if(aggregateFunction==='day'){return moment(val).format('YYYY-MM-DD');}else if(aggregateFunction==='week'){return moment(val).format('[W]WW GGGG');}else if(aggregateFunction==='quarter'){return moment(val).format('[Q]Q YYYY');}else if(aggregateFunction==='year'){return moment(val).format('Y');}else{return moment(val).format('MMMM YYYY');}}else if(Array.isArray(val)){if(val.length===0){return false;}
return type==="many2many"?val:val[0];}else{return val;}}
if(!groupBy.length){var group={__count:records.length};aggregateFields(group,records);return[group];}
const groups={};for(const r of records){let recordGroupValues=[];for(const gbField of groupBy){const[fieldName]=gbField.split(":");let value=formatValue(gbField,r[fieldName]);if(!Array.isArray(value)){value=[value];}
recordGroupValues=value.reduce((acc,val)=>{const newGroup={};newGroup[gbField]=val;if(recordGroupValues.length===0){acc.push(newGroup);}else{for(const groupValue of recordGroupValues){acc.push({...groupValue,...newGroup});}}
return acc;},[]);}
for(const groupValue of recordGroupValues){const valueKey=JSON.stringify(groupValue);groups[valueKey]=groups[valueKey]||[];groups[valueKey].push(r);}}
let readGroupResult=[];for(const[groupId,groupRecords]of Object.entries(groups)){const group={...JSON.parse(groupId),__domain:kwargs.domain||[],__range:{},};for(const gbField of groupBy){if(!(gbField in group)){group[gbField]=false;continue;}
const[fieldName,dateRange]=gbField.split(":");const value=Number.isInteger(group[gbField])?group[gbField]:group[gbField]||false;const{relation,type}=fields[fieldName];if(["many2one","many2many"].includes(type)&&!Array.isArray(value)){const relatedRecord=_.findWhere(this.data[relation].records,{id:value});if(relatedRecord){group[gbField]=[value,relatedRecord.display_name];}else{group[gbField]=false;}}
if(["date","datetime"].includes(type)){if(value){let startDate,endDate;switch(dateRange){case"hour":{startDate=moment(value,"HH[:00] DD MMM");endDate=startDate.clone().add(1,"hours");break;}
case"day":{startDate=moment(value,"YYYY-MM-DD");endDate=startDate.clone().add(1,"days");break;}
case"week":{startDate=moment(value,"[W]WW GGGG");endDate=startDate.clone().add(1,"weeks");break;}
case"quarter":{startDate=moment(value,"[Q]Q YYYY");endDate=startDate.clone().add(1,"quarters");break;}
case"year":{startDate=moment(value,"Y");endDate=startDate.clone().add(1,"years");break;}
case"month":default:{startDate=moment(value,"MMMM YYYY");endDate=startDate.clone().add(1,"months");break;}}
const from=type==="date"?startDate.locale('en').format("YYYY-MM-DD"):startDate.locale('en').format("YYYY-MM-DD HH:mm:ss");const to=type==="date"?endDate.locale('en').format("YYYY-MM-DD"):endDate.locale('en').format("YYYY-MM-DD HH:mm:ss");group.__range[fieldName]={from,to};group.__domain=[[fieldName,">=",from],[fieldName,"<",to],].concat(group.__domain);}else{group.__range[fieldName]=false;group.__domain=[[fieldName,"=",value]].concat(group.__domain);}}else{group.__domain=[[fieldName,"=",value]].concat(group.__domain);}}
if(_.isEmpty(group.__range)){delete group.__range;}
const groupByNoLeaf=kwargs.context?"group_by_no_leaf"in kwargs.context:false;let countKey;if(kwargs.lazy&&(groupBy.length>=2||!groupByNoLeaf)){countKey=groupBy[0].split(":")[0]+"_count";}else{countKey="__count";}
group[countKey]=groupRecords.length;aggregateFields(group,groupRecords);readGroupResult.push(group);}
if(kwargs.orderby){kwargs.orderby=kwargs.orderby.split(',')[0];const fieldName=kwargs.orderby.split(' ')[0];const order=kwargs.orderby.split(' ')[1];readGroupResult=this._sortByField(readGroupResult,model,fieldName,order);}
if(kwargs.limit){const offset=kwargs.offset||0;readGroupResult=readGroupResult.slice(offset,kwargs.limit+offset);}
return readGroupResult;},_mockReadProgressBar:function(model,kwargs){var domain=kwargs.domain;var groupBy=kwargs.group_by;var progress_bar=kwargs.progress_bar;var records=this._getRecords(model,domain||[]);var data={};_.each(records,function(record){var groupByValue=record[groupBy];if(!(groupByValue in data)){if(groupByValue===true){groupByValue="True";}else if(groupByValue===false){groupByValue="False";}}
if(!(groupByValue in data)){data[groupByValue]={};_.each(progress_bar.colors,function(val,key){data[groupByValue][key]=0;});}
var fieldValue=record[progress_bar.field];if(fieldValue in data[groupByValue]){data[groupByValue][fieldValue]++;}});return data;},_mockResequence:function(args){var offset=args.offset?Number(args.offset):0;var field=args.field?args.field:'sequence';var records=this.data[args.model].records;if(!(field in this.data[args.model].fields)){return false;}
for(var i in args.ids){var record=_.findWhere(records,{id:args.ids[i]});record[field]=Number(i)+offset;}
return true;},_mockSearch:function(model,args,kwargs){const limit=kwargs.limit||Number.MAX_VALUE;const{context}=kwargs;const active_test=context&&"active_test"in context?context.active_test:true;return this._getRecords(model,args[0],{active_test}).map(r=>r.id).slice(0,limit);},_mockSearchCount:function(model,args){return this._getRecords(model,args[0]).length;},_mockSearchRead:function(model,args,kwargs){var result=this._mockSearchReadController({model:model,domain:kwargs.domain||args[0],fields:kwargs.fields||args[1],offset:kwargs.offset||args[2],limit:kwargs.limit||args[3],sort:kwargs.order||args[4],context:kwargs.context,});return result.records;},_mockSearchReadController:function(args){var self=this;const{context}=args;const active_test=context&&"active_test"in context?context.active_test:true;var records=this._getRecords(args.model,args.domain||[],{active_test,});var fields=args.fields&&args.fields.length?args.fields:_.keys(this.data[args.model].fields);var nbRecords=records.length;var offset=args.offset||0;if(args.sort){args.sort=args.sort.split(',')[0];var fieldName=args.sort.split(' ')[0];var order=args.sort.split(' ')[1];records=this._sortByField(records,args.model,fieldName,order);}
records=records.slice(offset,args.limit?(offset+args.limit):nbRecords);var processedRecords=_.map(records,function(r){var result={};_.each(_.uniq(fields.concat(['id'])),function(fieldName){var field=self.data[args.model].fields[fieldName];if(field.type==='many2one'){var related_record=_.findWhere(self.data[field.relation].records,{id:r[fieldName]});result[fieldName]=related_record?[r[fieldName],related_record.display_name]:false;}else{result[fieldName]=r[fieldName];}});return result;});var result={length:nbRecords,records:processedRecords,};return $.extend(true,{},result);},_mockUnlink:function(model,args){var ids=args[0];if(!_.isArray(ids)){ids=[ids];}
this.data[model].records=_.reject(this.data[model].records,function(record){return _.contains(ids,record.id);});_.each(this.data,function(d){var relatedFields=_.pick(d.fields,function(field){return field.type==='one2many'&&field.relation===model;});_.each(Object.keys(relatedFields),function(relatedField){_.each(d.records,function(record){record[relatedField]=_.difference(record[relatedField],ids);});});});return true;},_mockWebReadGroup:function(model,kwargs){var self=this;var groups=this._mockReadGroup(model,kwargs);if(kwargs.expand&&kwargs.groupby.length===1){groups.forEach(function(group){group.__data=self._mockSearchReadController({domain:group.__domain,model:model,fields:kwargs.fields,limit:kwargs.expand_limit,order:kwargs.expand_orderby,});});}
var allGroups=this._mockReadGroup(model,{domain:kwargs.domain,fields:['display_name'],groupby:kwargs.groupby,lazy:kwargs.lazy,});return{groups:groups,length:allGroups.length,};},_mockWrite:function(model,args){_.each(args[0],this._writeRecord.bind(this,model,args[1]));return true;},_performFetch(resource,init){throw new Error("Unimplemented resource: "+resource);},async _performRpc(route,args){switch(route){case'/web/dataset/call_button':return this._mockCallButton(args);case'/web/action/load':return this._mockLoadAction(args);case'/web/dataset/search_read':return this._mockSearchReadController(args);case'/web/dataset/resequence':return this._mockResequence(args);}
if(route.indexOf('/web/image')>=0||_.contains(['.png','.jpg'],route.substr(route.length-4))){return;}
switch(args.method){case"render_public_asset":{return true;}
case'copy':return this._mockCopy(args.model,args.args[0]);case'create':return this._mockCreate(args.model,args.args[0]);case'fields_get':return this._mockFieldsGet(args.model,args.args);case'search_panel_select_range':return this._mockSearchPanelSelectRange(args.model,args.args,args.kwargs);case'search_panel_select_multi_range':return this._mockSearchPanelSelectMultiRange(args.model,args.args,args.kwargs);case'load_views':return this._mockLoadViews(args.model,args.kwargs);case'name_get':return this._mockNameGet(args.model,args.args);case'name_create':return this._mockNameCreate(args.model,args.args);case'name_search':return this._mockNameSearch(args.model,args.args,args.kwargs);case'onchange':return this._mockOnchange(args.model,args.args,args.kwargs);case'read':return this._mockRead(args.model,args.args,args.kwargs);case'read_group':return this._mockReadGroup(args.model,args.kwargs);case'web_read_group':return this._mockWebReadGroup(args.model,args.kwargs);case'read_progress_bar':return this._mockReadProgressBar(args.model,args.kwargs);case'search':return this._mockSearch(args.model,args.args,args.kwargs);case'search_count':return this._mockSearchCount(args.model,args.args);case'search_read':return this._mockSearchRead(args.model,args.args,args.kwargs);case'unlink':return this._mockUnlink(args.model,args.args);case'write':return this._mockWrite(args.model,args.args);}
var model=this.data[args.model];if(model&&typeof model[args.method]==='function'){return this.data[args.model][args.method](args.args,args.kwargs);}
throw new Error("Unimplemented route: "+route);},_sortByField:function(records,model,fieldName,order){const field=this.data[model].fields[fieldName];records.sort((r1,r2)=>{let v1=r1[fieldName];let v2=r2[fieldName];if(field.type==='many2one'){const coRecords=this.data[field.relation].records;if(this.data[field.relation].fields.sequence){v1=coRecords.find(r=>r.id===v1[0]).sequence;v2=coRecords.find(r=>r.id===v2[0]).sequence;}else{v1=v1[0];v2=v2[0];}}
if(v1<v2){return order==='ASC'?-1:1;}
if(v1>v2){return order==='ASC'?1:-1;}
return 0;});return records;},_traverse:function(tree,f){var self=this;if(f(tree)){_.each(tree.childNodes,function(c){self._traverse(c,f);});}},_writeRecord:function(model,values,id,{ensureIntegrity=true}={}){var self=this;var record=_.findWhere(this.data[model].records,{id:id});for(var field_changed in values){var field=this.data[model].fields[field_changed];var value=values[field_changed];if(!field){throw Error(`Mock: Can't write value "${JSON.stringify(value)}" on field "${field_changed}" on record "${model},${id}" (field is undefined)`);}
if(_.contains(['one2many','many2many'],field.type)){var ids=_.clone(record[field_changed])||[];if(Array.isArray(value)&&value.reduce((hasOnlyInt,val)=>hasOnlyInt&&Number.isInteger(val),true)){value=[[6,0,value]];}else if(value===false){value=[[5]];}
for(const command of value||[]){if(command[0]===0){const newId=self._mockCreate(field.relation,command[2]);ids.push(newId);}else if(command[0]===1){self._mockWrite(field.relation,[[command[1]],command[2]]);}else if(command[0]===2){ids=_.without(ids,command[1]);}else if(command[0]===3){ids=_.without(ids,command[1]);}else if(command[0]===4){if(!_.contains(ids,command[1])){ids.push(command[1]);}}else if(command[0]===5){ids=[];}else if(command[0]===6){ids=[...command[2]];}else{throw Error(`Command "${JSON.stringify(value)}" not supported by the MockServer on field "${field_changed}" on record "${model},${id}"`);}}
record[field_changed]=ids;}else if(field.type==='many2one'){if(value){var relatedRecord=_.findWhere(this.data[field.relation].records,{id:value});if(!relatedRecord&&ensureIntegrity){throw Error(`Wrong id "${JSON.stringify(value)}" for a many2one on field "${field_changed}" on record "${model},${id}"`);}
record[field_changed]=value;}else{record[field_changed]=false;}}else{record[field_changed]=value;}}},});return MockServer;});;

/* /web/static/tests/legacy/helpers/test_env.js defined in bundle 'web.tests_assets' */
odoo.define('web.test_env',async function(require){"use strict";const Bus=require('web.Bus');const{buildQuery}=require('web.rpc');const session=require('web.session');const{registerCleanup}=require("@web/../tests/helpers/cleanup");let qweb;function makeTestEnvironment(env={},providedRPC=null){if(!qweb){qweb=new owl.QWeb({templates:session.owlTemplates});}
registerCleanup(()=>{qweb.subscriptions={};});const defaultTranslationParamters={code:"en_US",date_format:'%m/%d/%Y',decimal_point:".",direction:'ltr',grouping:[],thousands_sep:",",time_format:'%H:%M:%S',};let _t;if('_t'in env){_t=Object.assign(env._t,{database:env._t.database||{}})}else{_t=Object.assign(((s)=>s),{database:{}});}
_t.database.parameters=Object.assign(defaultTranslationParamters,_t.database.parameters);const defaultEnv={_t,browser:Object.assign({setTimeout:window.setTimeout.bind(window),clearTimeout:window.clearTimeout.bind(window),setInterval:window.setInterval.bind(window),clearInterval:window.clearInterval.bind(window),requestAnimationFrame:window.requestAnimationFrame.bind(window),Date:window.Date,fetch:(window.fetch||(()=>{})).bind(window),},env.browser),bus:env.bus||new Bus(),device:Object.assign({isMobile:false,SIZES:{XS:0,VSM:1,SM:2,MD:3,LG:4,XL:5,XXL:6},},env.device),isDebug:env.isDebug||(()=>false),qweb,services:Object.assign({ajax:{rpc(){return env.session.rpc(...arguments);},loadLibs(){}},getCookie(){},httpRequest(){return Promise.resolve('');},rpc(params,options){const query=buildQuery(params);return env.session.rpc(query.route,query.params,options);},notification:{notify(){}},hotkey:{add:()=>()=>{}},ui:{activeElement:document},},env.services),session:Object.assign({rpc(route,params,options){if(providedRPC){return providedRPC(route,params,options);}
throw new Error(`No method to perform RPC`);},url:session.url,getTZOffset:(()=>0),},env.session),};return Object.assign(env,defaultEnv);}
QUnit.on('OdooBeforeTestHook',function(){owl.Component.env=makeTestEnvironment();});return makeTestEnvironment;});;

/* /web/static/tests/legacy/helpers/test_utils.js defined in bundle 'web.tests_assets' */
odoo.define('web.test_utils',async function(require){"use strict";const ajax=require('web.ajax');const core=require('web.core');const relationalFields=require('web.relational_fields');const session=require('web.session');const testUtilsCreate=require('web.test_utils_create');const testUtilsControlPanel=require('web.test_utils_control_panel');const testUtilsDom=require('web.test_utils_dom');const testUtilsFields=require('web.test_utils_fields');const testUtilsFile=require('web.test_utils_file');const testUtilsForm=require('web.test_utils_form');const testUtilsGraph=require('web.test_utils_graph');const testUtilsKanban=require('web.test_utils_kanban');const testUtilsMock=require('web.test_utils_mock');const testUtilsModal=require('web.test_utils_modal');const testUtilsPivot=require('web.test_utils_pivot');const tools=require('web.tools');function deprecated(fn,type){const msg=`Helper 'testUtils.${fn.name}' is deprecated. `+`Please use 'testUtils.${type}.${fn.name}' instead.`;return tools.deprecated(fn,msg);}
function makeTestPromise(){let resolve;let reject;const promise=new Promise(function(_resolve,_reject){resolve=_resolve;reject=_reject;});promise.resolve=function(){resolve.apply(null,arguments);return promise;};promise.reject=function(){reject.apply(null,arguments);return promise;};return promise;}
function makeTestPromiseWithAssert(assert,str){const prom=makeTestPromise();prom.then(()=>assert.step('ok '+str)).catch(function(){});prom.catch(()=>assert.step('ko '+str));return prom;}
async function nextMicrotaskTick(){return Promise.resolve();}
async function nextTick(){return testUtilsDom.returnAfterNextAnimationFrame();}
async function owlCompatibilityExtraNextTick(){return testUtilsDom.returnAfterNextAnimationFrame();}
await Promise.all([session.is_bound,ajax.loadXML('/web/static/src/legacy/frontend/debug_manager/debug.xml',core.qweb),ajax.loadXML('/web/static/src/legacy/xml/dialog.xml',core.qweb),ajax.loadXML('/web/static/src/legacy/xml/translation_dialog.xml',core.qweb),]);setTimeout(function(){relationalFields.FieldMany2One.prototype.AUTOCOMPLETE_DELAY=0;},0);return{mock:{addMockEnvironment:testUtilsMock.addMockEnvironment,addMockEnvironmentOwl:testUtilsMock.addMockEnvironmentOwl,intercept:testUtilsMock.intercept,patch:testUtilsMock.patch,patchDate:testUtilsMock.patchDate,unpatch:testUtilsMock.unpatch,fieldsViewGet:testUtilsMock.fieldsViewGet,patchSetTimeout:testUtilsMock.patchSetTimeout,},controlPanel:{toggleMenu:testUtilsControlPanel.toggleMenu,toggleMenuItem:testUtilsControlPanel.toggleMenuItem,toggleMenuItemOption:testUtilsControlPanel.toggleMenuItemOption,isItemSelected:testUtilsControlPanel.isItemSelected,isOptionSelected:testUtilsControlPanel.isOptionSelected,getMenuItemTexts:testUtilsControlPanel.getMenuItemTexts,getButtons:testUtilsControlPanel.getButtons,toggleFilterMenu:testUtilsControlPanel.toggleFilterMenu,toggleAddCustomFilter:testUtilsControlPanel.toggleAddCustomFilter,applyFilter:testUtilsControlPanel.applyFilter,addCondition:testUtilsControlPanel.addCondition,toggleGroupByMenu:testUtilsControlPanel.toggleGroupByMenu,toggleAddCustomGroup:testUtilsControlPanel.toggleAddCustomGroup,selectGroup:testUtilsControlPanel.selectGroup,applyGroup:testUtilsControlPanel.applyGroup,toggleFavoriteMenu:testUtilsControlPanel.toggleFavoriteMenu,toggleSaveFavorite:testUtilsControlPanel.toggleSaveFavorite,editFavoriteName:testUtilsControlPanel.editFavoriteName,saveFavorite:testUtilsControlPanel.saveFavorite,deleteFavorite:testUtilsControlPanel.deleteFavorite,toggleComparisonMenu:testUtilsControlPanel.toggleComparisonMenu,getFacetTexts:testUtilsControlPanel.getFacetTexts,removeFacet:testUtilsControlPanel.removeFacet,editSearch:testUtilsControlPanel.editSearch,validateSearch:testUtilsControlPanel.validateSearch,toggleActionMenu:testUtilsControlPanel.toggleActionMenu,pagerPrevious:testUtilsControlPanel.pagerPrevious,pagerNext:testUtilsControlPanel.pagerNext,getPagerValue:testUtilsControlPanel.getPagerValue,getPagerSize:testUtilsControlPanel.getPagerSize,setPagerValue:testUtilsControlPanel.setPagerValue,switchView:testUtilsControlPanel.switchView,},dom:{triggerKeypressEvent:testUtilsDom.triggerKeypressEvent,triggerMouseEvent:testUtilsDom.triggerMouseEvent,triggerPositionalMouseEvent:testUtilsDom.triggerPositionalMouseEvent,triggerPositionalTapEvents:testUtilsDom.triggerPositionalTapEvents,dragAndDrop:testUtilsDom.dragAndDrop,find:testUtilsDom.findItem,getNode:testUtilsDom.getNode,openDatepicker:testUtilsDom.openDatepicker,click:testUtilsDom.click,clickFirst:testUtilsDom.clickFirst,clickLast:testUtilsDom.clickLast,triggerEvents:testUtilsDom.triggerEvents,triggerEvent:testUtilsDom.triggerEvent,},form:{clickEdit:testUtilsForm.clickEdit,clickSave:testUtilsForm.clickSave,clickCreate:testUtilsForm.clickCreate,clickDiscard:testUtilsForm.clickDiscard,reload:testUtilsForm.reload,},graph:{reload:testUtilsGraph.reload,},kanban:{reload:testUtilsKanban.reload,clickCreate:testUtilsKanban.clickCreate,quickCreate:testUtilsKanban.quickCreate,toggleGroupSettings:testUtilsKanban.toggleGroupSettings,toggleRecordDropdown:testUtilsKanban.toggleRecordDropdown,},modal:{clickButton:testUtilsModal.clickButton,},pivot:{clickMeasure:testUtilsPivot.clickMeasure,toggleMeasuresDropdown:testUtilsPivot.toggleMeasuresDropdown,reload:testUtilsPivot.reload,},fields:{many2one:{createAndEdit:testUtilsFields.clickM2OCreateAndEdit,clickOpenDropdown:testUtilsFields.clickOpenM2ODropdown,clickHighlightedItem:testUtilsFields.clickM2OHighlightedItem,clickItem:testUtilsFields.clickM2OItem,searchAndClickItem:testUtilsFields.searchAndClickM2OItem,},editInput:testUtilsFields.editInput,editSelect:testUtilsFields.editSelect,editAndTrigger:testUtilsFields.editAndTrigger,triggerKey:testUtilsFields.triggerKey,triggerKeydown:testUtilsFields.triggerKeydown,triggerKeyup:testUtilsFields.triggerKeyup,},file:{createFile:testUtilsFile.createFile,dragoverFile:testUtilsFile.dragoverFile,dropFile:testUtilsFile.dropFile,dropFiles:testUtilsFile.dropFiles,inputFiles:testUtilsFile.inputFiles,},createComponent:testUtilsCreate.createComponent,createControlPanel:testUtilsCreate.createControlPanel,createAsyncView:testUtilsCreate.createView,createCalendarView:testUtilsCreate.createCalendarView,createView:testUtilsCreate.createView,createModel:testUtilsCreate.createModel,createParent:testUtilsCreate.createParent,makeTestPromise:makeTestPromise,makeTestPromiseWithAssert:makeTestPromiseWithAssert,nextMicrotaskTick:nextMicrotaskTick,nextTick:nextTick,owlCompatibilityExtraNextTick,prepareTarget:testUtilsCreate.prepareTarget,returnAfterNextAnimationFrame:testUtilsDom.returnAfterNextAnimationFrame,addMockEnvironment:deprecated(testUtilsMock.addMockEnvironment,'mock'),dragAndDrop:deprecated(testUtilsDom.dragAndDrop,'dom'),fieldsViewGet:deprecated(testUtilsMock.fieldsViewGet,'mock'),intercept:deprecated(testUtilsMock.intercept,'mock'),openDatepicker:deprecated(testUtilsDom.openDatepicker,'dom'),patch:deprecated(testUtilsMock.patch,'mock'),patchDate:deprecated(testUtilsMock.patchDate,'mock'),triggerKeypressEvent:deprecated(testUtilsDom.triggerKeypressEvent,'dom'),triggerMouseEvent:deprecated(testUtilsDom.triggerMouseEvent,'dom'),triggerPositionalMouseEvent:deprecated(testUtilsDom.triggerPositionalMouseEvent,'dom'),unpatch:deprecated(testUtilsMock.unpatch,'mock'),};});;

/* /web/static/tests/legacy/helpers/test_utils_control_panel.js defined in bundle 'web.tests_assets' */
odoo.define('web.test_utils_control_panel',function(require){"use strict";const{click,findItem,getNode,triggerEvent}=require('web.test_utils_dom');const{editInput,editSelect,editAndTrigger}=require('web.test_utils_fields');async function toggleMenu(el,menuFinder){const menu=findItem(el,`.dropdown > button`,menuFinder);await click(menu);}
async function toggleMenuItem(el,itemFinder){const item=findItem(el,`.o_menu_item > a`,itemFinder);await click(item);}
async function toggleMenuItemOption(el,itemFinder,optionFinder){const item=findItem(el,`.o_menu_item > a`,itemFinder);const option=findItem(item.parentNode,'.o_item_option > a',optionFinder);await click(option);}
function isItemSelected(el,itemFinder){const item=findItem(el,`.o_menu_item > a`,itemFinder);return item.classList.contains('selected');}
function isOptionSelected(el,itemFinder,optionFinder){const item=findItem(el,`.o_menu_item > a`,itemFinder);const option=findItem(item.parentNode,'.o_item_option > a',optionFinder);return option.classList.contains('selected');}
function getMenuItemTexts(el){return[...getNode(el).querySelectorAll(`.dropdown ul .o_menu_item`)].map(e=>e.innerText.trim());}
function getButtons(el){return[...getNode(el).querySelector((`div.o_cp_bottom div.o_cp_buttons`)).children];}
async function toggleFilterMenu(el){await click(getNode(el).querySelector(`.o_filter_menu button`));}
async function toggleAddCustomFilter(el){await click(getNode(el).querySelector(`button.o_add_custom_filter`));}
async function applyFilter(el){await click(getNode(el).querySelector(`div.o_add_filter_menu > button.o_apply_filter`));}
async function addCondition(el){await click(getNode(el).querySelector(`div.o_add_filter_menu > button.o_add_condition`));}
async function toggleGroupByMenu(el){await click(getNode(el).querySelector(`.o_group_by_menu button`));}
async function toggleAddCustomGroup(el){await click(getNode(el).querySelector(`span.o_add_custom_group_by`));}
async function selectGroup(el,fieldName){await editSelect(getNode(el).querySelector(`select.o_group_by_selector`),fieldName);}
async function applyGroup(el){await click(getNode(el).querySelector(`div.o_add_group_by_menu > button.o_apply_group_by`));}
async function toggleFavoriteMenu(el){await click(getNode(el).querySelector(`.o_favorite_menu button`));}
async function toggleSaveFavorite(el){await click(getNode(el).querySelector(`.o_favorite_menu .o_add_favorite .dropdown-item`));}
async function editFavoriteName(el,name){await editInput(getNode(el).querySelector(`.o_favorite_menu .o_add_favorite input[type="text"]`),name);}
async function saveFavorite(el){await click(getNode(el).querySelector(`.o_favorite_menu .o_add_favorite button.o_save_favorite`));}
async function deleteFavorite(el,favoriteFinder){const favorite=findItem(el,`.o_favorite_menu .o_menu_item`,favoriteFinder);await click(favorite.querySelector('i.fa-trash'));}
async function toggleComparisonMenu(el){await click(getNode(el).querySelector(`div.o_comparison_menu > button`));}
function getFacetTexts(el){return[...getNode(el).querySelectorAll(`.o_searchview .o_searchview_facet`)].map(facet=>facet.innerText.trim());}
async function removeFacet(el,facetFinder=0){const facet=findItem(el,`.o_searchview .o_searchview_facet`,facetFinder);await click(facet.querySelector('.o_facet_remove'));}
async function editSearch(el,value){await editInput(getNode(el).querySelector(`.o_searchview_input`),value);}
async function validateSearch(el){await triggerEvent(getNode(el).querySelector(`.o_searchview_input`),'keydown',{key:'Enter'});}
async function toggleActionMenu(el,menuFinder="Action"){const dropdown=findItem(el,`.o_cp_action_menus button`,menuFinder);await click(dropdown);}
async function pagerPrevious(el){await click(getNode(el).querySelector(`.o_pager button.o_pager_previous`));}
async function pagerNext(el){await click(getNode(el).querySelector(`.o_pager button.o_pager_next`));}
function getPagerValue(el){const pagerValue=getNode(el).querySelector(`.o_pager_counter .o_pager_value`);switch(pagerValue.tagName){case'INPUT':return pagerValue.value;case'SPAN':return pagerValue.innerText.trim();}}
function getPagerSize(el){return getNode(el).querySelector(`.o_pager_counter span.o_pager_limit`).innerText.trim();}
async function setPagerValue(el,value){let pagerValue=getNode(el).querySelector(`.o_pager_counter .o_pager_value`);if(pagerValue.tagName==='SPAN'){await click(pagerValue);}
pagerValue=getNode(el).querySelector(`.o_pager_counter input.o_pager_value`);if(!pagerValue){throw new Error("Pager value is being edited and cannot be changed.");}
await editAndTrigger(pagerValue,value,['change','blur']);}
async function switchView(el,viewType){await click(getNode(el).querySelector(`button.o_switch_view.o_${viewType}`));}
return{toggleMenu,toggleMenuItem,toggleMenuItemOption,isItemSelected,isOptionSelected,getMenuItemTexts,getButtons,toggleFilterMenu,toggleAddCustomFilter,applyFilter,addCondition,toggleGroupByMenu,toggleAddCustomGroup,selectGroup,applyGroup,toggleFavoriteMenu,toggleSaveFavorite,editFavoriteName,saveFavorite,deleteFavorite,toggleComparisonMenu,getFacetTexts,removeFacet,editSearch,validateSearch,toggleActionMenu,pagerPrevious,pagerNext,getPagerValue,getPagerSize,setPagerValue,switchView,};});;

/* /web/static/tests/legacy/helpers/test_utils_create.js defined in bundle 'web.tests_assets' */
odoo.define('web.test_utils_create',function(require){"use strict";const ActionMenus=require('web.ActionMenus');const concurrency=require('web.concurrency');const ControlPanel=require('web.ControlPanel');const customHooks=require('web.custom_hooks');const dom=require('web.dom');const makeTestEnvironment=require('web.test_env');const ActionModel=require('web.ActionModel');const Registry=require('web.Registry');const testUtilsMock=require('web.test_utils_mock');const Widget=require('web.Widget');const{Component}=owl;const{useRef,useState}=owl.hooks;const{xml}=owl.tags;async function createCalendarView(params,options){const calendar=await createView(params);if(!options||!options.positionalClicks){return calendar;}
const viewElements=[...document.getElementById('qunit-fixture').children];let fcScroller=document.querySelector('.fc-scroller');const scrollPosition=fcScroller.scrollTop;viewElements.forEach(el=>document.body.prepend(el));fcScroller=document.querySelector('.fc-scroller');fcScroller.scrollTop=scrollPosition;const destroy=calendar.destroy;calendar.destroy=()=>{viewElements.forEach(el=>el.remove());destroy();};await concurrency.delay(0);return calendar;}
async function createComponent(constructor,params={}){if(!constructor){throw new Error(`Missing argument "constructor".`);}
if(!(constructor.prototype instanceof Component)){throw new Error(`Argument "constructor" must be an Owl Component.`);}
const cleanUp=await testUtilsMock.addMockEnvironmentOwl(Component,params);class Parent extends Component{constructor(){super(...arguments);this.Component=constructor;this.state=useState(params.props||{});this.component=useRef('component');for(const eventName in params.intercepts||{}){customHooks.useListener(eventName,params.intercepts[eventName]);}}}
Parent.template=xml`<t t-component="Component" t-props="state" t-ref="component"/>`;const parent=new Parent();await parent.mount(prepareTarget(params.debug),{position:'first-child'});const child=parent.component.comp;const originalDestroy=child.destroy;child.destroy=function(){child.destroy=originalDestroy;cleanUp();parent.destroy();};return child;}
async function createControlPanel(params={}){const debug=params.debug||false;const env=makeTestEnvironment(params.env||{});const props=Object.assign({action:{},fields:{},},params.cpProps);const globalConfig=Object.assign({context:{},domain:[],},params.cpModelConfig);if(globalConfig.arch&&globalConfig.fields){const model="__mockmodel__";const serverParams={model,data:{[model]:{fields:globalConfig.fields,records:[]}},};const mockServer=await testUtilsMock.addMockEnvironment(new Widget(),serverParams,);const{arch,fields}=testUtilsMock.fieldsViewGet(mockServer,{arch:globalConfig.arch,fields:globalConfig.fields,model,viewOptions:{context:globalConfig.context},});Object.assign(globalConfig,{arch,fields});}
globalConfig.env=env;const archs=(globalConfig.arch&&{search:globalConfig.arch,})||{};const{ControlPanel:controlPanelInfo,}=ActionModel.extractArchInfo(archs);const extensions={ControlPanel:{archNodes:controlPanelInfo.children,},};class Parent extends Component{constructor(){super();this.searchModel=new ActionModel(extensions,globalConfig);this.state=useState(props);this.controlPanel=useRef("controlPanel");}
async willStart(){await this.searchModel.load();}
mounted(){if(params['get-controller-query-params']){this.searchModel.on('get-controller-query-params',this,params['get-controller-query-params']);}
if(params.search){this.searchModel.on('search',this,params.search);}}}
Parent.components={ControlPanel};Parent.env=env;Parent.template=xml`
            <ControlPanel
                t-ref="controlPanel"
                t-props="state"
                searchModel="searchModel"
            />`;const parent=new Parent();await parent.mount(prepareTarget(debug),{position:'first-child'});const controlPanel=parent.controlPanel.comp;const destroy=controlPanel.destroy;controlPanel.destroy=function(){controlPanel.destroy=destroy;parent.destroy();};controlPanel.getQuery=()=>parent.searchModel.get('query');return controlPanel;}
async function createModel(params){const widget=new Widget();const model=new params.Model(widget,params);await testUtilsMock.addMockEnvironment(widget,params);model.destroy=function(){delete model.destroy;widget.destroy();};return model;}
async function createParent(params){const widget=new Widget();await testUtilsMock.addMockEnvironment(widget,params);return widget;}
async function createView(params){const target=prepareTarget(params.debug);const widget=new Widget();const webClient=Object.assign(document.createElement('div'),{className:params.touchScreen?'o_web_client o_touch_device':'o_web_client',});const actionManager=Object.assign(document.createElement('div'),{className:'o_action_manager',});const dialogContainer=Object.assign(document.createElement('div'),{className:'o_dialog_container',});target.prepend(webClient);webClient.append(actionManager);webClient.append(dialogContainer);const mockServer=await testUtilsMock.addMockEnvironment(widget,params);const viewInfo=testUtilsMock.fieldsViewGet(mockServer,params);params.server=mockServer;const View=params.View;const modelName=params.model||'foo';const defaultAction={res_model:modelName,context:{},type:'ir.actions.act_window',};const viewOptions=Object.assign({action:Object.assign(defaultAction,params.action),view:viewInfo,modelName:modelName,ids:'res_id'in params?[params.res_id]:undefined,currentId:'res_id'in params?params.res_id:undefined,domain:params.domain||[],context:params.context||{},hasActionMenus:false,},params.viewOptions);testUtilsMock.patch(View,{_updateMVCParams(){this._super(...arguments);this.loadParams.groupedBy=params.groupBy||viewOptions.groupBy||[];testUtilsMock.unpatch(View);},});if('hasSelectors'in params){viewOptions.hasSelectors=params.hasSelectors;}
let view;if(viewInfo.type==='controlpanel'||viewInfo.type==='search'){view=new params.View({viewInfo,modelName});}else{viewOptions.controlPanelFieldsView=Object.assign(testUtilsMock.fieldsViewGet(mockServer,{arch:params.archs&&params.archs[params.model+',false,search']||'<search/>',fields:viewInfo.fields,model:params.model,}),{favoriteFilters:params.favoriteFilters});view=new params.View(viewInfo,viewOptions);}
if(params.interceptsPropagate){for(const name in params.interceptsPropagate){testUtilsMock.intercept(widget,name,params.interceptsPropagate[name],true);}}
let actionMenusRegistry=ActionMenus.registry;if(params.actionMenusRegistry!==true){ActionMenus.registry=new Registry();}
const viewController=await view.getController(widget);viewController.__destroy=viewController.destroy;viewController.destroy=function(){delete viewController.destroy;widget.destroy();webClient.remove();if(params.actionMenusRegistry!==true){ActionMenus.registry=actionMenusRegistry;}};const fragment=document.createDocumentFragment();await viewController.appendTo(fragment);dom.prepend(actionManager,fragment,{callbacks:[{widget:viewController}],in_DOM:true,});if(!params.doNotDisableAHref){[...viewController.el.getElementsByTagName('A')].forEach(elem=>{elem.addEventListener('click',ev=>{ev.preventDefault();});});}
return viewController;}
function prepareTarget(debug=false){document.body.classList.toggle('debug',debug);return debug?document.body:document.getElementById('qunit-fixture');}
return{createCalendarView,createComponent,createControlPanel,createModel,createParent,createView,prepareTarget,};});;

/* /web/static/tests/legacy/helpers/test_utils_dom.js defined in bundle 'web.tests_assets' */
odoo.define('web.test_utils_dom',function(require){"use strict";const concurrency=require('web.concurrency');const Widget=require('web.Widget');const keyboardEventBubble=args=>Object.assign({},args,{bubbles:true,keyCode:args.which});const mouseEventMapping=args=>Object.assign({},args,{bubbles:true,cancelable:true,clientX:args?args.clientX||args.pageX:undefined,clientY:args?args.clientY||args.pageY:undefined,view:window,});const mouseEventNoBubble=args=>Object.assign({},args,{bubbles:false,cancelable:false,clientX:args?args.clientX||args.pageX:undefined,clientY:args?args.clientY||args.pageY:undefined,view:window,});const touchEventMapping=args=>Object.assign({},args,{cancelable:true,bubbles:true,composed:true,view:window,rotation:0.0,zoom:1.0,});const touchEventCancelMapping=args=>Object.assign({},touchEventMapping(args),{cancelable:false,});const noBubble=args=>Object.assign({},args,{bubbles:false});const onlyBubble=args=>Object.assign({},args,{bubbles:true});const EVENT_TYPES={auxclick:{constructor:MouseEvent,processParameters:mouseEventMapping},click:{constructor:MouseEvent,processParameters:mouseEventMapping},contextmenu:{constructor:MouseEvent,processParameters:mouseEventMapping},dblclick:{constructor:MouseEvent,processParameters:mouseEventMapping},mousedown:{constructor:MouseEvent,processParameters:mouseEventMapping},mouseup:{constructor:MouseEvent,processParameters:mouseEventMapping},mousemove:{constructor:MouseEvent,processParameters:mouseEventMapping},mouseenter:{constructor:MouseEvent,processParameters:mouseEventNoBubble},mouseleave:{constructor:MouseEvent,processParameters:mouseEventNoBubble},mouseover:{constructor:MouseEvent,processParameters:mouseEventMapping},mouseout:{constructor:MouseEvent,processParameters:mouseEventMapping},focus:{constructor:FocusEvent,processParameters:noBubble},focusin:{constructor:FocusEvent,processParameters:onlyBubble},blur:{constructor:FocusEvent,processParameters:noBubble},cut:{constructor:ClipboardEvent,processParameters:onlyBubble},copy:{constructor:ClipboardEvent,processParameters:onlyBubble},paste:{constructor:ClipboardEvent,processParameters:onlyBubble},keydown:{constructor:KeyboardEvent,processParameters:keyboardEventBubble},keypress:{constructor:KeyboardEvent,processParameters:keyboardEventBubble},keyup:{constructor:KeyboardEvent,processParameters:keyboardEventBubble},drag:{constructor:DragEvent,processParameters:onlyBubble},dragend:{constructor:DragEvent,processParameters:onlyBubble},dragenter:{constructor:DragEvent,processParameters:onlyBubble},dragstart:{constructor:DragEvent,processParameters:onlyBubble},dragleave:{constructor:DragEvent,processParameters:onlyBubble},dragover:{constructor:DragEvent,processParameters:onlyBubble},drop:{constructor:DragEvent,processParameters:onlyBubble},input:{constructor:InputEvent,processParameters:onlyBubble},compositionstart:{constructor:CompositionEvent,processParameters:onlyBubble},compositionend:{constructor:CompositionEvent,processParameters:onlyBubble},};if(typeof TouchEvent==='function'){Object.assign(EVENT_TYPES,{touchstart:{constructor:TouchEvent,processParameters:touchEventMapping},touchend:{constructor:TouchEvent,processParameters:touchEventMapping},touchmove:{constructor:TouchEvent,processParameters:touchEventMapping},touchcancel:{constructor:TouchEvent,processParameters:touchEventCancelMapping},});}
function _isEventTarget(node){if(!node){throw new Error(`Provided node is ${node}.`);}
if(node instanceof window.top.EventTarget){return true;}
const contextWindow=node.defaultView||(node.ownerDocument&&node.ownerDocument.defaultView);return contextWindow&&node instanceof contextWindow.EventTarget;}
async function click(el,options={}){let matches,target;let selectorMsg="";if(typeof el==='string'){el=$(el);}
if(el.disabled||(el instanceof jQuery&&el.get(0).disabled)){throw new Error("Can't click on a disabled button");}
if(_isEventTarget(el)){matches=[el];}else{matches=[...el];}
const validMatches=options.allowInvisible?matches:matches.filter(t=>$(t).is(':visible'));if(options.first){if(validMatches.length===1){throw new Error(`There should be more than one visible target ${selectorMsg}.  If`+' you are sure that there is exactly one target, please use the '+'click function instead of the clickFirst function');}
target=validMatches[0];}else if(options.last){if(validMatches.length===1){throw new Error(`There should be more than one visible target ${selectorMsg}.  If`+' you are sure that there is exactly one target, please use the '+'click function instead of the clickLast function');}
target=validMatches[validMatches.length-1];}else if(validMatches.length!==1){throw new Error(`Found ${validMatches.length} elements to click on, instead of 1 ${selectorMsg}`);}else{target=validMatches[0];}
if(validMatches.length===0&&matches.length>0){throw new Error(`Element to click on is not visible ${selectorMsg}`);}
if(target.disabled){return;}
return triggerEvent(target,'click');}
async function clickFirst(el,options){return click(el,Object.assign({},options,{first:true}));}
async function clickLast(el,options){return click(el,Object.assign({},options,{last:true}));}
async function dragAndDrop($el,$to,options){let el=null;if(_isEventTarget($el)){el=$el;$el=$(el);}
if(_isEventTarget($to)){$to=$($to);}
options=options||{};const position=options.position||'center';const elementCenter=$el.offset();const toOffset=$to.offset();if(typeof position==='object'){toOffset.top+=position.top+1;toOffset.left+=position.left+1;}else{toOffset.top+=$to.outerHeight()/2;toOffset.left+=$to.outerWidth()/2;const vertical_offset=(toOffset.top<elementCenter.top)?-1:1;if(position==='top'){toOffset.top-=$to.outerHeight()/2+vertical_offset;}else if(position==='bottom'){toOffset.top+=$to.outerHeight()/2-vertical_offset;}else if(position==='left'){toOffset.left-=$to.outerWidth()/2;}else if(position==='right'){toOffset.left+=$to.outerWidth()/2;}}
if($to[0].ownerDocument!==document){const bound=$('iframe')[0].getBoundingClientRect();toOffset.left+=bound.left;toOffset.top+=bound.top;}
await triggerEvent(options.mouseenterTarget||el||$el,'mouseover',{},true);if(!(options.continueMove)){elementCenter.left+=$el.outerWidth()/2;elementCenter.top+=$el.outerHeight()/2;await triggerEvent(options.mousedownTarget||el||$el,'mousedown',{which:1,pageX:elementCenter.left,pageY:elementCenter.top},true);}
await triggerEvent(options.mousemoveTarget||el||$el,'mousemove',{which:1,pageX:toOffset.left,pageY:toOffset.top},true);if(!options.disableDrop){await triggerEvent(options.mouseupTarget||el||$el,'mouseup',{which:1,pageX:toOffset.left,pageY:toOffset.top,ctrlKey:options.ctrlKey,},true);if(options.withTrailingClick){await triggerEvent(options.mouseupTarget||el||$el,'click',{},true);}}else{$el.on('remove',function(){triggerEvent($el,'mouseup',{},true);});}
return returnAfterNextAnimationFrame();}
function findItem(el,selector,elFinder=0){const elements=[...getNode(el).querySelectorAll(selector)];if(!elements.length){throw new Error(`No element found with selector "${selector}".`);}
switch(typeof elFinder){case"number":{const match=elements[elFinder];if(!match){throw new Error(`No element with selector "${selector}" at index ${elFinder}.`);}
return match;}
case"string":{const match=elements.find((el)=>el.innerText.trim().toLowerCase()===elFinder.toLowerCase());if(!match){throw new Error(`No element with selector "${selector}" containing "${elFinder}".
                    `);}
return match;}
default:throw new Error(`Invalid provided element finder: must be a number|string|function.`);}}
function getNode(target){let nodes;if(target instanceof owl.Component||target instanceof Widget){nodes=[target.el];}else if(typeof target==='string'){nodes=document.querySelectorAll(target);}else if(target===jQuery){nodes=[document.body];}else if(target.length){nodes=target;}else{nodes=[target];}
if(nodes.length!==1){throw new Error(`Found ${nodes.length} nodes instead of 1.`);}
const node=nodes[0];if(!node){throw new Error(`Expected a node and got ${node}.`);}
if(!_isEventTarget(node)){throw new Error(`Expected node to be an instance of EventTarget and got ${node.constructor.name}.`);}
return node;}
async function openDatepicker($datepickerEl){return click($datepickerEl.find('.o_datepicker_input'));}
async function returnAfterNextAnimationFrame(){await concurrency.delay(0);await new Promise(resolve=>{window.requestAnimationFrame(resolve);});}
async function triggerEvent(el,eventType,eventAttrs={},fast=false){let matches;let selectorMsg="";if(_isEventTarget(el)){matches=[el];}else{matches=[...el];}
if(matches.length!==1){throw new Error(`Found ${matches.length} elements to trigger "${eventType}" on, instead of 1 ${selectorMsg}`);}
const target=matches[0];let event;if(!EVENT_TYPES[eventType]&&!EVENT_TYPES[eventType.type]){event=new Event(eventType,Object.assign({},eventAttrs,{bubbles:true}));}else{if(typeof eventType==="object"){const{constructor,processParameters}=EVENT_TYPES[eventType.type];const eventParameters=processParameters(eventType);event=new constructor(eventType.type,eventParameters);}else{const{constructor,processParameters}=EVENT_TYPES[eventType];event=new constructor(eventType,processParameters(eventAttrs));}}
target.dispatchEvent(event);return fast?undefined:returnAfterNextAnimationFrame();}
async function triggerEvents(el,events){if(el instanceof jQuery){if(el.length!==1){throw new Error(`target has length ${el.length} instead of 1`);}}
if(typeof events==='string'){events=[events];}
for(let e=0;e<events.length;e++){await triggerEvent(el,events[e]);}}
async function triggerKeypressEvent(char){let keycode;if(char==='Enter'){keycode=$.ui.keyCode.ENTER;}else if(char==="Tab"){keycode=$.ui.keyCode.TAB;}else{keycode=char.charCodeAt(0);}
return triggerEvent(document.body,'keypress',{key:char,keyCode:keycode,which:keycode,});}
async function triggerMouseEvent($el,type){const el=$el instanceof jQuery?$el[0]:$el;if(!el){throw new Error(`no target found to trigger MouseEvent`);}
const rect=el.getBoundingClientRect();const left=rect.x+Math.ceil(rect.width/2);const top=rect.y+Math.ceil(rect.height/2);return triggerEvent(el,type,{which:1,clientX:left,clientY:top});}
async function triggerPositionalMouseEvent(x,y,type){const ev=document.createEvent("MouseEvent");const el=document.elementFromPoint(x,y);ev.initMouseEvent(type,true,true,window,null,x,y,x,y,false,false,false,false,0,null);el.dispatchEvent(ev);return el;}
async function triggerPositionalTapEvents(x,y){const element=document.elementFromPoint(x,y);const touch=new Touch({identifier:0,target:element,clientX:x,clientY:y,pageX:x,pageY:y,});await triggerEvent(element,'touchstart',{touches:[touch],targetTouches:[touch],changedTouches:[touch],});await triggerEvent(element,'touchmove',{touches:[touch],targetTouches:[touch],changedTouches:[touch],});await triggerEvent(element,'touchend',{changedTouches:[touch],});return element;}
return{click,clickFirst,clickLast,dragAndDrop,findItem,getNode,openDatepicker,returnAfterNextAnimationFrame,triggerEvent,triggerEvents,triggerKeypressEvent,triggerMouseEvent,triggerPositionalMouseEvent,triggerPositionalTapEvents,};});;

/* /web/static/tests/legacy/helpers/test_utils_fields.js defined in bundle 'web.tests_assets' */
odoo.define('web.test_utils_fields',function(require){"use strict";const testUtilsDom=require('web.test_utils_dom');const ARROW_KEYS_MAPPING={down:'ArrowDown',left:'ArrowLeft',right:'ArrowRight',up:'ArrowUp',};async function clickM2OCreateAndEdit(fieldName,text="ABC"){await clickOpenM2ODropdown(fieldName);const match=document.querySelector(`.o_field_many2one[name=${fieldName}] input`);await editInput(match,text);return clickM2OItem(fieldName,"Create and Edit");}
async function clickM2OHighlightedItem(fieldName,selector){const m2oSelector=`${selector || ''} .o_field_many2one[name=${fieldName}] input`;const $dropdown=$(m2oSelector).autocomplete('widget');return testUtilsDom.click($dropdown[0].querySelector('li'));}
async function clickM2OItem(fieldName,searchText){const m2oSelector=`.o_field_many2one[name=${fieldName}] input`;const $dropdown=$(m2oSelector).autocomplete('widget');const $target=$dropdown.find(`li:contains(${searchText})`).first();if($target.length!==1||!$target.is(':visible')){throw new Error('Menu item should be visible');}
$target.mouseenter();return testUtilsDom.click($target);}
async function clickOpenM2ODropdown(fieldName,selector){const m2oSelector=`${selector || ''} .o_field_many2one[name=${fieldName}] input`;const matches=document.querySelectorAll(m2oSelector);if(matches.length!==1){throw new Error(`cannot open m2o: selector ${selector} has been found ${matches.length} instead of 1`);}
await testUtilsDom.click(matches[0]);return matches[0];}
async function editAndTrigger(el,value,events){if(el instanceof jQuery){if(el.length!==1){throw new Error(`target ${el.selector} has length ${el.length} instead of 1`);}
el.val(value);}else{el.value=value;}
return testUtilsDom.triggerEvents(el,events);}
async function editInput(el,value){return editAndTrigger(el,value,['input']);}
function editSelect(el,value){return editAndTrigger(el,value,['change']);}
async function searchAndClickM2OItem(fieldName,options={}){const input=await clickOpenM2ODropdown(fieldName,options.selector);if(options.search){await editInput(input,options.search);}
if(options.item){return clickM2OItem(fieldName,options.item);}else{return clickM2OHighlightedItem(fieldName,options.selector);}}
function triggerKey(type,$el,keyCode){type='key'+type;const params={};if(typeof keyCode==='string'){if(keyCode in ARROW_KEYS_MAPPING){params.key=ARROW_KEYS_MAPPING[keyCode];}else{params.key=keyCode[0].toUpperCase()+keyCode.slice(1).toLowerCase();}
if(keyCode.length>1){keyCode=keyCode.toUpperCase();keyCode=$.ui.keyCode[keyCode];}else{keyCode=keyCode.charCodeAt(0);}}
params.keyCode=keyCode;params.which=keyCode;return testUtilsDom.triggerEvent($el,type,params);}
function triggerKeydown($el,keyCode){return triggerKey('down',$el,keyCode);}
function triggerKeyup($el,keyCode){return triggerKey('up',$el,keyCode);}
return{clickM2OCreateAndEdit,clickM2OHighlightedItem,clickM2OItem,clickOpenM2ODropdown,editAndTrigger,editInput,editSelect,searchAndClickM2OItem,triggerKey,triggerKeydown,triggerKeyup,};});;

/* /web/static/tests/legacy/helpers/test_utils_file.js defined in bundle 'web.tests_assets' */
odoo.define('web.test_utils_file',function(){"use strict";function _createFakeDataTransfer(files){return{dropEffect:'all',effectAllowed:'all',files,getData:function(){return files;},items:[],types:['Files'],};}
function createFile(data){return new Promise(function(resolve,reject){var requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem;if(!requestFileSystem){throw new Error('FileSystem API is not supported');}
requestFileSystem(window.TEMPORARY,1024*1024,function(fileSystem){fileSystem.root.getFile(data.name,{create:true},function(fileEntry){fileEntry.createWriter(function(fileWriter){fileWriter.onwriteend=function(e){fileSystem.root.getFile(data.name,{},function(fileEntry){fileEntry.file(function(file){resolve(file);});});};fileWriter.write(new Blob([data.content],{type:data.contentType}));});});});});}
function dragoverFile($el,file){var ev=new Event('dragover',{bubbles:true});Object.defineProperty(ev,'dataTransfer',{value:_createFakeDataTransfer(file),});$el[0].dispatchEvent(ev);}
function dropFile($el,file){var ev=new Event('drop',{bubbles:true,});Object.defineProperty(ev,'dataTransfer',{value:_createFakeDataTransfer([file]),});$el[0].dispatchEvent(ev);}
function dropFiles($el,files){var ev=new Event('drop',{bubbles:true,});Object.defineProperty(ev,'dataTransfer',{value:_createFakeDataTransfer(files),});$el[0].dispatchEvent(ev);}
function inputFiles(el,files){const dataTransfer=new window.DataTransfer();for(const file of files){dataTransfer.items.add(file);}
el.files=dataTransfer.files;const versionRaw=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);const chromeVersion=versionRaw?parseInt(versionRaw[2],10):false;if(!chromeVersion||chromeVersion>=73){el.dispatchEvent(new Event('change'));}}
return{createFile:createFile,dragoverFile:dragoverFile,dropFile:dropFile,dropFiles,inputFiles,};});;

/* /web/static/tests/legacy/helpers/test_utils_form.js defined in bundle 'web.tests_assets' */
odoo.define('web.test_utils_form',function(require){"use strict";var testUtilsDom=require('web.test_utils_dom');function clickEdit(form){return testUtilsDom.click(form.$buttons.find('.o_form_button_edit'));}
function clickSave(form){return testUtilsDom.click(form.$buttons.find('.o_form_button_save'));}
function clickCreate(form){return testUtilsDom.click(form.$buttons.find('.o_form_button_create'));}
function clickDiscard(form){return testUtilsDom.click(form.$buttons.find('.o_form_button_cancel'));}
function reload(form,params){return form.reload(params);}
return{clickEdit:clickEdit,clickSave:clickSave,clickCreate:clickCreate,clickDiscard:clickDiscard,reload:reload,};});;

/* /web/static/tests/legacy/helpers/test_utils_graph.js defined in bundle 'web.tests_assets' */
odoo.define('web.test_utils_graph',function(){"use strict";function reload(graph,params){return graph.reload(params);}
return{reload:reload,};});;

/* /web/static/tests/legacy/helpers/test_utils_kanban.js defined in bundle 'web.tests_assets' */
odoo.define('web.test_utils_kanban',function(require){"use strict";var testUtilsDom=require('web.test_utils_dom');var testUtilsFields=require('web.test_utils_fields');function clickCreate(kanban){return testUtilsDom.click(kanban.$buttons.find('.o-kanban-button-new'));}
function toggleGroupSettings($column){var $dropdownToggler=$column.find('.o_kanban_config > a.dropdown-toggle');if(!$dropdownToggler.is(':visible')){$dropdownToggler.css('display','block');}
return testUtilsDom.click($dropdownToggler);}
function quickCreate(kanban,value,fieldName){var additionalSelector=fieldName?('[name='+fieldName+']'):'';var enterEvent=$.Event('keydown',{which:$.ui.keyCode.ENTER,keyCode:$.ui.keyCode.ENTER,});return testUtilsFields.editAndTrigger(kanban.$('.o_kanban_quick_create input'+additionalSelector),value,['input',enterEvent]);}
function reload(kanban,params){return kanban.reload(params);}
function toggleRecordDropdown($record){var $dropdownToggler=$record.find('.o_dropdown_kanban > a.dropdown-toggle');if(!$dropdownToggler.is(':visible')){$dropdownToggler.css('display','block');}
return testUtilsDom.click($dropdownToggler);}
return{clickCreate:clickCreate,quickCreate:quickCreate,reload:reload,toggleGroupSettings:toggleGroupSettings,toggleRecordDropdown:toggleRecordDropdown,};});;

/* /web/static/tests/legacy/helpers/test_utils_mock.js defined in bundle 'web.tests_assets' */
odoo.define('web.test_utils_mock',function(require){"use strict";const AbstractStorageService=require('web.AbstractStorageService');const AjaxService=require('web.AjaxService');const basic_fields=require('web.basic_fields');const Bus=require('web.Bus');const config=require('web.config');const core=require('web.core');const dom=require('web.dom');const FormController=require('web.FormController');const makeTestEnvironment=require('web.test_env');const MockServer=require('web.MockServer');const RamStorage=require('web.RamStorage');const session=require('web.session');const{patchDate}=require("@web/../tests/helpers/utils");const DebouncedField=basic_fields.DebouncedField;async function _getMockedOwlEnv(params,mockServer){params.env=params.env||{};const database={parameters:params.translateParameters||{}};const favoriteFilters=params.favoriteFilters;const debug=params.debug;const services={};const env=Object.assign({},params.env,{_t:params.env&&params.env._t||Object.assign((s=>s),{database}),browser:Object.assign({fetch:(resource,init)=>mockServer.performFetch(resource,init),},params.env.browser),bus:params.bus||params.env.bus||new Bus(),dataManager:Object.assign({load_action:(actionID,context)=>{return mockServer.performRpc('/web/action/load',{action_id:actionID,additional_context:context,});},load_views:(params,options)=>{return mockServer.performRpc('/web/dataset/call_kw/'+params.model,{args:[],kwargs:{context:params.context,options:options,views:params.views_descr,},method:'load_views',model:params.model,}).then(function(views){views=_.mapObject(views,viewParams=>{return fieldsViewGet(mockServer,viewParams);});if(favoriteFilters&&'search'in views){views.search.favoriteFilters=favoriteFilters;}
return views;});},load_filters:params=>{if(debug){console.log('[mock] load_filters',params);}
return Promise.resolve([]);},},params.env.dataManager),services:Object.assign(services,params.env.services),session:params.env.session||params.session||{},});const servicesToDeploy={};for(const name in params.services||{}){const Service=params.services[name];if(Service.constructor.name==='Class'){servicesToDeploy[name]=Service;}else{services[name]=Service;}}
if(!servicesToDeploy.ajax){const MockedAjaxService=AjaxService.extend({rpc:mockServer.performRpc.bind(mockServer),});services.ajax=new MockedAjaxService(env);}
const RamStorageService=AbstractStorageService.extend({storage:new RamStorage(),});if(!servicesToDeploy.local_storage){services.local_storage=new RamStorageService(env);}
if(!servicesToDeploy.session_storage){services.session_storage=new RamStorageService(env);}
let done=false;while(!done){const serviceName=Object.keys(servicesToDeploy).find(serviceName=>{const Service=servicesToDeploy[serviceName];return Service.prototype.dependencies.every(depName=>{return env.services[depName];});});if(serviceName){const Service=servicesToDeploy[serviceName];services[serviceName]=new Service(env);delete servicesToDeploy[serviceName];services[serviceName].start();}else{const serviceNames=_.keys(servicesToDeploy);if(serviceNames.length){console.warn("Non loaded services:",serviceNames);}
done=true;}}
await new Promise(setTimeout);return env;}
function _mockGlobalObjects(params){const initialSession=Object.assign({},session);const sessionPatch=Object.assign({getTZOffset(){return 0;},async user_has_group(){return false;},},params.session);Object.assign(session,sessionPatch);let initialConfig;if('config'in params){initialConfig=Object.assign({},config);initialConfig.device=Object.assign({},config.device);if('device'in params.config){Object.assign(config.device,params.config.device);}
if('debug'in params.config){odoo.debug=params.config.debug;}}
let initialParameters;if('translateParameters'in params){initialParameters=Object.assign({},core._t.database.parameters);Object.assign(core._t.database.parameters,params.translateParameters);}
function cleanUp(){let key;for(key in sessionPatch){delete session[key];}
Object.assign(session,initialSession);if('config'in params){for(key in config){delete config[key];}
_.extend(config,initialConfig);}
if('translateParameters'in params){for(key in core._t.database.parameters){delete core._t.database.parameters[key];}
_.extend(core._t.database.parameters,initialParameters);}}
return cleanUp;}
function _observe(widget){var _trigger_up=widget._trigger_up.bind(widget);widget._trigger_up=function(event){console.log('%c[event] '+event.name,'color: blue; font-weight: bold;',event);_trigger_up(event);};}
function fieldsViewGet(server,params){var fieldsView=server.fieldsViewGet(params);fieldsView.viewFields=fieldsView.fields;fieldsView.fields=server.fieldsGet(params.model);return fieldsView;}
function intercept(widget,eventName,fn,propagate){var _trigger_up=widget._trigger_up.bind(widget);widget._trigger_up=function(event){if(event.name===eventName){fn(event);if(!propagate){return;}}
_trigger_up(event);};}
function removeSrcAttribute(el,rpc){var nodes;if(el.nodeName==="#comment"){return;}
el=el.nodeType===8?el.nextSibling:el;if(el.nodeName==='IMG'||el.nodeName==='IFRAME'){nodes=[el];}else{nodes=Array.prototype.slice.call(el.getElementsByTagName('img')).concat(Array.prototype.slice.call(el.getElementsByTagName('iframe')));}
var node;while(node=nodes.pop()){const dataSrc=node.dataset.src;if(dataSrc&&dataSrc!=="about:blank"&&rpc){rpc(dataSrc,[]);$(node).trigger("load");}
var src=node.attributes.src&&node.attributes.src.value;if(src&&src!=='about:blank'){node.setAttribute('data-src',src);if(node.nodeName==='IMG'){node.attributes.removeNamedItem('src');}else{node.setAttribute('src','about:blank');}
if(rpc){rpc(src,[]);}
$(node).trigger('load');}}}
async function addMockEnvironmentOwl(Component,params,mockServer){params=params||{};if(!mockServer){let Server=MockServer;if(params.mockFetch){Server=MockServer.extend({_performFetch:params.mockFetch});}
if(params.mockRPC){Server=Server.extend({_performRpc:params.mockRPC});}
mockServer=new Server(params.data,{actions:params.actions,archs:params.archs,currentDate:params.currentDate,debug:params.debug,});}
const initialQuickEditDelay=FormController.prototype.multiClickTime;FormController.prototype.multiClickTime=params.formMultiClickTime||0;const initialDebounceValue=DebouncedField.prototype.DEBOUNCE;DebouncedField.prototype.DEBOUNCE=params.fieldDebounce||0;const initialDOMDebounceValue=dom.DEBOUNCE;dom.DEBOUNCE=0;const initialDebounce=_.debounce;if(params.debounce===false){_.debounce=function(func){return func;};}
const initialThrottle=_.throttle;if(!('throttle'in params)||!params.throttle){_.throttle=function(func){return func;};}
$('body').on('DOMNodeInserted.removeSRC',function(ev){let rpc;if(params.mockSRC){rpc=mockServer.performRpc.bind(mockServer);}
removeSrcAttribute(ev.target,rpc);});const restoreMockedGlobalObjects=_mockGlobalObjects(params);const env=await _getMockedOwlEnv(params,mockServer);const originalEnv=Component.env;Component.env=makeTestEnvironment(env,mockServer.performRpc.bind(mockServer));const envBusTrigger=env.bus.trigger;env.bus.trigger=function(){core.bus.trigger(...arguments);envBusTrigger.call(env.bus,...arguments);};function cleanUp(){env.bus.destroy();Object.keys(env.services).forEach(function(s){var service=env.services[s]||{};if(service.destroy&&!service.isDestroyed()){service.destroy();}});FormController.prototype.multiClickTime=initialQuickEditDelay;DebouncedField.prototype.DEBOUNCE=initialDebounceValue;dom.DEBOUNCE=initialDOMDebounceValue;_.debounce=initialDebounce;_.throttle=initialThrottle;core.bus.trigger('clear_cache');$('body').off('DOMNodeInserted.removeSRC');$('.blockUI').remove();restoreMockedGlobalObjects();Component.env=originalEnv;}
return cleanUp;}
async function addMockEnvironment(widget,params){if(params.debug){_observe(widget);var separator=window.location.href.indexOf('?')!==-1?"&":"?";var url=window.location.href+separator+'testId='+QUnit.config.current.testId;console.log('%c[debug] debug mode activated','color: blue; font-weight: bold;',url);}
var Server=MockServer;if(params.mockFetch){Server=MockServer.extend({_performFetch:params.mockFetch});}
if(params.mockRPC){Server=Server.extend({_performRpc:params.mockRPC});}
var mockServer=new Server(params.data,{actions:params.actions,archs:params.archs,currentDate:params.currentDate,debug:params.debug,widget:widget,});if(!('mockSRC'in params)){params.mockSRC=true;}
const cleanUp=await addMockEnvironmentOwl(owl.Component,params,mockServer);const env=owl.Component.env;const destroy=widget.destroy;widget.destroy=function(){cleanUp();destroy.call(this,...arguments);};intercept(widget,'call_service',function(ev){if(env.services[ev.data.service]){var service=env.services[ev.data.service];const result=service[ev.data.method].apply(service,ev.data.args||[]);ev.data.callback(result);}});intercept(widget,'load_action',async ev=>{const action=await env.dataManager.load_action(ev.data.actionID,ev.data.context);ev.data.on_success(action);});intercept(widget,"load_views",async ev=>{const params={model:ev.data.modelName,context:ev.data.context,views_descr:ev.data.views,};const views=await env.dataManager.load_views(params,ev.data.options);if('search'in views&&params.favoriteFilters){views.search.favoriteFilters=params.favoriteFilters;}
ev.data.on_success(views);});intercept(widget,"get_session",ev=>{ev.data.callback(session);});intercept(widget,"load_filters",async ev=>{const filters=await env.dataManager.load_filters(ev.data);ev.data.on_success(filters);});Object.keys(params.intercepts||{}).forEach(function(name){intercept(widget,name,params.intercepts[name]);});return mockServer;}
function legacyPatchDate(year,month,day,hours,minutes,seconds){patchDate(year,month,day,hours,minutes,seconds);return function(){};}
var patches={};function patch(target,props){var patchID=_.uniqueId('patch_');target.__patchID=patchID;patches[patchID]={target:target,otherPatchedProps:[],ownPatchedProps:[],};if(target.prototype){_.each(props,function(value,key){if(target.prototype.hasOwnProperty(key)){patches[patchID].ownPatchedProps.push({key:key,initialValue:target.prototype[key],});}else{patches[patchID].otherPatchedProps.push(key);}});target.include(props);}else{_.each(props,function(value,key){if(key in target){var oldValue=target[key];patches[patchID].ownPatchedProps.push({key:key,initialValue:oldValue,});if(typeof value==='function'){target[key]=function(){var oldSuper=this._super;this._super=oldValue;var result=value.apply(this,arguments);if(oldSuper===undefined){delete this._super;}else{this._super=oldSuper;}
return result;};}else{target[key]=value;}}else{patches[patchID].otherPatchedProps.push(key);target[key]=value;}});}}
function unpatch(target){var patchID=target.__patchID;var patch=patches[patchID];if(target.prototype){_.each(patch.ownPatchedProps,function(p){target.prototype[p.key]=p.initialValue;});_.each(patch.otherPatchedProps,function(key){delete target.prototype[key];});}else{_.each(patch.ownPatchedProps,function(p){target[p.key]=p.initialValue;});_.each(patch.otherPatchedProps,function(key){delete target[key];});}
delete patches[patchID];delete target.__patchID;}
window.originalSetTimeout=window.setTimeout;function patchSetTimeout(){var original=window.setTimeout;var self=this;window.setTimeout=function(handler,delay){console.log("calling setTimeout on "+(handler.name||"some function")+"with delay of "+delay);console.trace();var handlerArguments=Array.prototype.slice.call(arguments,1);return original(function(){handler.bind(self,handlerArguments)();console.log('after doing the action of the setTimeout');},delay);};return function(){window.setTimeout=original;};}
return{addMockEnvironment:addMockEnvironment,fieldsViewGet:fieldsViewGet,addMockEnvironmentOwl:addMockEnvironmentOwl,intercept:intercept,patchDate:legacyPatchDate,patch:patch,unpatch:unpatch,patchSetTimeout:patchSetTimeout,};});;

/* /web/static/tests/legacy/helpers/test_utils_modal.js defined in bundle 'web.tests_assets' */
odoo.define('web.test_utils_modal',function(require){"use strict";const{_t}=require('web.core');const testUtilsDom=require('web.test_utils_dom');function clickButton(text){return testUtilsDom.click($(`.modal-footer button:contains(${_t(text)})`));}
return{clickButton};});;

/* /web/static/tests/legacy/helpers/test_utils_pivot.js defined in bundle 'web.tests_assets' */
odoo.define('web.test_utils_pivot',function(require){"use strict";var testUtilsDom=require('web.test_utils_dom');function clickMeasure(pivot,measure){return testUtilsDom.click(pivot.$buttons.find(`.dropdown-item[data-field=${measure}]`));}
function toggleMeasuresDropdown(pivot){return testUtilsDom.click(pivot.$buttons.filter('.btn-group:first').find('> button'));}
function reload(pivot,params){return pivot.reload(params);}
return{clickMeasure:clickMeasure,reload:reload,toggleMeasuresDropdown:toggleMeasuresDropdown,};});;

/* /web/static/tests/legacy/legacy_setup.js defined in bundle 'web.tests_assets' */
odoo.define('@web/../tests/legacy/legacy_setup',async function(require){'use strict';let __exports={};const legacySetupProm=__exports.legacySetupProm=Promise.resolve();return __exports;});odoo.define(`web.legacySetup`,async function(require){return require('@web/../tests/legacy/legacy_setup')[Symbol.for("default")];});;

/* /web/static/lib/fullcalendar/core/main.js defined in bundle 'web.tests_assets' */
(function(global,factory){typeof exports==='object'&&typeof module!=='undefined'?factory(exports):typeof define==='function'&&define.amd?define(['exports'],factory):(global=global||self,factory(global.FullCalendar={}));}(this,function(exports){'use strict';var elementPropHash={className:true,colSpan:true,rowSpan:true};var containerTagHash={'<tr':'tbody','<td':'tr'};function createElement(tagName,attrs,content){var el=document.createElement(tagName);if(attrs){for(var attrName in attrs){if(attrName==='style'){applyStyle(el,attrs[attrName]);}
else if(elementPropHash[attrName]){el[attrName]=attrs[attrName];}
else{el.setAttribute(attrName,attrs[attrName]);}}}
if(typeof content==='string'){el.innerHTML=content;}
else if(content!=null){appendToElement(el,content);}
return el;}
function htmlToElement(html){html=html.trim();var container=document.createElement(computeContainerTag(html));container.innerHTML=html;return container.firstChild;}
function htmlToElements(html){return Array.prototype.slice.call(htmlToNodeList(html));}
function htmlToNodeList(html){html=html.trim();var container=document.createElement(computeContainerTag(html));container.innerHTML=html;return container.childNodes;}
function computeContainerTag(html){return containerTagHash[html.substr(0,3)]||'div';}
function appendToElement(el,content){var childNodes=normalizeContent(content);for(var i=0;i<childNodes.length;i++){el.appendChild(childNodes[i]);}}
function prependToElement(parent,content){var newEls=normalizeContent(content);var afterEl=parent.firstChild||null;for(var i=0;i<newEls.length;i++){parent.insertBefore(newEls[i],afterEl);}}
function insertAfterElement(refEl,content){var newEls=normalizeContent(content);var afterEl=refEl.nextSibling||null;for(var i=0;i<newEls.length;i++){refEl.parentNode.insertBefore(newEls[i],afterEl);}}
function normalizeContent(content){var els;if(typeof content==='string'){els=htmlToElements(content);}
else if(content instanceof Node){els=[content];}
else{els=Array.prototype.slice.call(content);}
return els;}
function removeElement(el){if(el.parentNode){el.parentNode.removeChild(el);}}
var matchesMethod=Element.prototype.matches||Element.prototype.matchesSelector||Element.prototype.msMatchesSelector;var closestMethod=Element.prototype.closest||function(selector){var el=this;if(!document.documentElement.contains(el)){return null;}
do{if(elementMatches(el,selector)){return el;}
el=el.parentElement||el.parentNode;}while(el!==null&&el.nodeType===1);return null;};function elementClosest(el,selector){return closestMethod.call(el,selector);}
function elementMatches(el,selector){return matchesMethod.call(el,selector);}
function findElements(container,selector){var containers=container instanceof HTMLElement?[container]:container;var allMatches=[];for(var i=0;i<containers.length;i++){var matches=containers[i].querySelectorAll(selector);for(var j=0;j<matches.length;j++){allMatches.push(matches[j]);}}
return allMatches;}
function findChildren(parent,selector){var parents=parent instanceof HTMLElement?[parent]:parent;var allMatches=[];for(var i=0;i<parents.length;i++){var childNodes=parents[i].children;for(var j=0;j<childNodes.length;j++){var childNode=childNodes[j];if(!selector||elementMatches(childNode,selector)){allMatches.push(childNode);}}}
return allMatches;}
function forceClassName(el,className,bool){if(bool){el.classList.add(className);}
else{el.classList.remove(className);}}
var PIXEL_PROP_RE=/(top|left|right|bottom|width|height)$/i;function applyStyle(el,props){for(var propName in props){applyStyleProp(el,propName,props[propName]);}}
function applyStyleProp(el,name,val){if(val==null){el.style[name]='';}
else if(typeof val==='number'&&PIXEL_PROP_RE.test(name)){el.style[name]=val+'px';}
else{el.style[name]=val;}}
function pointInsideRect(point,rect){return point.left>=rect.left&&point.left<rect.right&&point.top>=rect.top&&point.top<rect.bottom;}
function intersectRects(rect1,rect2){var res={left:Math.max(rect1.left,rect2.left),right:Math.min(rect1.right,rect2.right),top:Math.max(rect1.top,rect2.top),bottom:Math.min(rect1.bottom,rect2.bottom)};if(res.left<res.right&&res.top<res.bottom){return res;}
return false;}
function translateRect(rect,deltaX,deltaY){return{left:rect.left+deltaX,right:rect.right+deltaX,top:rect.top+deltaY,bottom:rect.bottom+deltaY};}
function constrainPoint(point,rect){return{left:Math.min(Math.max(point.left,rect.left),rect.right),top:Math.min(Math.max(point.top,rect.top),rect.bottom)};}
function getRectCenter(rect){return{left:(rect.left+rect.right)/2,top:(rect.top+rect.bottom)/2};}
function diffPoints(point1,point2){return{left:point1.left-point2.left,top:point1.top-point2.top};}
var isRtlScrollbarOnLeft=null;function getIsRtlScrollbarOnLeft(){if(isRtlScrollbarOnLeft===null){isRtlScrollbarOnLeft=computeIsRtlScrollbarOnLeft();}
return isRtlScrollbarOnLeft;}
function computeIsRtlScrollbarOnLeft(){var outerEl=createElement('div',{style:{position:'absolute',top:-1000,left:0,border:0,padding:0,overflow:'scroll',direction:'rtl'}},'<div></div>');document.body.appendChild(outerEl);var innerEl=outerEl.firstChild;var res=innerEl.getBoundingClientRect().left>outerEl.getBoundingClientRect().left;removeElement(outerEl);return res;}
function sanitizeScrollbarWidth(width){width=Math.max(0,width);width=Math.round(width);return width;}
function computeEdges(el,getPadding){if(getPadding===void 0){getPadding=false;}
var computedStyle=window.getComputedStyle(el);var borderLeft=parseInt(computedStyle.borderLeftWidth,10)||0;var borderRight=parseInt(computedStyle.borderRightWidth,10)||0;var borderTop=parseInt(computedStyle.borderTopWidth,10)||0;var borderBottom=parseInt(computedStyle.borderBottomWidth,10)||0;var scrollbarLeftRight=sanitizeScrollbarWidth(el.offsetWidth-el.clientWidth-borderLeft-borderRight);var scrollbarBottom=sanitizeScrollbarWidth(el.offsetHeight-el.clientHeight-borderTop-borderBottom);var res={borderLeft:borderLeft,borderRight:borderRight,borderTop:borderTop,borderBottom:borderBottom,scrollbarBottom:scrollbarBottom,scrollbarLeft:0,scrollbarRight:0};if(getIsRtlScrollbarOnLeft()&&computedStyle.direction==='rtl'){res.scrollbarLeft=scrollbarLeftRight;}
else{res.scrollbarRight=scrollbarLeftRight;}
if(getPadding){res.paddingLeft=parseInt(computedStyle.paddingLeft,10)||0;res.paddingRight=parseInt(computedStyle.paddingRight,10)||0;res.paddingTop=parseInt(computedStyle.paddingTop,10)||0;res.paddingBottom=parseInt(computedStyle.paddingBottom,10)||0;}
return res;}
function computeInnerRect(el,goWithinPadding){if(goWithinPadding===void 0){goWithinPadding=false;}
var outerRect=computeRect(el);var edges=computeEdges(el,goWithinPadding);var res={left:outerRect.left+edges.borderLeft+edges.scrollbarLeft,right:outerRect.right-edges.borderRight-edges.scrollbarRight,top:outerRect.top+edges.borderTop,bottom:outerRect.bottom-edges.borderBottom-edges.scrollbarBottom};if(goWithinPadding){res.left+=edges.paddingLeft;res.right-=edges.paddingRight;res.top+=edges.paddingTop;res.bottom-=edges.paddingBottom;}
return res;}
function computeRect(el){var rect=el.getBoundingClientRect();return{left:rect.left+window.pageXOffset,top:rect.top+window.pageYOffset,right:rect.right+window.pageXOffset,bottom:rect.bottom+window.pageYOffset};}
function computeViewportRect(){return{left:window.pageXOffset,right:window.pageXOffset+document.documentElement.clientWidth,top:window.pageYOffset,bottom:window.pageYOffset+document.documentElement.clientHeight};}
function computeHeightAndMargins(el){return el.getBoundingClientRect().height+computeVMargins(el);}
function computeVMargins(el){var computed=window.getComputedStyle(el);return parseInt(computed.marginTop,10)+
parseInt(computed.marginBottom,10);}
function getClippingParents(el){var parents=[];while(el instanceof HTMLElement){var computedStyle=window.getComputedStyle(el);if(computedStyle.position==='fixed'){break;}
if((/(auto|scroll)/).test(computedStyle.overflow+computedStyle.overflowY+computedStyle.overflowX)){parents.push(el);}
el=el.parentNode;}
return parents;}
function computeClippingRect(el){return getClippingParents(el).map(function(el){return computeInnerRect(el);}).concat(computeViewportRect()).reduce(function(rect0,rect1){return intersectRects(rect0,rect1)||rect1;});}
function preventDefault(ev){ev.preventDefault();}
function listenBySelector(container,eventType,selector,handler){function realHandler(ev){var matchedChild=elementClosest(ev.target,selector);if(matchedChild){handler.call(matchedChild,ev,matchedChild);}}
container.addEventListener(eventType,realHandler);return function(){container.removeEventListener(eventType,realHandler);};}
function listenToHoverBySelector(container,selector,onMouseEnter,onMouseLeave){var currentMatchedChild;return listenBySelector(container,'mouseover',selector,function(ev,matchedChild){if(matchedChild!==currentMatchedChild){currentMatchedChild=matchedChild;onMouseEnter(ev,matchedChild);var realOnMouseLeave_1=function(ev){currentMatchedChild=null;onMouseLeave(ev,matchedChild);matchedChild.removeEventListener('mouseleave',realOnMouseLeave_1);};matchedChild.addEventListener('mouseleave',realOnMouseLeave_1);}});}
var transitionEventNames=['webkitTransitionEnd','otransitionend','oTransitionEnd','msTransitionEnd','transitionend'];function whenTransitionDone(el,callback){var realCallback=function(ev){callback(ev);transitionEventNames.forEach(function(eventName){el.removeEventListener(eventName,realCallback);});};transitionEventNames.forEach(function(eventName){el.addEventListener(eventName,realCallback);});}
var DAY_IDS=['sun','mon','tue','wed','thu','fri','sat'];function addWeeks(m,n){var a=dateToUtcArray(m);a[2]+=n*7;return arrayToUtcDate(a);}
function addDays(m,n){var a=dateToUtcArray(m);a[2]+=n;return arrayToUtcDate(a);}
function addMs(m,n){var a=dateToUtcArray(m);a[6]+=n;return arrayToUtcDate(a);}
function diffWeeks(m0,m1){return diffDays(m0,m1)/7;}
function diffDays(m0,m1){return(m1.valueOf()-m0.valueOf())/(1000*60*60*24);}
function diffHours(m0,m1){return(m1.valueOf()-m0.valueOf())/(1000*60*60);}
function diffMinutes(m0,m1){return(m1.valueOf()-m0.valueOf())/(1000*60);}
function diffSeconds(m0,m1){return(m1.valueOf()-m0.valueOf())/1000;}
function diffDayAndTime(m0,m1){var m0day=startOfDay(m0);var m1day=startOfDay(m1);return{years:0,months:0,days:Math.round(diffDays(m0day,m1day)),milliseconds:(m1.valueOf()-m1day.valueOf())-(m0.valueOf()-m0day.valueOf())};}
function diffWholeWeeks(m0,m1){var d=diffWholeDays(m0,m1);if(d!==null&&d%7===0){return d/7;}
return null;}
function diffWholeDays(m0,m1){if(timeAsMs(m0)===timeAsMs(m1)){return Math.round(diffDays(m0,m1));}
return null;}
function startOfDay(m){return arrayToUtcDate([m.getUTCFullYear(),m.getUTCMonth(),m.getUTCDate()]);}
function startOfHour(m){return arrayToUtcDate([m.getUTCFullYear(),m.getUTCMonth(),m.getUTCDate(),m.getUTCHours()]);}
function startOfMinute(m){return arrayToUtcDate([m.getUTCFullYear(),m.getUTCMonth(),m.getUTCDate(),m.getUTCHours(),m.getUTCMinutes()]);}
function startOfSecond(m){return arrayToUtcDate([m.getUTCFullYear(),m.getUTCMonth(),m.getUTCDate(),m.getUTCHours(),m.getUTCMinutes(),m.getUTCSeconds()]);}
function weekOfYear(marker,dow,doy){var y=marker.getUTCFullYear();var w=weekOfGivenYear(marker,y,dow,doy);if(w<1){return weekOfGivenYear(marker,y-1,dow,doy);}
var nextW=weekOfGivenYear(marker,y+1,dow,doy);if(nextW>=1){return Math.min(w,nextW);}
return w;}
function weekOfGivenYear(marker,year,dow,doy){var firstWeekStart=arrayToUtcDate([year,0,1+firstWeekOffset(year,dow,doy)]);var dayStart=startOfDay(marker);var days=Math.round(diffDays(firstWeekStart,dayStart));return Math.floor(days/7)+1;}
function firstWeekOffset(year,dow,doy){var fwd=7+dow-doy;var fwdlw=(7+arrayToUtcDate([year,0,fwd]).getUTCDay()-dow)%7;return-fwdlw+fwd-1;}
function dateToLocalArray(date){return[date.getFullYear(),date.getMonth(),date.getDate(),date.getHours(),date.getMinutes(),date.getSeconds(),date.getMilliseconds()];}
function arrayToLocalDate(a){return new Date(a[0],a[1]||0,a[2]==null?1:a[2],a[3]||0,a[4]||0,a[5]||0);}
function dateToUtcArray(date){return[date.getUTCFullYear(),date.getUTCMonth(),date.getUTCDate(),date.getUTCHours(),date.getUTCMinutes(),date.getUTCSeconds(),date.getUTCMilliseconds()];}
function arrayToUtcDate(a){if(a.length===1){a=a.concat([0]);}
return new Date(Date.UTC.apply(Date,a));}
function isValidDate(m){return!isNaN(m.valueOf());}
function timeAsMs(m){return m.getUTCHours()*1000*60*60+
m.getUTCMinutes()*1000*60+
m.getUTCSeconds()*1000+
m.getUTCMilliseconds();}
var INTERNAL_UNITS=['years','months','days','milliseconds'];var PARSE_RE=/^(-?)(?:(\d+)\.)?(\d+):(\d\d)(?::(\d\d)(?:\.(\d\d\d))?)?/;function createDuration(input,unit){var _a;if(typeof input==='string'){return parseString(input);}
else if(typeof input==='object'&&input){return normalizeObject(input);}
else if(typeof input==='number'){return normalizeObject((_a={},_a[unit||'milliseconds']=input,_a));}
else{return null;}}
function parseString(s){var m=PARSE_RE.exec(s);if(m){var sign=m[1]?-1:1;return{years:0,months:0,days:sign*(m[2]?parseInt(m[2],10):0),milliseconds:sign*((m[3]?parseInt(m[3],10):0)*60*60*1000+
(m[4]?parseInt(m[4],10):0)*60*1000+
(m[5]?parseInt(m[5],10):0)*1000+
(m[6]?parseInt(m[6],10):0))};}
return null;}
function normalizeObject(obj){return{years:obj.years||obj.year||0,months:obj.months||obj.month||0,days:(obj.days||obj.day||0)+
getWeeksFromInput(obj)*7,milliseconds:(obj.hours||obj.hour||0)*60*60*1000+
(obj.minutes||obj.minute||0)*60*1000+
(obj.seconds||obj.second||0)*1000+
(obj.milliseconds||obj.millisecond||obj.ms||0)};}
function getWeeksFromInput(obj){return obj.weeks||obj.week||0;}
function durationsEqual(d0,d1){return d0.years===d1.years&&d0.months===d1.months&&d0.days===d1.days&&d0.milliseconds===d1.milliseconds;}
function isSingleDay(dur){return dur.years===0&&dur.months===0&&dur.days===1&&dur.milliseconds===0;}
function addDurations(d0,d1){return{years:d0.years+d1.years,months:d0.months+d1.months,days:d0.days+d1.days,milliseconds:d0.milliseconds+d1.milliseconds};}
function subtractDurations(d1,d0){return{years:d1.years-d0.years,months:d1.months-d0.months,days:d1.days-d0.days,milliseconds:d1.milliseconds-d0.milliseconds};}
function multiplyDuration(d,n){return{years:d.years*n,months:d.months*n,days:d.days*n,milliseconds:d.milliseconds*n};}
function asRoughYears(dur){return asRoughDays(dur)/365;}
function asRoughMonths(dur){return asRoughDays(dur)/30;}
function asRoughDays(dur){return asRoughMs(dur)/864e5;}
function asRoughMinutes(dur){return asRoughMs(dur)/(1000*60);}
function asRoughSeconds(dur){return asRoughMs(dur)/1000;}
function asRoughMs(dur){return dur.years*(365*864e5)+
dur.months*(30*864e5)+
dur.days*864e5+
dur.milliseconds;}
function wholeDivideDurations(numerator,denominator){var res=null;for(var i=0;i<INTERNAL_UNITS.length;i++){var unit=INTERNAL_UNITS[i];if(denominator[unit]){var localRes=numerator[unit]/denominator[unit];if(!isInt(localRes)||(res!==null&&res!==localRes)){return null;}
res=localRes;}
else if(numerator[unit]){return null;}}
return res;}
function greatestDurationDenominator(dur,dontReturnWeeks){var ms=dur.milliseconds;if(ms){if(ms%1000!==0){return{unit:'millisecond',value:ms};}
if(ms%(1000*60)!==0){return{unit:'second',value:ms/1000};}
if(ms%(1000*60*60)!==0){return{unit:'minute',value:ms/(1000*60)};}
if(ms){return{unit:'hour',value:ms/(1000*60*60)};}}
if(dur.days){if(!dontReturnWeeks&&dur.days%7===0){return{unit:'week',value:dur.days/7};}
return{unit:'day',value:dur.days};}
if(dur.months){return{unit:'month',value:dur.months};}
if(dur.years){return{unit:'year',value:dur.years};}
return{unit:'millisecond',value:0};}
function compensateScroll(rowEl,scrollbarWidths){if(scrollbarWidths.left){applyStyle(rowEl,{borderLeftWidth:1,marginLeft:scrollbarWidths.left-1});}
if(scrollbarWidths.right){applyStyle(rowEl,{borderRightWidth:1,marginRight:scrollbarWidths.right-1});}}
function uncompensateScroll(rowEl){applyStyle(rowEl,{marginLeft:'',marginRight:'',borderLeftWidth:'',borderRightWidth:''});}
function disableCursor(){document.body.classList.add('fc-not-allowed');}
function enableCursor(){document.body.classList.remove('fc-not-allowed');}
function distributeHeight(els,availableHeight,shouldRedistribute){var minOffset1=Math.floor(availableHeight/els.length);var minOffset2=Math.floor(availableHeight-minOffset1*(els.length-1));var flexEls=[];var flexOffsets=[];var flexHeights=[];var usedHeight=0;undistributeHeight(els);els.forEach(function(el,i){var minOffset=i===els.length-1?minOffset2:minOffset1;var naturalHeight=el.getBoundingClientRect().height;var naturalOffset=naturalHeight+computeVMargins(el);if(naturalOffset<minOffset){flexEls.push(el);flexOffsets.push(naturalOffset);flexHeights.push(naturalHeight);}
else{usedHeight+=naturalOffset;}});if(shouldRedistribute){availableHeight-=usedHeight;minOffset1=Math.floor(availableHeight/flexEls.length);minOffset2=Math.floor(availableHeight-minOffset1*(flexEls.length-1));}
flexEls.forEach(function(el,i){var minOffset=i===flexEls.length-1?minOffset2:minOffset1;var naturalOffset=flexOffsets[i];var naturalHeight=flexHeights[i];var newHeight=minOffset-(naturalOffset-naturalHeight);if(naturalOffset<minOffset){el.style.height=newHeight+'px';}});}
function undistributeHeight(els){els.forEach(function(el){el.style.height='';});}
function matchCellWidths(els){var maxInnerWidth=0;els.forEach(function(el){var innerEl=el.firstChild;if(innerEl instanceof HTMLElement){var innerWidth_1=innerEl.getBoundingClientRect().width;if(innerWidth_1>maxInnerWidth){maxInnerWidth=innerWidth_1;}}});maxInnerWidth++;els.forEach(function(el){el.style.width=maxInnerWidth+'px';});return maxInnerWidth;}
function subtractInnerElHeight(outerEl,innerEl){var reflowStyleProps={position:'relative',left:-1};applyStyle(outerEl,reflowStyleProps);applyStyle(innerEl,reflowStyleProps);var diff=outerEl.getBoundingClientRect().height-
innerEl.getBoundingClientRect().height;var resetStyleProps={position:'',left:''};applyStyle(outerEl,resetStyleProps);applyStyle(innerEl,resetStyleProps);return diff;}
function preventSelection(el){el.classList.add('fc-unselectable');el.addEventListener('selectstart',preventDefault);}
function allowSelection(el){el.classList.remove('fc-unselectable');el.removeEventListener('selectstart',preventDefault);}
function preventContextMenu(el){el.addEventListener('contextmenu',preventDefault);}
function allowContextMenu(el){el.removeEventListener('contextmenu',preventDefault);}
function parseFieldSpecs(input){var specs=[];var tokens=[];var i;var token;if(typeof input==='string'){tokens=input.split(/\s*,\s*/);}
else if(typeof input==='function'){tokens=[input];}
else if(Array.isArray(input)){tokens=input;}
for(i=0;i<tokens.length;i++){token=tokens[i];if(typeof token==='string'){specs.push(token.charAt(0)==='-'?{field:token.substring(1),order:-1}:{field:token,order:1});}
else if(typeof token==='function'){specs.push({func:token});}}
return specs;}
function compareByFieldSpecs(obj0,obj1,fieldSpecs){var i;var cmp;for(i=0;i<fieldSpecs.length;i++){cmp=compareByFieldSpec(obj0,obj1,fieldSpecs[i]);if(cmp){return cmp;}}
return 0;}
function compareByFieldSpec(obj0,obj1,fieldSpec){if(fieldSpec.func){return fieldSpec.func(obj0,obj1);}
return flexibleCompare(obj0[fieldSpec.field],obj1[fieldSpec.field])*(fieldSpec.order||1);}
function flexibleCompare(a,b){if(!a&&!b){return 0;}
if(b==null){return-1;}
if(a==null){return 1;}
if(typeof a==='string'||typeof b==='string'){return String(a).localeCompare(String(b));}
return a-b;}
function capitaliseFirstLetter(str){return str.charAt(0).toUpperCase()+str.slice(1);}
function padStart(val,len){var s=String(val);return'000'.substr(0,len-s.length)+s;}
function compareNumbers(a,b){return a-b;}
function isInt(n){return n%1===0;}
function applyAll(functions,thisObj,args){if(typeof functions==='function'){functions=[functions];}
if(functions){var i=void 0;var ret=void 0;for(i=0;i<functions.length;i++){ret=functions[i].apply(thisObj,args)||ret;}
return ret;}}
function firstDefined(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i];}
for(var i=0;i<args.length;i++){if(args[i]!==undefined){return args[i];}}}
function debounce(func,wait){var timeout;var args;var context;var timestamp;var result;var later=function(){var last=new Date().valueOf()-timestamp;if(last<wait){timeout=setTimeout(later,wait-last);}
else{timeout=null;result=func.apply(context,args);context=args=null;}};return function(){context=this;args=arguments;timestamp=new Date().valueOf();if(!timeout){timeout=setTimeout(later,wait);}
return result;};}
function refineProps(rawProps,processors,defaults,leftoverProps){if(defaults===void 0){defaults={};}
var refined={};for(var key in processors){var processor=processors[key];if(rawProps[key]!==undefined){if(processor===Function){refined[key]=typeof rawProps[key]==='function'?rawProps[key]:null;}
else if(processor){refined[key]=processor(rawProps[key]);}
else{refined[key]=rawProps[key];}}
else if(defaults[key]!==undefined){refined[key]=defaults[key];}
else{if(processor===String){refined[key]='';}
else if(!processor||processor===Number||processor===Boolean||processor===Function){refined[key]=null;}
else{refined[key]=processor(null);}}}
if(leftoverProps){for(var key in rawProps){if(processors[key]===undefined){leftoverProps[key]=rawProps[key];}}}
return refined;}
function computeAlignedDayRange(timedRange){var dayCnt=Math.floor(diffDays(timedRange.start,timedRange.end))||1;var start=startOfDay(timedRange.start);var end=addDays(start,dayCnt);return{start:start,end:end};}
function computeVisibleDayRange(timedRange,nextDayThreshold){if(nextDayThreshold===void 0){nextDayThreshold=createDuration(0);}
var startDay=null;var endDay=null;if(timedRange.end){endDay=startOfDay(timedRange.end);var endTimeMS=timedRange.end.valueOf()-endDay.valueOf();if(endTimeMS&&endTimeMS>=asRoughMs(nextDayThreshold)){endDay=addDays(endDay,1);}}
if(timedRange.start){startDay=startOfDay(timedRange.start);if(endDay&&endDay<=startDay){endDay=addDays(startDay,1);}}
return{start:startDay,end:endDay};}
function isMultiDayRange(range){var visibleRange=computeVisibleDayRange(range);return diffDays(visibleRange.start,visibleRange.end)>1;}
function diffDates(date0,date1,dateEnv,largeUnit){if(largeUnit==='year'){return createDuration(dateEnv.diffWholeYears(date0,date1),'year');}
else if(largeUnit==='month'){return createDuration(dateEnv.diffWholeMonths(date0,date1),'month');}
else{return diffDayAndTime(date0,date1);}}
var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b;})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];};return extendStatics(d,b);};function __extends(d,b){extendStatics(d,b);function __(){this.constructor=d;}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __());}
var __assign=function(){__assign=Object.assign||function __assign(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p))t[p]=s[p];}
return t;};return __assign.apply(this,arguments);};function parseRecurring(eventInput,allDayDefault,dateEnv,recurringTypes,leftovers){for(var i=0;i<recurringTypes.length;i++){var localLeftovers={};var parsed=recurringTypes[i].parse(eventInput,localLeftovers,dateEnv);if(parsed){var allDay=localLeftovers.allDay;delete localLeftovers.allDay;if(allDay==null){allDay=allDayDefault;if(allDay==null){allDay=parsed.allDayGuess;if(allDay==null){allDay=false;}}}
__assign(leftovers,localLeftovers);return{allDay:allDay,duration:parsed.duration,typeData:parsed.typeData,typeId:i};}}
return null;}
function expandRecurringRanges(eventDef,duration,framingRange,dateEnv,recurringTypes){var typeDef=recurringTypes[eventDef.recurringDef.typeId];var markers=typeDef.expand(eventDef.recurringDef.typeData,{start:dateEnv.subtract(framingRange.start,duration),end:framingRange.end},dateEnv);if(eventDef.allDay){markers=markers.map(startOfDay);}
return markers;}
var hasOwnProperty=Object.prototype.hasOwnProperty;function mergeProps(propObjs,complexProps){var dest={};var i;var name;var complexObjs;var j;var val;var props;if(complexProps){for(i=0;i<complexProps.length;i++){name=complexProps[i];complexObjs=[];for(j=propObjs.length-1;j>=0;j--){val=propObjs[j][name];if(typeof val==='object'&&val){complexObjs.unshift(val);}
else if(val!==undefined){dest[name]=val;break;}}
if(complexObjs.length){dest[name]=mergeProps(complexObjs);}}}
for(i=propObjs.length-1;i>=0;i--){props=propObjs[i];for(name in props){if(!(name in dest)){dest[name]=props[name];}}}
return dest;}
function filterHash(hash,func){var filtered={};for(var key in hash){if(func(hash[key],key)){filtered[key]=hash[key];}}
return filtered;}
function mapHash(hash,func){var newHash={};for(var key in hash){newHash[key]=func(hash[key],key);}
return newHash;}
function arrayToHash(a){var hash={};for(var _i=0,a_1=a;_i<a_1.length;_i++){var item=a_1[_i];hash[item]=true;}
return hash;}
function hashValuesToArray(obj){var a=[];for(var key in obj){a.push(obj[key]);}
return a;}
function isPropsEqual(obj0,obj1){for(var key in obj0){if(hasOwnProperty.call(obj0,key)){if(!(key in obj1)){return false;}}}
for(var key in obj1){if(hasOwnProperty.call(obj1,key)){if(obj0[key]!==obj1[key]){return false;}}}
return true;}
function parseEvents(rawEvents,sourceId,calendar,allowOpenRange){var eventStore=createEmptyEventStore();for(var _i=0,rawEvents_1=rawEvents;_i<rawEvents_1.length;_i++){var rawEvent=rawEvents_1[_i];var tuple=parseEvent(rawEvent,sourceId,calendar,allowOpenRange);if(tuple){eventTupleToStore(tuple,eventStore);}}
return eventStore;}
function eventTupleToStore(tuple,eventStore){if(eventStore===void 0){eventStore=createEmptyEventStore();}
eventStore.defs[tuple.def.defId]=tuple.def;if(tuple.instance){eventStore.instances[tuple.instance.instanceId]=tuple.instance;}
return eventStore;}
function expandRecurring(eventStore,framingRange,calendar){var dateEnv=calendar.dateEnv;var defs=eventStore.defs,instances=eventStore.instances;instances=filterHash(instances,function(instance){return!defs[instance.defId].recurringDef;});for(var defId in defs){var def=defs[defId];if(def.recurringDef){var duration=def.recurringDef.duration;if(!duration){duration=def.allDay?calendar.defaultAllDayEventDuration:calendar.defaultTimedEventDuration;}
var starts=expandRecurringRanges(def,duration,framingRange,calendar.dateEnv,calendar.pluginSystem.hooks.recurringTypes);for(var _i=0,starts_1=starts;_i<starts_1.length;_i++){var start=starts_1[_i];var instance=createEventInstance(defId,{start:start,end:dateEnv.add(start,duration)});instances[instance.instanceId]=instance;}}}
return{defs:defs,instances:instances};}
function getRelevantEvents(eventStore,instanceId){var instance=eventStore.instances[instanceId];if(instance){var def_1=eventStore.defs[instance.defId];var newStore=filterEventStoreDefs(eventStore,function(lookDef){return isEventDefsGrouped(def_1,lookDef);});newStore.defs[def_1.defId]=def_1;newStore.instances[instance.instanceId]=instance;return newStore;}
return createEmptyEventStore();}
function isEventDefsGrouped(def0,def1){return Boolean(def0.groupId&&def0.groupId===def1.groupId);}
function transformRawEvents(rawEvents,eventSource,calendar){var calEachTransform=calendar.opt('eventDataTransform');var sourceEachTransform=eventSource?eventSource.eventDataTransform:null;if(sourceEachTransform){rawEvents=transformEachRawEvent(rawEvents,sourceEachTransform);}
if(calEachTransform){rawEvents=transformEachRawEvent(rawEvents,calEachTransform);}
return rawEvents;}
function transformEachRawEvent(rawEvents,func){var refinedEvents;if(!func){refinedEvents=rawEvents;}
else{refinedEvents=[];for(var _i=0,rawEvents_2=rawEvents;_i<rawEvents_2.length;_i++){var rawEvent=rawEvents_2[_i];var refinedEvent=func(rawEvent);if(refinedEvent){refinedEvents.push(refinedEvent);}
else if(refinedEvent==null){refinedEvents.push(rawEvent);}}}
return refinedEvents;}
function createEmptyEventStore(){return{defs:{},instances:{}};}
function mergeEventStores(store0,store1){return{defs:__assign({},store0.defs,store1.defs),instances:__assign({},store0.instances,store1.instances)};}
function filterEventStoreDefs(eventStore,filterFunc){var defs=filterHash(eventStore.defs,filterFunc);var instances=filterHash(eventStore.instances,function(instance){return defs[instance.defId];});return{defs:defs,instances:instances};}
function parseRange(input,dateEnv){var start=null;var end=null;if(input.start){start=dateEnv.createMarker(input.start);}
if(input.end){end=dateEnv.createMarker(input.end);}
if(!start&&!end){return null;}
if(start&&end&&end<start){return null;}
return{start:start,end:end};}
function invertRanges(ranges,constraintRange){var invertedRanges=[];var start=constraintRange.start;var i;var dateRange;ranges.sort(compareRanges);for(i=0;i<ranges.length;i++){dateRange=ranges[i];if(dateRange.start>start){invertedRanges.push({start:start,end:dateRange.start});}
if(dateRange.end>start){start=dateRange.end;}}
if(start<constraintRange.end){invertedRanges.push({start:start,end:constraintRange.end});}
return invertedRanges;}
function compareRanges(range0,range1){return range0.start.valueOf()-range1.start.valueOf();}
function intersectRanges(range0,range1){var start=range0.start;var end=range0.end;var newRange=null;if(range1.start!==null){if(start===null){start=range1.start;}
else{start=new Date(Math.max(start.valueOf(),range1.start.valueOf()));}}
if(range1.end!=null){if(end===null){end=range1.end;}
else{end=new Date(Math.min(end.valueOf(),range1.end.valueOf()));}}
if(start===null||end===null||start<end){newRange={start:start,end:end};}
return newRange;}
function rangesEqual(range0,range1){return(range0.start===null?null:range0.start.valueOf())===(range1.start===null?null:range1.start.valueOf())&&(range0.end===null?null:range0.end.valueOf())===(range1.end===null?null:range1.end.valueOf());}
function rangesIntersect(range0,range1){return(range0.end===null||range1.start===null||range0.end>range1.start)&&(range0.start===null||range1.end===null||range0.start<range1.end);}
function rangeContainsRange(outerRange,innerRange){return(outerRange.start===null||(innerRange.start!==null&&innerRange.start>=outerRange.start))&&(outerRange.end===null||(innerRange.end!==null&&innerRange.end<=outerRange.end));}
function rangeContainsMarker(range,date){return(range.start===null||date>=range.start)&&(range.end===null||date<range.end);}
function constrainMarkerToRange(date,range){if(range.start!=null&&date<range.start){return range.start;}
if(range.end!=null&&date>=range.end){return new Date(range.end.valueOf()-1);}
return date;}
function removeExact(array,exactVal){var removeCnt=0;var i=0;while(i<array.length){if(array[i]===exactVal){array.splice(i,1);removeCnt++;}
else{i++;}}
return removeCnt;}
function isArraysEqual(a0,a1){var len=a0.length;var i;if(len!==a1.length){return false;}
for(i=0;i<len;i++){if(a0[i]!==a1[i]){return false;}}
return true;}
function memoize(workerFunc){var args;var res;return function(){if(!args||!isArraysEqual(args,arguments)){args=arguments;res=workerFunc.apply(this,arguments);}
return res;};}
function memoizeOutput(workerFunc,equalityFunc){var cachedRes=null;return function(){var newRes=workerFunc.apply(this,arguments);if(cachedRes===null||!(cachedRes===newRes||equalityFunc(cachedRes,newRes))){cachedRes=newRes;}
return cachedRes;};}
var EXTENDED_SETTINGS_AND_SEVERITIES={week:3,separator:0,omitZeroMinute:0,meridiem:0,omitCommas:0};var STANDARD_DATE_PROP_SEVERITIES={timeZoneName:7,era:6,year:5,month:4,day:2,weekday:2,hour:1,minute:1,second:1};var MERIDIEM_RE=/\s*([ap])\.?m\.?/i;var COMMA_RE=/,/g;var MULTI_SPACE_RE=/\s+/g;var LTR_RE=/\u200e/g;var UTC_RE=/UTC|GMT/;var NativeFormatter=(function(){function NativeFormatter(formatSettings){var standardDateProps={};var extendedSettings={};var severity=0;for(var name_1 in formatSettings){if(name_1 in EXTENDED_SETTINGS_AND_SEVERITIES){extendedSettings[name_1]=formatSettings[name_1];severity=Math.max(EXTENDED_SETTINGS_AND_SEVERITIES[name_1],severity);}
else{standardDateProps[name_1]=formatSettings[name_1];if(name_1 in STANDARD_DATE_PROP_SEVERITIES){severity=Math.max(STANDARD_DATE_PROP_SEVERITIES[name_1],severity);}}}
this.standardDateProps=standardDateProps;this.extendedSettings=extendedSettings;this.severity=severity;this.buildFormattingFunc=memoize(buildFormattingFunc);}
NativeFormatter.prototype.format=function(date,context){return this.buildFormattingFunc(this.standardDateProps,this.extendedSettings,context)(date);};NativeFormatter.prototype.formatRange=function(start,end,context){var _a=this,standardDateProps=_a.standardDateProps,extendedSettings=_a.extendedSettings;var diffSeverity=computeMarkerDiffSeverity(start.marker,end.marker,context.calendarSystem);if(!diffSeverity){return this.format(start,context);}
var biggestUnitForPartial=diffSeverity;if(biggestUnitForPartial>1&&(standardDateProps.year==='numeric'||standardDateProps.year==='2-digit')&&(standardDateProps.month==='numeric'||standardDateProps.month==='2-digit')&&(standardDateProps.day==='numeric'||standardDateProps.day==='2-digit')){biggestUnitForPartial=1;}
var full0=this.format(start,context);var full1=this.format(end,context);if(full0===full1){return full0;}
var partialDateProps=computePartialFormattingOptions(standardDateProps,biggestUnitForPartial);var partialFormattingFunc=buildFormattingFunc(partialDateProps,extendedSettings,context);var partial0=partialFormattingFunc(start);var partial1=partialFormattingFunc(end);var insertion=findCommonInsertion(full0,partial0,full1,partial1);var separator=extendedSettings.separator||'';if(insertion){return insertion.before+partial0+separator+partial1+insertion.after;}
return full0+separator+full1;};NativeFormatter.prototype.getLargestUnit=function(){switch(this.severity){case 7:case 6:case 5:return'year';case 4:return'month';case 3:return'week';default:return'day';}};return NativeFormatter;}());function buildFormattingFunc(standardDateProps,extendedSettings,context){var standardDatePropCnt=Object.keys(standardDateProps).length;if(standardDatePropCnt===1&&standardDateProps.timeZoneName==='short'){return function(date){return formatTimeZoneOffset(date.timeZoneOffset);};}
if(standardDatePropCnt===0&&extendedSettings.week){return function(date){return formatWeekNumber(context.computeWeekNumber(date.marker),context.weekLabel,context.locale,extendedSettings.week);};}
return buildNativeFormattingFunc(standardDateProps,extendedSettings,context);}
function buildNativeFormattingFunc(standardDateProps,extendedSettings,context){standardDateProps=__assign({},standardDateProps);extendedSettings=__assign({},extendedSettings);sanitizeSettings(standardDateProps,extendedSettings);standardDateProps.timeZone='UTC';var normalFormat=new Intl.DateTimeFormat(context.locale.codes,standardDateProps);var zeroFormat;if(extendedSettings.omitZeroMinute){var zeroProps=__assign({},standardDateProps);delete zeroProps.minute;zeroFormat=new Intl.DateTimeFormat(context.locale.codes,zeroProps);}
return function(date){var marker=date.marker;var format;if(zeroFormat&&!marker.getUTCMinutes()){format=zeroFormat;}
else{format=normalFormat;}
var s=format.format(marker);return postProcess(s,date,standardDateProps,extendedSettings,context);};}
function sanitizeSettings(standardDateProps,extendedSettings){if(standardDateProps.timeZoneName){if(!standardDateProps.hour){standardDateProps.hour='2-digit';}
if(!standardDateProps.minute){standardDateProps.minute='2-digit';}}
if(standardDateProps.timeZoneName==='long'){standardDateProps.timeZoneName='short';}
if(extendedSettings.omitZeroMinute&&(standardDateProps.second||standardDateProps.millisecond)){delete extendedSettings.omitZeroMinute;}}
function postProcess(s,date,standardDateProps,extendedSettings,context){s=s.replace(LTR_RE,'');if(standardDateProps.timeZoneName==='short'){s=injectTzoStr(s,(context.timeZone==='UTC'||date.timeZoneOffset==null)?'UTC':formatTimeZoneOffset(date.timeZoneOffset));}
if(extendedSettings.omitCommas){s=s.replace(COMMA_RE,'').trim();}
if(extendedSettings.omitZeroMinute){s=s.replace(':00','');}
if(extendedSettings.meridiem===false){s=s.replace(MERIDIEM_RE,'').trim();}
else if(extendedSettings.meridiem==='narrow'){s=s.replace(MERIDIEM_RE,function(m0,m1){return m1.toLocaleLowerCase();});}
else if(extendedSettings.meridiem==='short'){s=s.replace(MERIDIEM_RE,function(m0,m1){return m1.toLocaleLowerCase()+'m';});}
else if(extendedSettings.meridiem==='lowercase'){s=s.replace(MERIDIEM_RE,function(m0){return m0.toLocaleLowerCase();});}
s=s.replace(MULTI_SPACE_RE,' ');s=s.trim();return s;}
function injectTzoStr(s,tzoStr){var replaced=false;s=s.replace(UTC_RE,function(){replaced=true;return tzoStr;});if(!replaced){s+=' '+tzoStr;}
return s;}
function formatWeekNumber(num,weekLabel,locale,display){var parts=[];if(display==='narrow'){parts.push(weekLabel);}
else if(display==='short'){parts.push(weekLabel,' ');}
parts.push(locale.simpleNumberFormat.format(num));if(locale.options.isRtl){parts.reverse();}
return parts.join('');}
function computeMarkerDiffSeverity(d0,d1,ca){if(ca.getMarkerYear(d0)!==ca.getMarkerYear(d1)){return 5;}
if(ca.getMarkerMonth(d0)!==ca.getMarkerMonth(d1)){return 4;}
if(ca.getMarkerDay(d0)!==ca.getMarkerDay(d1)){return 2;}
if(timeAsMs(d0)!==timeAsMs(d1)){return 1;}
return 0;}
function computePartialFormattingOptions(options,biggestUnit){var partialOptions={};for(var name_2 in options){if(!(name_2 in STANDARD_DATE_PROP_SEVERITIES)||STANDARD_DATE_PROP_SEVERITIES[name_2]<=biggestUnit){partialOptions[name_2]=options[name_2];}}
return partialOptions;}
function findCommonInsertion(full0,partial0,full1,partial1){var i0=0;while(i0<full0.length){var found0=full0.indexOf(partial0,i0);if(found0===-1){break;}
var before0=full0.substr(0,found0);i0=found0+partial0.length;var after0=full0.substr(i0);var i1=0;while(i1<full1.length){var found1=full1.indexOf(partial1,i1);if(found1===-1){break;}
var before1=full1.substr(0,found1);i1=found1+partial1.length;var after1=full1.substr(i1);if(before0===before1&&after0===after1){return{before:before0,after:after0};}}}
return null;}
var CmdFormatter=(function(){function CmdFormatter(cmdStr,separator){this.cmdStr=cmdStr;this.separator=separator;}
CmdFormatter.prototype.format=function(date,context){return context.cmdFormatter(this.cmdStr,createVerboseFormattingArg(date,null,context,this.separator));};CmdFormatter.prototype.formatRange=function(start,end,context){return context.cmdFormatter(this.cmdStr,createVerboseFormattingArg(start,end,context,this.separator));};return CmdFormatter;}());var FuncFormatter=(function(){function FuncFormatter(func){this.func=func;}
FuncFormatter.prototype.format=function(date,context){return this.func(createVerboseFormattingArg(date,null,context));};FuncFormatter.prototype.formatRange=function(start,end,context){return this.func(createVerboseFormattingArg(start,end,context));};return FuncFormatter;}());function createFormatter(input,defaultSeparator){if(typeof input==='object'&&input){if(typeof defaultSeparator==='string'){input=__assign({separator:defaultSeparator},input);}
return new NativeFormatter(input);}
else if(typeof input==='string'){return new CmdFormatter(input,defaultSeparator);}
else if(typeof input==='function'){return new FuncFormatter(input);}}
function buildIsoString(marker,timeZoneOffset,stripZeroTime){if(stripZeroTime===void 0){stripZeroTime=false;}
var s=marker.toISOString();s=s.replace('.000','');if(stripZeroTime){s=s.replace('T00:00:00Z','');}
if(s.length>10){if(timeZoneOffset==null){s=s.replace('Z','');}
else if(timeZoneOffset!==0){s=s.replace('Z',formatTimeZoneOffset(timeZoneOffset,true));}}
return s;}
function formatIsoTimeString(marker){return padStart(marker.getUTCHours(),2)+':'+
padStart(marker.getUTCMinutes(),2)+':'+
padStart(marker.getUTCSeconds(),2);}
function formatTimeZoneOffset(minutes,doIso){if(doIso===void 0){doIso=false;}
var sign=minutes<0?'-':'+';var abs=Math.abs(minutes);var hours=Math.floor(abs/60);var mins=Math.round(abs%60);if(doIso){return sign+padStart(hours,2)+':'+padStart(mins,2);}
else{return'GMT'+sign+hours+(mins?':'+padStart(mins,2):'');}}
function createVerboseFormattingArg(start,end,context,separator){var startInfo=expandZonedMarker(start,context.calendarSystem);var endInfo=end?expandZonedMarker(end,context.calendarSystem):null;return{date:startInfo,start:startInfo,end:endInfo,timeZone:context.timeZone,localeCodes:context.locale.codes,separator:separator};}
function expandZonedMarker(dateInfo,calendarSystem){var a=calendarSystem.markerToArray(dateInfo.marker);return{marker:dateInfo.marker,timeZoneOffset:dateInfo.timeZoneOffset,array:a,year:a[0],month:a[1],day:a[2],hour:a[3],minute:a[4],second:a[5],millisecond:a[6]};}
var EventSourceApi=(function(){function EventSourceApi(calendar,internalEventSource){this.calendar=calendar;this.internalEventSource=internalEventSource;}
EventSourceApi.prototype.remove=function(){this.calendar.dispatch({type:'REMOVE_EVENT_SOURCE',sourceId:this.internalEventSource.sourceId});};EventSourceApi.prototype.refetch=function(){this.calendar.dispatch({type:'FETCH_EVENT_SOURCES',sourceIds:[this.internalEventSource.sourceId]});};Object.defineProperty(EventSourceApi.prototype,"id",{get:function(){return this.internalEventSource.publicId;},enumerable:true,configurable:true});Object.defineProperty(EventSourceApi.prototype,"url",{get:function(){return this.internalEventSource.meta.url;},enumerable:true,configurable:true});return EventSourceApi;}());var EventApi=(function(){function EventApi(calendar,def,instance){this._calendar=calendar;this._def=def;this._instance=instance||null;}
EventApi.prototype.setProp=function(name,val){var _a,_b;if(name in DATE_PROPS);else if(name in NON_DATE_PROPS){if(typeof NON_DATE_PROPS[name]==='function'){val=NON_DATE_PROPS[name](val);}
this.mutate({standardProps:(_a={},_a[name]=val,_a)});}
else if(name in UNSCOPED_EVENT_UI_PROPS){var ui=void 0;if(typeof UNSCOPED_EVENT_UI_PROPS[name]==='function'){val=UNSCOPED_EVENT_UI_PROPS[name](val);}
if(name==='color'){ui={backgroundColor:val,borderColor:val};}
else if(name==='editable'){ui={startEditable:val,durationEditable:val};}
else{ui=(_b={},_b[name]=val,_b);}
this.mutate({standardProps:{ui:ui}});}};EventApi.prototype.setExtendedProp=function(name,val){var _a;this.mutate({extendedProps:(_a={},_a[name]=val,_a)});};EventApi.prototype.setStart=function(startInput,options){if(options===void 0){options={};}
var dateEnv=this._calendar.dateEnv;var start=dateEnv.createMarker(startInput);if(start&&this._instance){var instanceRange=this._instance.range;var startDelta=diffDates(instanceRange.start,start,dateEnv,options.granularity);if(options.maintainDuration){this.mutate({datesDelta:startDelta});}
else{this.mutate({startDelta:startDelta});}}};EventApi.prototype.setEnd=function(endInput,options){if(options===void 0){options={};}
var dateEnv=this._calendar.dateEnv;var end;if(endInput!=null){end=dateEnv.createMarker(endInput);if(!end){return;}}
if(this._instance){if(end){var endDelta=diffDates(this._instance.range.end,end,dateEnv,options.granularity);this.mutate({endDelta:endDelta});}
else{this.mutate({standardProps:{hasEnd:false}});}}};EventApi.prototype.setDates=function(startInput,endInput,options){if(options===void 0){options={};}
var dateEnv=this._calendar.dateEnv;var standardProps={allDay:options.allDay};var start=dateEnv.createMarker(startInput);var end;if(!start){return;}
if(endInput!=null){end=dateEnv.createMarker(endInput);if(!end){return;}}
if(this._instance){var instanceRange=this._instance.range;if(options.allDay===true){instanceRange=computeAlignedDayRange(instanceRange);}
var startDelta=diffDates(instanceRange.start,start,dateEnv,options.granularity);if(end){var endDelta=diffDates(instanceRange.end,end,dateEnv,options.granularity);if(durationsEqual(startDelta,endDelta)){this.mutate({datesDelta:startDelta,standardProps:standardProps});}
else{this.mutate({startDelta:startDelta,endDelta:endDelta,standardProps:standardProps});}}
else{standardProps.hasEnd=false;this.mutate({datesDelta:startDelta,standardProps:standardProps});}}};EventApi.prototype.moveStart=function(deltaInput){var delta=createDuration(deltaInput);if(delta){this.mutate({startDelta:delta});}};EventApi.prototype.moveEnd=function(deltaInput){var delta=createDuration(deltaInput);if(delta){this.mutate({endDelta:delta});}};EventApi.prototype.moveDates=function(deltaInput){var delta=createDuration(deltaInput);if(delta){this.mutate({datesDelta:delta});}};EventApi.prototype.setAllDay=function(allDay,options){if(options===void 0){options={};}
var standardProps={allDay:allDay};var maintainDuration=options.maintainDuration;if(maintainDuration==null){maintainDuration=this._calendar.opt('allDayMaintainDuration');}
if(this._def.allDay!==allDay){standardProps.hasEnd=maintainDuration;}
this.mutate({standardProps:standardProps});};EventApi.prototype.formatRange=function(formatInput){var dateEnv=this._calendar.dateEnv;var instance=this._instance;var formatter=createFormatter(formatInput,this._calendar.opt('defaultRangeSeparator'));if(this._def.hasEnd){return dateEnv.formatRange(instance.range.start,instance.range.end,formatter,{forcedStartTzo:instance.forcedStartTzo,forcedEndTzo:instance.forcedEndTzo});}
else{return dateEnv.format(instance.range.start,formatter,{forcedTzo:instance.forcedStartTzo});}};EventApi.prototype.mutate=function(mutation){var def=this._def;var instance=this._instance;if(instance){this._calendar.dispatch({type:'MUTATE_EVENTS',instanceId:instance.instanceId,mutation:mutation,fromApi:true});var eventStore=this._calendar.state.eventStore;this._def=eventStore.defs[def.defId];this._instance=eventStore.instances[instance.instanceId];}};EventApi.prototype.remove=function(){this._calendar.dispatch({type:'REMOVE_EVENT_DEF',defId:this._def.defId});};Object.defineProperty(EventApi.prototype,"source",{get:function(){var sourceId=this._def.sourceId;if(sourceId){return new EventSourceApi(this._calendar,this._calendar.state.eventSources[sourceId]);}
return null;},enumerable:true,configurable:true});Object.defineProperty(EventApi.prototype,"start",{get:function(){return this._instance?this._calendar.dateEnv.toDate(this._instance.range.start):null;},enumerable:true,configurable:true});Object.defineProperty(EventApi.prototype,"end",{get:function(){return(this._instance&&this._def.hasEnd)?this._calendar.dateEnv.toDate(this._instance.range.end):null;},enumerable:true,configurable:true});Object.defineProperty(EventApi.prototype,"id",{get:function(){return this._def.publicId;},enumerable:true,configurable:true});Object.defineProperty(EventApi.prototype,"groupId",{get:function(){return this._def.groupId;},enumerable:true,configurable:true});Object.defineProperty(EventApi.prototype,"allDay",{get:function(){return this._def.allDay;},enumerable:true,configurable:true});Object.defineProperty(EventApi.prototype,"title",{get:function(){return this._def.title;},enumerable:true,configurable:true});Object.defineProperty(EventApi.prototype,"url",{get:function(){return this._def.url;},enumerable:true,configurable:true});Object.defineProperty(EventApi.prototype,"rendering",{get:function(){return this._def.rendering;},enumerable:true,configurable:true});Object.defineProperty(EventApi.prototype,"startEditable",{get:function(){return this._def.ui.startEditable;},enumerable:true,configurable:true});Object.defineProperty(EventApi.prototype,"durationEditable",{get:function(){return this._def.ui.durationEditable;},enumerable:true,configurable:true});Object.defineProperty(EventApi.prototype,"constraint",{get:function(){return this._def.ui.constraints[0]||null;},enumerable:true,configurable:true});Object.defineProperty(EventApi.prototype,"overlap",{get:function(){return this._def.ui.overlap;},enumerable:true,configurable:true});Object.defineProperty(EventApi.prototype,"allow",{get:function(){return this._def.ui.allows[0]||null;},enumerable:true,configurable:true});Object.defineProperty(EventApi.prototype,"backgroundColor",{get:function(){return this._def.ui.backgroundColor;},enumerable:true,configurable:true});Object.defineProperty(EventApi.prototype,"borderColor",{get:function(){return this._def.ui.borderColor;},enumerable:true,configurable:true});Object.defineProperty(EventApi.prototype,"textColor",{get:function(){return this._def.ui.textColor;},enumerable:true,configurable:true});Object.defineProperty(EventApi.prototype,"classNames",{get:function(){return this._def.ui.classNames;},enumerable:true,configurable:true});Object.defineProperty(EventApi.prototype,"extendedProps",{get:function(){return this._def.extendedProps;},enumerable:true,configurable:true});return EventApi;}());function sliceEventStore(eventStore,eventUiBases,framingRange,nextDayThreshold){var inverseBgByGroupId={};var inverseBgByDefId={};var defByGroupId={};var bgRanges=[];var fgRanges=[];var eventUis=compileEventUis(eventStore.defs,eventUiBases);for(var defId in eventStore.defs){var def=eventStore.defs[defId];if(def.rendering==='inverse-background'){if(def.groupId){inverseBgByGroupId[def.groupId]=[];if(!defByGroupId[def.groupId]){defByGroupId[def.groupId]=def;}}
else{inverseBgByDefId[defId]=[];}}}
for(var instanceId in eventStore.instances){var instance=eventStore.instances[instanceId];var def=eventStore.defs[instance.defId];var ui=eventUis[def.defId];var origRange=instance.range;var normalRange=(!def.allDay&&nextDayThreshold)?computeVisibleDayRange(origRange,nextDayThreshold):origRange;var slicedRange=intersectRanges(normalRange,framingRange);if(slicedRange){if(def.rendering==='inverse-background'){if(def.groupId){inverseBgByGroupId[def.groupId].push(slicedRange);}
else{inverseBgByDefId[instance.defId].push(slicedRange);}}
else{(def.rendering==='background'?bgRanges:fgRanges).push({def:def,ui:ui,instance:instance,range:slicedRange,isStart:normalRange.start&&normalRange.start.valueOf()===slicedRange.start.valueOf(),isEnd:normalRange.end&&normalRange.end.valueOf()===slicedRange.end.valueOf()});}}}
for(var groupId in inverseBgByGroupId){var ranges=inverseBgByGroupId[groupId];var invertedRanges=invertRanges(ranges,framingRange);for(var _i=0,invertedRanges_1=invertedRanges;_i<invertedRanges_1.length;_i++){var invertedRange=invertedRanges_1[_i];var def=defByGroupId[groupId];var ui=eventUis[def.defId];bgRanges.push({def:def,ui:ui,instance:null,range:invertedRange,isStart:false,isEnd:false});}}
for(var defId in inverseBgByDefId){var ranges=inverseBgByDefId[defId];var invertedRanges=invertRanges(ranges,framingRange);for(var _a=0,invertedRanges_2=invertedRanges;_a<invertedRanges_2.length;_a++){var invertedRange=invertedRanges_2[_a];bgRanges.push({def:eventStore.defs[defId],ui:eventUis[defId],instance:null,range:invertedRange,isStart:false,isEnd:false});}}
return{bg:bgRanges,fg:fgRanges};}
function hasBgRendering(def){return def.rendering==='background'||def.rendering==='inverse-background';}
function filterSegsViaEls(context,segs,isMirror){var calendar=context.calendar,view=context.view;if(calendar.hasPublicHandlers('eventRender')){segs=segs.filter(function(seg){var custom=calendar.publiclyTrigger('eventRender',[{event:new EventApi(calendar,seg.eventRange.def,seg.eventRange.instance),isMirror:isMirror,isStart:seg.isStart,isEnd:seg.isEnd,el:seg.el,view:view}]);if(custom===false){return false;}
else if(custom&&custom!==true){seg.el=custom;}
return true;});}
for(var _i=0,segs_1=segs;_i<segs_1.length;_i++){var seg=segs_1[_i];setElSeg(seg.el,seg);}
return segs;}
function setElSeg(el,seg){el.fcSeg=seg;}
function getElSeg(el){return el.fcSeg||null;}
function compileEventUis(eventDefs,eventUiBases){return mapHash(eventDefs,function(eventDef){return compileEventUi(eventDef,eventUiBases);});}
function compileEventUi(eventDef,eventUiBases){var uis=[];if(eventUiBases['']){uis.push(eventUiBases['']);}
if(eventUiBases[eventDef.defId]){uis.push(eventUiBases[eventDef.defId]);}
uis.push(eventDef.ui);return combineEventUis(uis);}
function triggerRenderedSegs(context,segs,isMirrors){var calendar=context.calendar,view=context.view;if(calendar.hasPublicHandlers('eventPositioned')){for(var _i=0,segs_2=segs;_i<segs_2.length;_i++){var seg=segs_2[_i];calendar.publiclyTriggerAfterSizing('eventPositioned',[{event:new EventApi(calendar,seg.eventRange.def,seg.eventRange.instance),isMirror:isMirrors,isStart:seg.isStart,isEnd:seg.isEnd,el:seg.el,view:view}]);}}
if(!calendar.state.loadingLevel){calendar.afterSizingTriggers._eventsPositioned=[null];}}
function triggerWillRemoveSegs(context,segs,isMirrors){var calendar=context.calendar,view=context.view;for(var _i=0,segs_3=segs;_i<segs_3.length;_i++){var seg=segs_3[_i];calendar.trigger('eventElRemove',seg.el);}
if(calendar.hasPublicHandlers('eventDestroy')){for(var _a=0,segs_4=segs;_a<segs_4.length;_a++){var seg=segs_4[_a];calendar.publiclyTrigger('eventDestroy',[{event:new EventApi(calendar,seg.eventRange.def,seg.eventRange.instance),isMirror:isMirrors,el:seg.el,view:view}]);}}}
function computeEventDraggable(context,eventDef,eventUi){var calendar=context.calendar,view=context.view;var transformers=calendar.pluginSystem.hooks.isDraggableTransformers;var val=eventUi.startEditable;for(var _i=0,transformers_1=transformers;_i<transformers_1.length;_i++){var transformer=transformers_1[_i];val=transformer(val,eventDef,eventUi,view);}
return val;}
function computeEventStartResizable(context,eventDef,eventUi){return eventUi.durationEditable&&context.options.eventResizableFromStart;}
function computeEventEndResizable(context,eventDef,eventUi){return eventUi.durationEditable;}
function applyMutationToEventStore(eventStore,eventConfigBase,mutation,calendar){var eventConfigs=compileEventUis(eventStore.defs,eventConfigBase);var dest=createEmptyEventStore();for(var defId in eventStore.defs){var def=eventStore.defs[defId];dest.defs[defId]=applyMutationToEventDef(def,eventConfigs[defId],mutation,calendar.pluginSystem.hooks.eventDefMutationAppliers,calendar);}
for(var instanceId in eventStore.instances){var instance=eventStore.instances[instanceId];var def=dest.defs[instance.defId];dest.instances[instanceId]=applyMutationToEventInstance(instance,def,eventConfigs[instance.defId],mutation,calendar);}
return dest;}
function applyMutationToEventDef(eventDef,eventConfig,mutation,appliers,calendar){var standardProps=mutation.standardProps||{};if(standardProps.hasEnd==null&&eventConfig.durationEditable&&(mutation.startDelta||mutation.endDelta)){standardProps.hasEnd=true;}
var copy=__assign({},eventDef,standardProps,{ui:__assign({},eventDef.ui,standardProps.ui)});if(mutation.extendedProps){copy.extendedProps=__assign({},copy.extendedProps,mutation.extendedProps);}
for(var _i=0,appliers_1=appliers;_i<appliers_1.length;_i++){var applier=appliers_1[_i];applier(copy,mutation,calendar);}
if(!copy.hasEnd&&calendar.opt('forceEventDuration')){copy.hasEnd=true;}
return copy;}
function applyMutationToEventInstance(eventInstance,eventDef,eventConfig,mutation,calendar){var dateEnv=calendar.dateEnv;var forceAllDay=mutation.standardProps&&mutation.standardProps.allDay===true;var clearEnd=mutation.standardProps&&mutation.standardProps.hasEnd===false;var copy=__assign({},eventInstance);if(forceAllDay){copy.range=computeAlignedDayRange(copy.range);}
if(mutation.datesDelta&&eventConfig.startEditable){copy.range={start:dateEnv.add(copy.range.start,mutation.datesDelta),end:dateEnv.add(copy.range.end,mutation.datesDelta)};}
if(mutation.startDelta&&eventConfig.durationEditable){copy.range={start:dateEnv.add(copy.range.start,mutation.startDelta),end:copy.range.end};}
if(mutation.endDelta&&eventConfig.durationEditable){copy.range={start:copy.range.start,end:dateEnv.add(copy.range.end,mutation.endDelta)};}
if(clearEnd){copy.range={start:copy.range.start,end:calendar.getDefaultEventEnd(eventDef.allDay,copy.range.start)};}
if(eventDef.allDay){copy.range={start:startOfDay(copy.range.start),end:startOfDay(copy.range.end)};}
if(copy.range.end<copy.range.start){copy.range.end=calendar.getDefaultEventEnd(eventDef.allDay,copy.range.start);}
return copy;}
function reduceEventStore(eventStore,action,eventSources,dateProfile,calendar){switch(action.type){case'RECEIVE_EVENTS':return receiveRawEvents(eventStore,eventSources[action.sourceId],action.fetchId,action.fetchRange,action.rawEvents,calendar);case'ADD_EVENTS':return addEvent(eventStore,action.eventStore,dateProfile?dateProfile.activeRange:null,calendar);case'MERGE_EVENTS':return mergeEventStores(eventStore,action.eventStore);case'PREV':case'NEXT':case'SET_DATE':case'SET_VIEW_TYPE':if(dateProfile){return expandRecurring(eventStore,dateProfile.activeRange,calendar);}
else{return eventStore;}
case'CHANGE_TIMEZONE':return rezoneDates(eventStore,action.oldDateEnv,calendar.dateEnv);case'MUTATE_EVENTS':return applyMutationToRelated(eventStore,action.instanceId,action.mutation,action.fromApi,calendar);case'REMOVE_EVENT_INSTANCES':return excludeInstances(eventStore,action.instances);case'REMOVE_EVENT_DEF':return filterEventStoreDefs(eventStore,function(eventDef){return eventDef.defId!==action.defId;});case'REMOVE_EVENT_SOURCE':return excludeEventsBySourceId(eventStore,action.sourceId);case'REMOVE_ALL_EVENT_SOURCES':return filterEventStoreDefs(eventStore,function(eventDef){return!eventDef.sourceId;});case'REMOVE_ALL_EVENTS':return createEmptyEventStore();case'RESET_EVENTS':return{defs:eventStore.defs,instances:eventStore.instances};default:return eventStore;}}
function receiveRawEvents(eventStore,eventSource,fetchId,fetchRange,rawEvents,calendar){if(eventSource&&fetchId===eventSource.latestFetchId){var subset=parseEvents(transformRawEvents(rawEvents,eventSource,calendar),eventSource.sourceId,calendar);if(fetchRange){subset=expandRecurring(subset,fetchRange,calendar);}
return mergeEventStores(excludeEventsBySourceId(eventStore,eventSource.sourceId),subset);}
return eventStore;}
function addEvent(eventStore,subset,expandRange,calendar){if(expandRange){subset=expandRecurring(subset,expandRange,calendar);}
return mergeEventStores(eventStore,subset);}
function rezoneDates(eventStore,oldDateEnv,newDateEnv){var defs=eventStore.defs;var instances=mapHash(eventStore.instances,function(instance){var def=defs[instance.defId];if(def.allDay||def.recurringDef){return instance;}
else{return __assign({},instance,{range:{start:newDateEnv.createMarker(oldDateEnv.toDate(instance.range.start,instance.forcedStartTzo)),end:newDateEnv.createMarker(oldDateEnv.toDate(instance.range.end,instance.forcedEndTzo))},forcedStartTzo:newDateEnv.canComputeOffset?null:instance.forcedStartTzo,forcedEndTzo:newDateEnv.canComputeOffset?null:instance.forcedEndTzo});}});return{defs:defs,instances:instances};}
function applyMutationToRelated(eventStore,instanceId,mutation,fromApi,calendar){var relevant=getRelevantEvents(eventStore,instanceId);var eventConfigBase=fromApi?{'':{startEditable:true,durationEditable:true,constraints:[],overlap:null,allows:[],backgroundColor:'',borderColor:'',textColor:'',classNames:[]}}:calendar.eventUiBases;relevant=applyMutationToEventStore(relevant,eventConfigBase,mutation,calendar);return mergeEventStores(eventStore,relevant);}
function excludeEventsBySourceId(eventStore,sourceId){return filterEventStoreDefs(eventStore,function(eventDef){return eventDef.sourceId!==sourceId;});}
function excludeInstances(eventStore,removals){return{defs:eventStore.defs,instances:filterHash(eventStore.instances,function(instance){return!removals[instance.instanceId];})};}
function isInteractionValid(interaction,calendar){return isNewPropsValid({eventDrag:interaction},calendar);}
function isDateSelectionValid(dateSelection,calendar){return isNewPropsValid({dateSelection:dateSelection},calendar);}
function isNewPropsValid(newProps,calendar){var view=calendar.view;var props=__assign({businessHours:view?view.props.businessHours:createEmptyEventStore(),dateSelection:'',eventStore:calendar.state.eventStore,eventUiBases:calendar.eventUiBases,eventSelection:'',eventDrag:null,eventResize:null},newProps);return(calendar.pluginSystem.hooks.isPropsValid||isPropsValid)(props,calendar);}
function isPropsValid(state,calendar,dateSpanMeta,filterConfig){if(dateSpanMeta===void 0){dateSpanMeta={};}
if(state.eventDrag&&!isInteractionPropsValid(state,calendar,dateSpanMeta,filterConfig)){return false;}
if(state.dateSelection&&!isDateSelectionPropsValid(state,calendar,dateSpanMeta,filterConfig)){return false;}
return true;}
function isInteractionPropsValid(state,calendar,dateSpanMeta,filterConfig){var interaction=state.eventDrag;var subjectEventStore=interaction.mutatedEvents;var subjectDefs=subjectEventStore.defs;var subjectInstances=subjectEventStore.instances;var subjectConfigs=compileEventUis(subjectDefs,interaction.isEvent?state.eventUiBases:{'':calendar.selectionConfig});if(filterConfig){subjectConfigs=mapHash(subjectConfigs,filterConfig);}
var otherEventStore=excludeInstances(state.eventStore,interaction.affectedEvents.instances);var otherDefs=otherEventStore.defs;var otherInstances=otherEventStore.instances;var otherConfigs=compileEventUis(otherDefs,state.eventUiBases);for(var subjectInstanceId in subjectInstances){var subjectInstance=subjectInstances[subjectInstanceId];var subjectRange=subjectInstance.range;var subjectConfig=subjectConfigs[subjectInstance.defId];var subjectDef=subjectDefs[subjectInstance.defId];if(!allConstraintsPass(subjectConfig.constraints,subjectRange,otherEventStore,state.businessHours,calendar)){return false;}
var overlapFunc=calendar.opt('eventOverlap');if(typeof overlapFunc!=='function'){overlapFunc=null;}
for(var otherInstanceId in otherInstances){var otherInstance=otherInstances[otherInstanceId];if(rangesIntersect(subjectRange,otherInstance.range)){var otherOverlap=otherConfigs[otherInstance.defId].overlap;if(otherOverlap===false&&interaction.isEvent){return false;}
if(subjectConfig.overlap===false){return false;}
if(overlapFunc&&!overlapFunc(new EventApi(calendar,otherDefs[otherInstance.defId],otherInstance),new EventApi(calendar,subjectDef,subjectInstance))){return false;}}}
var calendarEventStore=calendar.state.eventStore;for(var _i=0,_a=subjectConfig.allows;_i<_a.length;_i++){var subjectAllow=_a[_i];var subjectDateSpan=__assign({},dateSpanMeta,{range:subjectInstance.range,allDay:subjectDef.allDay});var origDef=calendarEventStore.defs[subjectDef.defId];var origInstance=calendarEventStore.instances[subjectInstanceId];var eventApi=void 0;if(origDef){eventApi=new EventApi(calendar,origDef,origInstance);}
else{eventApi=new EventApi(calendar,subjectDef);}
if(!subjectAllow(calendar.buildDateSpanApi(subjectDateSpan),eventApi)){return false;}}}
return true;}
function isDateSelectionPropsValid(state,calendar,dateSpanMeta,filterConfig){var relevantEventStore=state.eventStore;var relevantDefs=relevantEventStore.defs;var relevantInstances=relevantEventStore.instances;var selection=state.dateSelection;var selectionRange=selection.range;var selectionConfig=calendar.selectionConfig;if(filterConfig){selectionConfig=filterConfig(selectionConfig);}
if(!allConstraintsPass(selectionConfig.constraints,selectionRange,relevantEventStore,state.businessHours,calendar)){return false;}
var overlapFunc=calendar.opt('selectOverlap');if(typeof overlapFunc!=='function'){overlapFunc=null;}
for(var relevantInstanceId in relevantInstances){var relevantInstance=relevantInstances[relevantInstanceId];if(rangesIntersect(selectionRange,relevantInstance.range)){if(selectionConfig.overlap===false){return false;}
if(overlapFunc&&!overlapFunc(new EventApi(calendar,relevantDefs[relevantInstance.defId],relevantInstance))){return false;}}}
for(var _i=0,_a=selectionConfig.allows;_i<_a.length;_i++){var selectionAllow=_a[_i];var fullDateSpan=__assign({},dateSpanMeta,selection);if(!selectionAllow(calendar.buildDateSpanApi(fullDateSpan),null)){return false;}}
return true;}
function allConstraintsPass(constraints,subjectRange,otherEventStore,businessHoursUnexpanded,calendar){for(var _i=0,constraints_1=constraints;_i<constraints_1.length;_i++){var constraint=constraints_1[_i];if(!anyRangesContainRange(constraintToRanges(constraint,subjectRange,otherEventStore,businessHoursUnexpanded,calendar),subjectRange)){return false;}}
return true;}
function constraintToRanges(constraint,subjectRange,otherEventStore,businessHoursUnexpanded,calendar){if(constraint==='businessHours'){return eventStoreToRanges(expandRecurring(businessHoursUnexpanded,subjectRange,calendar));}
else if(typeof constraint==='string'){return eventStoreToRanges(filterEventStoreDefs(otherEventStore,function(eventDef){return eventDef.groupId===constraint;}));}
else if(typeof constraint==='object'&&constraint){return eventStoreToRanges(expandRecurring(constraint,subjectRange,calendar));}
return[];}
function eventStoreToRanges(eventStore){var instances=eventStore.instances;var ranges=[];for(var instanceId in instances){ranges.push(instances[instanceId].range);}
return ranges;}
function anyRangesContainRange(outerRanges,innerRange){for(var _i=0,outerRanges_1=outerRanges;_i<outerRanges_1.length;_i++){var outerRange=outerRanges_1[_i];if(rangeContainsRange(outerRange,innerRange)){return true;}}
return false;}
function normalizeConstraint(input,calendar){if(Array.isArray(input)){return parseEvents(input,'',calendar,true);}
else if(typeof input==='object'&&input){return parseEvents([input],'',calendar,true);}
else if(input!=null){return String(input);}
else{return null;}}
function htmlEscape(s){return(s+'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/'/g,'&#039;').replace(/"/g,'&quot;').replace(/\n/g,'<br />');}
function cssToStr(cssProps){var statements=[];for(var name_1 in cssProps){var val=cssProps[name_1];if(val!=null&&val!==''){statements.push(name_1+':'+val);}}
return statements.join(';');}
function attrsToStr(attrs){var parts=[];for(var name_2 in attrs){var val=attrs[name_2];if(val!=null){parts.push(name_2+'="'+htmlEscape(val)+'"');}}
return parts.join(' ');}
function parseClassName(raw){if(Array.isArray(raw)){return raw;}
else if(typeof raw==='string'){return raw.split(/\s+/);}
else{return[];}}
var UNSCOPED_EVENT_UI_PROPS={editable:Boolean,startEditable:Boolean,durationEditable:Boolean,constraint:null,overlap:null,allow:null,className:parseClassName,classNames:parseClassName,color:String,backgroundColor:String,borderColor:String,textColor:String};function processUnscopedUiProps(rawProps,calendar,leftovers){var props=refineProps(rawProps,UNSCOPED_EVENT_UI_PROPS,{},leftovers);var constraint=normalizeConstraint(props.constraint,calendar);return{startEditable:props.startEditable!=null?props.startEditable:props.editable,durationEditable:props.durationEditable!=null?props.durationEditable:props.editable,constraints:constraint!=null?[constraint]:[],overlap:props.overlap,allows:props.allow!=null?[props.allow]:[],backgroundColor:props.backgroundColor||props.color,borderColor:props.borderColor||props.color,textColor:props.textColor,classNames:props.classNames.concat(props.className)};}
function processScopedUiProps(prefix,rawScoped,calendar,leftovers){var rawUnscoped={};var wasFound={};for(var key in UNSCOPED_EVENT_UI_PROPS){var scopedKey=prefix+capitaliseFirstLetter(key);rawUnscoped[key]=rawScoped[scopedKey];wasFound[scopedKey]=true;}
if(prefix==='event'){rawUnscoped.editable=rawScoped.editable;}
if(leftovers){for(var key in rawScoped){if(!wasFound[key]){leftovers[key]=rawScoped[key];}}}
return processUnscopedUiProps(rawUnscoped,calendar);}
var EMPTY_EVENT_UI={startEditable:null,durationEditable:null,constraints:[],overlap:null,allows:[],backgroundColor:'',borderColor:'',textColor:'',classNames:[]};function combineEventUis(uis){return uis.reduce(combineTwoEventUis,EMPTY_EVENT_UI);}
function combineTwoEventUis(item0,item1){return{startEditable:item1.startEditable!=null?item1.startEditable:item0.startEditable,durationEditable:item1.durationEditable!=null?item1.durationEditable:item0.durationEditable,constraints:item0.constraints.concat(item1.constraints),overlap:typeof item1.overlap==='boolean'?item1.overlap:item0.overlap,allows:item0.allows.concat(item1.allows),backgroundColor:item1.backgroundColor||item0.backgroundColor,borderColor:item1.borderColor||item0.borderColor,textColor:item1.textColor||item0.textColor,classNames:item0.classNames.concat(item1.classNames)};}
var NON_DATE_PROPS={id:String,groupId:String,title:String,url:String,rendering:String,extendedProps:null};var DATE_PROPS={start:null,date:null,end:null,allDay:null};var uid=0;function parseEvent(raw,sourceId,calendar,allowOpenRange){var allDayDefault=computeIsAllDayDefault(sourceId,calendar);var leftovers0={};var recurringRes=parseRecurring(raw,allDayDefault,calendar.dateEnv,calendar.pluginSystem.hooks.recurringTypes,leftovers0);if(recurringRes){var def=parseEventDef(leftovers0,sourceId,recurringRes.allDay,Boolean(recurringRes.duration),calendar);def.recurringDef={typeId:recurringRes.typeId,typeData:recurringRes.typeData,duration:recurringRes.duration};return{def:def,instance:null};}
else{var leftovers1={};var singleRes=parseSingle(raw,allDayDefault,calendar,leftovers1,allowOpenRange);if(singleRes){var def=parseEventDef(leftovers1,sourceId,singleRes.allDay,singleRes.hasEnd,calendar);var instance=createEventInstance(def.defId,singleRes.range,singleRes.forcedStartTzo,singleRes.forcedEndTzo);return{def:def,instance:instance};}}
return null;}
function parseEventDef(raw,sourceId,allDay,hasEnd,calendar){var leftovers={};var def=pluckNonDateProps(raw,calendar,leftovers);def.defId=String(uid++);def.sourceId=sourceId;def.allDay=allDay;def.hasEnd=hasEnd;for(var _i=0,_a=calendar.pluginSystem.hooks.eventDefParsers;_i<_a.length;_i++){var eventDefParser=_a[_i];var newLeftovers={};eventDefParser(def,leftovers,newLeftovers);leftovers=newLeftovers;}
def.extendedProps=__assign(leftovers,def.extendedProps||{});Object.freeze(def.ui.classNames);Object.freeze(def.extendedProps);return def;}
function createEventInstance(defId,range,forcedStartTzo,forcedEndTzo){return{instanceId:String(uid++),defId:defId,range:range,forcedStartTzo:forcedStartTzo==null?null:forcedStartTzo,forcedEndTzo:forcedEndTzo==null?null:forcedEndTzo};}
function parseSingle(raw,allDayDefault,calendar,leftovers,allowOpenRange){var props=pluckDateProps(raw,leftovers);var allDay=props.allDay;var startMeta;var startMarker=null;var hasEnd=false;var endMeta;var endMarker=null;startMeta=calendar.dateEnv.createMarkerMeta(props.start);if(startMeta){startMarker=startMeta.marker;}
else if(!allowOpenRange){return null;}
if(props.end!=null){endMeta=calendar.dateEnv.createMarkerMeta(props.end);}
if(allDay==null){if(allDayDefault!=null){allDay=allDayDefault;}
else{allDay=(!startMeta||startMeta.isTimeUnspecified)&&(!endMeta||endMeta.isTimeUnspecified);}}
if(allDay&&startMarker){startMarker=startOfDay(startMarker);}
if(endMeta){endMarker=endMeta.marker;if(allDay){endMarker=startOfDay(endMarker);}
if(startMarker&&endMarker<=startMarker){endMarker=null;}}
if(endMarker){hasEnd=true;}
else if(!allowOpenRange){hasEnd=calendar.opt('forceEventDuration')||false;endMarker=calendar.dateEnv.add(startMarker,allDay?calendar.defaultAllDayEventDuration:calendar.defaultTimedEventDuration);}
return{allDay:allDay,hasEnd:hasEnd,range:{start:startMarker,end:endMarker},forcedStartTzo:startMeta?startMeta.forcedTzo:null,forcedEndTzo:endMeta?endMeta.forcedTzo:null};}
function pluckDateProps(raw,leftovers){var props=refineProps(raw,DATE_PROPS,{},leftovers);props.start=(props.start!==null)?props.start:props.date;delete props.date;return props;}
function pluckNonDateProps(raw,calendar,leftovers){var preLeftovers={};var props=refineProps(raw,NON_DATE_PROPS,{},preLeftovers);var ui=processUnscopedUiProps(preLeftovers,calendar,leftovers);props.publicId=props.id;delete props.id;props.ui=ui;return props;}
function computeIsAllDayDefault(sourceId,calendar){var res=null;if(sourceId){var source=calendar.state.eventSources[sourceId];res=source.allDayDefault;}
if(res==null){res=calendar.opt('allDayDefault');}
return res;}
var DEF_DEFAULTS={startTime:'09:00',endTime:'17:00',daysOfWeek:[1,2,3,4,5],rendering:'inverse-background',classNames:'fc-nonbusiness',groupId:'_businessHours'};function parseBusinessHours(input,calendar){return parseEvents(refineInputs(input),'',calendar);}
function refineInputs(input){var rawDefs;if(input===true){rawDefs=[{}];}
else if(Array.isArray(input)){rawDefs=input.filter(function(rawDef){return rawDef.daysOfWeek;});}
else if(typeof input==='object'&&input){rawDefs=[input];}
else{rawDefs=[];}
rawDefs=rawDefs.map(function(rawDef){return __assign({},DEF_DEFAULTS,rawDef);});return rawDefs;}
function memoizeRendering(renderFunc,unrenderFunc,dependencies){if(dependencies===void 0){dependencies=[];}
var dependents=[];var thisContext;var prevArgs;function unrender(){if(prevArgs){for(var _i=0,dependents_1=dependents;_i<dependents_1.length;_i++){var dependent=dependents_1[_i];dependent.unrender();}
if(unrenderFunc){unrenderFunc.apply(thisContext,prevArgs);}
prevArgs=null;}}
function res(){if(!prevArgs||!isArraysEqual(prevArgs,arguments)){unrender();thisContext=this;prevArgs=arguments;renderFunc.apply(this,arguments);}}
res.dependents=dependents;res.unrender=unrender;for(var _i=0,dependencies_1=dependencies;_i<dependencies_1.length;_i++){var dependency=dependencies_1[_i];dependency.dependents.push(res);}
return res;}
var EMPTY_EVENT_STORE=createEmptyEventStore();var Splitter=(function(){function Splitter(){this.getKeysForEventDefs=memoize(this._getKeysForEventDefs);this.splitDateSelection=memoize(this._splitDateSpan);this.splitEventStore=memoize(this._splitEventStore);this.splitIndividualUi=memoize(this._splitIndividualUi);this.splitEventDrag=memoize(this._splitInteraction);this.splitEventResize=memoize(this._splitInteraction);this.eventUiBuilders={};}
Splitter.prototype.splitProps=function(props){var _this=this;var keyInfos=this.getKeyInfo(props);var defKeys=this.getKeysForEventDefs(props.eventStore);var dateSelections=this.splitDateSelection(props.dateSelection);var individualUi=this.splitIndividualUi(props.eventUiBases,defKeys);var eventStores=this.splitEventStore(props.eventStore,defKeys);var eventDrags=this.splitEventDrag(props.eventDrag);var eventResizes=this.splitEventResize(props.eventResize);var splitProps={};this.eventUiBuilders=mapHash(keyInfos,function(info,key){return _this.eventUiBuilders[key]||memoize(buildEventUiForKey);});for(var key in keyInfos){var keyInfo=keyInfos[key];var eventStore=eventStores[key]||EMPTY_EVENT_STORE;var buildEventUi=this.eventUiBuilders[key];splitProps[key]={businessHours:keyInfo.businessHours||props.businessHours,dateSelection:dateSelections[key]||null,eventStore:eventStore,eventUiBases:buildEventUi(props.eventUiBases[''],keyInfo.ui,individualUi[key]),eventSelection:eventStore.instances[props.eventSelection]?props.eventSelection:'',eventDrag:eventDrags[key]||null,eventResize:eventResizes[key]||null};}
return splitProps;};Splitter.prototype._splitDateSpan=function(dateSpan){var dateSpans={};if(dateSpan){var keys=this.getKeysForDateSpan(dateSpan);for(var _i=0,keys_1=keys;_i<keys_1.length;_i++){var key=keys_1[_i];dateSpans[key]=dateSpan;}}
return dateSpans;};Splitter.prototype._getKeysForEventDefs=function(eventStore){var _this=this;return mapHash(eventStore.defs,function(eventDef){return _this.getKeysForEventDef(eventDef);});};Splitter.prototype._splitEventStore=function(eventStore,defKeys){var defs=eventStore.defs,instances=eventStore.instances;var splitStores={};for(var defId in defs){for(var _i=0,_a=defKeys[defId];_i<_a.length;_i++){var key=_a[_i];if(!splitStores[key]){splitStores[key]=createEmptyEventStore();}
splitStores[key].defs[defId]=defs[defId];}}
for(var instanceId in instances){var instance=instances[instanceId];for(var _b=0,_c=defKeys[instance.defId];_b<_c.length;_b++){var key=_c[_b];if(splitStores[key]){splitStores[key].instances[instanceId]=instance;}}}
return splitStores;};Splitter.prototype._splitIndividualUi=function(eventUiBases,defKeys){var splitHashes={};for(var defId in eventUiBases){if(defId){for(var _i=0,_a=defKeys[defId];_i<_a.length;_i++){var key=_a[_i];if(!splitHashes[key]){splitHashes[key]={};}
splitHashes[key][defId]=eventUiBases[defId];}}}
return splitHashes;};Splitter.prototype._splitInteraction=function(interaction){var splitStates={};if(interaction){var affectedStores_1=this._splitEventStore(interaction.affectedEvents,this._getKeysForEventDefs(interaction.affectedEvents));var mutatedKeysByDefId=this._getKeysForEventDefs(interaction.mutatedEvents);var mutatedStores_1=this._splitEventStore(interaction.mutatedEvents,mutatedKeysByDefId);var populate=function(key){if(!splitStates[key]){splitStates[key]={affectedEvents:affectedStores_1[key]||EMPTY_EVENT_STORE,mutatedEvents:mutatedStores_1[key]||EMPTY_EVENT_STORE,isEvent:interaction.isEvent,origSeg:interaction.origSeg};}};for(var key in affectedStores_1){populate(key);}
for(var key in mutatedStores_1){populate(key);}}
return splitStates;};return Splitter;}());function buildEventUiForKey(allUi,eventUiForKey,individualUi){var baseParts=[];if(allUi){baseParts.push(allUi);}
if(eventUiForKey){baseParts.push(eventUiForKey);}
var stuff={'':combineEventUis(baseParts)};if(individualUi){__assign(stuff,individualUi);}
return stuff;}
function buildGotoAnchorHtml(allOptions,dateEnv,gotoOptions,attrs,innerHtml){var date;var type;var forceOff;var finalOptions;if(gotoOptions instanceof Date){date=gotoOptions;}
else{date=gotoOptions.date;type=gotoOptions.type;forceOff=gotoOptions.forceOff;}
finalOptions={date:dateEnv.formatIso(date,{omitTime:true}),type:type||'day'};if(typeof attrs==='string'){innerHtml=attrs;attrs=null;}
attrs=attrs?' '+attrsToStr(attrs):'';innerHtml=innerHtml||'';if(!forceOff&&allOptions.navLinks){return'<a'+attrs+' data-goto="'+htmlEscape(JSON.stringify(finalOptions))+'">'+
innerHtml+'</a>';}
else{return'<span'+attrs+'>'+
innerHtml+'</span>';}}
function getAllDayHtml(allOptions){return allOptions.allDayHtml||htmlEscape(allOptions.allDayText);}
function getDayClasses(date,dateProfile,context,noThemeHighlight){var calendar=context.calendar,options=context.options,theme=context.theme,dateEnv=context.dateEnv;var classes=[];var todayStart;var todayEnd;if(!rangeContainsMarker(dateProfile.activeRange,date)){classes.push('fc-disabled-day');}
else{classes.push('fc-'+DAY_IDS[date.getUTCDay()]);if(options.monthMode&&dateEnv.getMonth(date)!==dateEnv.getMonth(dateProfile.currentRange.start)){classes.push('fc-other-month');}
todayStart=startOfDay(calendar.getNow());todayEnd=addDays(todayStart,1);if(date<todayStart){classes.push('fc-past');}
else if(date>=todayEnd){classes.push('fc-future');}
else{classes.push('fc-today');if(noThemeHighlight!==true){classes.push(theme.getClass('today'));}}}
return classes;}
function unpromisify(func,success,failure){var isResolved=false;var wrappedSuccess=function(){if(!isResolved){isResolved=true;success.apply(this,arguments);}};var wrappedFailure=function(){if(!isResolved){isResolved=true;if(failure){failure.apply(this,arguments);}}};var res=func(wrappedSuccess,wrappedFailure);if(res&&typeof res.then==='function'){res.then(wrappedSuccess,wrappedFailure);}}
var Mixin=(function(){function Mixin(){}
Mixin.mixInto=function(destClass){this.mixIntoObj(destClass.prototype);};Mixin.mixIntoObj=function(destObj){var _this=this;Object.getOwnPropertyNames(this.prototype).forEach(function(name){if(!destObj[name]){destObj[name]=_this.prototype[name];}});};Mixin.mixOver=function(destClass){var _this=this;Object.getOwnPropertyNames(this.prototype).forEach(function(name){destClass.prototype[name]=_this.prototype[name];});};return Mixin;}());var EmitterMixin=(function(_super){__extends(EmitterMixin,_super);function EmitterMixin(){return _super!==null&&_super.apply(this,arguments)||this;}
EmitterMixin.prototype.on=function(type,handler){addToHash(this._handlers||(this._handlers={}),type,handler);return this;};EmitterMixin.prototype.one=function(type,handler){addToHash(this._oneHandlers||(this._oneHandlers={}),type,handler);return this;};EmitterMixin.prototype.off=function(type,handler){if(this._handlers){removeFromHash(this._handlers,type,handler);}
if(this._oneHandlers){removeFromHash(this._oneHandlers,type,handler);}
return this;};EmitterMixin.prototype.trigger=function(type){var args=[];for(var _i=1;_i<arguments.length;_i++){args[_i-1]=arguments[_i];}
this.triggerWith(type,this,args);return this;};EmitterMixin.prototype.triggerWith=function(type,context,args){if(this._handlers){applyAll(this._handlers[type],context,args);}
if(this._oneHandlers){applyAll(this._oneHandlers[type],context,args);delete this._oneHandlers[type];}
return this;};EmitterMixin.prototype.hasHandlers=function(type){return(this._handlers&&this._handlers[type]&&this._handlers[type].length)||(this._oneHandlers&&this._oneHandlers[type]&&this._oneHandlers[type].length);};return EmitterMixin;}(Mixin));function addToHash(hash,type,handler){(hash[type]||(hash[type]=[])).push(handler);}
function removeFromHash(hash,type,handler){if(handler){if(hash[type]){hash[type]=hash[type].filter(function(func){return func!==handler;});}}
else{delete hash[type];}}
var PositionCache=(function(){function PositionCache(originEl,els,isHorizontal,isVertical){this.originEl=originEl;this.els=els;this.isHorizontal=isHorizontal;this.isVertical=isVertical;}
PositionCache.prototype.build=function(){var originEl=this.originEl;var originClientRect=this.originClientRect=originEl.getBoundingClientRect();if(this.isHorizontal){this.buildElHorizontals(originClientRect.left);}
if(this.isVertical){this.buildElVerticals(originClientRect.top);}};PositionCache.prototype.buildElHorizontals=function(originClientLeft){var lefts=[];var rights=[];for(var _i=0,_a=this.els;_i<_a.length;_i++){var el=_a[_i];var rect=el.getBoundingClientRect();lefts.push(rect.left-originClientLeft);rights.push(rect.right-originClientLeft);}
this.lefts=lefts;this.rights=rights;};PositionCache.prototype.buildElVerticals=function(originClientTop){var tops=[];var bottoms=[];for(var _i=0,_a=this.els;_i<_a.length;_i++){var el=_a[_i];var rect=el.getBoundingClientRect();tops.push(rect.top-originClientTop);bottoms.push(rect.bottom-originClientTop);}
this.tops=tops;this.bottoms=bottoms;};PositionCache.prototype.leftToIndex=function(leftPosition){var lefts=this.lefts;var rights=this.rights;var len=lefts.length;var i;for(i=0;i<len;i++){if(leftPosition>=lefts[i]&&leftPosition<rights[i]){return i;}}};PositionCache.prototype.topToIndex=function(topPosition){var tops=this.tops;var bottoms=this.bottoms;var len=tops.length;var i;for(i=0;i<len;i++){if(topPosition>=tops[i]&&topPosition<bottoms[i]){return i;}}};PositionCache.prototype.getWidth=function(leftIndex){return this.rights[leftIndex]-this.lefts[leftIndex];};PositionCache.prototype.getHeight=function(topIndex){return this.bottoms[topIndex]-this.tops[topIndex];};return PositionCache;}());var ScrollController=(function(){function ScrollController(){}
ScrollController.prototype.getMaxScrollTop=function(){return this.getScrollHeight()-this.getClientHeight();};ScrollController.prototype.getMaxScrollLeft=function(){return this.getScrollWidth()-this.getClientWidth();};ScrollController.prototype.canScrollVertically=function(){return this.getMaxScrollTop()>0;};ScrollController.prototype.canScrollHorizontally=function(){return this.getMaxScrollLeft()>0;};ScrollController.prototype.canScrollUp=function(){return this.getScrollTop()>0;};ScrollController.prototype.canScrollDown=function(){return this.getScrollTop()<this.getMaxScrollTop();};ScrollController.prototype.canScrollLeft=function(){return this.getScrollLeft()>0;};ScrollController.prototype.canScrollRight=function(){return this.getScrollLeft()<this.getMaxScrollLeft();};return ScrollController;}());var ElementScrollController=(function(_super){__extends(ElementScrollController,_super);function ElementScrollController(el){var _this=_super.call(this)||this;_this.el=el;return _this;}
ElementScrollController.prototype.getScrollTop=function(){return this.el.scrollTop;};ElementScrollController.prototype.getScrollLeft=function(){return this.el.scrollLeft;};ElementScrollController.prototype.setScrollTop=function(top){this.el.scrollTop=top;};ElementScrollController.prototype.setScrollLeft=function(left){this.el.scrollLeft=left;};ElementScrollController.prototype.getScrollWidth=function(){return this.el.scrollWidth;};ElementScrollController.prototype.getScrollHeight=function(){return this.el.scrollHeight;};ElementScrollController.prototype.getClientHeight=function(){return this.el.clientHeight;};ElementScrollController.prototype.getClientWidth=function(){return this.el.clientWidth;};return ElementScrollController;}(ScrollController));var WindowScrollController=(function(_super){__extends(WindowScrollController,_super);function WindowScrollController(){return _super!==null&&_super.apply(this,arguments)||this;}
WindowScrollController.prototype.getScrollTop=function(){return window.pageYOffset;};WindowScrollController.prototype.getScrollLeft=function(){return window.pageXOffset;};WindowScrollController.prototype.setScrollTop=function(n){window.scroll(window.pageXOffset,n);};WindowScrollController.prototype.setScrollLeft=function(n){window.scroll(n,window.pageYOffset);};WindowScrollController.prototype.getScrollWidth=function(){return document.documentElement.scrollWidth;};WindowScrollController.prototype.getScrollHeight=function(){return document.documentElement.scrollHeight;};WindowScrollController.prototype.getClientHeight=function(){return document.documentElement.clientHeight;};WindowScrollController.prototype.getClientWidth=function(){return document.documentElement.clientWidth;};return WindowScrollController;}(ScrollController));var ScrollComponent=(function(_super){__extends(ScrollComponent,_super);function ScrollComponent(overflowX,overflowY){var _this=_super.call(this,createElement('div',{className:'fc-scroller'}))||this;_this.overflowX=overflowX;_this.overflowY=overflowY;_this.applyOverflow();return _this;}
ScrollComponent.prototype.clear=function(){this.setHeight('auto');this.applyOverflow();};ScrollComponent.prototype.destroy=function(){removeElement(this.el);};ScrollComponent.prototype.applyOverflow=function(){applyStyle(this.el,{overflowX:this.overflowX,overflowY:this.overflowY});};ScrollComponent.prototype.lockOverflow=function(scrollbarWidths){var overflowX=this.overflowX;var overflowY=this.overflowY;scrollbarWidths=scrollbarWidths||this.getScrollbarWidths();if(overflowX==='auto'){overflowX=(scrollbarWidths.bottom||this.canScrollHorizontally())?'scroll':'hidden';}
if(overflowY==='auto'){overflowY=(scrollbarWidths.left||scrollbarWidths.right||this.canScrollVertically())?'scroll':'hidden';}
applyStyle(this.el,{overflowX:overflowX,overflowY:overflowY});};ScrollComponent.prototype.setHeight=function(height){applyStyleProp(this.el,'height',height);};ScrollComponent.prototype.getScrollbarWidths=function(){var edges=computeEdges(this.el);return{left:edges.scrollbarLeft,right:edges.scrollbarRight,bottom:edges.scrollbarBottom};};return ScrollComponent;}(ElementScrollController));var Theme=(function(){function Theme(calendarOptions){this.calendarOptions=calendarOptions;this.processIconOverride();}
Theme.prototype.processIconOverride=function(){if(this.iconOverrideOption){this.setIconOverride(this.calendarOptions[this.iconOverrideOption]);}};Theme.prototype.setIconOverride=function(iconOverrideHash){var iconClassesCopy;var buttonName;if(typeof iconOverrideHash==='object'&&iconOverrideHash){iconClassesCopy=__assign({},this.iconClasses);for(buttonName in iconOverrideHash){iconClassesCopy[buttonName]=this.applyIconOverridePrefix(iconOverrideHash[buttonName]);}
this.iconClasses=iconClassesCopy;}
else if(iconOverrideHash===false){this.iconClasses={};}};Theme.prototype.applyIconOverridePrefix=function(className){var prefix=this.iconOverridePrefix;if(prefix&&className.indexOf(prefix)!==0){className=prefix+className;}
return className;};Theme.prototype.getClass=function(key){return this.classes[key]||'';};Theme.prototype.getIconClass=function(buttonName){var className=this.iconClasses[buttonName];if(className){return this.baseIconClass+' '+className;}
return'';};Theme.prototype.getCustomButtonIconClass=function(customButtonProps){var className;if(this.iconOverrideCustomButtonOption){className=customButtonProps[this.iconOverrideCustomButtonOption];if(className){return this.baseIconClass+' '+this.applyIconOverridePrefix(className);}}
return'';};return Theme;}());Theme.prototype.classes={};Theme.prototype.iconClasses={};Theme.prototype.baseIconClass='';Theme.prototype.iconOverridePrefix='';var guid=0;var ComponentContext=(function(){function ComponentContext(calendar,theme,dateEnv,options,view){this.calendar=calendar;this.theme=theme;this.dateEnv=dateEnv;this.options=options;this.view=view;this.isRtl=options.dir==='rtl';this.eventOrderSpecs=parseFieldSpecs(options.eventOrder);this.nextDayThreshold=createDuration(options.nextDayThreshold);}
ComponentContext.prototype.extend=function(options,view){return new ComponentContext(this.calendar,this.theme,this.dateEnv,options||this.options,view||this.view);};return ComponentContext;}());var Component=(function(){function Component(){this.uid=String(guid++);}
Component.addEqualityFuncs=function(newFuncs){this.prototype.equalityFuncs=__assign({},this.prototype.equalityFuncs,newFuncs);};Component.prototype.receiveProps=function(props,context){var oldContext=this.context;this.context=context;if(!oldContext){this.firstContext(context);}
var _a=recycleProps(this.props||{},props,this.equalityFuncs),anyChanges=_a.anyChanges,comboProps=_a.comboProps;this.props=comboProps;if(anyChanges){if(oldContext){this.beforeUpdate();}
this.render(comboProps,context);if(oldContext){this.afterUpdate();}}};Component.prototype.render=function(props,context){};Component.prototype.firstContext=function(context){};Component.prototype.beforeUpdate=function(){};Component.prototype.afterUpdate=function(){};Component.prototype.destroy=function(){};return Component;}());Component.prototype.equalityFuncs={};function recycleProps(oldProps,newProps,equalityFuncs){var comboProps={};var anyChanges=false;for(var key in newProps){if(key in oldProps&&(oldProps[key]===newProps[key]||(equalityFuncs[key]&&equalityFuncs[key](oldProps[key],newProps[key])))){comboProps[key]=oldProps[key];}
else{comboProps[key]=newProps[key];anyChanges=true;}}
for(var key in oldProps){if(!(key in newProps)){anyChanges=true;break;}}
return{anyChanges:anyChanges,comboProps:comboProps};}
var DateComponent=(function(_super){__extends(DateComponent,_super);function DateComponent(el){var _this=_super.call(this)||this;_this.el=el;return _this;}
DateComponent.prototype.destroy=function(){_super.prototype.destroy.call(this);removeElement(this.el);};DateComponent.prototype.buildPositionCaches=function(){};DateComponent.prototype.queryHit=function(positionLeft,positionTop,elWidth,elHeight){return null;};DateComponent.prototype.isInteractionValid=function(interaction){var calendar=this.context.calendar;var dateProfile=this.props.dateProfile;var instances=interaction.mutatedEvents.instances;if(dateProfile){for(var instanceId in instances){if(!rangeContainsRange(dateProfile.validRange,instances[instanceId].range)){return false;}}}
return isInteractionValid(interaction,calendar);};DateComponent.prototype.isDateSelectionValid=function(selection){var calendar=this.context.calendar;var dateProfile=this.props.dateProfile;if(dateProfile&&!rangeContainsRange(dateProfile.validRange,selection.range)){return false;}
return isDateSelectionValid(selection,calendar);};DateComponent.prototype.isValidSegDownEl=function(el){return!this.props.eventDrag&&!this.props.eventResize&&!elementClosest(el,'.fc-mirror')&&(this.isPopover()||!this.isInPopover(el));};DateComponent.prototype.isValidDateDownEl=function(el){var segEl=elementClosest(el,this.fgSegSelector);return(!segEl||segEl.classList.contains('fc-mirror'))&&!elementClosest(el,'.fc-more')&&!elementClosest(el,'a[data-goto]')&&!this.isInPopover(el);};DateComponent.prototype.isPopover=function(){return this.el.classList.contains('fc-popover');};DateComponent.prototype.isInPopover=function(el){return Boolean(elementClosest(el,'.fc-popover'));};return DateComponent;}(Component));DateComponent.prototype.fgSegSelector='.fc-event-container > *';DateComponent.prototype.bgSegSelector='.fc-bgevent:not(.fc-nonbusiness)';var uid$1=0;function createPlugin(input){return{id:String(uid$1++),deps:input.deps||[],reducers:input.reducers||[],eventDefParsers:input.eventDefParsers||[],isDraggableTransformers:input.isDraggableTransformers||[],eventDragMutationMassagers:input.eventDragMutationMassagers||[],eventDefMutationAppliers:input.eventDefMutationAppliers||[],dateSelectionTransformers:input.dateSelectionTransformers||[],datePointTransforms:input.datePointTransforms||[],dateSpanTransforms:input.dateSpanTransforms||[],views:input.views||{},viewPropsTransformers:input.viewPropsTransformers||[],isPropsValid:input.isPropsValid||null,externalDefTransforms:input.externalDefTransforms||[],eventResizeJoinTransforms:input.eventResizeJoinTransforms||[],viewContainerModifiers:input.viewContainerModifiers||[],eventDropTransformers:input.eventDropTransformers||[],componentInteractions:input.componentInteractions||[],calendarInteractions:input.calendarInteractions||[],themeClasses:input.themeClasses||{},eventSourceDefs:input.eventSourceDefs||[],cmdFormatter:input.cmdFormatter,recurringTypes:input.recurringTypes||[],namedTimeZonedImpl:input.namedTimeZonedImpl,defaultView:input.defaultView||'',elementDraggingImpl:input.elementDraggingImpl,optionChangeHandlers:input.optionChangeHandlers||{}};}
var PluginSystem=(function(){function PluginSystem(){this.hooks={reducers:[],eventDefParsers:[],isDraggableTransformers:[],eventDragMutationMassagers:[],eventDefMutationAppliers:[],dateSelectionTransformers:[],datePointTransforms:[],dateSpanTransforms:[],views:{},viewPropsTransformers:[],isPropsValid:null,externalDefTransforms:[],eventResizeJoinTransforms:[],viewContainerModifiers:[],eventDropTransformers:[],componentInteractions:[],calendarInteractions:[],themeClasses:{},eventSourceDefs:[],cmdFormatter:null,recurringTypes:[],namedTimeZonedImpl:null,defaultView:'',elementDraggingImpl:null,optionChangeHandlers:{}};this.addedHash={};}
PluginSystem.prototype.add=function(plugin){if(!this.addedHash[plugin.id]){this.addedHash[plugin.id]=true;for(var _i=0,_a=plugin.deps;_i<_a.length;_i++){var dep=_a[_i];this.add(dep);}
this.hooks=combineHooks(this.hooks,plugin);}};return PluginSystem;}());function combineHooks(hooks0,hooks1){return{reducers:hooks0.reducers.concat(hooks1.reducers),eventDefParsers:hooks0.eventDefParsers.concat(hooks1.eventDefParsers),isDraggableTransformers:hooks0.isDraggableTransformers.concat(hooks1.isDraggableTransformers),eventDragMutationMassagers:hooks0.eventDragMutationMassagers.concat(hooks1.eventDragMutationMassagers),eventDefMutationAppliers:hooks0.eventDefMutationAppliers.concat(hooks1.eventDefMutationAppliers),dateSelectionTransformers:hooks0.dateSelectionTransformers.concat(hooks1.dateSelectionTransformers),datePointTransforms:hooks0.datePointTransforms.concat(hooks1.datePointTransforms),dateSpanTransforms:hooks0.dateSpanTransforms.concat(hooks1.dateSpanTransforms),views:__assign({},hooks0.views,hooks1.views),viewPropsTransformers:hooks0.viewPropsTransformers.concat(hooks1.viewPropsTransformers),isPropsValid:hooks1.isPropsValid||hooks0.isPropsValid,externalDefTransforms:hooks0.externalDefTransforms.concat(hooks1.externalDefTransforms),eventResizeJoinTransforms:hooks0.eventResizeJoinTransforms.concat(hooks1.eventResizeJoinTransforms),viewContainerModifiers:hooks0.viewContainerModifiers.concat(hooks1.viewContainerModifiers),eventDropTransformers:hooks0.eventDropTransformers.concat(hooks1.eventDropTransformers),calendarInteractions:hooks0.calendarInteractions.concat(hooks1.calendarInteractions),componentInteractions:hooks0.componentInteractions.concat(hooks1.componentInteractions),themeClasses:__assign({},hooks0.themeClasses,hooks1.themeClasses),eventSourceDefs:hooks0.eventSourceDefs.concat(hooks1.eventSourceDefs),cmdFormatter:hooks1.cmdFormatter||hooks0.cmdFormatter,recurringTypes:hooks0.recurringTypes.concat(hooks1.recurringTypes),namedTimeZonedImpl:hooks1.namedTimeZonedImpl||hooks0.namedTimeZonedImpl,defaultView:hooks0.defaultView||hooks1.defaultView,elementDraggingImpl:hooks0.elementDraggingImpl||hooks1.elementDraggingImpl,optionChangeHandlers:__assign({},hooks0.optionChangeHandlers,hooks1.optionChangeHandlers)};}
var eventSourceDef={ignoreRange:true,parseMeta:function(raw){if(Array.isArray(raw)){return raw;}
else if(Array.isArray(raw.events)){return raw.events;}
return null;},fetch:function(arg,success){success({rawEvents:arg.eventSource.meta});}};var ArrayEventSourcePlugin=createPlugin({eventSourceDefs:[eventSourceDef]});var eventSourceDef$1={parseMeta:function(raw){if(typeof raw==='function'){return raw;}
else if(typeof raw.events==='function'){return raw.events;}
return null;},fetch:function(arg,success,failure){var dateEnv=arg.calendar.dateEnv;var func=arg.eventSource.meta;unpromisify(func.bind(null,{start:dateEnv.toDate(arg.range.start),end:dateEnv.toDate(arg.range.end),startStr:dateEnv.formatIso(arg.range.start),endStr:dateEnv.formatIso(arg.range.end),timeZone:dateEnv.timeZone}),function(rawEvents){success({rawEvents:rawEvents});},failure);}};var FuncEventSourcePlugin=createPlugin({eventSourceDefs:[eventSourceDef$1]});function requestJson(method,url,params,successCallback,failureCallback){method=method.toUpperCase();var body=null;if(method==='GET'){url=injectQueryStringParams(url,params);}
else{body=encodeParams(params);}
var xhr=new XMLHttpRequest();xhr.open(method,url,true);if(method!=='GET'){xhr.setRequestHeader('Content-Type','application/x-www-form-urlencoded');}
xhr.onload=function(){if(xhr.status>=200&&xhr.status<400){try{var res=JSON.parse(xhr.responseText);successCallback(res,xhr);}
catch(err){failureCallback('Failure parsing JSON',xhr);}}
else{failureCallback('Request failed',xhr);}};xhr.onerror=function(){failureCallback('Request failed',xhr);};xhr.send(body);}
function injectQueryStringParams(url,params){return url+
(url.indexOf('?')===-1?'?':'&')+
encodeParams(params);}
function encodeParams(params){var parts=[];for(var key in params){parts.push(encodeURIComponent(key)+'='+encodeURIComponent(params[key]));}
return parts.join('&');}
var eventSourceDef$2={parseMeta:function(raw){if(typeof raw==='string'){raw={url:raw};}
else if(!raw||typeof raw!=='object'||!raw.url){return null;}
return{url:raw.url,method:(raw.method||'GET').toUpperCase(),extraParams:raw.extraParams,startParam:raw.startParam,endParam:raw.endParam,timeZoneParam:raw.timeZoneParam};},fetch:function(arg,success,failure){var meta=arg.eventSource.meta;var requestParams=buildRequestParams(meta,arg.range,arg.calendar);requestJson(meta.method,meta.url,requestParams,function(rawEvents,xhr){success({rawEvents:rawEvents,xhr:xhr});},function(errorMessage,xhr){failure({message:errorMessage,xhr:xhr});});}};var JsonFeedEventSourcePlugin=createPlugin({eventSourceDefs:[eventSourceDef$2]});function buildRequestParams(meta,range,calendar){var dateEnv=calendar.dateEnv;var startParam;var endParam;var timeZoneParam;var customRequestParams;var params={};startParam=meta.startParam;if(startParam==null){startParam=calendar.opt('startParam');}
endParam=meta.endParam;if(endParam==null){endParam=calendar.opt('endParam');}
timeZoneParam=meta.timeZoneParam;if(timeZoneParam==null){timeZoneParam=calendar.opt('timeZoneParam');}
if(typeof meta.extraParams==='function'){customRequestParams=meta.extraParams();}
else{customRequestParams=meta.extraParams||{};}
__assign(params,customRequestParams);params[startParam]=dateEnv.formatIso(range.start);params[endParam]=dateEnv.formatIso(range.end);if(dateEnv.timeZone!=='local'){params[timeZoneParam]=dateEnv.timeZone;}
return params;}
var recurring={parse:function(rawEvent,leftoverProps,dateEnv){var createMarker=dateEnv.createMarker.bind(dateEnv);var processors={daysOfWeek:null,startTime:createDuration,endTime:createDuration,startRecur:createMarker,endRecur:createMarker};var props=refineProps(rawEvent,processors,{},leftoverProps);var anyValid=false;for(var propName in props){if(props[propName]!=null){anyValid=true;break;}}
if(anyValid){var duration=null;if('duration'in leftoverProps){duration=createDuration(leftoverProps.duration);delete leftoverProps.duration;}
if(!duration&&props.startTime&&props.endTime){duration=subtractDurations(props.endTime,props.startTime);}
return{allDayGuess:Boolean(!props.startTime&&!props.endTime),duration:duration,typeData:props};}
return null;},expand:function(typeData,framingRange,dateEnv){var clippedFramingRange=intersectRanges(framingRange,{start:typeData.startRecur,end:typeData.endRecur});if(clippedFramingRange){return expandRanges(typeData.daysOfWeek,typeData.startTime,clippedFramingRange,dateEnv);}
else{return[];}}};var SimpleRecurrencePlugin=createPlugin({recurringTypes:[recurring]});function expandRanges(daysOfWeek,startTime,framingRange,dateEnv){var dowHash=daysOfWeek?arrayToHash(daysOfWeek):null;var dayMarker=startOfDay(framingRange.start);var endMarker=framingRange.end;var instanceStarts=[];while(dayMarker<endMarker){var instanceStart=void 0;if(!dowHash||dowHash[dayMarker.getUTCDay()]){if(startTime){instanceStart=dateEnv.add(dayMarker,startTime);}
else{instanceStart=dayMarker;}
instanceStarts.push(instanceStart);}
dayMarker=addDays(dayMarker,1);}
return instanceStarts;}
var DefaultOptionChangeHandlers=createPlugin({optionChangeHandlers:{events:function(events,calendar,deepEqual){handleEventSources([events],calendar,deepEqual);},eventSources:handleEventSources,plugins:handlePlugins}});function handleEventSources(inputs,calendar,deepEqual){var unfoundSources=hashValuesToArray(calendar.state.eventSources);var newInputs=[];for(var _i=0,inputs_1=inputs;_i<inputs_1.length;_i++){var input=inputs_1[_i];var inputFound=false;for(var i=0;i<unfoundSources.length;i++){if(deepEqual(unfoundSources[i]._raw,input)){unfoundSources.splice(i,1);inputFound=true;break;}}
if(!inputFound){newInputs.push(input);}}
for(var _a=0,unfoundSources_1=unfoundSources;_a<unfoundSources_1.length;_a++){var unfoundSource=unfoundSources_1[_a];calendar.dispatch({type:'REMOVE_EVENT_SOURCE',sourceId:unfoundSource.sourceId});}
for(var _b=0,newInputs_1=newInputs;_b<newInputs_1.length;_b++){var newInput=newInputs_1[_b];calendar.addEventSource(newInput);}}
function handlePlugins(inputs,calendar){calendar.addPluginInputs(inputs);}
var config={};var globalDefaults={defaultRangeSeparator:' - ',titleRangeSeparator:' \u2013 ',defaultTimedEventDuration:'01:00:00',defaultAllDayEventDuration:{day:1},forceEventDuration:false,nextDayThreshold:'00:00:00',columnHeader:true,defaultView:'',aspectRatio:1.35,header:{left:'title',center:'',right:'today prev,next'},weekends:true,weekNumbers:false,weekNumberCalculation:'local',editable:false,scrollTime:'06:00:00',minTime:'00:00:00',maxTime:'24:00:00',showNonCurrentDates:true,lazyFetching:true,startParam:'start',endParam:'end',timeZoneParam:'timeZone',timeZone:'local',locales:[],locale:'',timeGridEventMinHeight:0,themeSystem:'standard',dragRevertDuration:500,dragScroll:true,allDayMaintainDuration:false,unselectAuto:true,dropAccept:'*',eventOrder:'start,-duration,allDay,title',eventLimit:false,eventLimitClick:'popover',dayPopoverFormat:{month:'long',day:'numeric',year:'numeric'},handleWindowResize:true,windowResizeDelay:100,longPressDelay:1000,eventDragMinDistance:5};var rtlDefaults={header:{left:'next,prev today',center:'',right:'title'},buttonIcons:{prev:'fc-icon-chevron-right',next:'fc-icon-chevron-left',prevYear:'fc-icon-chevrons-right',nextYear:'fc-icon-chevrons-left'}};var complexOptions=['header','footer','buttonText','buttonIcons'];function mergeOptions(optionObjs){return mergeProps(optionObjs,complexOptions);}
var INTERNAL_PLUGINS=[ArrayEventSourcePlugin,FuncEventSourcePlugin,JsonFeedEventSourcePlugin,SimpleRecurrencePlugin,DefaultOptionChangeHandlers];function refinePluginDefs(pluginInputs){var plugins=[];for(var _i=0,pluginInputs_1=pluginInputs;_i<pluginInputs_1.length;_i++){var pluginInput=pluginInputs_1[_i];if(typeof pluginInput==='string'){var globalName='FullCalendar'+capitaliseFirstLetter(pluginInput);if(!window[globalName]){console.warn('Plugin file not loaded for '+pluginInput);}
else{plugins.push(window[globalName].default);}}
else{plugins.push(pluginInput);}}
return INTERNAL_PLUGINS.concat(plugins);}
var RAW_EN_LOCALE={code:'en',week:{dow:0,doy:4},dir:'ltr',buttonText:{prev:'prev',next:'next',prevYear:'prev year',nextYear:'next year',year:'year',today:'today',month:'month',week:'week',day:'day',list:'list'},weekLabel:'W',allDayText:'all-day',eventLimitText:'more',noEventsMessage:'No events to display'};function parseRawLocales(explicitRawLocales){var defaultCode=explicitRawLocales.length>0?explicitRawLocales[0].code:'en';var globalArray=window['FullCalendarLocalesAll']||[];var globalObject=window['FullCalendarLocales']||{};var allRawLocales=globalArray.concat(hashValuesToArray(globalObject),explicitRawLocales);var rawLocaleMap={en:RAW_EN_LOCALE};for(var _i=0,allRawLocales_1=allRawLocales;_i<allRawLocales_1.length;_i++){var rawLocale=allRawLocales_1[_i];rawLocaleMap[rawLocale.code]=rawLocale;}
return{map:rawLocaleMap,defaultCode:defaultCode};}
function buildLocale(inputSingular,available){if(typeof inputSingular==='object'&&!Array.isArray(inputSingular)){return parseLocale(inputSingular.code,[inputSingular.code],inputSingular);}
else{return queryLocale(inputSingular,available);}}
function queryLocale(codeArg,available){var codes=[].concat(codeArg||[]);var raw=queryRawLocale(codes,available)||RAW_EN_LOCALE;return parseLocale(codeArg,codes,raw);}
function queryRawLocale(codes,available){for(var i=0;i<codes.length;i++){var parts=codes[i].toLocaleLowerCase().split('-');for(var j=parts.length;j>0;j--){var simpleId=parts.slice(0,j).join('-');if(available[simpleId]){return available[simpleId];}}}
return null;}
function parseLocale(codeArg,codes,raw){var merged=mergeProps([RAW_EN_LOCALE,raw],['buttonText']);delete merged.code;var week=merged.week;delete merged.week;return{codeArg:codeArg,codes:codes,week:week,simpleNumberFormat:new Intl.NumberFormat(codeArg),options:merged};}
var OptionsManager=(function(){function OptionsManager(overrides){this.overrides=__assign({},overrides);this.dynamicOverrides={};this.compute();}
OptionsManager.prototype.mutate=function(updates,removals,isDynamic){if(!Object.keys(updates).length&&!removals.length){return;}
var overrideHash=isDynamic?this.dynamicOverrides:this.overrides;__assign(overrideHash,updates);for(var _i=0,removals_1=removals;_i<removals_1.length;_i++){var propName=removals_1[_i];delete overrideHash[propName];}
this.compute();};OptionsManager.prototype.compute=function(){var locales=firstDefined(this.dynamicOverrides.locales,this.overrides.locales,globalDefaults.locales);var locale=firstDefined(this.dynamicOverrides.locale,this.overrides.locale,globalDefaults.locale);var available=parseRawLocales(locales);var localeDefaults=buildLocale(locale||available.defaultCode,available.map).options;var dir=firstDefined(this.dynamicOverrides.dir,this.overrides.dir,localeDefaults.dir);var dirDefaults=dir==='rtl'?rtlDefaults:{};this.dirDefaults=dirDefaults;this.localeDefaults=localeDefaults;this.computed=mergeOptions([globalDefaults,dirDefaults,localeDefaults,this.overrides,this.dynamicOverrides]);};return OptionsManager;}());var calendarSystemClassMap={};function registerCalendarSystem(name,theClass){calendarSystemClassMap[name]=theClass;}
function createCalendarSystem(name){return new calendarSystemClassMap[name]();}
var GregorianCalendarSystem=(function(){function GregorianCalendarSystem(){}
GregorianCalendarSystem.prototype.getMarkerYear=function(d){return d.getUTCFullYear();};GregorianCalendarSystem.prototype.getMarkerMonth=function(d){return d.getUTCMonth();};GregorianCalendarSystem.prototype.getMarkerDay=function(d){return d.getUTCDate();};GregorianCalendarSystem.prototype.arrayToMarker=function(arr){return arrayToUtcDate(arr);};GregorianCalendarSystem.prototype.markerToArray=function(marker){return dateToUtcArray(marker);};return GregorianCalendarSystem;}());registerCalendarSystem('gregory',GregorianCalendarSystem);var ISO_RE=/^\s*(\d{4})(-(\d{2})(-(\d{2})([T ](\d{2}):(\d{2})(:(\d{2})(\.(\d+))?)?(Z|(([-+])(\d{2})(:?(\d{2}))?))?)?)?)?$/;function parse(str){var m=ISO_RE.exec(str);if(m){var marker=new Date(Date.UTC(Number(m[1]),m[3]?Number(m[3])-1:0,Number(m[5]||1),Number(m[7]||0),Number(m[8]||0),Number(m[10]||0),m[12]?Number('0.'+m[12])*1000:0));if(isValidDate(marker)){var timeZoneOffset=null;if(m[13]){timeZoneOffset=(m[15]==='-'?-1:1)*(Number(m[16]||0)*60+
Number(m[18]||0));}
return{marker:marker,isTimeUnspecified:!m[6],timeZoneOffset:timeZoneOffset};}}
return null;}
var DateEnv=(function(){function DateEnv(settings){var timeZone=this.timeZone=settings.timeZone;var isNamedTimeZone=timeZone!=='local'&&timeZone!=='UTC';if(settings.namedTimeZoneImpl&&isNamedTimeZone){this.namedTimeZoneImpl=new settings.namedTimeZoneImpl(timeZone);}
this.canComputeOffset=Boolean(!isNamedTimeZone||this.namedTimeZoneImpl);this.calendarSystem=createCalendarSystem(settings.calendarSystem);this.locale=settings.locale;this.weekDow=settings.locale.week.dow;this.weekDoy=settings.locale.week.doy;if(settings.weekNumberCalculation==='ISO'){this.weekDow=1;this.weekDoy=4;}
if(typeof settings.firstDay==='number'){this.weekDow=settings.firstDay;}
if(typeof settings.weekNumberCalculation==='function'){this.weekNumberFunc=settings.weekNumberCalculation;}
this.weekLabel=settings.weekLabel!=null?settings.weekLabel:settings.locale.options.weekLabel;this.cmdFormatter=settings.cmdFormatter;}
DateEnv.prototype.createMarker=function(input){var meta=this.createMarkerMeta(input);if(meta===null){return null;}
return meta.marker;};DateEnv.prototype.createNowMarker=function(){if(this.canComputeOffset){return this.timestampToMarker(new Date().valueOf());}
else{return arrayToUtcDate(dateToLocalArray(new Date()));}};DateEnv.prototype.createMarkerMeta=function(input){if(typeof input==='string'){return this.parse(input);}
var marker=null;if(typeof input==='number'){marker=this.timestampToMarker(input);}
else if(input instanceof Date){input=input.valueOf();if(!isNaN(input)){marker=this.timestampToMarker(input);}}
else if(Array.isArray(input)){marker=arrayToUtcDate(input);}
if(marker===null||!isValidDate(marker)){return null;}
return{marker:marker,isTimeUnspecified:false,forcedTzo:null};};DateEnv.prototype.parse=function(s){var parts=parse(s);if(parts===null){return null;}
var marker=parts.marker;var forcedTzo=null;if(parts.timeZoneOffset!==null){if(this.canComputeOffset){marker=this.timestampToMarker(marker.valueOf()-parts.timeZoneOffset*60*1000);}
else{forcedTzo=parts.timeZoneOffset;}}
return{marker:marker,isTimeUnspecified:parts.isTimeUnspecified,forcedTzo:forcedTzo};};DateEnv.prototype.getYear=function(marker){return this.calendarSystem.getMarkerYear(marker);};DateEnv.prototype.getMonth=function(marker){return this.calendarSystem.getMarkerMonth(marker);};DateEnv.prototype.add=function(marker,dur){var a=this.calendarSystem.markerToArray(marker);a[0]+=dur.years;a[1]+=dur.months;a[2]+=dur.days;a[6]+=dur.milliseconds;return this.calendarSystem.arrayToMarker(a);};DateEnv.prototype.subtract=function(marker,dur){var a=this.calendarSystem.markerToArray(marker);a[0]-=dur.years;a[1]-=dur.months;a[2]-=dur.days;a[6]-=dur.milliseconds;return this.calendarSystem.arrayToMarker(a);};DateEnv.prototype.addYears=function(marker,n){var a=this.calendarSystem.markerToArray(marker);a[0]+=n;return this.calendarSystem.arrayToMarker(a);};DateEnv.prototype.addMonths=function(marker,n){var a=this.calendarSystem.markerToArray(marker);a[1]+=n;return this.calendarSystem.arrayToMarker(a);};DateEnv.prototype.diffWholeYears=function(m0,m1){var calendarSystem=this.calendarSystem;if(timeAsMs(m0)===timeAsMs(m1)&&calendarSystem.getMarkerDay(m0)===calendarSystem.getMarkerDay(m1)&&calendarSystem.getMarkerMonth(m0)===calendarSystem.getMarkerMonth(m1)){return calendarSystem.getMarkerYear(m1)-calendarSystem.getMarkerYear(m0);}
return null;};DateEnv.prototype.diffWholeMonths=function(m0,m1){var calendarSystem=this.calendarSystem;if(timeAsMs(m0)===timeAsMs(m1)&&calendarSystem.getMarkerDay(m0)===calendarSystem.getMarkerDay(m1)){return(calendarSystem.getMarkerMonth(m1)-calendarSystem.getMarkerMonth(m0))+
(calendarSystem.getMarkerYear(m1)-calendarSystem.getMarkerYear(m0))*12;}
return null;};DateEnv.prototype.greatestWholeUnit=function(m0,m1){var n=this.diffWholeYears(m0,m1);if(n!==null){return{unit:'year',value:n};}
n=this.diffWholeMonths(m0,m1);if(n!==null){return{unit:'month',value:n};}
n=diffWholeWeeks(m0,m1);if(n!==null){return{unit:'week',value:n};}
n=diffWholeDays(m0,m1);if(n!==null){return{unit:'day',value:n};}
n=diffHours(m0,m1);if(isInt(n)){return{unit:'hour',value:n};}
n=diffMinutes(m0,m1);if(isInt(n)){return{unit:'minute',value:n};}
n=diffSeconds(m0,m1);if(isInt(n)){return{unit:'second',value:n};}
return{unit:'millisecond',value:m1.valueOf()-m0.valueOf()};};DateEnv.prototype.countDurationsBetween=function(m0,m1,d){var diff;if(d.years){diff=this.diffWholeYears(m0,m1);if(diff!==null){return diff/asRoughYears(d);}}
if(d.months){diff=this.diffWholeMonths(m0,m1);if(diff!==null){return diff/asRoughMonths(d);}}
if(d.days){diff=diffWholeDays(m0,m1);if(diff!==null){return diff/asRoughDays(d);}}
return(m1.valueOf()-m0.valueOf())/asRoughMs(d);};DateEnv.prototype.startOf=function(m,unit){if(unit==='year'){return this.startOfYear(m);}
else if(unit==='month'){return this.startOfMonth(m);}
else if(unit==='week'){return this.startOfWeek(m);}
else if(unit==='day'){return startOfDay(m);}
else if(unit==='hour'){return startOfHour(m);}
else if(unit==='minute'){return startOfMinute(m);}
else if(unit==='second'){return startOfSecond(m);}};DateEnv.prototype.startOfYear=function(m){return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(m)]);};DateEnv.prototype.startOfMonth=function(m){return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(m),this.calendarSystem.getMarkerMonth(m)]);};DateEnv.prototype.startOfWeek=function(m){return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(m),this.calendarSystem.getMarkerMonth(m),m.getUTCDate()-((m.getUTCDay()-this.weekDow+7)%7)]);};DateEnv.prototype.computeWeekNumber=function(marker){if(this.weekNumberFunc){return this.weekNumberFunc(this.toDate(marker));}
else{return weekOfYear(marker,this.weekDow,this.weekDoy);}};DateEnv.prototype.format=function(marker,formatter,dateOptions){if(dateOptions===void 0){dateOptions={};}
return formatter.format({marker:marker,timeZoneOffset:dateOptions.forcedTzo!=null?dateOptions.forcedTzo:this.offsetForMarker(marker)},this);};DateEnv.prototype.formatRange=function(start,end,formatter,dateOptions){if(dateOptions===void 0){dateOptions={};}
if(dateOptions.isEndExclusive){end=addMs(end,-1);}
return formatter.formatRange({marker:start,timeZoneOffset:dateOptions.forcedStartTzo!=null?dateOptions.forcedStartTzo:this.offsetForMarker(start)},{marker:end,timeZoneOffset:dateOptions.forcedEndTzo!=null?dateOptions.forcedEndTzo:this.offsetForMarker(end)},this);};DateEnv.prototype.formatIso=function(marker,extraOptions){if(extraOptions===void 0){extraOptions={};}
var timeZoneOffset=null;if(!extraOptions.omitTimeZoneOffset){if(extraOptions.forcedTzo!=null){timeZoneOffset=extraOptions.forcedTzo;}
else{timeZoneOffset=this.offsetForMarker(marker);}}
return buildIsoString(marker,timeZoneOffset,extraOptions.omitTime);};DateEnv.prototype.timestampToMarker=function(ms){if(this.timeZone==='local'){return arrayToUtcDate(dateToLocalArray(new Date(ms)));}
else if(this.timeZone==='UTC'||!this.namedTimeZoneImpl){return new Date(ms);}
else{return arrayToUtcDate(this.namedTimeZoneImpl.timestampToArray(ms));}};DateEnv.prototype.offsetForMarker=function(m){if(this.timeZone==='local'){return-arrayToLocalDate(dateToUtcArray(m)).getTimezoneOffset();}
else if(this.timeZone==='UTC'){return 0;}
else if(this.namedTimeZoneImpl){return this.namedTimeZoneImpl.offsetForArray(dateToUtcArray(m));}
return null;};DateEnv.prototype.toDate=function(m,forcedTzo){if(this.timeZone==='local'){return arrayToLocalDate(dateToUtcArray(m));}
else if(this.timeZone==='UTC'){return new Date(m.valueOf());}
else if(!this.namedTimeZoneImpl){return new Date(m.valueOf()-(forcedTzo||0));}
else{return new Date(m.valueOf()-
this.namedTimeZoneImpl.offsetForArray(dateToUtcArray(m))*1000*60);}};return DateEnv;}());var SIMPLE_SOURCE_PROPS={id:String,allDayDefault:Boolean,eventDataTransform:Function,success:Function,failure:Function};var uid$2=0;function doesSourceNeedRange(eventSource,calendar){var defs=calendar.pluginSystem.hooks.eventSourceDefs;return!defs[eventSource.sourceDefId].ignoreRange;}
function parseEventSource(raw,calendar){var defs=calendar.pluginSystem.hooks.eventSourceDefs;for(var i=defs.length-1;i>=0;i--){var def=defs[i];var meta=def.parseMeta(raw);if(meta){var res=parseEventSourceProps(typeof raw==='object'?raw:{},meta,i,calendar);res._raw=raw;return res;}}
return null;}
function parseEventSourceProps(raw,meta,sourceDefId,calendar){var leftovers0={};var props=refineProps(raw,SIMPLE_SOURCE_PROPS,{},leftovers0);var leftovers1={};var ui=processUnscopedUiProps(leftovers0,calendar,leftovers1);props.isFetching=false;props.latestFetchId='';props.fetchRange=null;props.publicId=String(raw.id||'');props.sourceId=String(uid$2++);props.sourceDefId=sourceDefId;props.meta=meta;props.ui=ui;props.extendedProps=leftovers1;return props;}
function reduceEventSources(eventSources,action,dateProfile,calendar){switch(action.type){case'ADD_EVENT_SOURCES':return addSources(eventSources,action.sources,dateProfile?dateProfile.activeRange:null,calendar);case'REMOVE_EVENT_SOURCE':return removeSource(eventSources,action.sourceId);case'PREV':case'NEXT':case'SET_DATE':case'SET_VIEW_TYPE':if(dateProfile){return fetchDirtySources(eventSources,dateProfile.activeRange,calendar);}
else{return eventSources;}
case'FETCH_EVENT_SOURCES':case'CHANGE_TIMEZONE':return fetchSourcesByIds(eventSources,action.sourceIds?arrayToHash(action.sourceIds):excludeStaticSources(eventSources,calendar),dateProfile?dateProfile.activeRange:null,calendar);case'RECEIVE_EVENTS':case'RECEIVE_EVENT_ERROR':return receiveResponse(eventSources,action.sourceId,action.fetchId,action.fetchRange);case'REMOVE_ALL_EVENT_SOURCES':return{};default:return eventSources;}}
var uid$3=0;function addSources(eventSourceHash,sources,fetchRange,calendar){var hash={};for(var _i=0,sources_1=sources;_i<sources_1.length;_i++){var source=sources_1[_i];hash[source.sourceId]=source;}
if(fetchRange){hash=fetchDirtySources(hash,fetchRange,calendar);}
return __assign({},eventSourceHash,hash);}
function removeSource(eventSourceHash,sourceId){return filterHash(eventSourceHash,function(eventSource){return eventSource.sourceId!==sourceId;});}
function fetchDirtySources(sourceHash,fetchRange,calendar){return fetchSourcesByIds(sourceHash,filterHash(sourceHash,function(eventSource){return isSourceDirty(eventSource,fetchRange,calendar);}),fetchRange,calendar);}
function isSourceDirty(eventSource,fetchRange,calendar){if(!doesSourceNeedRange(eventSource,calendar)){return!eventSource.latestFetchId;}
else{return!calendar.opt('lazyFetching')||!eventSource.fetchRange||eventSource.isFetching||fetchRange.start<eventSource.fetchRange.start||fetchRange.end>eventSource.fetchRange.end;}}
function fetchSourcesByIds(prevSources,sourceIdHash,fetchRange,calendar){var nextSources={};for(var sourceId in prevSources){var source=prevSources[sourceId];if(sourceIdHash[sourceId]){nextSources[sourceId]=fetchSource(source,fetchRange,calendar);}
else{nextSources[sourceId]=source;}}
return nextSources;}
function fetchSource(eventSource,fetchRange,calendar){var sourceDef=calendar.pluginSystem.hooks.eventSourceDefs[eventSource.sourceDefId];var fetchId=String(uid$3++);sourceDef.fetch({eventSource:eventSource,calendar:calendar,range:fetchRange},function(res){var rawEvents=res.rawEvents;var calSuccess=calendar.opt('eventSourceSuccess');var calSuccessRes;var sourceSuccessRes;if(eventSource.success){sourceSuccessRes=eventSource.success(rawEvents,res.xhr);}
if(calSuccess){calSuccessRes=calSuccess(rawEvents,res.xhr);}
rawEvents=sourceSuccessRes||calSuccessRes||rawEvents;calendar.dispatch({type:'RECEIVE_EVENTS',sourceId:eventSource.sourceId,fetchId:fetchId,fetchRange:fetchRange,rawEvents:rawEvents});},function(error){var callFailure=calendar.opt('eventSourceFailure');console.warn(error.message,error);if(eventSource.failure){eventSource.failure(error);}
if(callFailure){callFailure(error);}
calendar.dispatch({type:'RECEIVE_EVENT_ERROR',sourceId:eventSource.sourceId,fetchId:fetchId,fetchRange:fetchRange,error:error});});return __assign({},eventSource,{isFetching:true,latestFetchId:fetchId});}
function receiveResponse(sourceHash,sourceId,fetchId,fetchRange){var _a;var eventSource=sourceHash[sourceId];if(eventSource&&fetchId===eventSource.latestFetchId){return __assign({},sourceHash,(_a={},_a[sourceId]=__assign({},eventSource,{isFetching:false,fetchRange:fetchRange}),_a));}
return sourceHash;}
function excludeStaticSources(eventSources,calendar){return filterHash(eventSources,function(eventSource){return doesSourceNeedRange(eventSource,calendar);});}
var DateProfileGenerator=(function(){function DateProfileGenerator(viewSpec,calendar){this.viewSpec=viewSpec;this.options=viewSpec.options;this.dateEnv=calendar.dateEnv;this.calendar=calendar;this.initHiddenDays();}
DateProfileGenerator.prototype.buildPrev=function(currentDateProfile,currentDate){var dateEnv=this.dateEnv;var prevDate=dateEnv.subtract(dateEnv.startOf(currentDate,currentDateProfile.currentRangeUnit),currentDateProfile.dateIncrement);return this.build(prevDate,-1);};DateProfileGenerator.prototype.buildNext=function(currentDateProfile,currentDate){var dateEnv=this.dateEnv;var nextDate=dateEnv.add(dateEnv.startOf(currentDate,currentDateProfile.currentRangeUnit),currentDateProfile.dateIncrement);return this.build(nextDate,1);};DateProfileGenerator.prototype.build=function(currentDate,direction,forceToValid){if(forceToValid===void 0){forceToValid=false;}
var validRange;var minTime=null;var maxTime=null;var currentInfo;var isRangeAllDay;var renderRange;var activeRange;var isValid;validRange=this.buildValidRange();validRange=this.trimHiddenDays(validRange);if(forceToValid){currentDate=constrainMarkerToRange(currentDate,validRange);}
currentInfo=this.buildCurrentRangeInfo(currentDate,direction);isRangeAllDay=/^(year|month|week|day)$/.test(currentInfo.unit);renderRange=this.buildRenderRange(this.trimHiddenDays(currentInfo.range),currentInfo.unit,isRangeAllDay);renderRange=this.trimHiddenDays(renderRange);activeRange=renderRange;if(!this.options.showNonCurrentDates){activeRange=intersectRanges(activeRange,currentInfo.range);}
minTime=createDuration(this.options.minTime);maxTime=createDuration(this.options.maxTime);activeRange=this.adjustActiveRange(activeRange,minTime,maxTime);activeRange=intersectRanges(activeRange,validRange);isValid=rangesIntersect(currentInfo.range,validRange);return{validRange:validRange,currentRange:currentInfo.range,currentRangeUnit:currentInfo.unit,isRangeAllDay:isRangeAllDay,activeRange:activeRange,renderRange:renderRange,minTime:minTime,maxTime:maxTime,isValid:isValid,dateIncrement:this.buildDateIncrement(currentInfo.duration)};};DateProfileGenerator.prototype.buildValidRange=function(){return this.getRangeOption('validRange',this.calendar.getNow())||{start:null,end:null};};DateProfileGenerator.prototype.buildCurrentRangeInfo=function(date,direction){var _a=this,viewSpec=_a.viewSpec,dateEnv=_a.dateEnv;var duration=null;var unit=null;var range=null;var dayCount;if(viewSpec.duration){duration=viewSpec.duration;unit=viewSpec.durationUnit;range=this.buildRangeFromDuration(date,direction,duration,unit);}
else if((dayCount=this.options.dayCount)){unit='day';range=this.buildRangeFromDayCount(date,direction,dayCount);}
else if((range=this.buildCustomVisibleRange(date))){unit=dateEnv.greatestWholeUnit(range.start,range.end).unit;}
else{duration=this.getFallbackDuration();unit=greatestDurationDenominator(duration).unit;range=this.buildRangeFromDuration(date,direction,duration,unit);}
return{duration:duration,unit:unit,range:range};};DateProfileGenerator.prototype.getFallbackDuration=function(){return createDuration({day:1});};DateProfileGenerator.prototype.adjustActiveRange=function(range,minTime,maxTime){var dateEnv=this.dateEnv;var start=range.start;var end=range.end;if(this.viewSpec.class.prototype.usesMinMaxTime){if(asRoughDays(minTime)<0){start=startOfDay(start);start=dateEnv.add(start,minTime);}
if(asRoughDays(maxTime)>1){end=startOfDay(end);end=addDays(end,-1);end=dateEnv.add(end,maxTime);}}
return{start:start,end:end};};DateProfileGenerator.prototype.buildRangeFromDuration=function(date,direction,duration,unit){var dateEnv=this.dateEnv;var alignment=this.options.dateAlignment;var dateIncrementInput;var dateIncrementDuration;var start;var end;var res;if(!alignment){dateIncrementInput=this.options.dateIncrement;if(dateIncrementInput){dateIncrementDuration=createDuration(dateIncrementInput);if(asRoughMs(dateIncrementDuration)<asRoughMs(duration)){alignment=greatestDurationDenominator(dateIncrementDuration,!getWeeksFromInput(dateIncrementInput)).unit;}
else{alignment=unit;}}
else{alignment=unit;}}
if(asRoughDays(duration)<=1){if(this.isHiddenDay(start)){start=this.skipHiddenDays(start,direction);start=startOfDay(start);}}
function computeRes(){start=dateEnv.startOf(date,alignment);end=dateEnv.add(start,duration);res={start:start,end:end};}
computeRes();if(!this.trimHiddenDays(res)){date=this.skipHiddenDays(date,direction);computeRes();}
return res;};DateProfileGenerator.prototype.buildRangeFromDayCount=function(date,direction,dayCount){var dateEnv=this.dateEnv;var customAlignment=this.options.dateAlignment;var runningCount=0;var start=date;var end;if(customAlignment){start=dateEnv.startOf(start,customAlignment);}
start=startOfDay(start);start=this.skipHiddenDays(start,direction);end=start;do{end=addDays(end,1);if(!this.isHiddenDay(end)){runningCount++;}}while(runningCount<dayCount);return{start:start,end:end};};DateProfileGenerator.prototype.buildCustomVisibleRange=function(date){var dateEnv=this.dateEnv;var visibleRange=this.getRangeOption('visibleRange',dateEnv.toDate(date));if(visibleRange&&(visibleRange.start==null||visibleRange.end==null)){return null;}
return visibleRange;};DateProfileGenerator.prototype.buildRenderRange=function(currentRange,currentRangeUnit,isRangeAllDay){return currentRange;};DateProfileGenerator.prototype.buildDateIncrement=function(fallback){var dateIncrementInput=this.options.dateIncrement;var customAlignment;if(dateIncrementInput){return createDuration(dateIncrementInput);}
else if((customAlignment=this.options.dateAlignment)){return createDuration(1,customAlignment);}
else if(fallback){return fallback;}
else{return createDuration({days:1});}};DateProfileGenerator.prototype.getRangeOption=function(name){var otherArgs=[];for(var _i=1;_i<arguments.length;_i++){otherArgs[_i-1]=arguments[_i];}
var val=this.options[name];if(typeof val==='function'){val=val.apply(null,otherArgs);}
if(val){val=parseRange(val,this.dateEnv);}
if(val){val=computeVisibleDayRange(val);}
return val;};DateProfileGenerator.prototype.initHiddenDays=function(){var hiddenDays=this.options.hiddenDays||[];var isHiddenDayHash=[];var dayCnt=0;var i;if(this.options.weekends===false){hiddenDays.push(0,6);}
for(i=0;i<7;i++){if(!(isHiddenDayHash[i]=hiddenDays.indexOf(i)!==-1)){dayCnt++;}}
if(!dayCnt){throw new Error('invalid hiddenDays');}
this.isHiddenDayHash=isHiddenDayHash;};DateProfileGenerator.prototype.trimHiddenDays=function(range){var start=range.start;var end=range.end;if(start){start=this.skipHiddenDays(start);}
if(end){end=this.skipHiddenDays(end,-1,true);}
if(start==null||end==null||start<end){return{start:start,end:end};}
return null;};DateProfileGenerator.prototype.isHiddenDay=function(day){if(day instanceof Date){day=day.getUTCDay();}
return this.isHiddenDayHash[day];};DateProfileGenerator.prototype.skipHiddenDays=function(date,inc,isExclusive){if(inc===void 0){inc=1;}
if(isExclusive===void 0){isExclusive=false;}
while(this.isHiddenDayHash[(date.getUTCDay()+(isExclusive?inc:0)+7)%7]){date=addDays(date,inc);}
return date;};return DateProfileGenerator;}());function isDateProfilesEqual(p0,p1){return rangesEqual(p0.validRange,p1.validRange)&&rangesEqual(p0.activeRange,p1.activeRange)&&rangesEqual(p0.renderRange,p1.renderRange)&&durationsEqual(p0.minTime,p1.minTime)&&durationsEqual(p0.maxTime,p1.maxTime);}
function reduce(state,action,calendar){var viewType=reduceViewType(state.viewType,action);var dateProfile=reduceDateProfile(state.dateProfile,action,state.currentDate,viewType,calendar);var eventSources=reduceEventSources(state.eventSources,action,dateProfile,calendar);var nextState=__assign({},state,{viewType:viewType,dateProfile:dateProfile,currentDate:reduceCurrentDate(state.currentDate,action,dateProfile),eventSources:eventSources,eventStore:reduceEventStore(state.eventStore,action,eventSources,dateProfile,calendar),dateSelection:reduceDateSelection(state.dateSelection,action,calendar),eventSelection:reduceSelectedEvent(state.eventSelection,action),eventDrag:reduceEventDrag(state.eventDrag,action,eventSources,calendar),eventResize:reduceEventResize(state.eventResize,action,eventSources,calendar),eventSourceLoadingLevel:computeLoadingLevel(eventSources),loadingLevel:computeLoadingLevel(eventSources)});for(var _i=0,_a=calendar.pluginSystem.hooks.reducers;_i<_a.length;_i++){var reducerFunc=_a[_i];nextState=reducerFunc(nextState,action,calendar);}
return nextState;}
function reduceViewType(currentViewType,action){switch(action.type){case'SET_VIEW_TYPE':return action.viewType;default:return currentViewType;}}
function reduceDateProfile(currentDateProfile,action,currentDate,viewType,calendar){var newDateProfile;switch(action.type){case'PREV':newDateProfile=calendar.dateProfileGenerators[viewType].buildPrev(currentDateProfile,currentDate);break;case'NEXT':newDateProfile=calendar.dateProfileGenerators[viewType].buildNext(currentDateProfile,currentDate);break;case'SET_DATE':if(!currentDateProfile.activeRange||!rangeContainsMarker(currentDateProfile.currentRange,action.dateMarker)){newDateProfile=calendar.dateProfileGenerators[viewType].build(action.dateMarker,undefined,true);}
break;case'SET_VIEW_TYPE':var generator=calendar.dateProfileGenerators[viewType];if(!generator){throw new Error(viewType?'The FullCalendar view "'+viewType+'" does not exist. Make sure your plugins are loaded correctly.':'No available FullCalendar view plugins.');}
newDateProfile=generator.build(action.dateMarker||currentDate,undefined,true);break;}
if(newDateProfile&&newDateProfile.isValid&&!(currentDateProfile&&isDateProfilesEqual(currentDateProfile,newDateProfile))){return newDateProfile;}
else{return currentDateProfile;}}
function reduceCurrentDate(currentDate,action,dateProfile){switch(action.type){case'PREV':case'NEXT':if(!rangeContainsMarker(dateProfile.currentRange,currentDate)){return dateProfile.currentRange.start;}
else{return currentDate;}
case'SET_DATE':case'SET_VIEW_TYPE':var newDate=action.dateMarker||currentDate;if(dateProfile.activeRange&&!rangeContainsMarker(dateProfile.activeRange,newDate)){return dateProfile.currentRange.start;}
else{return newDate;}
default:return currentDate;}}
function reduceDateSelection(currentSelection,action,calendar){switch(action.type){case'SELECT_DATES':return action.selection;case'UNSELECT_DATES':return null;default:return currentSelection;}}
function reduceSelectedEvent(currentInstanceId,action){switch(action.type){case'SELECT_EVENT':return action.eventInstanceId;case'UNSELECT_EVENT':return'';default:return currentInstanceId;}}
function reduceEventDrag(currentDrag,action,sources,calendar){switch(action.type){case'SET_EVENT_DRAG':var newDrag=action.state;return{affectedEvents:newDrag.affectedEvents,mutatedEvents:newDrag.mutatedEvents,isEvent:newDrag.isEvent,origSeg:newDrag.origSeg};case'UNSET_EVENT_DRAG':return null;default:return currentDrag;}}
function reduceEventResize(currentResize,action,sources,calendar){switch(action.type){case'SET_EVENT_RESIZE':var newResize=action.state;return{affectedEvents:newResize.affectedEvents,mutatedEvents:newResize.mutatedEvents,isEvent:newResize.isEvent,origSeg:newResize.origSeg};case'UNSET_EVENT_RESIZE':return null;default:return currentResize;}}
function computeLoadingLevel(eventSources){var cnt=0;for(var sourceId in eventSources){if(eventSources[sourceId].isFetching){cnt++;}}
return cnt;}
var STANDARD_PROPS={start:null,end:null,allDay:Boolean};function parseDateSpan(raw,dateEnv,defaultDuration){var span=parseOpenDateSpan(raw,dateEnv);var range=span.range;if(!range.start){return null;}
if(!range.end){if(defaultDuration==null){return null;}
else{range.end=dateEnv.add(range.start,defaultDuration);}}
return span;}
function parseOpenDateSpan(raw,dateEnv){var leftovers={};var standardProps=refineProps(raw,STANDARD_PROPS,{},leftovers);var startMeta=standardProps.start?dateEnv.createMarkerMeta(standardProps.start):null;var endMeta=standardProps.end?dateEnv.createMarkerMeta(standardProps.end):null;var allDay=standardProps.allDay;if(allDay==null){allDay=(startMeta&&startMeta.isTimeUnspecified)&&(!endMeta||endMeta.isTimeUnspecified);}
leftovers.range={start:startMeta?startMeta.marker:null,end:endMeta?endMeta.marker:null};leftovers.allDay=allDay;return leftovers;}
function isDateSpansEqual(span0,span1){return rangesEqual(span0.range,span1.range)&&span0.allDay===span1.allDay&&isSpanPropsEqual(span0,span1);}
function isSpanPropsEqual(span0,span1){for(var propName in span1){if(propName!=='range'&&propName!=='allDay'){if(span0[propName]!==span1[propName]){return false;}}}
for(var propName in span0){if(!(propName in span1)){return false;}}
return true;}
function buildDateSpanApi(span,dateEnv){return{start:dateEnv.toDate(span.range.start),end:dateEnv.toDate(span.range.end),startStr:dateEnv.formatIso(span.range.start,{omitTime:span.allDay}),endStr:dateEnv.formatIso(span.range.end,{omitTime:span.allDay}),allDay:span.allDay};}
function buildDatePointApi(span,dateEnv){return{date:dateEnv.toDate(span.range.start),dateStr:dateEnv.formatIso(span.range.start,{omitTime:span.allDay}),allDay:span.allDay};}
function fabricateEventRange(dateSpan,eventUiBases,calendar){var def=parseEventDef({editable:false},'',dateSpan.allDay,true,calendar);return{def:def,ui:compileEventUi(def,eventUiBases),instance:createEventInstance(def.defId,dateSpan.range),range:dateSpan.range,isStart:true,isEnd:true};}
function compileViewDefs(defaultConfigs,overrideConfigs){var hash={};var viewType;for(viewType in defaultConfigs){ensureViewDef(viewType,hash,defaultConfigs,overrideConfigs);}
for(viewType in overrideConfigs){ensureViewDef(viewType,hash,defaultConfigs,overrideConfigs);}
return hash;}
function ensureViewDef(viewType,hash,defaultConfigs,overrideConfigs){if(hash[viewType]){return hash[viewType];}
var viewDef=buildViewDef(viewType,hash,defaultConfigs,overrideConfigs);if(viewDef){hash[viewType]=viewDef;}
return viewDef;}
function buildViewDef(viewType,hash,defaultConfigs,overrideConfigs){var defaultConfig=defaultConfigs[viewType];var overrideConfig=overrideConfigs[viewType];var queryProp=function(name){return(defaultConfig&&defaultConfig[name]!==null)?defaultConfig[name]:((overrideConfig&&overrideConfig[name]!==null)?overrideConfig[name]:null);};var theClass=queryProp('class');var superType=queryProp('superType');if(!superType&&theClass){superType=findViewNameBySubclass(theClass,overrideConfigs)||findViewNameBySubclass(theClass,defaultConfigs);}
var superDef=null;if(superType){if(superType===viewType){throw new Error('Can\'t have a custom view type that references itself');}
superDef=ensureViewDef(superType,hash,defaultConfigs,overrideConfigs);}
if(!theClass&&superDef){theClass=superDef.class;}
if(!theClass){return null;}
return{type:viewType,class:theClass,defaults:__assign({},(superDef?superDef.defaults:{}),(defaultConfig?defaultConfig.options:{})),overrides:__assign({},(superDef?superDef.overrides:{}),(overrideConfig?overrideConfig.options:{}))};}
function findViewNameBySubclass(viewSubclass,configs){var superProto=Object.getPrototypeOf(viewSubclass.prototype);for(var viewType in configs){var parsed=configs[viewType];if(parsed.class&&parsed.class.prototype===superProto){return viewType;}}
return'';}
function parseViewConfigs(inputs){return mapHash(inputs,parseViewConfig);}
var VIEW_DEF_PROPS={type:String,class:null};function parseViewConfig(input){if(typeof input==='function'){input={class:input};}
var options={};var props=refineProps(input,VIEW_DEF_PROPS,{},options);return{superType:props.type,class:props.class,options:options};}
function buildViewSpecs(defaultInputs,optionsManager){var defaultConfigs=parseViewConfigs(defaultInputs);var overrideConfigs=parseViewConfigs(optionsManager.overrides.views);var viewDefs=compileViewDefs(defaultConfigs,overrideConfigs);return mapHash(viewDefs,function(viewDef){return buildViewSpec(viewDef,overrideConfigs,optionsManager);});}
function buildViewSpec(viewDef,overrideConfigs,optionsManager){var durationInput=viewDef.overrides.duration||viewDef.defaults.duration||optionsManager.dynamicOverrides.duration||optionsManager.overrides.duration;var duration=null;var durationUnit='';var singleUnit='';var singleUnitOverrides={};if(durationInput){duration=createDuration(durationInput);if(duration){var denom=greatestDurationDenominator(duration,!getWeeksFromInput(durationInput));durationUnit=denom.unit;if(denom.value===1){singleUnit=durationUnit;singleUnitOverrides=overrideConfigs[durationUnit]?overrideConfigs[durationUnit].options:{};}}}
var queryButtonText=function(options){var buttonTextMap=options.buttonText||{};var buttonTextKey=viewDef.defaults.buttonTextKey;if(buttonTextKey!=null&&buttonTextMap[buttonTextKey]!=null){return buttonTextMap[buttonTextKey];}
if(buttonTextMap[viewDef.type]!=null){return buttonTextMap[viewDef.type];}
if(buttonTextMap[singleUnit]!=null){return buttonTextMap[singleUnit];}};return{type:viewDef.type,class:viewDef.class,duration:duration,durationUnit:durationUnit,singleUnit:singleUnit,options:__assign({},globalDefaults,viewDef.defaults,optionsManager.dirDefaults,optionsManager.localeDefaults,optionsManager.overrides,singleUnitOverrides,viewDef.overrides,optionsManager.dynamicOverrides),buttonTextOverride:queryButtonText(optionsManager.dynamicOverrides)||queryButtonText(optionsManager.overrides)||viewDef.overrides.buttonText,buttonTextDefault:queryButtonText(optionsManager.localeDefaults)||queryButtonText(optionsManager.dirDefaults)||viewDef.defaults.buttonText||queryButtonText(globalDefaults)||viewDef.type};}
var Toolbar=(function(_super){__extends(Toolbar,_super);function Toolbar(extraClassName){var _this=_super.call(this)||this;_this._renderLayout=memoizeRendering(_this.renderLayout,_this.unrenderLayout);_this._updateTitle=memoizeRendering(_this.updateTitle,null,[_this._renderLayout]);_this._updateActiveButton=memoizeRendering(_this.updateActiveButton,null,[_this._renderLayout]);_this._updateToday=memoizeRendering(_this.updateToday,null,[_this._renderLayout]);_this._updatePrev=memoizeRendering(_this.updatePrev,null,[_this._renderLayout]);_this._updateNext=memoizeRendering(_this.updateNext,null,[_this._renderLayout]);_this.el=createElement('div',{className:'fc-toolbar '+extraClassName});return _this;}
Toolbar.prototype.destroy=function(){_super.prototype.destroy.call(this);this._renderLayout.unrender();removeElement(this.el);};Toolbar.prototype.render=function(props){this._renderLayout(props.layout);this._updateTitle(props.title);this._updateActiveButton(props.activeButton);this._updateToday(props.isTodayEnabled);this._updatePrev(props.isPrevEnabled);this._updateNext(props.isNextEnabled);};Toolbar.prototype.renderLayout=function(layout){var el=this.el;this.viewsWithButtons=[];appendToElement(el,this.renderSection('left',layout.left));appendToElement(el,this.renderSection('center',layout.center));appendToElement(el,this.renderSection('right',layout.right));};Toolbar.prototype.unrenderLayout=function(){this.el.innerHTML='';};Toolbar.prototype.renderSection=function(position,buttonStr){var _this=this;var _a=this.context,theme=_a.theme,calendar=_a.calendar;var optionsManager=calendar.optionsManager;var viewSpecs=calendar.viewSpecs;var sectionEl=createElement('div',{className:'fc-'+position});var calendarCustomButtons=optionsManager.computed.customButtons||{};var calendarButtonTextOverrides=optionsManager.overrides.buttonText||{};var calendarButtonText=optionsManager.computed.buttonText||{};if(buttonStr){buttonStr.split(' ').forEach(function(buttonGroupStr,i){var groupChildren=[];var isOnlyButtons=true;var groupEl;buttonGroupStr.split(',').forEach(function(buttonName,j){var customButtonProps;var viewSpec;var buttonClick;var buttonIcon;var buttonText;var buttonInnerHtml;var buttonClasses;var buttonEl;var buttonAriaAttr;if(buttonName==='title'){groupChildren.push(htmlToElement('<h2>&nbsp;</h2>'));isOnlyButtons=false;}
else{if((customButtonProps=calendarCustomButtons[buttonName])){buttonClick=function(ev){if(customButtonProps.click){customButtonProps.click.call(buttonEl,ev);}};(buttonIcon=theme.getCustomButtonIconClass(customButtonProps))||(buttonIcon=theme.getIconClass(buttonName))||(buttonText=customButtonProps.text);}
else if((viewSpec=viewSpecs[buttonName])){_this.viewsWithButtons.push(buttonName);buttonClick=function(){calendar.changeView(buttonName);};(buttonText=viewSpec.buttonTextOverride)||(buttonIcon=theme.getIconClass(buttonName))||(buttonText=viewSpec.buttonTextDefault);}
else if(calendar[buttonName]){buttonClick=function(){calendar[buttonName]();};(buttonText=calendarButtonTextOverrides[buttonName])||(buttonIcon=theme.getIconClass(buttonName))||(buttonText=calendarButtonText[buttonName]);}
if(buttonClick){buttonClasses=['fc-'+buttonName+'-button',theme.getClass('button')];if(buttonText){buttonInnerHtml=htmlEscape(buttonText);buttonAriaAttr='';}
else if(buttonIcon){buttonInnerHtml="<span class='"+buttonIcon+"'></span>";buttonAriaAttr=' aria-label="'+buttonName+'"';}
buttonEl=htmlToElement('<button type="button" class="'+buttonClasses.join(' ')+'"'+
buttonAriaAttr+'>'+buttonInnerHtml+'</button>');buttonEl.addEventListener('click',buttonClick);groupChildren.push(buttonEl);}}});if(groupChildren.length>1){groupEl=document.createElement('div');var buttonGroupClassName=theme.getClass('buttonGroup');if(isOnlyButtons&&buttonGroupClassName){groupEl.classList.add(buttonGroupClassName);}
appendToElement(groupEl,groupChildren);sectionEl.appendChild(groupEl);}
else{appendToElement(sectionEl,groupChildren);}});}
return sectionEl;};Toolbar.prototype.updateToday=function(isTodayEnabled){this.toggleButtonEnabled('today',isTodayEnabled);};Toolbar.prototype.updatePrev=function(isPrevEnabled){this.toggleButtonEnabled('prev',isPrevEnabled);};Toolbar.prototype.updateNext=function(isNextEnabled){this.toggleButtonEnabled('next',isNextEnabled);};Toolbar.prototype.updateTitle=function(text){findElements(this.el,'h2').forEach(function(titleEl){titleEl.innerText=text;});};Toolbar.prototype.updateActiveButton=function(buttonName){var theme=this.context.theme;var className=theme.getClass('buttonActive');findElements(this.el,'button').forEach(function(buttonEl){if(buttonName&&buttonEl.classList.contains('fc-'+buttonName+'-button')){buttonEl.classList.add(className);}
else{buttonEl.classList.remove(className);}});};Toolbar.prototype.toggleButtonEnabled=function(buttonName,bool){findElements(this.el,'.fc-'+buttonName+'-button').forEach(function(buttonEl){buttonEl.disabled=!bool;});};return Toolbar;}(Component));var CalendarComponent=(function(_super){__extends(CalendarComponent,_super);function CalendarComponent(el){var _this=_super.call(this)||this;_this.elClassNames=[];_this.renderSkeleton=memoizeRendering(_this._renderSkeleton,_this._unrenderSkeleton);_this.renderToolbars=memoizeRendering(_this._renderToolbars,_this._unrenderToolbars,[_this.renderSkeleton]);_this.buildComponentContext=memoize(buildComponentContext);_this.buildViewPropTransformers=memoize(buildViewPropTransformers);_this.el=el;_this.computeTitle=memoize(computeTitle);_this.parseBusinessHours=memoize(function(input){return parseBusinessHours(input,_this.context.calendar);});return _this;}
CalendarComponent.prototype.render=function(props,context){this.freezeHeight();var title=this.computeTitle(props.dateProfile,props.viewSpec.options);this.renderSkeleton(context);this.renderToolbars(props.viewSpec,props.dateProfile,props.currentDate,title);this.renderView(props,title);this.updateSize();this.thawHeight();};CalendarComponent.prototype.destroy=function(){if(this.header){this.header.destroy();}
if(this.footer){this.footer.destroy();}
this.renderSkeleton.unrender();_super.prototype.destroy.call(this);};CalendarComponent.prototype._renderSkeleton=function(context){this.updateElClassNames(context);prependToElement(this.el,this.contentEl=createElement('div',{className:'fc-view-container'}));var calendar=context.calendar;for(var _i=0,_a=calendar.pluginSystem.hooks.viewContainerModifiers;_i<_a.length;_i++){var modifyViewContainer=_a[_i];modifyViewContainer(this.contentEl,calendar);}};CalendarComponent.prototype._unrenderSkeleton=function(){if(this.view){this.savedScroll=this.view.queryScroll();this.view.destroy();this.view=null;}
removeElement(this.contentEl);this.removeElClassNames();};CalendarComponent.prototype.removeElClassNames=function(){var classList=this.el.classList;for(var _i=0,_a=this.elClassNames;_i<_a.length;_i++){var className=_a[_i];classList.remove(className);}
this.elClassNames=[];};CalendarComponent.prototype.updateElClassNames=function(context){this.removeElClassNames();var theme=context.theme,options=context.options;this.elClassNames=['fc','fc-'+options.dir,theme.getClass('widget')];var classList=this.el.classList;for(var _i=0,_a=this.elClassNames;_i<_a.length;_i++){var className=_a[_i];classList.add(className);}};CalendarComponent.prototype._renderToolbars=function(viewSpec,dateProfile,currentDate,title){var _a=this,context=_a.context,header=_a.header,footer=_a.footer;var options=context.options,calendar=context.calendar;var headerLayout=options.header;var footerLayout=options.footer;var dateProfileGenerator=this.props.dateProfileGenerator;var now=calendar.getNow();var todayInfo=dateProfileGenerator.build(now);var prevInfo=dateProfileGenerator.buildPrev(dateProfile,currentDate);var nextInfo=dateProfileGenerator.buildNext(dateProfile,currentDate);var toolbarProps={title:title,activeButton:viewSpec.type,isTodayEnabled:todayInfo.isValid&&!rangeContainsMarker(dateProfile.currentRange,now),isPrevEnabled:prevInfo.isValid,isNextEnabled:nextInfo.isValid};if(headerLayout){if(!header){header=this.header=new Toolbar('fc-header-toolbar');prependToElement(this.el,header.el);}
header.receiveProps(__assign({layout:headerLayout},toolbarProps),context);}
else if(header){header.destroy();header=this.header=null;}
if(footerLayout){if(!footer){footer=this.footer=new Toolbar('fc-footer-toolbar');appendToElement(this.el,footer.el);}
footer.receiveProps(__assign({layout:footerLayout},toolbarProps),context);}
else if(footer){footer.destroy();footer=this.footer=null;}};CalendarComponent.prototype._unrenderToolbars=function(){if(this.header){this.header.destroy();this.header=null;}
if(this.footer){this.footer.destroy();this.footer=null;}};CalendarComponent.prototype.renderView=function(props,title){var view=this.view;var _a=this.context,calendar=_a.calendar,options=_a.options;var viewSpec=props.viewSpec,dateProfileGenerator=props.dateProfileGenerator;if(!view||view.viewSpec!==viewSpec){if(view){view.destroy();}
view=this.view=new viewSpec['class'](viewSpec,this.contentEl);if(this.savedScroll){view.addScroll(this.savedScroll,true);this.savedScroll=null;}}
view.title=title;var viewProps={dateProfileGenerator:dateProfileGenerator,dateProfile:props.dateProfile,businessHours:this.parseBusinessHours(viewSpec.options.businessHours),eventStore:props.eventStore,eventUiBases:props.eventUiBases,dateSelection:props.dateSelection,eventSelection:props.eventSelection,eventDrag:props.eventDrag,eventResize:props.eventResize};var transformers=this.buildViewPropTransformers(calendar.pluginSystem.hooks.viewPropsTransformers);for(var _i=0,transformers_1=transformers;_i<transformers_1.length;_i++){var transformer=transformers_1[_i];__assign(viewProps,transformer.transform(viewProps,viewSpec,props,options));}
view.receiveProps(viewProps,this.buildComponentContext(this.context,viewSpec,view));};CalendarComponent.prototype.updateSize=function(isResize){if(isResize===void 0){isResize=false;}
var view=this.view;if(!view){return;}
if(isResize||this.isHeightAuto==null){this.computeHeightVars();}
view.updateSize(isResize,this.viewHeight,this.isHeightAuto);view.updateNowIndicator();view.popScroll(isResize);};CalendarComponent.prototype.computeHeightVars=function(){var calendar=this.context.calendar;var heightInput=calendar.opt('height');var contentHeightInput=calendar.opt('contentHeight');this.isHeightAuto=heightInput==='auto'||contentHeightInput==='auto';if(typeof contentHeightInput==='number'){this.viewHeight=contentHeightInput;}
else if(typeof contentHeightInput==='function'){this.viewHeight=contentHeightInput();}
else if(typeof heightInput==='number'){this.viewHeight=heightInput-this.queryToolbarsHeight();}
else if(typeof heightInput==='function'){this.viewHeight=heightInput()-this.queryToolbarsHeight();}
else if(heightInput==='parent'){var parentEl=this.el.parentNode;this.viewHeight=parentEl.getBoundingClientRect().height-this.queryToolbarsHeight();}
else{this.viewHeight=Math.round(this.contentEl.getBoundingClientRect().width/Math.max(calendar.opt('aspectRatio'),.5));}};CalendarComponent.prototype.queryToolbarsHeight=function(){var height=0;if(this.header){height+=computeHeightAndMargins(this.header.el);}
if(this.footer){height+=computeHeightAndMargins(this.footer.el);}
return height;};CalendarComponent.prototype.freezeHeight=function(){applyStyle(this.el,{height:this.el.getBoundingClientRect().height,overflow:'hidden'});};CalendarComponent.prototype.thawHeight=function(){applyStyle(this.el,{height:'',overflow:''});};return CalendarComponent;}(Component));function computeTitle(dateProfile,viewOptions){var range;if(/^(year|month)$/.test(dateProfile.currentRangeUnit)){range=dateProfile.currentRange;}
else{range=dateProfile.activeRange;}
return this.context.dateEnv.formatRange(range.start,range.end,createFormatter(viewOptions.titleFormat||computeTitleFormat(dateProfile),viewOptions.titleRangeSeparator),{isEndExclusive:dateProfile.isRangeAllDay});}
function computeTitleFormat(dateProfile){var currentRangeUnit=dateProfile.currentRangeUnit;if(currentRangeUnit==='year'){return{year:'numeric'};}
else if(currentRangeUnit==='month'){return{year:'numeric',month:'long'};}
else{var days=diffWholeDays(dateProfile.currentRange.start,dateProfile.currentRange.end);if(days!==null&&days>1){return{year:'numeric',month:'short',day:'numeric'};}
else{return{year:'numeric',month:'long',day:'numeric'};}}}
function buildComponentContext(context,viewSpec,view){return context.extend(viewSpec.options,view);}
function buildViewPropTransformers(theClasses){return theClasses.map(function(theClass){return new theClass();});}
var Interaction=(function(){function Interaction(settings){this.component=settings.component;}
Interaction.prototype.destroy=function(){};return Interaction;}());function parseInteractionSettings(component,input){return{component:component,el:input.el,useEventCenter:input.useEventCenter!=null?input.useEventCenter:true};}
function interactionSettingsToStore(settings){var _a;return _a={},_a[settings.component.uid]=settings,_a;}
var interactionSettingsStore={};var EventClicking=(function(_super){__extends(EventClicking,_super);function EventClicking(settings){var _this=_super.call(this,settings)||this;_this.handleSegClick=function(ev,segEl){var component=_this.component;var _a=component.context,calendar=_a.calendar,view=_a.view;var seg=getElSeg(segEl);if(seg&&component.isValidSegDownEl(ev.target)){var hasUrlContainer=elementClosest(ev.target,'.fc-has-url');var url=hasUrlContainer?hasUrlContainer.querySelector('a[href]').href:'';calendar.publiclyTrigger('eventClick',[{el:segEl,event:new EventApi(component.context.calendar,seg.eventRange.def,seg.eventRange.instance),jsEvent:ev,view:view}]);if(url&&!ev.defaultPrevented){window.location.href=url;}}};var component=settings.component;_this.destroy=listenBySelector(component.el,'click',component.fgSegSelector+','+component.bgSegSelector,_this.handleSegClick);return _this;}
return EventClicking;}(Interaction));var EventHovering=(function(_super){__extends(EventHovering,_super);function EventHovering(settings){var _this=_super.call(this,settings)||this;_this.handleEventElRemove=function(el){if(el===_this.currentSegEl){_this.handleSegLeave(null,_this.currentSegEl);}};_this.handleSegEnter=function(ev,segEl){if(getElSeg(segEl)){segEl.classList.add('fc-allow-mouse-resize');_this.currentSegEl=segEl;_this.triggerEvent('eventMouseEnter',ev,segEl);}};_this.handleSegLeave=function(ev,segEl){if(_this.currentSegEl){segEl.classList.remove('fc-allow-mouse-resize');_this.currentSegEl=null;_this.triggerEvent('eventMouseLeave',ev,segEl);}};var component=settings.component;_this.removeHoverListeners=listenToHoverBySelector(component.el,component.fgSegSelector+','+component.bgSegSelector,_this.handleSegEnter,_this.handleSegLeave);component.context.calendar.on('eventElRemove',_this.handleEventElRemove);return _this;}
EventHovering.prototype.destroy=function(){this.removeHoverListeners();this.component.context.calendar.off('eventElRemove',this.handleEventElRemove);};EventHovering.prototype.triggerEvent=function(publicEvName,ev,segEl){var component=this.component;var _a=component.context,calendar=_a.calendar,view=_a.view;var seg=getElSeg(segEl);if(!ev||component.isValidSegDownEl(ev.target)){calendar.publiclyTrigger(publicEvName,[{el:segEl,event:new EventApi(calendar,seg.eventRange.def,seg.eventRange.instance),jsEvent:ev,view:view}]);}};return EventHovering;}(Interaction));var StandardTheme=(function(_super){__extends(StandardTheme,_super);function StandardTheme(){return _super!==null&&_super.apply(this,arguments)||this;}
return StandardTheme;}(Theme));StandardTheme.prototype.classes={widget:'fc-unthemed',widgetHeader:'fc-widget-header',widgetContent:'fc-widget-content',buttonGroup:'fc-button-group',button:'fc-button fc-button-primary',buttonActive:'fc-button-active',popoverHeader:'fc-widget-header',popoverContent:'fc-widget-content',headerRow:'fc-widget-header',dayRow:'fc-widget-content',listView:'fc-widget-content'};StandardTheme.prototype.baseIconClass='fc-icon';StandardTheme.prototype.iconClasses={close:'fc-icon-x',prev:'fc-icon-chevron-left',next:'fc-icon-chevron-right',prevYear:'fc-icon-chevrons-left',nextYear:'fc-icon-chevrons-right'};StandardTheme.prototype.iconOverrideOption='buttonIcons';StandardTheme.prototype.iconOverrideCustomButtonOption='icon';StandardTheme.prototype.iconOverridePrefix='fc-icon-';var Calendar=(function(){function Calendar(el,overrides){var _this=this;this.buildComponentContext=memoize(buildComponentContext$1);this.parseRawLocales=memoize(parseRawLocales);this.buildLocale=memoize(buildLocale);this.buildDateEnv=memoize(buildDateEnv);this.buildTheme=memoize(buildTheme);this.buildEventUiSingleBase=memoize(this._buildEventUiSingleBase);this.buildSelectionConfig=memoize(this._buildSelectionConfig);this.buildEventUiBySource=memoizeOutput(buildEventUiBySource,isPropsEqual);this.buildEventUiBases=memoize(buildEventUiBases);this.interactionsStore={};this.actionQueue=[];this.isReducing=false;this.needsRerender=false;this.isRendering=false;this.renderingPauseDepth=0;this.buildDelayedRerender=memoize(buildDelayedRerender);this.afterSizingTriggers={};this.isViewUpdated=false;this.isDatesUpdated=false;this.isEventsUpdated=false;this.el=el;this.optionsManager=new OptionsManager(overrides||{});this.pluginSystem=new PluginSystem();this.addPluginInputs(this.optionsManager.computed.plugins||[]);this.handleOptions(this.optionsManager.computed);this.publiclyTrigger('_init');this.hydrate();this.calendarInteractions=this.pluginSystem.hooks.calendarInteractions.map(function(calendarInteractionClass){return new calendarInteractionClass(_this);});}
Calendar.prototype.addPluginInputs=function(pluginInputs){var pluginDefs=refinePluginDefs(pluginInputs);for(var _i=0,pluginDefs_1=pluginDefs;_i<pluginDefs_1.length;_i++){var pluginDef=pluginDefs_1[_i];this.pluginSystem.add(pluginDef);}};Object.defineProperty(Calendar.prototype,"view",{get:function(){return this.component?this.component.view:null;},enumerable:true,configurable:true});Calendar.prototype.render=function(){if(!this.component){this.component=new CalendarComponent(this.el);this.renderableEventStore=createEmptyEventStore();this.bindHandlers();this.executeRender();}
else{this.requestRerender();}};Calendar.prototype.destroy=function(){if(this.component){this.unbindHandlers();this.component.destroy();this.component=null;for(var _i=0,_a=this.calendarInteractions;_i<_a.length;_i++){var interaction=_a[_i];interaction.destroy();}
this.publiclyTrigger('_destroyed');}};Calendar.prototype.bindHandlers=function(){var _this=this;this.removeNavLinkListener=listenBySelector(this.el,'click','a[data-goto]',function(ev,anchorEl){var gotoOptions=anchorEl.getAttribute('data-goto');gotoOptions=gotoOptions?JSON.parse(gotoOptions):{};var dateEnv=_this.dateEnv;var dateMarker=dateEnv.createMarker(gotoOptions.date);var viewType=gotoOptions.type;var customAction=_this.viewOpt('navLink'+capitaliseFirstLetter(viewType)+'Click');if(typeof customAction==='function'){customAction(dateEnv.toDate(dateMarker),ev);}
else{if(typeof customAction==='string'){viewType=customAction;}
_this.zoomTo(dateMarker,viewType);}});if(this.opt('handleWindowResize')){window.addEventListener('resize',this.windowResizeProxy=debounce(this.windowResize.bind(this),this.opt('windowResizeDelay')));}};Calendar.prototype.unbindHandlers=function(){this.removeNavLinkListener();if(this.windowResizeProxy){window.removeEventListener('resize',this.windowResizeProxy);this.windowResizeProxy=null;}};Calendar.prototype.hydrate=function(){var _this=this;this.state=this.buildInitialState();var rawSources=this.opt('eventSources')||[];var singleRawSource=this.opt('events');var sources=[];if(singleRawSource){rawSources.unshift(singleRawSource);}
for(var _i=0,rawSources_1=rawSources;_i<rawSources_1.length;_i++){var rawSource=rawSources_1[_i];var source=parseEventSource(rawSource,this);if(source){sources.push(source);}}
this.batchRendering(function(){_this.dispatch({type:'INIT'});_this.dispatch({type:'ADD_EVENT_SOURCES',sources:sources});_this.dispatch({type:'SET_VIEW_TYPE',viewType:_this.opt('defaultView')||_this.pluginSystem.hooks.defaultView});});};Calendar.prototype.buildInitialState=function(){return{viewType:null,loadingLevel:0,eventSourceLoadingLevel:0,currentDate:this.getInitialDate(),dateProfile:null,eventSources:{},eventStore:createEmptyEventStore(),dateSelection:null,eventSelection:'',eventDrag:null,eventResize:null};};Calendar.prototype.dispatch=function(action){this.actionQueue.push(action);if(!this.isReducing){this.isReducing=true;var oldState=this.state;while(this.actionQueue.length){this.state=this.reduce(this.state,this.actionQueue.shift(),this);}
var newState=this.state;this.isReducing=false;if(!oldState.loadingLevel&&newState.loadingLevel){this.publiclyTrigger('loading',[true]);}
else if(oldState.loadingLevel&&!newState.loadingLevel){this.publiclyTrigger('loading',[false]);}
var view=this.component&&this.component.view;if(oldState.eventStore!==newState.eventStore){if(oldState.eventStore){this.isEventsUpdated=true;}}
if(oldState.dateProfile!==newState.dateProfile){if(oldState.dateProfile&&view){this.publiclyTrigger('datesDestroy',[{view:view,el:view.el}]);}
this.isDatesUpdated=true;}
if(oldState.viewType!==newState.viewType){if(oldState.viewType&&view){this.publiclyTrigger('viewSkeletonDestroy',[{view:view,el:view.el}]);}
this.isViewUpdated=true;}
this.requestRerender();}};Calendar.prototype.reduce=function(state,action,calendar){return reduce(state,action,calendar);};Calendar.prototype.requestRerender=function(){this.needsRerender=true;this.delayedRerender();};Calendar.prototype.tryRerender=function(){if(this.component&&this.needsRerender&&!this.renderingPauseDepth&&!this.isRendering){this.executeRender();}};Calendar.prototype.batchRendering=function(func){this.renderingPauseDepth++;func();this.renderingPauseDepth--;if(this.needsRerender){this.requestRerender();}};Calendar.prototype.executeRender=function(){this.needsRerender=false;this.isRendering=true;this.renderComponent();this.isRendering=false;if(this.needsRerender){this.delayedRerender();}};Calendar.prototype.renderComponent=function(){var _a=this,state=_a.state,component=_a.component;var viewType=state.viewType;var viewSpec=this.viewSpecs[viewType];if(!viewSpec){throw new Error("View type \""+viewType+"\" is not valid");}
var renderableEventStore=this.renderableEventStore=(state.eventSourceLoadingLevel&&!this.opt('progressiveEventRendering'))?this.renderableEventStore:state.eventStore;var eventUiSingleBase=this.buildEventUiSingleBase(viewSpec.options);var eventUiBySource=this.buildEventUiBySource(state.eventSources);var eventUiBases=this.eventUiBases=this.buildEventUiBases(renderableEventStore.defs,eventUiSingleBase,eventUiBySource);component.receiveProps(__assign({},state,{viewSpec:viewSpec,dateProfileGenerator:this.dateProfileGenerators[viewType],dateProfile:state.dateProfile,eventStore:renderableEventStore,eventUiBases:eventUiBases,dateSelection:state.dateSelection,eventSelection:state.eventSelection,eventDrag:state.eventDrag,eventResize:state.eventResize}),this.buildComponentContext(this.theme,this.dateEnv,this.optionsManager.computed));if(this.isViewUpdated){this.isViewUpdated=false;this.publiclyTrigger('viewSkeletonRender',[{view:component.view,el:component.view.el}]);}
if(this.isDatesUpdated){this.isDatesUpdated=false;this.publiclyTrigger('datesRender',[{view:component.view,el:component.view.el}]);}
if(this.isEventsUpdated){this.isEventsUpdated=false;}
this.releaseAfterSizingTriggers();};Calendar.prototype.setOption=function(name,val){var _a;this.mutateOptions((_a={},_a[name]=val,_a),[],true);};Calendar.prototype.getOption=function(name){return this.optionsManager.computed[name];};Calendar.prototype.opt=function(name){return this.optionsManager.computed[name];};Calendar.prototype.viewOpt=function(name){return this.viewOpts()[name];};Calendar.prototype.viewOpts=function(){return this.viewSpecs[this.state.viewType].options;};Calendar.prototype.mutateOptions=function(updates,removals,isDynamic,deepEqual){var _this=this;var changeHandlers=this.pluginSystem.hooks.optionChangeHandlers;var normalUpdates={};var specialUpdates={};var oldDateEnv=this.dateEnv;var isTimeZoneDirty=false;var isSizeDirty=false;var anyDifficultOptions=Boolean(removals.length);for(var name_1 in updates){if(changeHandlers[name_1]){specialUpdates[name_1]=updates[name_1];}
else{normalUpdates[name_1]=updates[name_1];}}
for(var name_2 in normalUpdates){if(/^(height|contentHeight|aspectRatio)$/.test(name_2)){isSizeDirty=true;}
else if(/^(defaultDate|defaultView)$/.test(name_2));else{anyDifficultOptions=true;if(name_2==='timeZone'){isTimeZoneDirty=true;}}}
this.optionsManager.mutate(normalUpdates,removals,isDynamic);if(anyDifficultOptions){this.handleOptions(this.optionsManager.computed);}
this.batchRendering(function(){if(anyDifficultOptions){if(isTimeZoneDirty){_this.dispatch({type:'CHANGE_TIMEZONE',oldDateEnv:oldDateEnv});}
_this.dispatch({type:'SET_VIEW_TYPE',viewType:_this.state.viewType});}
else if(isSizeDirty){_this.updateSize();}
if(deepEqual){for(var name_3 in specialUpdates){changeHandlers[name_3](specialUpdates[name_3],_this,deepEqual);}}});};Calendar.prototype.handleOptions=function(options){var _this=this;var pluginHooks=this.pluginSystem.hooks;this.defaultAllDayEventDuration=createDuration(options.defaultAllDayEventDuration);this.defaultTimedEventDuration=createDuration(options.defaultTimedEventDuration);this.delayedRerender=this.buildDelayedRerender(options.rerenderDelay);this.theme=this.buildTheme(options);var available=this.parseRawLocales(options.locales);this.availableRawLocales=available.map;var locale=this.buildLocale(options.locale||available.defaultCode,available.map);this.dateEnv=this.buildDateEnv(locale,options.timeZone,pluginHooks.namedTimeZonedImpl,options.firstDay,options.weekNumberCalculation,options.weekLabel,pluginHooks.cmdFormatter);this.selectionConfig=this.buildSelectionConfig(options);this.viewSpecs=buildViewSpecs(pluginHooks.views,this.optionsManager);this.dateProfileGenerators=mapHash(this.viewSpecs,function(viewSpec){return new viewSpec.class.prototype.dateProfileGeneratorClass(viewSpec,_this);});};Calendar.prototype.getAvailableLocaleCodes=function(){return Object.keys(this.availableRawLocales);};Calendar.prototype._buildSelectionConfig=function(rawOpts){return processScopedUiProps('select',rawOpts,this);};Calendar.prototype._buildEventUiSingleBase=function(rawOpts){if(rawOpts.editable){rawOpts=__assign({},rawOpts,{eventEditable:true});}
return processScopedUiProps('event',rawOpts,this);};Calendar.prototype.hasPublicHandlers=function(name){return this.hasHandlers(name)||this.opt(name);};Calendar.prototype.publiclyTrigger=function(name,args){var optHandler=this.opt(name);this.triggerWith(name,this,args);if(optHandler){return optHandler.apply(this,args);}};Calendar.prototype.publiclyTriggerAfterSizing=function(name,args){var afterSizingTriggers=this.afterSizingTriggers;(afterSizingTriggers[name]||(afterSizingTriggers[name]=[])).push(args);};Calendar.prototype.releaseAfterSizingTriggers=function(){var afterSizingTriggers=this.afterSizingTriggers;for(var name_4 in afterSizingTriggers){for(var _i=0,_a=afterSizingTriggers[name_4];_i<_a.length;_i++){var args=_a[_i];this.publiclyTrigger(name_4,args);}}
this.afterSizingTriggers={};};Calendar.prototype.isValidViewType=function(viewType){return Boolean(this.viewSpecs[viewType]);};Calendar.prototype.changeView=function(viewType,dateOrRange){var dateMarker=null;if(dateOrRange){if(dateOrRange.start&&dateOrRange.end){this.optionsManager.mutate({visibleRange:dateOrRange},[]);this.handleOptions(this.optionsManager.computed);}
else{dateMarker=this.dateEnv.createMarker(dateOrRange);}}
this.unselect();this.dispatch({type:'SET_VIEW_TYPE',viewType:viewType,dateMarker:dateMarker});};Calendar.prototype.zoomTo=function(dateMarker,viewType){var spec;viewType=viewType||'day';spec=this.viewSpecs[viewType]||this.getUnitViewSpec(viewType);this.unselect();if(spec){this.dispatch({type:'SET_VIEW_TYPE',viewType:spec.type,dateMarker:dateMarker});}
else{this.dispatch({type:'SET_DATE',dateMarker:dateMarker});}};Calendar.prototype.getUnitViewSpec=function(unit){var component=this.component;var viewTypes=[];var i;var spec;if(component.header){viewTypes.push.apply(viewTypes,component.header.viewsWithButtons);}
if(component.footer){viewTypes.push.apply(viewTypes,component.footer.viewsWithButtons);}
for(var viewType in this.viewSpecs){viewTypes.push(viewType);}
for(i=0;i<viewTypes.length;i++){spec=this.viewSpecs[viewTypes[i]];if(spec){if(spec.singleUnit===unit){return spec;}}}};Calendar.prototype.getInitialDate=function(){var defaultDateInput=this.opt('defaultDate');if(defaultDateInput!=null){return this.dateEnv.createMarker(defaultDateInput);}
else{return this.getNow();}};Calendar.prototype.prev=function(){this.unselect();this.dispatch({type:'PREV'});};Calendar.prototype.next=function(){this.unselect();this.dispatch({type:'NEXT'});};Calendar.prototype.prevYear=function(){this.unselect();this.dispatch({type:'SET_DATE',dateMarker:this.dateEnv.addYears(this.state.currentDate,-1)});};Calendar.prototype.nextYear=function(){this.unselect();this.dispatch({type:'SET_DATE',dateMarker:this.dateEnv.addYears(this.state.currentDate,1)});};Calendar.prototype.today=function(){this.unselect();this.dispatch({type:'SET_DATE',dateMarker:this.getNow()});};Calendar.prototype.gotoDate=function(zonedDateInput){this.unselect();this.dispatch({type:'SET_DATE',dateMarker:this.dateEnv.createMarker(zonedDateInput)});};Calendar.prototype.incrementDate=function(deltaInput){var delta=createDuration(deltaInput);if(delta){this.unselect();this.dispatch({type:'SET_DATE',dateMarker:this.dateEnv.add(this.state.currentDate,delta)});}};Calendar.prototype.getDate=function(){return this.dateEnv.toDate(this.state.currentDate);};Calendar.prototype.formatDate=function(d,formatter){var dateEnv=this.dateEnv;return dateEnv.format(dateEnv.createMarker(d),createFormatter(formatter));};Calendar.prototype.formatRange=function(d0,d1,settings){var dateEnv=this.dateEnv;return dateEnv.formatRange(dateEnv.createMarker(d0),dateEnv.createMarker(d1),createFormatter(settings,this.opt('defaultRangeSeparator')),settings);};Calendar.prototype.formatIso=function(d,omitTime){var dateEnv=this.dateEnv;return dateEnv.formatIso(dateEnv.createMarker(d),{omitTime:omitTime});};Calendar.prototype.windowResize=function(ev){if(!this.isHandlingWindowResize&&this.component&&ev.target===window){this.isHandlingWindowResize=true;this.updateSize();this.publiclyTrigger('windowResize',[this.view]);this.isHandlingWindowResize=false;}};Calendar.prototype.updateSize=function(){if(this.component){this.component.updateSize(true);}};Calendar.prototype.registerInteractiveComponent=function(component,settingsInput){var settings=parseInteractionSettings(component,settingsInput);var DEFAULT_INTERACTIONS=[EventClicking,EventHovering];var interactionClasses=DEFAULT_INTERACTIONS.concat(this.pluginSystem.hooks.componentInteractions);var interactions=interactionClasses.map(function(interactionClass){return new interactionClass(settings);});this.interactionsStore[component.uid]=interactions;interactionSettingsStore[component.uid]=settings;};Calendar.prototype.unregisterInteractiveComponent=function(component){for(var _i=0,_a=this.interactionsStore[component.uid];_i<_a.length;_i++){var listener=_a[_i];listener.destroy();}
delete this.interactionsStore[component.uid];delete interactionSettingsStore[component.uid];};Calendar.prototype.select=function(dateOrObj,endDate){var selectionInput;if(endDate==null){if(dateOrObj.start!=null){selectionInput=dateOrObj;}
else{selectionInput={start:dateOrObj,end:null};}}
else{selectionInput={start:dateOrObj,end:endDate};}
var selection=parseDateSpan(selectionInput,this.dateEnv,createDuration({days:1}));if(selection){this.dispatch({type:'SELECT_DATES',selection:selection});this.triggerDateSelect(selection);}};Calendar.prototype.unselect=function(pev){if(this.state.dateSelection){this.dispatch({type:'UNSELECT_DATES'});this.triggerDateUnselect(pev);}};Calendar.prototype.triggerDateSelect=function(selection,pev){var arg=__assign({},this.buildDateSpanApi(selection),{jsEvent:pev?pev.origEvent:null,view:this.view});this.publiclyTrigger('select',[arg]);};Calendar.prototype.triggerDateUnselect=function(pev){this.publiclyTrigger('unselect',[{jsEvent:pev?pev.origEvent:null,view:this.view}]);};Calendar.prototype.triggerDateClick=function(dateSpan,dayEl,view,ev){var arg=__assign({},this.buildDatePointApi(dateSpan),{dayEl:dayEl,jsEvent:ev,view:view});this.publiclyTrigger('dateClick',[arg]);};Calendar.prototype.buildDatePointApi=function(dateSpan){var props={};for(var _i=0,_a=this.pluginSystem.hooks.datePointTransforms;_i<_a.length;_i++){var transform=_a[_i];__assign(props,transform(dateSpan,this));}
__assign(props,buildDatePointApi(dateSpan,this.dateEnv));return props;};Calendar.prototype.buildDateSpanApi=function(dateSpan){var props={};for(var _i=0,_a=this.pluginSystem.hooks.dateSpanTransforms;_i<_a.length;_i++){var transform=_a[_i];__assign(props,transform(dateSpan,this));}
__assign(props,buildDateSpanApi(dateSpan,this.dateEnv));return props;};Calendar.prototype.getNow=function(){var now=this.opt('now');if(typeof now==='function'){now=now();}
if(now==null){return this.dateEnv.createNowMarker();}
return this.dateEnv.createMarker(now);};Calendar.prototype.getDefaultEventEnd=function(allDay,marker){var end=marker;if(allDay){end=startOfDay(end);end=this.dateEnv.add(end,this.defaultAllDayEventDuration);}
else{end=this.dateEnv.add(end,this.defaultTimedEventDuration);}
return end;};Calendar.prototype.addEvent=function(eventInput,sourceInput){if(eventInput instanceof EventApi){var def=eventInput._def;var instance=eventInput._instance;if(!this.state.eventStore.defs[def.defId]){this.dispatch({type:'ADD_EVENTS',eventStore:eventTupleToStore({def:def,instance:instance})});}
return eventInput;}
var sourceId;if(sourceInput instanceof EventSourceApi){sourceId=sourceInput.internalEventSource.sourceId;}
else if(sourceInput!=null){var sourceApi=this.getEventSourceById(sourceInput);if(!sourceApi){console.warn('Could not find an event source with ID "'+sourceInput+'"');return null;}
else{sourceId=sourceApi.internalEventSource.sourceId;}}
var tuple=parseEvent(eventInput,sourceId,this);if(tuple){this.dispatch({type:'ADD_EVENTS',eventStore:eventTupleToStore(tuple)});return new EventApi(this,tuple.def,tuple.def.recurringDef?null:tuple.instance);}
return null;};Calendar.prototype.getEventById=function(id){var _a=this.state.eventStore,defs=_a.defs,instances=_a.instances;id=String(id);for(var defId in defs){var def=defs[defId];if(def.publicId===id){if(def.recurringDef){return new EventApi(this,def,null);}
else{for(var instanceId in instances){var instance=instances[instanceId];if(instance.defId===def.defId){return new EventApi(this,def,instance);}}}}}
return null;};Calendar.prototype.getEvents=function(){var _a=this.state.eventStore,defs=_a.defs,instances=_a.instances;var eventApis=[];for(var id in instances){var instance=instances[id];var def=defs[instance.defId];eventApis.push(new EventApi(this,def,instance));}
return eventApis;};Calendar.prototype.removeAllEvents=function(){this.dispatch({type:'REMOVE_ALL_EVENTS'});};Calendar.prototype.rerenderEvents=function(){this.dispatch({type:'RESET_EVENTS'});};Calendar.prototype.getEventSources=function(){var sourceHash=this.state.eventSources;var sourceApis=[];for(var internalId in sourceHash){sourceApis.push(new EventSourceApi(this,sourceHash[internalId]));}
return sourceApis;};Calendar.prototype.getEventSourceById=function(id){var sourceHash=this.state.eventSources;id=String(id);for(var sourceId in sourceHash){if(sourceHash[sourceId].publicId===id){return new EventSourceApi(this,sourceHash[sourceId]);}}
return null;};Calendar.prototype.addEventSource=function(sourceInput){if(sourceInput instanceof EventSourceApi){if(!this.state.eventSources[sourceInput.internalEventSource.sourceId]){this.dispatch({type:'ADD_EVENT_SOURCES',sources:[sourceInput.internalEventSource]});}
return sourceInput;}
var eventSource=parseEventSource(sourceInput,this);if(eventSource){this.dispatch({type:'ADD_EVENT_SOURCES',sources:[eventSource]});return new EventSourceApi(this,eventSource);}
return null;};Calendar.prototype.removeAllEventSources=function(){this.dispatch({type:'REMOVE_ALL_EVENT_SOURCES'});};Calendar.prototype.refetchEvents=function(){this.dispatch({type:'FETCH_EVENT_SOURCES'});};Calendar.prototype.scrollToTime=function(timeInput){var duration=createDuration(timeInput);if(duration){this.component.view.scrollToDuration(duration);}};return Calendar;}());EmitterMixin.mixInto(Calendar);function buildComponentContext$1(theme,dateEnv,options){return new ComponentContext(this,theme,dateEnv,options,null);}
function buildDateEnv(locale,timeZone,namedTimeZoneImpl,firstDay,weekNumberCalculation,weekLabel,cmdFormatter){return new DateEnv({calendarSystem:'gregory',timeZone:timeZone,namedTimeZoneImpl:namedTimeZoneImpl,locale:locale,weekNumberCalculation:weekNumberCalculation,firstDay:firstDay,weekLabel:weekLabel,cmdFormatter:cmdFormatter});}
function buildTheme(calendarOptions){var themeClass=this.pluginSystem.hooks.themeClasses[calendarOptions.themeSystem]||StandardTheme;return new themeClass(calendarOptions);}
function buildDelayedRerender(wait){var func=this.tryRerender.bind(this);if(wait!=null){func=debounce(func,wait);}
return func;}
function buildEventUiBySource(eventSources){return mapHash(eventSources,function(eventSource){return eventSource.ui;});}
function buildEventUiBases(eventDefs,eventUiSingleBase,eventUiBySource){var eventUiBases={'':eventUiSingleBase};for(var defId in eventDefs){var def=eventDefs[defId];if(def.sourceId&&eventUiBySource[def.sourceId]){eventUiBases[defId]=eventUiBySource[def.sourceId];}}
return eventUiBases;}
var View=(function(_super){__extends(View,_super);function View(viewSpec,parentEl){var _this=_super.call(this,createElement('div',{className:'fc-view fc-'+viewSpec.type+'-view'}))||this;_this.renderDatesMem=memoizeRendering(_this.renderDatesWrap,_this.unrenderDatesWrap);_this.renderBusinessHoursMem=memoizeRendering(_this.renderBusinessHours,_this.unrenderBusinessHours,[_this.renderDatesMem]);_this.renderDateSelectionMem=memoizeRendering(_this.renderDateSelectionWrap,_this.unrenderDateSelectionWrap,[_this.renderDatesMem]);_this.renderEventsMem=memoizeRendering(_this.renderEvents,_this.unrenderEvents,[_this.renderDatesMem]);_this.renderEventSelectionMem=memoizeRendering(_this.renderEventSelectionWrap,_this.unrenderEventSelectionWrap,[_this.renderEventsMem]);_this.renderEventDragMem=memoizeRendering(_this.renderEventDragWrap,_this.unrenderEventDragWrap,[_this.renderDatesMem]);_this.renderEventResizeMem=memoizeRendering(_this.renderEventResizeWrap,_this.unrenderEventResizeWrap,[_this.renderDatesMem]);_this.viewSpec=viewSpec;_this.type=viewSpec.type;parentEl.appendChild(_this.el);_this.initialize();return _this;}
View.prototype.initialize=function(){};Object.defineProperty(View.prototype,"activeStart",{get:function(){return this.context.dateEnv.toDate(this.props.dateProfile.activeRange.start);},enumerable:true,configurable:true});Object.defineProperty(View.prototype,"activeEnd",{get:function(){return this.context.dateEnv.toDate(this.props.dateProfile.activeRange.end);},enumerable:true,configurable:true});Object.defineProperty(View.prototype,"currentStart",{get:function(){return this.context.dateEnv.toDate(this.props.dateProfile.currentRange.start);},enumerable:true,configurable:true});Object.defineProperty(View.prototype,"currentEnd",{get:function(){return this.context.dateEnv.toDate(this.props.dateProfile.currentRange.end);},enumerable:true,configurable:true});View.prototype.render=function(props,context){this.renderDatesMem(props.dateProfile);this.renderBusinessHoursMem(props.businessHours);this.renderDateSelectionMem(props.dateSelection);this.renderEventsMem(props.eventStore);this.renderEventSelectionMem(props.eventSelection);this.renderEventDragMem(props.eventDrag);this.renderEventResizeMem(props.eventResize);};View.prototype.beforeUpdate=function(){this.addScroll(this.queryScroll());};View.prototype.destroy=function(){_super.prototype.destroy.call(this);this.renderDatesMem.unrender();};View.prototype.updateSize=function(isResize,viewHeight,isAuto){var calendar=this.context.calendar;if(isResize){this.addScroll(this.queryScroll());}
if(isResize||calendar.isViewUpdated||calendar.isDatesUpdated||calendar.isEventsUpdated){this.updateBaseSize(isResize,viewHeight,isAuto);}};View.prototype.updateBaseSize=function(isResize,viewHeight,isAuto){};View.prototype.renderDatesWrap=function(dateProfile){this.renderDates(dateProfile);this.addScroll({duration:createDuration(this.context.options.scrollTime)});};View.prototype.unrenderDatesWrap=function(){this.stopNowIndicator();this.unrenderDates();};View.prototype.renderDates=function(dateProfile){};View.prototype.unrenderDates=function(){};View.prototype.renderBusinessHours=function(businessHours){};View.prototype.unrenderBusinessHours=function(){};View.prototype.renderDateSelectionWrap=function(selection){if(selection){this.renderDateSelection(selection);}};View.prototype.unrenderDateSelectionWrap=function(selection){if(selection){this.unrenderDateSelection(selection);}};View.prototype.renderDateSelection=function(selection){};View.prototype.unrenderDateSelection=function(selection){};View.prototype.renderEvents=function(eventStore){};View.prototype.unrenderEvents=function(){};View.prototype.sliceEvents=function(eventStore,allDay){var props=this.props;return sliceEventStore(eventStore,props.eventUiBases,props.dateProfile.activeRange,allDay?this.context.nextDayThreshold:null).fg;};View.prototype.renderEventSelectionWrap=function(instanceId){if(instanceId){this.renderEventSelection(instanceId);}};View.prototype.unrenderEventSelectionWrap=function(instanceId){if(instanceId){this.unrenderEventSelection(instanceId);}};View.prototype.renderEventSelection=function(instanceId){};View.prototype.unrenderEventSelection=function(instanceId){};View.prototype.renderEventDragWrap=function(state){if(state){this.renderEventDrag(state);}};View.prototype.unrenderEventDragWrap=function(state){if(state){this.unrenderEventDrag(state);}};View.prototype.renderEventDrag=function(state){};View.prototype.unrenderEventDrag=function(state){};View.prototype.renderEventResizeWrap=function(state){if(state){this.renderEventResize(state);}};View.prototype.unrenderEventResizeWrap=function(state){if(state){this.unrenderEventResize(state);}};View.prototype.renderEventResize=function(state){};View.prototype.unrenderEventResize=function(state){};View.prototype.startNowIndicator=function(dateProfile,dateProfileGenerator){var _this=this;var _a=this.context,calendar=_a.calendar,dateEnv=_a.dateEnv,options=_a.options;var unit;var update;var delay;if(options.nowIndicator&&!this.initialNowDate){unit=this.getNowIndicatorUnit(dateProfile,dateProfileGenerator);if(unit){update=this.updateNowIndicator.bind(this);this.initialNowDate=calendar.getNow();this.initialNowQueriedMs=new Date().valueOf();delay=dateEnv.add(dateEnv.startOf(this.initialNowDate,unit),createDuration(1,unit)).valueOf()-this.initialNowDate.valueOf();this.nowIndicatorTimeoutID=setTimeout(function(){_this.nowIndicatorTimeoutID=null;update();if(unit==='second'){delay=1000;}
else{delay=1000*60;}
_this.nowIndicatorIntervalID=setInterval(update,delay);},delay);}}};View.prototype.updateNowIndicator=function(){if(this.props.dateProfile&&this.initialNowDate){this.unrenderNowIndicator();this.renderNowIndicator(addMs(this.initialNowDate,new Date().valueOf()-this.initialNowQueriedMs));this.isNowIndicatorRendered=true;}};View.prototype.stopNowIndicator=function(){if(this.nowIndicatorTimeoutID){clearTimeout(this.nowIndicatorTimeoutID);this.nowIndicatorTimeoutID=null;}
if(this.nowIndicatorIntervalID){clearInterval(this.nowIndicatorIntervalID);this.nowIndicatorIntervalID=null;}
if(this.isNowIndicatorRendered){this.unrenderNowIndicator();this.isNowIndicatorRendered=false;}};View.prototype.getNowIndicatorUnit=function(dateProfile,dateProfileGenerator){};View.prototype.renderNowIndicator=function(date){};View.prototype.unrenderNowIndicator=function(){};View.prototype.addScroll=function(scroll,isForced){if(isForced){scroll.isForced=isForced;}
__assign(this.queuedScroll||(this.queuedScroll={}),scroll);};View.prototype.popScroll=function(isResize){this.applyQueuedScroll(isResize);this.queuedScroll=null;};View.prototype.applyQueuedScroll=function(isResize){if(this.queuedScroll){this.applyScroll(this.queuedScroll,isResize);}};View.prototype.queryScroll=function(){var scroll={};if(this.props.dateProfile){__assign(scroll,this.queryDateScroll());}
return scroll;};View.prototype.applyScroll=function(scroll,isResize){var duration=scroll.duration,isForced=scroll.isForced;if(duration!=null&&!isForced){delete scroll.duration;if(this.props.dateProfile){__assign(scroll,this.computeDateScroll(duration));}}
if(this.props.dateProfile){this.applyDateScroll(scroll);}};View.prototype.computeDateScroll=function(duration){return{};};View.prototype.queryDateScroll=function(){return{};};View.prototype.applyDateScroll=function(scroll){};View.prototype.scrollToDuration=function(duration){this.applyScroll({duration:duration},false);};return View;}(DateComponent));EmitterMixin.mixInto(View);View.prototype.usesMinMaxTime=false;View.prototype.dateProfileGeneratorClass=DateProfileGenerator;var FgEventRenderer=(function(){function FgEventRenderer(){this.segs=[];this.isSizeDirty=false;}
FgEventRenderer.prototype.renderSegs=function(context,segs,mirrorInfo){this.context=context;this.rangeUpdated();segs=this.renderSegEls(segs,mirrorInfo);this.segs=segs;this.attachSegs(segs,mirrorInfo);this.isSizeDirty=true;triggerRenderedSegs(this.context,this.segs,Boolean(mirrorInfo));};FgEventRenderer.prototype.unrender=function(context,_segs,mirrorInfo){triggerWillRemoveSegs(this.context,this.segs,Boolean(mirrorInfo));this.detachSegs(this.segs);this.segs=[];};FgEventRenderer.prototype.rangeUpdated=function(){var options=this.context.options;var displayEventTime;var displayEventEnd;this.eventTimeFormat=createFormatter(options.eventTimeFormat||this.computeEventTimeFormat(),options.defaultRangeSeparator);displayEventTime=options.displayEventTime;if(displayEventTime==null){displayEventTime=this.computeDisplayEventTime();}
displayEventEnd=options.displayEventEnd;if(displayEventEnd==null){displayEventEnd=this.computeDisplayEventEnd();}
this.displayEventTime=displayEventTime;this.displayEventEnd=displayEventEnd;};FgEventRenderer.prototype.renderSegEls=function(segs,mirrorInfo){var html='';var i;if(segs.length){for(i=0;i<segs.length;i++){html+=this.renderSegHtml(segs[i],mirrorInfo);}
htmlToElements(html).forEach(function(el,i){var seg=segs[i];if(el){seg.el=el;}});segs=filterSegsViaEls(this.context,segs,Boolean(mirrorInfo));}
return segs;};FgEventRenderer.prototype.getSegClasses=function(seg,isDraggable,isResizable,mirrorInfo){var classes=['fc-event',seg.isStart?'fc-start':'fc-not-start',seg.isEnd?'fc-end':'fc-not-end'].concat(seg.eventRange.ui.classNames);if(isDraggable){classes.push('fc-draggable');}
if(isResizable){classes.push('fc-resizable');}
if(mirrorInfo){classes.push('fc-mirror');if(mirrorInfo.isDragging){classes.push('fc-dragging');}
if(mirrorInfo.isResizing){classes.push('fc-resizing');}}
return classes;};FgEventRenderer.prototype.getTimeText=function(eventRange,formatter,displayEnd){var def=eventRange.def,instance=eventRange.instance;return this._getTimeText(instance.range.start,def.hasEnd?instance.range.end:null,def.allDay,formatter,displayEnd,instance.forcedStartTzo,instance.forcedEndTzo);};FgEventRenderer.prototype._getTimeText=function(start,end,allDay,formatter,displayEnd,forcedStartTzo,forcedEndTzo){var dateEnv=this.context.dateEnv;if(formatter==null){formatter=this.eventTimeFormat;}
if(displayEnd==null){displayEnd=this.displayEventEnd;}
if(this.displayEventTime&&!allDay){if(displayEnd&&end){return dateEnv.formatRange(start,end,formatter,{forcedStartTzo:forcedStartTzo,forcedEndTzo:forcedEndTzo});}
else{return dateEnv.format(start,formatter,{forcedTzo:forcedStartTzo});}}
return'';};FgEventRenderer.prototype.computeEventTimeFormat=function(){return{hour:'numeric',minute:'2-digit',omitZeroMinute:true};};FgEventRenderer.prototype.computeDisplayEventTime=function(){return true;};FgEventRenderer.prototype.computeDisplayEventEnd=function(){return true;};FgEventRenderer.prototype.getSkinCss=function(ui){return{'background-color':ui.backgroundColor,'border-color':ui.borderColor,color:ui.textColor};};FgEventRenderer.prototype.sortEventSegs=function(segs){var specs=this.context.eventOrderSpecs;var objs=segs.map(buildSegCompareObj);objs.sort(function(obj0,obj1){return compareByFieldSpecs(obj0,obj1,specs);});return objs.map(function(c){return c._seg;});};FgEventRenderer.prototype.computeSizes=function(force){if(force||this.isSizeDirty){this.computeSegSizes(this.segs);}};FgEventRenderer.prototype.assignSizes=function(force){if(force||this.isSizeDirty){this.assignSegSizes(this.segs);this.isSizeDirty=false;}};FgEventRenderer.prototype.computeSegSizes=function(segs){};FgEventRenderer.prototype.assignSegSizes=function(segs){};FgEventRenderer.prototype.hideByHash=function(hash){if(hash){for(var _i=0,_a=this.segs;_i<_a.length;_i++){var seg=_a[_i];if(hash[seg.eventRange.instance.instanceId]){seg.el.style.visibility='hidden';}}}};FgEventRenderer.prototype.showByHash=function(hash){if(hash){for(var _i=0,_a=this.segs;_i<_a.length;_i++){var seg=_a[_i];if(hash[seg.eventRange.instance.instanceId]){seg.el.style.visibility='';}}}};FgEventRenderer.prototype.selectByInstanceId=function(instanceId){if(instanceId){for(var _i=0,_a=this.segs;_i<_a.length;_i++){var seg=_a[_i];var eventInstance=seg.eventRange.instance;if(eventInstance&&eventInstance.instanceId===instanceId&&seg.el){seg.el.classList.add('fc-selected');}}}};FgEventRenderer.prototype.unselectByInstanceId=function(instanceId){if(instanceId){for(var _i=0,_a=this.segs;_i<_a.length;_i++){var seg=_a[_i];if(seg.el){seg.el.classList.remove('fc-selected');}}}};return FgEventRenderer;}());function buildSegCompareObj(seg){var eventDef=seg.eventRange.def;var range=seg.eventRange.instance.range;var start=range.start?range.start.valueOf():0;var end=range.end?range.end.valueOf():0;return __assign({},eventDef.extendedProps,eventDef,{id:eventDef.publicId,start:start,end:end,duration:end-start,allDay:Number(eventDef.allDay),_seg:seg});}
var FillRenderer=(function(){function FillRenderer(){this.fillSegTag='div';this.dirtySizeFlags={};this.containerElsByType={};this.segsByType={};}
FillRenderer.prototype.getSegsByType=function(type){return this.segsByType[type]||[];};FillRenderer.prototype.renderSegs=function(type,context,segs){var _a;this.context=context;var renderedSegs=this.renderSegEls(type,segs);var containerEls=this.attachSegs(type,renderedSegs);if(containerEls){(_a=(this.containerElsByType[type]||(this.containerElsByType[type]=[]))).push.apply(_a,containerEls);}
this.segsByType[type]=renderedSegs;if(type==='bgEvent'){triggerRenderedSegs(context,renderedSegs,false);}
this.dirtySizeFlags[type]=true;};FillRenderer.prototype.unrender=function(type,context){var segs=this.segsByType[type];if(segs){if(type==='bgEvent'){triggerWillRemoveSegs(context,segs,false);}
this.detachSegs(type,segs);}};FillRenderer.prototype.renderSegEls=function(type,segs){var _this=this;var html='';var i;if(segs.length){for(i=0;i<segs.length;i++){html+=this.renderSegHtml(type,segs[i]);}
htmlToElements(html).forEach(function(el,i){var seg=segs[i];if(el){seg.el=el;}});if(type==='bgEvent'){segs=filterSegsViaEls(this.context,segs,false);}
segs=segs.filter(function(seg){return elementMatches(seg.el,_this.fillSegTag);});}
return segs;};FillRenderer.prototype.renderSegHtml=function(type,seg){var css=null;var classNames=[];if(type!=='highlight'&&type!=='businessHours'){css={'background-color':seg.eventRange.ui.backgroundColor};}
if(type!=='highlight'){classNames=classNames.concat(seg.eventRange.ui.classNames);}
if(type==='businessHours'){classNames.push('fc-bgevent');}
else{classNames.push('fc-'+type.toLowerCase());}
return'<'+this.fillSegTag+
(classNames.length?' class="'+classNames.join(' ')+'"':'')+
(css?' style="'+cssToStr(css)+'"':'')+'></'+this.fillSegTag+'>';};FillRenderer.prototype.detachSegs=function(type,segs){var containerEls=this.containerElsByType[type];if(containerEls){containerEls.forEach(removeElement);delete this.containerElsByType[type];}};FillRenderer.prototype.computeSizes=function(force){for(var type in this.segsByType){if(force||this.dirtySizeFlags[type]){this.computeSegSizes(this.segsByType[type]);}}};FillRenderer.prototype.assignSizes=function(force){for(var type in this.segsByType){if(force||this.dirtySizeFlags[type]){this.assignSegSizes(this.segsByType[type]);}}
this.dirtySizeFlags={};};FillRenderer.prototype.computeSegSizes=function(segs){};FillRenderer.prototype.assignSegSizes=function(segs){};return FillRenderer;}());var NamedTimeZoneImpl=(function(){function NamedTimeZoneImpl(timeZoneName){this.timeZoneName=timeZoneName;}
return NamedTimeZoneImpl;}());var ElementDragging=(function(){function ElementDragging(el){this.emitter=new EmitterMixin();}
ElementDragging.prototype.destroy=function(){};ElementDragging.prototype.setMirrorIsVisible=function(bool){};ElementDragging.prototype.setMirrorNeedsRevert=function(bool){};ElementDragging.prototype.setAutoScrollEnabled=function(bool){};return ElementDragging;}());function formatDate(dateInput,settings){if(settings===void 0){settings={};}
var dateEnv=buildDateEnv$1(settings);var formatter=createFormatter(settings);var dateMeta=dateEnv.createMarkerMeta(dateInput);if(!dateMeta){return'';}
return dateEnv.format(dateMeta.marker,formatter,{forcedTzo:dateMeta.forcedTzo});}
function formatRange(startInput,endInput,settings){var dateEnv=buildDateEnv$1(typeof settings==='object'&&settings?settings:{});var formatter=createFormatter(settings,globalDefaults.defaultRangeSeparator);var startMeta=dateEnv.createMarkerMeta(startInput);var endMeta=dateEnv.createMarkerMeta(endInput);if(!startMeta||!endMeta){return'';}
return dateEnv.formatRange(startMeta.marker,endMeta.marker,formatter,{forcedStartTzo:startMeta.forcedTzo,forcedEndTzo:endMeta.forcedTzo,isEndExclusive:settings.isEndExclusive});}
function buildDateEnv$1(settings){var locale=buildLocale(settings.locale||'en',parseRawLocales([]).map);settings=__assign({timeZone:globalDefaults.timeZone,calendarSystem:'gregory'},settings,{locale:locale});return new DateEnv(settings);}
var DRAG_META_PROPS={startTime:createDuration,duration:createDuration,create:Boolean,sourceId:String};var DRAG_META_DEFAULTS={create:true};function parseDragMeta(raw){var leftoverProps={};var refined=refineProps(raw,DRAG_META_PROPS,DRAG_META_DEFAULTS,leftoverProps);refined.leftoverProps=leftoverProps;return refined;}
function computeFallbackHeaderFormat(datesRepDistinctDays,dayCnt){if(!datesRepDistinctDays||dayCnt>10){return{weekday:'short'};}
else if(dayCnt>1){return{weekday:'short',month:'numeric',day:'numeric',omitCommas:true};}
else{return{weekday:'long'};}}
function renderDateCell(dateMarker,dateProfile,datesRepDistinctDays,colCnt,colHeadFormat,context,colspan,otherAttrs){var dateEnv=context.dateEnv,theme=context.theme,options=context.options;var isDateValid=rangeContainsMarker(dateProfile.activeRange,dateMarker);var classNames=['fc-day-header',theme.getClass('widgetHeader')];var innerHtml;if(typeof options.columnHeaderHtml==='function'){innerHtml=options.columnHeaderHtml(dateEnv.toDate(dateMarker));}
else if(typeof options.columnHeaderText==='function'){innerHtml=htmlEscape(options.columnHeaderText(dateEnv.toDate(dateMarker)));}
else{innerHtml=htmlEscape(dateEnv.format(dateMarker,colHeadFormat));}
if(datesRepDistinctDays){classNames=classNames.concat(getDayClasses(dateMarker,dateProfile,context,true));}
else{classNames.push('fc-'+DAY_IDS[dateMarker.getUTCDay()]);}
return''+'<th class="'+classNames.join(' ')+'"'+
((isDateValid&&datesRepDistinctDays)?' data-date="'+dateEnv.formatIso(dateMarker,{omitTime:true})+'"':'')+
(colspan>1?' colspan="'+colspan+'"':'')+
(otherAttrs?' '+otherAttrs:'')+'>'+
(isDateValid?buildGotoAnchorHtml(options,dateEnv,{date:dateMarker,forceOff:!datesRepDistinctDays||colCnt===1},innerHtml):innerHtml)+'</th>';}
var DayHeader=(function(_super){__extends(DayHeader,_super);function DayHeader(parentEl){var _this=_super.call(this)||this;_this.renderSkeleton=memoizeRendering(_this._renderSkeleton,_this._unrenderSkeleton);_this.parentEl=parentEl;return _this;}
DayHeader.prototype.render=function(props,context){var dates=props.dates,datesRepDistinctDays=props.datesRepDistinctDays;var parts=[];this.renderSkeleton(context);if(props.renderIntroHtml){parts.push(props.renderIntroHtml());}
var colHeadFormat=createFormatter(context.options.columnHeaderFormat||computeFallbackHeaderFormat(datesRepDistinctDays,dates.length));for(var _i=0,dates_1=dates;_i<dates_1.length;_i++){var date=dates_1[_i];parts.push(renderDateCell(date,props.dateProfile,datesRepDistinctDays,dates.length,colHeadFormat,context));}
if(context.isRtl){parts.reverse();}
this.thead.innerHTML='<tr>'+parts.join('')+'</tr>';};DayHeader.prototype.destroy=function(){_super.prototype.destroy.call(this);this.renderSkeleton.unrender();};DayHeader.prototype._renderSkeleton=function(context){var theme=context.theme;var parentEl=this.parentEl;parentEl.innerHTML='';parentEl.appendChild(this.el=htmlToElement('<div class="fc-row '+theme.getClass('headerRow')+'">'+'<table class="'+theme.getClass('tableGrid')+'">'+'<thead></thead>'+'</table>'+'</div>'));this.thead=this.el.querySelector('thead');};DayHeader.prototype._unrenderSkeleton=function(){removeElement(this.el);};return DayHeader;}(Component));var DaySeries=(function(){function DaySeries(range,dateProfileGenerator){var date=range.start;var end=range.end;var indices=[];var dates=[];var dayIndex=-1;while(date<end){if(dateProfileGenerator.isHiddenDay(date)){indices.push(dayIndex+0.5);}
else{dayIndex++;indices.push(dayIndex);dates.push(date);}
date=addDays(date,1);}
this.dates=dates;this.indices=indices;this.cnt=dates.length;}
DaySeries.prototype.sliceRange=function(range){var firstIndex=this.getDateDayIndex(range.start);var lastIndex=this.getDateDayIndex(addDays(range.end,-1));var clippedFirstIndex=Math.max(0,firstIndex);var clippedLastIndex=Math.min(this.cnt-1,lastIndex);clippedFirstIndex=Math.ceil(clippedFirstIndex);clippedLastIndex=Math.floor(clippedLastIndex);if(clippedFirstIndex<=clippedLastIndex){return{firstIndex:clippedFirstIndex,lastIndex:clippedLastIndex,isStart:firstIndex===clippedFirstIndex,isEnd:lastIndex===clippedLastIndex};}
else{return null;}};DaySeries.prototype.getDateDayIndex=function(date){var indices=this.indices;var dayOffset=Math.floor(diffDays(this.dates[0],date));if(dayOffset<0){return indices[0]-1;}
else if(dayOffset>=indices.length){return indices[indices.length-1]+1;}
else{return indices[dayOffset];}};return DaySeries;}());var DayTable=(function(){function DayTable(daySeries,breakOnWeeks){var dates=daySeries.dates;var daysPerRow;var firstDay;var rowCnt;if(breakOnWeeks){firstDay=dates[0].getUTCDay();for(daysPerRow=1;daysPerRow<dates.length;daysPerRow++){if(dates[daysPerRow].getUTCDay()===firstDay){break;}}
rowCnt=Math.ceil(dates.length/daysPerRow);}
else{rowCnt=1;daysPerRow=dates.length;}
this.rowCnt=rowCnt;this.colCnt=daysPerRow;this.daySeries=daySeries;this.cells=this.buildCells();this.headerDates=this.buildHeaderDates();}
DayTable.prototype.buildCells=function(){var rows=[];for(var row=0;row<this.rowCnt;row++){var cells=[];for(var col=0;col<this.colCnt;col++){cells.push(this.buildCell(row,col));}
rows.push(cells);}
return rows;};DayTable.prototype.buildCell=function(row,col){return{date:this.daySeries.dates[row*this.colCnt+col]};};DayTable.prototype.buildHeaderDates=function(){var dates=[];for(var col=0;col<this.colCnt;col++){dates.push(this.cells[0][col].date);}
return dates;};DayTable.prototype.sliceRange=function(range){var colCnt=this.colCnt;var seriesSeg=this.daySeries.sliceRange(range);var segs=[];if(seriesSeg){var firstIndex=seriesSeg.firstIndex,lastIndex=seriesSeg.lastIndex;var index=firstIndex;while(index<=lastIndex){var row=Math.floor(index/colCnt);var nextIndex=Math.min((row+1)*colCnt,lastIndex+1);segs.push({row:row,firstCol:index%colCnt,lastCol:(nextIndex-1)%colCnt,isStart:seriesSeg.isStart&&index===firstIndex,isEnd:seriesSeg.isEnd&&(nextIndex-1)===lastIndex});index=nextIndex;}}
return segs;};return DayTable;}());var Slicer=(function(){function Slicer(){this.sliceBusinessHours=memoize(this._sliceBusinessHours);this.sliceDateSelection=memoize(this._sliceDateSpan);this.sliceEventStore=memoize(this._sliceEventStore);this.sliceEventDrag=memoize(this._sliceInteraction);this.sliceEventResize=memoize(this._sliceInteraction);}
Slicer.prototype.sliceProps=function(props,dateProfile,nextDayThreshold,calendar,component){var extraArgs=[];for(var _i=5;_i<arguments.length;_i++){extraArgs[_i-5]=arguments[_i];}
var eventUiBases=props.eventUiBases;var eventSegs=this.sliceEventStore.apply(this,[props.eventStore,eventUiBases,dateProfile,nextDayThreshold,component].concat(extraArgs));return{dateSelectionSegs:this.sliceDateSelection.apply(this,[props.dateSelection,eventUiBases,component].concat(extraArgs)),businessHourSegs:this.sliceBusinessHours.apply(this,[props.businessHours,dateProfile,nextDayThreshold,calendar,component].concat(extraArgs)),fgEventSegs:eventSegs.fg,bgEventSegs:eventSegs.bg,eventDrag:this.sliceEventDrag.apply(this,[props.eventDrag,eventUiBases,dateProfile,nextDayThreshold,component].concat(extraArgs)),eventResize:this.sliceEventResize.apply(this,[props.eventResize,eventUiBases,dateProfile,nextDayThreshold,component].concat(extraArgs)),eventSelection:props.eventSelection};};Slicer.prototype.sliceNowDate=function(date,component){var extraArgs=[];for(var _i=2;_i<arguments.length;_i++){extraArgs[_i-2]=arguments[_i];}
return this._sliceDateSpan.apply(this,[{range:{start:date,end:addMs(date,1)},allDay:false},{},component].concat(extraArgs));};Slicer.prototype._sliceBusinessHours=function(businessHours,dateProfile,nextDayThreshold,calendar,component){var extraArgs=[];for(var _i=5;_i<arguments.length;_i++){extraArgs[_i-5]=arguments[_i];}
if(!businessHours){return[];}
return this._sliceEventStore.apply(this,[expandRecurring(businessHours,computeActiveRange(dateProfile,Boolean(nextDayThreshold)),calendar),{},dateProfile,nextDayThreshold,component].concat(extraArgs)).bg;};Slicer.prototype._sliceEventStore=function(eventStore,eventUiBases,dateProfile,nextDayThreshold,component){var extraArgs=[];for(var _i=5;_i<arguments.length;_i++){extraArgs[_i-5]=arguments[_i];}
if(eventStore){var rangeRes=sliceEventStore(eventStore,eventUiBases,computeActiveRange(dateProfile,Boolean(nextDayThreshold)),nextDayThreshold);return{bg:this.sliceEventRanges(rangeRes.bg,component,extraArgs),fg:this.sliceEventRanges(rangeRes.fg,component,extraArgs)};}
else{return{bg:[],fg:[]};}};Slicer.prototype._sliceInteraction=function(interaction,eventUiBases,dateProfile,nextDayThreshold,component){var extraArgs=[];for(var _i=5;_i<arguments.length;_i++){extraArgs[_i-5]=arguments[_i];}
if(!interaction){return null;}
var rangeRes=sliceEventStore(interaction.mutatedEvents,eventUiBases,computeActiveRange(dateProfile,Boolean(nextDayThreshold)),nextDayThreshold);return{segs:this.sliceEventRanges(rangeRes.fg,component,extraArgs),affectedInstances:interaction.affectedEvents.instances,isEvent:interaction.isEvent,sourceSeg:interaction.origSeg};};Slicer.prototype._sliceDateSpan=function(dateSpan,eventUiBases,component){var extraArgs=[];for(var _i=3;_i<arguments.length;_i++){extraArgs[_i-3]=arguments[_i];}
if(!dateSpan){return[];}
var eventRange=fabricateEventRange(dateSpan,eventUiBases,component.context.calendar);var segs=this.sliceRange.apply(this,[dateSpan.range].concat(extraArgs));for(var _a=0,segs_1=segs;_a<segs_1.length;_a++){var seg=segs_1[_a];seg.component=component;seg.eventRange=eventRange;}
return segs;};Slicer.prototype.sliceEventRanges=function(eventRanges,component,extraArgs){var segs=[];for(var _i=0,eventRanges_1=eventRanges;_i<eventRanges_1.length;_i++){var eventRange=eventRanges_1[_i];segs.push.apply(segs,this.sliceEventRange(eventRange,component,extraArgs));}
return segs;};Slicer.prototype.sliceEventRange=function(eventRange,component,extraArgs){var segs=this.sliceRange.apply(this,[eventRange.range].concat(extraArgs));for(var _i=0,segs_2=segs;_i<segs_2.length;_i++){var seg=segs_2[_i];seg.component=component;seg.eventRange=eventRange;seg.isStart=eventRange.isStart&&seg.isStart;seg.isEnd=eventRange.isEnd&&seg.isEnd;}
return segs;};return Slicer;}());function computeActiveRange(dateProfile,isComponentAllDay){var range=dateProfile.activeRange;if(isComponentAllDay){return range;}
return{start:addMs(range.start,dateProfile.minTime.milliseconds),end:addMs(range.end,dateProfile.maxTime.milliseconds-864e5)};}
var version='4.4.0';exports.Calendar=Calendar;exports.Component=Component;exports.ComponentContext=ComponentContext;exports.DateComponent=DateComponent;exports.DateEnv=DateEnv;exports.DateProfileGenerator=DateProfileGenerator;exports.DayHeader=DayHeader;exports.DaySeries=DaySeries;exports.DayTable=DayTable;exports.ElementDragging=ElementDragging;exports.ElementScrollController=ElementScrollController;exports.EmitterMixin=EmitterMixin;exports.EventApi=EventApi;exports.FgEventRenderer=FgEventRenderer;exports.FillRenderer=FillRenderer;exports.Interaction=Interaction;exports.Mixin=Mixin;exports.NamedTimeZoneImpl=NamedTimeZoneImpl;exports.PositionCache=PositionCache;exports.ScrollComponent=ScrollComponent;exports.ScrollController=ScrollController;exports.Slicer=Slicer;exports.Splitter=Splitter;exports.Theme=Theme;exports.View=View;exports.WindowScrollController=WindowScrollController;exports.addDays=addDays;exports.addDurations=addDurations;exports.addMs=addMs;exports.addWeeks=addWeeks;exports.allowContextMenu=allowContextMenu;exports.allowSelection=allowSelection;exports.appendToElement=appendToElement;exports.applyAll=applyAll;exports.applyMutationToEventStore=applyMutationToEventStore;exports.applyStyle=applyStyle;exports.applyStyleProp=applyStyleProp;exports.asRoughMinutes=asRoughMinutes;exports.asRoughMs=asRoughMs;exports.asRoughSeconds=asRoughSeconds;exports.buildGotoAnchorHtml=buildGotoAnchorHtml;exports.buildSegCompareObj=buildSegCompareObj;exports.capitaliseFirstLetter=capitaliseFirstLetter;exports.combineEventUis=combineEventUis;exports.compareByFieldSpec=compareByFieldSpec;exports.compareByFieldSpecs=compareByFieldSpecs;exports.compareNumbers=compareNumbers;exports.compensateScroll=compensateScroll;exports.computeClippingRect=computeClippingRect;exports.computeEdges=computeEdges;exports.computeEventDraggable=computeEventDraggable;exports.computeEventEndResizable=computeEventEndResizable;exports.computeEventStartResizable=computeEventStartResizable;exports.computeFallbackHeaderFormat=computeFallbackHeaderFormat;exports.computeHeightAndMargins=computeHeightAndMargins;exports.computeInnerRect=computeInnerRect;exports.computeRect=computeRect;exports.computeVisibleDayRange=computeVisibleDayRange;exports.config=config;exports.constrainPoint=constrainPoint;exports.createDuration=createDuration;exports.createElement=createElement;exports.createEmptyEventStore=createEmptyEventStore;exports.createEventInstance=createEventInstance;exports.createFormatter=createFormatter;exports.createPlugin=createPlugin;exports.cssToStr=cssToStr;exports.debounce=debounce;exports.diffDates=diffDates;exports.diffDayAndTime=diffDayAndTime;exports.diffDays=diffDays;exports.diffPoints=diffPoints;exports.diffWeeks=diffWeeks;exports.diffWholeDays=diffWholeDays;exports.diffWholeWeeks=diffWholeWeeks;exports.disableCursor=disableCursor;exports.distributeHeight=distributeHeight;exports.elementClosest=elementClosest;exports.elementMatches=elementMatches;exports.enableCursor=enableCursor;exports.eventTupleToStore=eventTupleToStore;exports.filterEventStoreDefs=filterEventStoreDefs;exports.filterHash=filterHash;exports.findChildren=findChildren;exports.findElements=findElements;exports.flexibleCompare=flexibleCompare;exports.forceClassName=forceClassName;exports.formatDate=formatDate;exports.formatIsoTimeString=formatIsoTimeString;exports.formatRange=formatRange;exports.getAllDayHtml=getAllDayHtml;exports.getClippingParents=getClippingParents;exports.getDayClasses=getDayClasses;exports.getElSeg=getElSeg;exports.getRectCenter=getRectCenter;exports.getRelevantEvents=getRelevantEvents;exports.globalDefaults=globalDefaults;exports.greatestDurationDenominator=greatestDurationDenominator;exports.hasBgRendering=hasBgRendering;exports.htmlEscape=htmlEscape;exports.htmlToElement=htmlToElement;exports.insertAfterElement=insertAfterElement;exports.interactionSettingsStore=interactionSettingsStore;exports.interactionSettingsToStore=interactionSettingsToStore;exports.intersectRanges=intersectRanges;exports.intersectRects=intersectRects;exports.isArraysEqual=isArraysEqual;exports.isDateSpansEqual=isDateSpansEqual;exports.isInt=isInt;exports.isInteractionValid=isInteractionValid;exports.isMultiDayRange=isMultiDayRange;exports.isPropsEqual=isPropsEqual;exports.isPropsValid=isPropsValid;exports.isSingleDay=isSingleDay;exports.isValidDate=isValidDate;exports.listenBySelector=listenBySelector;exports.mapHash=mapHash;exports.matchCellWidths=matchCellWidths;exports.memoize=memoize;exports.memoizeOutput=memoizeOutput;exports.memoizeRendering=memoizeRendering;exports.mergeEventStores=mergeEventStores;exports.multiplyDuration=multiplyDuration;exports.padStart=padStart;exports.parseBusinessHours=parseBusinessHours;exports.parseDragMeta=parseDragMeta;exports.parseEventDef=parseEventDef;exports.parseFieldSpecs=parseFieldSpecs;exports.parseMarker=parse;exports.pointInsideRect=pointInsideRect;exports.prependToElement=prependToElement;exports.preventContextMenu=preventContextMenu;exports.preventDefault=preventDefault;exports.preventSelection=preventSelection;exports.processScopedUiProps=processScopedUiProps;exports.rangeContainsMarker=rangeContainsMarker;exports.rangeContainsRange=rangeContainsRange;exports.rangesEqual=rangesEqual;exports.rangesIntersect=rangesIntersect;exports.refineProps=refineProps;exports.removeElement=removeElement;exports.removeExact=removeExact;exports.renderDateCell=renderDateCell;exports.requestJson=requestJson;exports.sliceEventStore=sliceEventStore;exports.startOfDay=startOfDay;exports.subtractInnerElHeight=subtractInnerElHeight;exports.translateRect=translateRect;exports.uncompensateScroll=uncompensateScroll;exports.undistributeHeight=undistributeHeight;exports.unpromisify=unpromisify;exports.version=version;exports.whenTransitionDone=whenTransitionDone;exports.wholeDivideDurations=wholeDivideDurations;Object.defineProperty(exports,'__esModule',{value:true});}));;

/* /web/static/lib/fullcalendar/moment/main.js defined in bundle 'web.tests_assets' */
(function(global,factory){typeof exports==='object'&&typeof module!=='undefined'?factory(exports,require('moment'),require('@fullcalendar/core')):typeof define==='function'&&define.amd?define(['exports','moment','@fullcalendar/core'],factory):(global=global||self,factory(global.FullCalendarMoment={},global.moment,global.FullCalendar));}(this,function(exports,momentNs,core){'use strict';var moment=momentNs;function toMoment(date,calendar){if(!(calendar instanceof core.Calendar)){throw new Error('must supply a Calendar instance');}
return convertToMoment(date,calendar.dateEnv.timeZone,null,calendar.dateEnv.locale.codes[0]);}
function toDuration(fcDuration){return moment.duration(fcDuration);}
function formatWithCmdStr(cmdStr,arg){var cmd=parseCmdStr(cmdStr);if(arg.end){var startMom=convertToMoment(arg.start.array,arg.timeZone,arg.start.timeZoneOffset,arg.localeCodes[0]);var endMom=convertToMoment(arg.end.array,arg.timeZone,arg.end.timeZoneOffset,arg.localeCodes[0]);return formatRange(cmd,createMomentFormatFunc(startMom),createMomentFormatFunc(endMom),arg.separator);}
return convertToMoment(arg.date.array,arg.timeZone,arg.date.timeZoneOffset,arg.localeCodes[0]).format(cmd.whole);}
var main=core.createPlugin({cmdFormatter:formatWithCmdStr});function createMomentFormatFunc(mom){return function(cmdStr){return cmdStr?mom.format(cmdStr):'';};}
function convertToMoment(input,timeZone,timeZoneOffset,locale){var mom;if(timeZone==='local'){mom=moment(input);}
else if(timeZone==='UTC'){mom=moment.utc(input);}
else if(moment.tz){mom=moment.tz(input,timeZone);}
else{mom=moment.utc(input);if(timeZoneOffset!=null){mom.utcOffset(timeZoneOffset);}}
mom.locale(locale);return mom;}
function parseCmdStr(cmdStr){var parts=cmdStr.match(/^(.*?)\{(.*)\}(.*)$/);if(parts){var middle=parseCmdStr(parts[2]);return{head:parts[1],middle:middle,tail:parts[3],whole:parts[1]+middle.whole+parts[3]};}
else{return{head:null,middle:null,tail:null,whole:cmdStr};}}
function formatRange(cmd,formatStart,formatEnd,separator){if(cmd.middle){var startHead=formatStart(cmd.head);var startMiddle=formatRange(cmd.middle,formatStart,formatEnd,separator);var startTail=formatStart(cmd.tail);var endHead=formatEnd(cmd.head);var endMiddle=formatRange(cmd.middle,formatStart,formatEnd,separator);var endTail=formatEnd(cmd.tail);if(startHead===endHead&&startTail===endTail){return startHead+
(startMiddle===endMiddle?startMiddle:startMiddle+separator+endMiddle)+
startTail;}}
var startWhole=formatStart(cmd.whole);var endWhole=formatEnd(cmd.whole);if(startWhole===endWhole){return startWhole;}
else{return startWhole+separator+endWhole;}}
exports.default=main;exports.toDuration=toDuration;exports.toMoment=toMoment;Object.defineProperty(exports,'__esModule',{value:true});}));;

/* /web/static/lib/fullcalendar/interaction/main.js defined in bundle 'web.tests_assets' */
(function(global,factory){typeof exports==='object'&&typeof module!=='undefined'?factory(exports,require('@fullcalendar/core')):typeof define==='function'&&define.amd?define(['exports','@fullcalendar/core'],factory):(global=global||self,factory(global.FullCalendarInteraction={},global.FullCalendar));}(this,function(exports,core){'use strict';var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b;})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];};return extendStatics(d,b);};function __extends(d,b){extendStatics(d,b);function __(){this.constructor=d;}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __());}
var __assign=function(){__assign=Object.assign||function __assign(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p))t[p]=s[p];}
return t;};return __assign.apply(this,arguments);};core.config.touchMouseIgnoreWait=500;var ignoreMouseDepth=0;var listenerCnt=0;var isWindowTouchMoveCancelled=false;var PointerDragging=(function(){function PointerDragging(containerEl){var _this=this;this.subjectEl=null;this.downEl=null;this.selector='';this.handleSelector='';this.shouldIgnoreMove=false;this.shouldWatchScroll=true;this.isDragging=false;this.isTouchDragging=false;this.wasTouchScroll=false;this.handleMouseDown=function(ev){if(!_this.shouldIgnoreMouse()&&isPrimaryMouseButton(ev)&&_this.tryStart(ev)){var pev=_this.createEventFromMouse(ev,true);_this.emitter.trigger('pointerdown',pev);_this.initScrollWatch(pev);if(!_this.shouldIgnoreMove){document.addEventListener('mousemove',_this.handleMouseMove);}
document.addEventListener('mouseup',_this.handleMouseUp);}};this.handleMouseMove=function(ev){var pev=_this.createEventFromMouse(ev);_this.recordCoords(pev);_this.emitter.trigger('pointermove',pev);};this.handleMouseUp=function(ev){document.removeEventListener('mousemove',_this.handleMouseMove);document.removeEventListener('mouseup',_this.handleMouseUp);_this.emitter.trigger('pointerup',_this.createEventFromMouse(ev));_this.cleanup();};this.handleTouchStart=function(ev){if(_this.tryStart(ev)){_this.isTouchDragging=true;var pev=_this.createEventFromTouch(ev,true);_this.emitter.trigger('pointerdown',pev);_this.initScrollWatch(pev);var target=ev.target;if(!_this.shouldIgnoreMove){target.addEventListener('touchmove',_this.handleTouchMove);}
target.addEventListener('touchend',_this.handleTouchEnd);target.addEventListener('touchcancel',_this.handleTouchEnd);window.addEventListener('scroll',_this.handleTouchScroll,true);}};this.handleTouchMove=function(ev){var pev=_this.createEventFromTouch(ev);_this.recordCoords(pev);_this.emitter.trigger('pointermove',pev);};this.handleTouchEnd=function(ev){if(_this.isDragging){var target=ev.target;target.removeEventListener('touchmove',_this.handleTouchMove);target.removeEventListener('touchend',_this.handleTouchEnd);target.removeEventListener('touchcancel',_this.handleTouchEnd);window.removeEventListener('scroll',_this.handleTouchScroll,true);_this.emitter.trigger('pointerup',_this.createEventFromTouch(ev));_this.cleanup();_this.isTouchDragging=false;startIgnoringMouse();}};this.handleTouchScroll=function(){_this.wasTouchScroll=true;};this.handleScroll=function(ev){if(!_this.shouldIgnoreMove){var pageX=(window.pageXOffset-_this.prevScrollX)+_this.prevPageX;var pageY=(window.pageYOffset-_this.prevScrollY)+_this.prevPageY;_this.emitter.trigger('pointermove',{origEvent:ev,isTouch:_this.isTouchDragging,subjectEl:_this.subjectEl,pageX:pageX,pageY:pageY,deltaX:pageX-_this.origPageX,deltaY:pageY-_this.origPageY});}};this.containerEl=containerEl;this.emitter=new core.EmitterMixin();containerEl.addEventListener('mousedown',this.handleMouseDown);containerEl.addEventListener('touchstart',this.handleTouchStart,{passive:true});listenerCreated();}
PointerDragging.prototype.destroy=function(){this.containerEl.removeEventListener('mousedown',this.handleMouseDown);this.containerEl.removeEventListener('touchstart',this.handleTouchStart,{passive:true});listenerDestroyed();};PointerDragging.prototype.tryStart=function(ev){var subjectEl=this.querySubjectEl(ev);var downEl=ev.target;if(subjectEl&&(!this.handleSelector||core.elementClosest(downEl,this.handleSelector))){this.subjectEl=subjectEl;this.downEl=downEl;this.isDragging=true;this.wasTouchScroll=false;return true;}
return false;};PointerDragging.prototype.cleanup=function(){isWindowTouchMoveCancelled=false;this.isDragging=false;this.subjectEl=null;this.downEl=null;this.destroyScrollWatch();};PointerDragging.prototype.querySubjectEl=function(ev){if(this.selector){return core.elementClosest(ev.target,this.selector);}
else{return this.containerEl;}};PointerDragging.prototype.shouldIgnoreMouse=function(){return ignoreMouseDepth||this.isTouchDragging;};PointerDragging.prototype.cancelTouchScroll=function(){if(this.isDragging){isWindowTouchMoveCancelled=true;}};PointerDragging.prototype.initScrollWatch=function(ev){if(this.shouldWatchScroll){this.recordCoords(ev);window.addEventListener('scroll',this.handleScroll,true);}};PointerDragging.prototype.recordCoords=function(ev){if(this.shouldWatchScroll){this.prevPageX=ev.pageX;this.prevPageY=ev.pageY;this.prevScrollX=window.pageXOffset;this.prevScrollY=window.pageYOffset;}};PointerDragging.prototype.destroyScrollWatch=function(){if(this.shouldWatchScroll){window.removeEventListener('scroll',this.handleScroll,true);}};PointerDragging.prototype.createEventFromMouse=function(ev,isFirst){var deltaX=0;var deltaY=0;if(isFirst){this.origPageX=ev.pageX;this.origPageY=ev.pageY;}
else{deltaX=ev.pageX-this.origPageX;deltaY=ev.pageY-this.origPageY;}
return{origEvent:ev,isTouch:false,subjectEl:this.subjectEl,pageX:ev.pageX,pageY:ev.pageY,deltaX:deltaX,deltaY:deltaY};};PointerDragging.prototype.createEventFromTouch=function(ev,isFirst){var touches=ev.touches;var pageX;var pageY;var deltaX=0;var deltaY=0;if(touches&&touches.length){pageX=touches[0].pageX;pageY=touches[0].pageY;}
else{pageX=ev.pageX;pageY=ev.pageY;}
if(isFirst){this.origPageX=pageX;this.origPageY=pageY;}
else{deltaX=pageX-this.origPageX;deltaY=pageY-this.origPageY;}
return{origEvent:ev,isTouch:true,subjectEl:this.subjectEl,pageX:pageX,pageY:pageY,deltaX:deltaX,deltaY:deltaY};};return PointerDragging;}());function isPrimaryMouseButton(ev){return ev.button===0&&!ev.ctrlKey;}
function startIgnoringMouse(){ignoreMouseDepth++;setTimeout(function(){ignoreMouseDepth--;},core.config.touchMouseIgnoreWait);}
function listenerCreated(){if(!(listenerCnt++)){window.addEventListener('touchmove',onWindowTouchMove,{passive:false});}}
function listenerDestroyed(){if(!(--listenerCnt)){window.removeEventListener('touchmove',onWindowTouchMove,{passive:false});}}
function onWindowTouchMove(ev){if(isWindowTouchMoveCancelled){ev.preventDefault();}}
var ElementMirror=(function(){function ElementMirror(){this.isVisible=false;this.sourceEl=null;this.mirrorEl=null;this.sourceElRect=null;this.parentNode=document.body;this.zIndex=9999;this.revertDuration=0;}
ElementMirror.prototype.start=function(sourceEl,pageX,pageY){this.sourceEl=sourceEl;this.sourceElRect=this.sourceEl.getBoundingClientRect();this.origScreenX=pageX-window.pageXOffset;this.origScreenY=pageY-window.pageYOffset;this.deltaX=0;this.deltaY=0;this.updateElPosition();};ElementMirror.prototype.handleMove=function(pageX,pageY){this.deltaX=(pageX-window.pageXOffset)-this.origScreenX;this.deltaY=(pageY-window.pageYOffset)-this.origScreenY;this.updateElPosition();};ElementMirror.prototype.setIsVisible=function(bool){if(bool){if(!this.isVisible){if(this.mirrorEl){this.mirrorEl.style.display='';}
this.isVisible=bool;this.updateElPosition();}}
else{if(this.isVisible){if(this.mirrorEl){this.mirrorEl.style.display='none';}
this.isVisible=bool;}}};ElementMirror.prototype.stop=function(needsRevertAnimation,callback){var _this=this;var done=function(){_this.cleanup();callback();};if(needsRevertAnimation&&this.mirrorEl&&this.isVisible&&this.revertDuration&&(this.deltaX||this.deltaY)){this.doRevertAnimation(done,this.revertDuration);}
else{setTimeout(done,0);}};ElementMirror.prototype.doRevertAnimation=function(callback,revertDuration){var mirrorEl=this.mirrorEl;var finalSourceElRect=this.sourceEl.getBoundingClientRect();mirrorEl.style.transition='top '+revertDuration+'ms,'+'left '+revertDuration+'ms';core.applyStyle(mirrorEl,{left:finalSourceElRect.left,top:finalSourceElRect.top});core.whenTransitionDone(mirrorEl,function(){mirrorEl.style.transition='';callback();});};ElementMirror.prototype.cleanup=function(){if(this.mirrorEl){core.removeElement(this.mirrorEl);this.mirrorEl=null;}
this.sourceEl=null;};ElementMirror.prototype.updateElPosition=function(){if(this.sourceEl&&this.isVisible){core.applyStyle(this.getMirrorEl(),{left:this.sourceElRect.left+this.deltaX,top:this.sourceElRect.top+this.deltaY});}};ElementMirror.prototype.getMirrorEl=function(){var sourceElRect=this.sourceElRect;var mirrorEl=this.mirrorEl;if(!mirrorEl){mirrorEl=this.mirrorEl=this.sourceEl.cloneNode(true);mirrorEl.classList.add('fc-unselectable');mirrorEl.classList.add('fc-dragging');core.applyStyle(mirrorEl,{position:'fixed',zIndex:this.zIndex,visibility:'',boxSizing:'border-box',width:sourceElRect.right-sourceElRect.left,height:sourceElRect.bottom-sourceElRect.top,right:'auto',bottom:'auto',margin:0});this.parentNode.appendChild(mirrorEl);}
return mirrorEl;};return ElementMirror;}());var ScrollGeomCache=(function(_super){__extends(ScrollGeomCache,_super);function ScrollGeomCache(scrollController,doesListening){var _this=_super.call(this)||this;_this.handleScroll=function(){_this.scrollTop=_this.scrollController.getScrollTop();_this.scrollLeft=_this.scrollController.getScrollLeft();_this.handleScrollChange();};_this.scrollController=scrollController;_this.doesListening=doesListening;_this.scrollTop=_this.origScrollTop=scrollController.getScrollTop();_this.scrollLeft=_this.origScrollLeft=scrollController.getScrollLeft();_this.scrollWidth=scrollController.getScrollWidth();_this.scrollHeight=scrollController.getScrollHeight();_this.clientWidth=scrollController.getClientWidth();_this.clientHeight=scrollController.getClientHeight();_this.clientRect=_this.computeClientRect();if(_this.doesListening){_this.getEventTarget().addEventListener('scroll',_this.handleScroll);}
return _this;}
ScrollGeomCache.prototype.destroy=function(){if(this.doesListening){this.getEventTarget().removeEventListener('scroll',this.handleScroll);}};ScrollGeomCache.prototype.getScrollTop=function(){return this.scrollTop;};ScrollGeomCache.prototype.getScrollLeft=function(){return this.scrollLeft;};ScrollGeomCache.prototype.setScrollTop=function(top){this.scrollController.setScrollTop(top);if(!this.doesListening){this.scrollTop=Math.max(Math.min(top,this.getMaxScrollTop()),0);this.handleScrollChange();}};ScrollGeomCache.prototype.setScrollLeft=function(top){this.scrollController.setScrollLeft(top);if(!this.doesListening){this.scrollLeft=Math.max(Math.min(top,this.getMaxScrollLeft()),0);this.handleScrollChange();}};ScrollGeomCache.prototype.getClientWidth=function(){return this.clientWidth;};ScrollGeomCache.prototype.getClientHeight=function(){return this.clientHeight;};ScrollGeomCache.prototype.getScrollWidth=function(){return this.scrollWidth;};ScrollGeomCache.prototype.getScrollHeight=function(){return this.scrollHeight;};ScrollGeomCache.prototype.handleScrollChange=function(){};return ScrollGeomCache;}(core.ScrollController));var ElementScrollGeomCache=(function(_super){__extends(ElementScrollGeomCache,_super);function ElementScrollGeomCache(el,doesListening){return _super.call(this,new core.ElementScrollController(el),doesListening)||this;}
ElementScrollGeomCache.prototype.getEventTarget=function(){return this.scrollController.el;};ElementScrollGeomCache.prototype.computeClientRect=function(){return core.computeInnerRect(this.scrollController.el);};return ElementScrollGeomCache;}(ScrollGeomCache));var WindowScrollGeomCache=(function(_super){__extends(WindowScrollGeomCache,_super);function WindowScrollGeomCache(doesListening){return _super.call(this,new core.WindowScrollController(),doesListening)||this;}
WindowScrollGeomCache.prototype.getEventTarget=function(){return window;};WindowScrollGeomCache.prototype.computeClientRect=function(){return{left:this.scrollLeft,right:this.scrollLeft+this.clientWidth,top:this.scrollTop,bottom:this.scrollTop+this.clientHeight};};WindowScrollGeomCache.prototype.handleScrollChange=function(){this.clientRect=this.computeClientRect();};return WindowScrollGeomCache;}(ScrollGeomCache));var getTime=typeof performance==='function'?performance.now:Date.now;var AutoScroller=(function(){function AutoScroller(){var _this=this;this.isEnabled=true;this.scrollQuery=[window,'.fc-scroller'];this.edgeThreshold=50;this.maxVelocity=300;this.pointerScreenX=null;this.pointerScreenY=null;this.isAnimating=false;this.scrollCaches=null;this.everMovedUp=false;this.everMovedDown=false;this.everMovedLeft=false;this.everMovedRight=false;this.animate=function(){if(_this.isAnimating){var edge=_this.computeBestEdge(_this.pointerScreenX+window.pageXOffset,_this.pointerScreenY+window.pageYOffset);if(edge){var now=getTime();_this.handleSide(edge,(now-_this.msSinceRequest)/1000);_this.requestAnimation(now);}
else{_this.isAnimating=false;}}};}
AutoScroller.prototype.start=function(pageX,pageY){if(this.isEnabled){this.scrollCaches=this.buildCaches();this.pointerScreenX=null;this.pointerScreenY=null;this.everMovedUp=false;this.everMovedDown=false;this.everMovedLeft=false;this.everMovedRight=false;this.handleMove(pageX,pageY);}};AutoScroller.prototype.handleMove=function(pageX,pageY){if(this.isEnabled){var pointerScreenX=pageX-window.pageXOffset;var pointerScreenY=pageY-window.pageYOffset;var yDelta=this.pointerScreenY===null?0:pointerScreenY-this.pointerScreenY;var xDelta=this.pointerScreenX===null?0:pointerScreenX-this.pointerScreenX;if(yDelta<0){this.everMovedUp=true;}
else if(yDelta>0){this.everMovedDown=true;}
if(xDelta<0){this.everMovedLeft=true;}
else if(xDelta>0){this.everMovedRight=true;}
this.pointerScreenX=pointerScreenX;this.pointerScreenY=pointerScreenY;if(!this.isAnimating){this.isAnimating=true;this.requestAnimation(getTime());}}};AutoScroller.prototype.stop=function(){if(this.isEnabled){this.isAnimating=false;for(var _i=0,_a=this.scrollCaches;_i<_a.length;_i++){var scrollCache=_a[_i];scrollCache.destroy();}
this.scrollCaches=null;}};AutoScroller.prototype.requestAnimation=function(now){this.msSinceRequest=now;requestAnimationFrame(this.animate);};AutoScroller.prototype.handleSide=function(edge,seconds){var scrollCache=edge.scrollCache;var edgeThreshold=this.edgeThreshold;var invDistance=edgeThreshold-edge.distance;var velocity=(invDistance*invDistance)/(edgeThreshold*edgeThreshold)*this.maxVelocity*seconds;var sign=1;switch(edge.name){case'left':sign=-1;case'right':scrollCache.setScrollLeft(scrollCache.getScrollLeft()+velocity*sign);break;case'top':sign=-1;case'bottom':scrollCache.setScrollTop(scrollCache.getScrollTop()+velocity*sign);break;}};AutoScroller.prototype.computeBestEdge=function(left,top){var edgeThreshold=this.edgeThreshold;var bestSide=null;for(var _i=0,_a=this.scrollCaches;_i<_a.length;_i++){var scrollCache=_a[_i];var rect=scrollCache.clientRect;var leftDist=left-rect.left;var rightDist=rect.right-left;var topDist=top-rect.top;var bottomDist=rect.bottom-top;if(leftDist>=0&&rightDist>=0&&topDist>=0&&bottomDist>=0){if(topDist<=edgeThreshold&&this.everMovedUp&&scrollCache.canScrollUp()&&(!bestSide||bestSide.distance>topDist)){bestSide={scrollCache:scrollCache,name:'top',distance:topDist};}
if(bottomDist<=edgeThreshold&&this.everMovedDown&&scrollCache.canScrollDown()&&(!bestSide||bestSide.distance>bottomDist)){bestSide={scrollCache:scrollCache,name:'bottom',distance:bottomDist};}
if(leftDist<=edgeThreshold&&this.everMovedLeft&&scrollCache.canScrollLeft()&&(!bestSide||bestSide.distance>leftDist)){bestSide={scrollCache:scrollCache,name:'left',distance:leftDist};}
if(rightDist<=edgeThreshold&&this.everMovedRight&&scrollCache.canScrollRight()&&(!bestSide||bestSide.distance>rightDist)){bestSide={scrollCache:scrollCache,name:'right',distance:rightDist};}}}
return bestSide;};AutoScroller.prototype.buildCaches=function(){return this.queryScrollEls().map(function(el){if(el===window){return new WindowScrollGeomCache(false);}
else{return new ElementScrollGeomCache(el,false);}});};AutoScroller.prototype.queryScrollEls=function(){var els=[];for(var _i=0,_a=this.scrollQuery;_i<_a.length;_i++){var query=_a[_i];if(typeof query==='object'){els.push(query);}
else{els.push.apply(els,Array.prototype.slice.call(document.querySelectorAll(query)));}}
return els;};return AutoScroller;}());var FeaturefulElementDragging=(function(_super){__extends(FeaturefulElementDragging,_super);function FeaturefulElementDragging(containerEl){var _this=_super.call(this,containerEl)||this;_this.delay=null;_this.minDistance=0;_this.touchScrollAllowed=true;_this.mirrorNeedsRevert=false;_this.isInteracting=false;_this.isDragging=false;_this.isDelayEnded=false;_this.isDistanceSurpassed=false;_this.delayTimeoutId=null;_this.onPointerDown=function(ev){if(!_this.isDragging){_this.isInteracting=true;_this.isDelayEnded=false;_this.isDistanceSurpassed=false;core.preventSelection(document.body);core.preventContextMenu(document.body);if(!ev.isTouch){ev.origEvent.preventDefault();}
_this.emitter.trigger('pointerdown',ev);if(!_this.pointer.shouldIgnoreMove){_this.mirror.setIsVisible(false);_this.mirror.start(ev.subjectEl,ev.pageX,ev.pageY);_this.startDelay(ev);if(!_this.minDistance){_this.handleDistanceSurpassed(ev);}}}};_this.onPointerMove=function(ev){if(_this.isInteracting){_this.emitter.trigger('pointermove',ev);if(!_this.isDistanceSurpassed){var minDistance=_this.minDistance;var distanceSq=void 0;var deltaX=ev.deltaX,deltaY=ev.deltaY;distanceSq=deltaX*deltaX+deltaY*deltaY;if(distanceSq>=minDistance*minDistance){_this.handleDistanceSurpassed(ev);}}
if(_this.isDragging){if(ev.origEvent.type!=='scroll'){_this.mirror.handleMove(ev.pageX,ev.pageY);_this.autoScroller.handleMove(ev.pageX,ev.pageY);}
_this.emitter.trigger('dragmove',ev);}}};_this.onPointerUp=function(ev){if(_this.isInteracting){_this.isInteracting=false;core.allowSelection(document.body);core.allowContextMenu(document.body);_this.emitter.trigger('pointerup',ev);if(_this.isDragging){_this.autoScroller.stop();_this.tryStopDrag(ev);}
if(_this.delayTimeoutId){clearTimeout(_this.delayTimeoutId);_this.delayTimeoutId=null;}}};var pointer=_this.pointer=new PointerDragging(containerEl);pointer.emitter.on('pointerdown',_this.onPointerDown);pointer.emitter.on('pointermove',_this.onPointerMove);pointer.emitter.on('pointerup',_this.onPointerUp);_this.mirror=new ElementMirror();_this.autoScroller=new AutoScroller();return _this;}
FeaturefulElementDragging.prototype.destroy=function(){this.pointer.destroy();};FeaturefulElementDragging.prototype.startDelay=function(ev){var _this=this;if(typeof this.delay==='number'){this.delayTimeoutId=setTimeout(function(){_this.delayTimeoutId=null;_this.handleDelayEnd(ev);},this.delay);}
else{this.handleDelayEnd(ev);}};FeaturefulElementDragging.prototype.handleDelayEnd=function(ev){this.isDelayEnded=true;this.tryStartDrag(ev);};FeaturefulElementDragging.prototype.handleDistanceSurpassed=function(ev){this.isDistanceSurpassed=true;this.tryStartDrag(ev);};FeaturefulElementDragging.prototype.tryStartDrag=function(ev){if(this.isDelayEnded&&this.isDistanceSurpassed){if(!this.pointer.wasTouchScroll||this.touchScrollAllowed){this.isDragging=true;this.mirrorNeedsRevert=false;this.autoScroller.start(ev.pageX,ev.pageY);this.emitter.trigger('dragstart',ev);if(this.touchScrollAllowed===false){this.pointer.cancelTouchScroll();}}}};FeaturefulElementDragging.prototype.tryStopDrag=function(ev){this.mirror.stop(this.mirrorNeedsRevert,this.stopDrag.bind(this,ev));};FeaturefulElementDragging.prototype.stopDrag=function(ev){this.isDragging=false;this.emitter.trigger('dragend',ev);};FeaturefulElementDragging.prototype.setIgnoreMove=function(bool){this.pointer.shouldIgnoreMove=bool;};FeaturefulElementDragging.prototype.setMirrorIsVisible=function(bool){this.mirror.setIsVisible(bool);};FeaturefulElementDragging.prototype.setMirrorNeedsRevert=function(bool){this.mirrorNeedsRevert=bool;};FeaturefulElementDragging.prototype.setAutoScrollEnabled=function(bool){this.autoScroller.isEnabled=bool;};return FeaturefulElementDragging;}(core.ElementDragging));var OffsetTracker=(function(){function OffsetTracker(el){this.origRect=core.computeRect(el);this.scrollCaches=core.getClippingParents(el).map(function(el){return new ElementScrollGeomCache(el,true);});}
OffsetTracker.prototype.destroy=function(){for(var _i=0,_a=this.scrollCaches;_i<_a.length;_i++){var scrollCache=_a[_i];scrollCache.destroy();}};OffsetTracker.prototype.computeLeft=function(){var left=this.origRect.left;for(var _i=0,_a=this.scrollCaches;_i<_a.length;_i++){var scrollCache=_a[_i];left+=scrollCache.origScrollLeft-scrollCache.getScrollLeft();}
return left;};OffsetTracker.prototype.computeTop=function(){var top=this.origRect.top;for(var _i=0,_a=this.scrollCaches;_i<_a.length;_i++){var scrollCache=_a[_i];top+=scrollCache.origScrollTop-scrollCache.getScrollTop();}
return top;};OffsetTracker.prototype.isWithinClipping=function(pageX,pageY){var point={left:pageX,top:pageY};for(var _i=0,_a=this.scrollCaches;_i<_a.length;_i++){var scrollCache=_a[_i];if(!isIgnoredClipping(scrollCache.getEventTarget())&&!core.pointInsideRect(point,scrollCache.clientRect)){return false;}}
return true;};return OffsetTracker;}());function isIgnoredClipping(node){var tagName=node.tagName;return tagName==='HTML'||tagName==='BODY';}
var HitDragging=(function(){function HitDragging(dragging,droppableStore){var _this=this;this.useSubjectCenter=false;this.requireInitial=true;this.initialHit=null;this.movingHit=null;this.finalHit=null;this.handlePointerDown=function(ev){var dragging=_this.dragging;_this.initialHit=null;_this.movingHit=null;_this.finalHit=null;_this.prepareHits();_this.processFirstCoord(ev);if(_this.initialHit||!_this.requireInitial){dragging.setIgnoreMove(false);_this.emitter.trigger('pointerdown',ev);}
else{dragging.setIgnoreMove(true);}};this.handleDragStart=function(ev){_this.emitter.trigger('dragstart',ev);_this.handleMove(ev,true);};this.handleDragMove=function(ev){_this.emitter.trigger('dragmove',ev);_this.handleMove(ev);};this.handlePointerUp=function(ev){_this.releaseHits();_this.emitter.trigger('pointerup',ev);};this.handleDragEnd=function(ev){if(_this.movingHit){_this.emitter.trigger('hitupdate',null,true,ev);}
_this.finalHit=_this.movingHit;_this.movingHit=null;_this.emitter.trigger('dragend',ev);};this.droppableStore=droppableStore;dragging.emitter.on('pointerdown',this.handlePointerDown);dragging.emitter.on('dragstart',this.handleDragStart);dragging.emitter.on('dragmove',this.handleDragMove);dragging.emitter.on('pointerup',this.handlePointerUp);dragging.emitter.on('dragend',this.handleDragEnd);this.dragging=dragging;this.emitter=new core.EmitterMixin();}
HitDragging.prototype.processFirstCoord=function(ev){var origPoint={left:ev.pageX,top:ev.pageY};var adjustedPoint=origPoint;var subjectEl=ev.subjectEl;var subjectRect;if(subjectEl!==document){subjectRect=core.computeRect(subjectEl);adjustedPoint=core.constrainPoint(adjustedPoint,subjectRect);}
var initialHit=this.initialHit=this.queryHitForOffset(adjustedPoint.left,adjustedPoint.top);if(initialHit){if(this.useSubjectCenter&&subjectRect){var slicedSubjectRect=core.intersectRects(subjectRect,initialHit.rect);if(slicedSubjectRect){adjustedPoint=core.getRectCenter(slicedSubjectRect);}}
this.coordAdjust=core.diffPoints(adjustedPoint,origPoint);}
else{this.coordAdjust={left:0,top:0};}};HitDragging.prototype.handleMove=function(ev,forceHandle){var hit=this.queryHitForOffset(ev.pageX+this.coordAdjust.left,ev.pageY+this.coordAdjust.top);if(forceHandle||!isHitsEqual(this.movingHit,hit)){this.movingHit=hit;this.emitter.trigger('hitupdate',hit,false,ev);}};HitDragging.prototype.prepareHits=function(){this.offsetTrackers=core.mapHash(this.droppableStore,function(interactionSettings){interactionSettings.component.buildPositionCaches();return new OffsetTracker(interactionSettings.el);});};HitDragging.prototype.releaseHits=function(){var offsetTrackers=this.offsetTrackers;for(var id in offsetTrackers){offsetTrackers[id].destroy();}
this.offsetTrackers={};};HitDragging.prototype.queryHitForOffset=function(offsetLeft,offsetTop){var _a=this,droppableStore=_a.droppableStore,offsetTrackers=_a.offsetTrackers;var bestHit=null;for(var id in droppableStore){var component=droppableStore[id].component;var offsetTracker=offsetTrackers[id];if(offsetTracker.isWithinClipping(offsetLeft,offsetTop)){var originLeft=offsetTracker.computeLeft();var originTop=offsetTracker.computeTop();var positionLeft=offsetLeft-originLeft;var positionTop=offsetTop-originTop;var origRect=offsetTracker.origRect;var width=origRect.right-origRect.left;var height=origRect.bottom-origRect.top;if(positionLeft>=0&&positionLeft<width&&positionTop>=0&&positionTop<height){var hit=component.queryHit(positionLeft,positionTop,width,height);if(hit&&(!component.props.dateProfile||core.rangeContainsRange(component.props.dateProfile.activeRange,hit.dateSpan.range))&&(!bestHit||hit.layer>bestHit.layer)){hit.rect.left+=originLeft;hit.rect.right+=originLeft;hit.rect.top+=originTop;hit.rect.bottom+=originTop;bestHit=hit;}}}}
return bestHit;};return HitDragging;}());function isHitsEqual(hit0,hit1){if(!hit0&&!hit1){return true;}
if(Boolean(hit0)!==Boolean(hit1)){return false;}
return core.isDateSpansEqual(hit0.dateSpan,hit1.dateSpan);}
var DateClicking=(function(_super){__extends(DateClicking,_super);function DateClicking(settings){var _this=_super.call(this,settings)||this;_this.handlePointerDown=function(ev){var dragging=_this.dragging;dragging.setIgnoreMove(!_this.component.isValidDateDownEl(dragging.pointer.downEl));};_this.handleDragEnd=function(ev){var component=_this.component;var _a=component.context,calendar=_a.calendar,view=_a.view;var pointer=_this.dragging.pointer;if(!pointer.wasTouchScroll){var _b=_this.hitDragging,initialHit=_b.initialHit,finalHit=_b.finalHit;if(initialHit&&finalHit&&isHitsEqual(initialHit,finalHit)){calendar.triggerDateClick(initialHit.dateSpan,initialHit.dayEl,view,ev.origEvent);}}};var component=settings.component;_this.dragging=new FeaturefulElementDragging(component.el);_this.dragging.autoScroller.isEnabled=false;var hitDragging=_this.hitDragging=new HitDragging(_this.dragging,core.interactionSettingsToStore(settings));hitDragging.emitter.on('pointerdown',_this.handlePointerDown);hitDragging.emitter.on('dragend',_this.handleDragEnd);return _this;}
DateClicking.prototype.destroy=function(){this.dragging.destroy();};return DateClicking;}(core.Interaction));var DateSelecting=(function(_super){__extends(DateSelecting,_super);function DateSelecting(settings){var _this=_super.call(this,settings)||this;_this.dragSelection=null;_this.handlePointerDown=function(ev){var _a=_this,component=_a.component,dragging=_a.dragging;var options=component.context.options;var canSelect=options.selectable&&component.isValidDateDownEl(ev.origEvent.target);dragging.setIgnoreMove(!canSelect);dragging.delay=ev.isTouch?getComponentTouchDelay(component):null;};_this.handleDragStart=function(ev){_this.component.context.calendar.unselect(ev);};_this.handleHitUpdate=function(hit,isFinal){var calendar=_this.component.context.calendar;var dragSelection=null;var isInvalid=false;if(hit){dragSelection=joinHitsIntoSelection(_this.hitDragging.initialHit,hit,calendar.pluginSystem.hooks.dateSelectionTransformers);if(!dragSelection||!_this.component.isDateSelectionValid(dragSelection)){isInvalid=true;dragSelection=null;}}
if(dragSelection){calendar.dispatch({type:'SELECT_DATES',selection:dragSelection});}
else if(!isFinal){calendar.dispatch({type:'UNSELECT_DATES'});}
if(!isInvalid){core.enableCursor();}
else{core.disableCursor();}
if(!isFinal){_this.dragSelection=dragSelection;}};_this.handlePointerUp=function(pev){if(_this.dragSelection){_this.component.context.calendar.triggerDateSelect(_this.dragSelection,pev);_this.dragSelection=null;}};var component=settings.component;var options=component.context.options;var dragging=_this.dragging=new FeaturefulElementDragging(component.el);dragging.touchScrollAllowed=false;dragging.minDistance=options.selectMinDistance||0;dragging.autoScroller.isEnabled=options.dragScroll;var hitDragging=_this.hitDragging=new HitDragging(_this.dragging,core.interactionSettingsToStore(settings));hitDragging.emitter.on('pointerdown',_this.handlePointerDown);hitDragging.emitter.on('dragstart',_this.handleDragStart);hitDragging.emitter.on('hitupdate',_this.handleHitUpdate);hitDragging.emitter.on('pointerup',_this.handlePointerUp);return _this;}
DateSelecting.prototype.destroy=function(){this.dragging.destroy();};return DateSelecting;}(core.Interaction));function getComponentTouchDelay(component){var options=component.context.options;var delay=options.selectLongPressDelay;if(delay==null){delay=options.longPressDelay;}
return delay;}
function joinHitsIntoSelection(hit0,hit1,dateSelectionTransformers){var dateSpan0=hit0.dateSpan;var dateSpan1=hit1.dateSpan;var ms=[dateSpan0.range.start,dateSpan0.range.end,dateSpan1.range.start,dateSpan1.range.end];ms.sort(core.compareNumbers);var props={};for(var _i=0,dateSelectionTransformers_1=dateSelectionTransformers;_i<dateSelectionTransformers_1.length;_i++){var transformer=dateSelectionTransformers_1[_i];var res=transformer(hit0,hit1);if(res===false){return null;}
else if(res){__assign(props,res);}}
props.range={start:ms[0],end:ms[3]};props.allDay=dateSpan0.allDay;return props;}
var EventDragging=(function(_super){__extends(EventDragging,_super);function EventDragging(settings){var _this=_super.call(this,settings)||this;_this.subjectSeg=null;_this.isDragging=false;_this.eventRange=null;_this.relevantEvents=null;_this.receivingCalendar=null;_this.validMutation=null;_this.mutatedRelevantEvents=null;_this.handlePointerDown=function(ev){var origTarget=ev.origEvent.target;var _a=_this,component=_a.component,dragging=_a.dragging;var mirror=dragging.mirror;var options=component.context.options;var initialCalendar=component.context.calendar;var subjectSeg=_this.subjectSeg=core.getElSeg(ev.subjectEl);var eventRange=_this.eventRange=subjectSeg.eventRange;var eventInstanceId=eventRange.instance.instanceId;_this.relevantEvents=core.getRelevantEvents(initialCalendar.state.eventStore,eventInstanceId);dragging.minDistance=ev.isTouch?0:options.eventDragMinDistance;dragging.delay=(ev.isTouch&&eventInstanceId!==component.props.eventSelection)?getComponentTouchDelay$1(component):null;mirror.parentNode=initialCalendar.el;mirror.revertDuration=options.dragRevertDuration;var isValid=component.isValidSegDownEl(origTarget)&&!core.elementClosest(origTarget,'.fc-resizer');dragging.setIgnoreMove(!isValid);_this.isDragging=isValid&&ev.subjectEl.classList.contains('fc-draggable');};_this.handleDragStart=function(ev){var context=_this.component.context;var initialCalendar=context.calendar;var eventRange=_this.eventRange;var eventInstanceId=eventRange.instance.instanceId;if(ev.isTouch){if(eventInstanceId!==_this.component.props.eventSelection){initialCalendar.dispatch({type:'SELECT_EVENT',eventInstanceId:eventInstanceId});}}
else{initialCalendar.dispatch({type:'UNSELECT_EVENT'});}
if(_this.isDragging){initialCalendar.unselect(ev);initialCalendar.publiclyTrigger('eventDragStart',[{el:_this.subjectSeg.el,event:new core.EventApi(initialCalendar,eventRange.def,eventRange.instance),jsEvent:ev.origEvent,view:context.view}]);}};_this.handleHitUpdate=function(hit,isFinal){if(!_this.isDragging){return;}
var relevantEvents=_this.relevantEvents;var initialHit=_this.hitDragging.initialHit;var initialCalendar=_this.component.context.calendar;var receivingCalendar=null;var mutation=null;var mutatedRelevantEvents=null;var isInvalid=false;var interaction={affectedEvents:relevantEvents,mutatedEvents:core.createEmptyEventStore(),isEvent:true,origSeg:_this.subjectSeg};if(hit){var receivingComponent=hit.component;receivingCalendar=receivingComponent.context.calendar;var receivingOptions=receivingComponent.context.options;if(initialCalendar===receivingCalendar||receivingOptions.editable&&receivingOptions.droppable){mutation=computeEventMutation(initialHit,hit,receivingCalendar.pluginSystem.hooks.eventDragMutationMassagers);if(mutation){mutatedRelevantEvents=core.applyMutationToEventStore(relevantEvents,receivingCalendar.eventUiBases,mutation,receivingCalendar);interaction.mutatedEvents=mutatedRelevantEvents;if(!receivingComponent.isInteractionValid(interaction)){isInvalid=true;mutation=null;mutatedRelevantEvents=null;interaction.mutatedEvents=core.createEmptyEventStore();}}}
else{receivingCalendar=null;}}
_this.displayDrag(receivingCalendar,interaction);if(!isInvalid){core.enableCursor();}
else{core.disableCursor();}
if(!isFinal){if(initialCalendar===receivingCalendar&&isHitsEqual(initialHit,hit)){mutation=null;}
_this.dragging.setMirrorNeedsRevert(!mutation);_this.dragging.setMirrorIsVisible(!hit||!document.querySelector('.fc-mirror'));_this.receivingCalendar=receivingCalendar;_this.validMutation=mutation;_this.mutatedRelevantEvents=mutatedRelevantEvents;}};_this.handlePointerUp=function(){if(!_this.isDragging){_this.cleanup();}};_this.handleDragEnd=function(ev){if(_this.isDragging){var context=_this.component.context;var initialCalendar_1=context.calendar;var initialView=context.view;var _a=_this,receivingCalendar=_a.receivingCalendar,validMutation=_a.validMutation;var eventDef=_this.eventRange.def;var eventInstance=_this.eventRange.instance;var eventApi=new core.EventApi(initialCalendar_1,eventDef,eventInstance);var relevantEvents_1=_this.relevantEvents;var mutatedRelevantEvents=_this.mutatedRelevantEvents;var finalHit=_this.hitDragging.finalHit;_this.clearDrag();initialCalendar_1.publiclyTrigger('eventDragStop',[{el:_this.subjectSeg.el,event:eventApi,jsEvent:ev.origEvent,view:initialView}]);if(validMutation){if(receivingCalendar===initialCalendar_1){initialCalendar_1.dispatch({type:'MERGE_EVENTS',eventStore:mutatedRelevantEvents});var transformed={};for(var _i=0,_b=initialCalendar_1.pluginSystem.hooks.eventDropTransformers;_i<_b.length;_i++){var transformer=_b[_i];__assign(transformed,transformer(validMutation,initialCalendar_1));}
var eventDropArg=__assign({},transformed,{el:ev.subjectEl,delta:validMutation.datesDelta,oldEvent:eventApi,event:new core.EventApi(initialCalendar_1,mutatedRelevantEvents.defs[eventDef.defId],eventInstance?mutatedRelevantEvents.instances[eventInstance.instanceId]:null),revert:function(){initialCalendar_1.dispatch({type:'MERGE_EVENTS',eventStore:relevantEvents_1});},jsEvent:ev.origEvent,view:initialView});initialCalendar_1.publiclyTrigger('eventDrop',[eventDropArg]);}
else if(receivingCalendar){initialCalendar_1.publiclyTrigger('eventLeave',[{draggedEl:ev.subjectEl,event:eventApi,view:initialView}]);initialCalendar_1.dispatch({type:'REMOVE_EVENT_INSTANCES',instances:_this.mutatedRelevantEvents.instances});receivingCalendar.dispatch({type:'MERGE_EVENTS',eventStore:_this.mutatedRelevantEvents});if(ev.isTouch){receivingCalendar.dispatch({type:'SELECT_EVENT',eventInstanceId:eventInstance.instanceId});}
var dropArg=__assign({},receivingCalendar.buildDatePointApi(finalHit.dateSpan),{draggedEl:ev.subjectEl,jsEvent:ev.origEvent,view:finalHit.component});receivingCalendar.publiclyTrigger('drop',[dropArg]);receivingCalendar.publiclyTrigger('eventReceive',[{draggedEl:ev.subjectEl,event:new core.EventApi(receivingCalendar,mutatedRelevantEvents.defs[eventDef.defId],mutatedRelevantEvents.instances[eventInstance.instanceId]),view:finalHit.component}]);}}
else{initialCalendar_1.publiclyTrigger('_noEventDrop');}}
_this.cleanup();};var component=_this.component;var options=component.context.options;var dragging=_this.dragging=new FeaturefulElementDragging(component.el);dragging.pointer.selector=EventDragging.SELECTOR;dragging.touchScrollAllowed=false;dragging.autoScroller.isEnabled=options.dragScroll;var hitDragging=_this.hitDragging=new HitDragging(_this.dragging,core.interactionSettingsStore);hitDragging.useSubjectCenter=settings.useEventCenter;hitDragging.emitter.on('pointerdown',_this.handlePointerDown);hitDragging.emitter.on('dragstart',_this.handleDragStart);hitDragging.emitter.on('hitupdate',_this.handleHitUpdate);hitDragging.emitter.on('pointerup',_this.handlePointerUp);hitDragging.emitter.on('dragend',_this.handleDragEnd);return _this;}
EventDragging.prototype.destroy=function(){this.dragging.destroy();};EventDragging.prototype.displayDrag=function(nextCalendar,state){var initialCalendar=this.component.context.calendar;var prevCalendar=this.receivingCalendar;if(prevCalendar&&prevCalendar!==nextCalendar){if(prevCalendar===initialCalendar){prevCalendar.dispatch({type:'SET_EVENT_DRAG',state:{affectedEvents:state.affectedEvents,mutatedEvents:core.createEmptyEventStore(),isEvent:true,origSeg:state.origSeg}});}
else{prevCalendar.dispatch({type:'UNSET_EVENT_DRAG'});}}
if(nextCalendar){nextCalendar.dispatch({type:'SET_EVENT_DRAG',state:state});}};EventDragging.prototype.clearDrag=function(){var initialCalendar=this.component.context.calendar;var receivingCalendar=this.receivingCalendar;if(receivingCalendar){receivingCalendar.dispatch({type:'UNSET_EVENT_DRAG'});}
if(initialCalendar!==receivingCalendar){initialCalendar.dispatch({type:'UNSET_EVENT_DRAG'});}};EventDragging.prototype.cleanup=function(){this.subjectSeg=null;this.isDragging=false;this.eventRange=null;this.relevantEvents=null;this.receivingCalendar=null;this.validMutation=null;this.mutatedRelevantEvents=null;};EventDragging.SELECTOR='.fc-draggable, .fc-resizable';return EventDragging;}(core.Interaction));function computeEventMutation(hit0,hit1,massagers){var dateSpan0=hit0.dateSpan;var dateSpan1=hit1.dateSpan;var date0=dateSpan0.range.start;var date1=dateSpan1.range.start;var standardProps={};if(dateSpan0.allDay!==dateSpan1.allDay){standardProps.allDay=dateSpan1.allDay;standardProps.hasEnd=hit1.component.context.options.allDayMaintainDuration;if(dateSpan1.allDay){date0=core.startOfDay(date0);}}
var delta=core.diffDates(date0,date1,hit0.component.context.dateEnv,hit0.component===hit1.component?hit0.component.largeUnit:null);if(delta.milliseconds){standardProps.allDay=false;}
var mutation={datesDelta:delta,standardProps:standardProps};for(var _i=0,massagers_1=massagers;_i<massagers_1.length;_i++){var massager=massagers_1[_i];massager(mutation,hit0,hit1);}
return mutation;}
function getComponentTouchDelay$1(component){var options=component.context.options;var delay=options.eventLongPressDelay;if(delay==null){delay=options.longPressDelay;}
return delay;}
var EventDragging$1=(function(_super){__extends(EventDragging,_super);function EventDragging(settings){var _this=_super.call(this,settings)||this;_this.draggingSeg=null;_this.eventRange=null;_this.relevantEvents=null;_this.validMutation=null;_this.mutatedRelevantEvents=null;_this.handlePointerDown=function(ev){var component=_this.component;var seg=_this.querySeg(ev);var eventRange=_this.eventRange=seg.eventRange;_this.dragging.minDistance=component.context.options.eventDragMinDistance;_this.dragging.setIgnoreMove(!_this.component.isValidSegDownEl(ev.origEvent.target)||(ev.isTouch&&_this.component.props.eventSelection!==eventRange.instance.instanceId));};_this.handleDragStart=function(ev){var _a=_this.component.context,calendar=_a.calendar,view=_a.view;var eventRange=_this.eventRange;_this.relevantEvents=core.getRelevantEvents(calendar.state.eventStore,_this.eventRange.instance.instanceId);_this.draggingSeg=_this.querySeg(ev);calendar.unselect();calendar.publiclyTrigger('eventResizeStart',[{el:_this.draggingSeg.el,event:new core.EventApi(calendar,eventRange.def,eventRange.instance),jsEvent:ev.origEvent,view:view}]);};_this.handleHitUpdate=function(hit,isFinal,ev){var calendar=_this.component.context.calendar;var relevantEvents=_this.relevantEvents;var initialHit=_this.hitDragging.initialHit;var eventInstance=_this.eventRange.instance;var mutation=null;var mutatedRelevantEvents=null;var isInvalid=false;var interaction={affectedEvents:relevantEvents,mutatedEvents:core.createEmptyEventStore(),isEvent:true,origSeg:_this.draggingSeg};if(hit){mutation=computeMutation(initialHit,hit,ev.subjectEl.classList.contains('fc-start-resizer'),eventInstance.range,calendar.pluginSystem.hooks.eventResizeJoinTransforms);}
if(mutation){mutatedRelevantEvents=core.applyMutationToEventStore(relevantEvents,calendar.eventUiBases,mutation,calendar);interaction.mutatedEvents=mutatedRelevantEvents;if(!_this.component.isInteractionValid(interaction)){isInvalid=true;mutation=null;mutatedRelevantEvents=null;interaction.mutatedEvents=null;}}
if(mutatedRelevantEvents){calendar.dispatch({type:'SET_EVENT_RESIZE',state:interaction});}
else{calendar.dispatch({type:'UNSET_EVENT_RESIZE'});}
if(!isInvalid){core.enableCursor();}
else{core.disableCursor();}
if(!isFinal){if(mutation&&isHitsEqual(initialHit,hit)){mutation=null;}
_this.validMutation=mutation;_this.mutatedRelevantEvents=mutatedRelevantEvents;}};_this.handleDragEnd=function(ev){var _a=_this.component.context,calendar=_a.calendar,view=_a.view;var eventDef=_this.eventRange.def;var eventInstance=_this.eventRange.instance;var eventApi=new core.EventApi(calendar,eventDef,eventInstance);var relevantEvents=_this.relevantEvents;var mutatedRelevantEvents=_this.mutatedRelevantEvents;calendar.publiclyTrigger('eventResizeStop',[{el:_this.draggingSeg.el,event:eventApi,jsEvent:ev.origEvent,view:view}]);if(_this.validMutation){calendar.dispatch({type:'MERGE_EVENTS',eventStore:mutatedRelevantEvents});calendar.publiclyTrigger('eventResize',[{el:_this.draggingSeg.el,startDelta:_this.validMutation.startDelta||core.createDuration(0),endDelta:_this.validMutation.endDelta||core.createDuration(0),prevEvent:eventApi,event:new core.EventApi(calendar,mutatedRelevantEvents.defs[eventDef.defId],eventInstance?mutatedRelevantEvents.instances[eventInstance.instanceId]:null),revert:function(){calendar.dispatch({type:'MERGE_EVENTS',eventStore:relevantEvents});},jsEvent:ev.origEvent,view:view}]);}
else{calendar.publiclyTrigger('_noEventResize');}
_this.draggingSeg=null;_this.relevantEvents=null;_this.validMutation=null;};var component=settings.component;var dragging=_this.dragging=new FeaturefulElementDragging(component.el);dragging.pointer.selector='.fc-resizer';dragging.touchScrollAllowed=false;dragging.autoScroller.isEnabled=component.context.options.dragScroll;var hitDragging=_this.hitDragging=new HitDragging(_this.dragging,core.interactionSettingsToStore(settings));hitDragging.emitter.on('pointerdown',_this.handlePointerDown);hitDragging.emitter.on('dragstart',_this.handleDragStart);hitDragging.emitter.on('hitupdate',_this.handleHitUpdate);hitDragging.emitter.on('dragend',_this.handleDragEnd);return _this;}
EventDragging.prototype.destroy=function(){this.dragging.destroy();};EventDragging.prototype.querySeg=function(ev){return core.getElSeg(core.elementClosest(ev.subjectEl,this.component.fgSegSelector));};return EventDragging;}(core.Interaction));function computeMutation(hit0,hit1,isFromStart,instanceRange,transforms){var dateEnv=hit0.component.context.dateEnv;var date0=hit0.dateSpan.range.start;var date1=hit1.dateSpan.range.start;var delta=core.diffDates(date0,date1,dateEnv,hit0.component.largeUnit);var props={};for(var _i=0,transforms_1=transforms;_i<transforms_1.length;_i++){var transform=transforms_1[_i];var res=transform(hit0,hit1);if(res===false){return null;}
else if(res){__assign(props,res);}}
if(isFromStart){if(dateEnv.add(instanceRange.start,delta)<instanceRange.end){props.startDelta=delta;return props;}}
else{if(dateEnv.add(instanceRange.end,delta)>instanceRange.start){props.endDelta=delta;return props;}}
return null;}
var UnselectAuto=(function(){function UnselectAuto(calendar){var _this=this;this.isRecentPointerDateSelect=false;this.onSelect=function(selectInfo){if(selectInfo.jsEvent){_this.isRecentPointerDateSelect=true;}};this.onDocumentPointerUp=function(pev){var _a=_this,calendar=_a.calendar,documentPointer=_a.documentPointer;var state=calendar.state;if(!documentPointer.wasTouchScroll){if(state.dateSelection&&!_this.isRecentPointerDateSelect){var unselectAuto=calendar.viewOpt('unselectAuto');var unselectCancel=calendar.viewOpt('unselectCancel');if(unselectAuto&&(!unselectAuto||!core.elementClosest(documentPointer.downEl,unselectCancel))){calendar.unselect(pev);}}
if(state.eventSelection&&!core.elementClosest(documentPointer.downEl,EventDragging.SELECTOR)){calendar.dispatch({type:'UNSELECT_EVENT'});}}
_this.isRecentPointerDateSelect=false;};this.calendar=calendar;var documentPointer=this.documentPointer=new PointerDragging(document);documentPointer.shouldIgnoreMove=true;documentPointer.shouldWatchScroll=false;documentPointer.emitter.on('pointerup',this.onDocumentPointerUp);calendar.on('select',this.onSelect);}
UnselectAuto.prototype.destroy=function(){this.calendar.off('select',this.onSelect);this.documentPointer.destroy();};return UnselectAuto;}());var ExternalElementDragging=(function(){function ExternalElementDragging(dragging,suppliedDragMeta){var _this=this;this.receivingCalendar=null;this.droppableEvent=null;this.suppliedDragMeta=null;this.dragMeta=null;this.handleDragStart=function(ev){_this.dragMeta=_this.buildDragMeta(ev.subjectEl);};this.handleHitUpdate=function(hit,isFinal,ev){var dragging=_this.hitDragging.dragging;var receivingCalendar=null;var droppableEvent=null;var isInvalid=false;var interaction={affectedEvents:core.createEmptyEventStore(),mutatedEvents:core.createEmptyEventStore(),isEvent:_this.dragMeta.create,origSeg:null};if(hit){receivingCalendar=hit.component.context.calendar;if(_this.canDropElOnCalendar(ev.subjectEl,receivingCalendar)){droppableEvent=computeEventForDateSpan(hit.dateSpan,_this.dragMeta,receivingCalendar);interaction.mutatedEvents=core.eventTupleToStore(droppableEvent);isInvalid=!core.isInteractionValid(interaction,receivingCalendar);if(isInvalid){interaction.mutatedEvents=core.createEmptyEventStore();droppableEvent=null;}}}
_this.displayDrag(receivingCalendar,interaction);dragging.setMirrorIsVisible(isFinal||!droppableEvent||!document.querySelector('.fc-mirror'));if(!isInvalid){core.enableCursor();}
else{core.disableCursor();}
if(!isFinal){dragging.setMirrorNeedsRevert(!droppableEvent);_this.receivingCalendar=receivingCalendar;_this.droppableEvent=droppableEvent;}};this.handleDragEnd=function(pev){var _a=_this,receivingCalendar=_a.receivingCalendar,droppableEvent=_a.droppableEvent;_this.clearDrag();if(receivingCalendar&&droppableEvent){var finalHit=_this.hitDragging.finalHit;var finalView=finalHit.component.context.view;var dragMeta=_this.dragMeta;var arg=__assign({},receivingCalendar.buildDatePointApi(finalHit.dateSpan),{draggedEl:pev.subjectEl,jsEvent:pev.origEvent,view:finalView});receivingCalendar.publiclyTrigger('drop',[arg]);if(dragMeta.create){receivingCalendar.dispatch({type:'MERGE_EVENTS',eventStore:core.eventTupleToStore(droppableEvent)});if(pev.isTouch){receivingCalendar.dispatch({type:'SELECT_EVENT',eventInstanceId:droppableEvent.instance.instanceId});}
receivingCalendar.publiclyTrigger('eventReceive',[{draggedEl:pev.subjectEl,event:new core.EventApi(receivingCalendar,droppableEvent.def,droppableEvent.instance),view:finalView}]);}}
_this.receivingCalendar=null;_this.droppableEvent=null;};var hitDragging=this.hitDragging=new HitDragging(dragging,core.interactionSettingsStore);hitDragging.requireInitial=false;hitDragging.emitter.on('dragstart',this.handleDragStart);hitDragging.emitter.on('hitupdate',this.handleHitUpdate);hitDragging.emitter.on('dragend',this.handleDragEnd);this.suppliedDragMeta=suppliedDragMeta;}
ExternalElementDragging.prototype.buildDragMeta=function(subjectEl){if(typeof this.suppliedDragMeta==='object'){return core.parseDragMeta(this.suppliedDragMeta);}
else if(typeof this.suppliedDragMeta==='function'){return core.parseDragMeta(this.suppliedDragMeta(subjectEl));}
else{return getDragMetaFromEl(subjectEl);}};ExternalElementDragging.prototype.displayDrag=function(nextCalendar,state){var prevCalendar=this.receivingCalendar;if(prevCalendar&&prevCalendar!==nextCalendar){prevCalendar.dispatch({type:'UNSET_EVENT_DRAG'});}
if(nextCalendar){nextCalendar.dispatch({type:'SET_EVENT_DRAG',state:state});}};ExternalElementDragging.prototype.clearDrag=function(){if(this.receivingCalendar){this.receivingCalendar.dispatch({type:'UNSET_EVENT_DRAG'});}};ExternalElementDragging.prototype.canDropElOnCalendar=function(el,receivingCalendar){var dropAccept=receivingCalendar.opt('dropAccept');if(typeof dropAccept==='function'){return dropAccept(el);}
else if(typeof dropAccept==='string'&&dropAccept){return Boolean(core.elementMatches(el,dropAccept));}
return true;};return ExternalElementDragging;}());function computeEventForDateSpan(dateSpan,dragMeta,calendar){var defProps=__assign({},dragMeta.leftoverProps);for(var _i=0,_a=calendar.pluginSystem.hooks.externalDefTransforms;_i<_a.length;_i++){var transform=_a[_i];__assign(defProps,transform(dateSpan,dragMeta));}
var def=core.parseEventDef(defProps,dragMeta.sourceId,dateSpan.allDay,calendar.opt('forceEventDuration')||Boolean(dragMeta.duration),calendar);var start=dateSpan.range.start;if(dateSpan.allDay&&dragMeta.startTime){start=calendar.dateEnv.add(start,dragMeta.startTime);}
var end=dragMeta.duration?calendar.dateEnv.add(start,dragMeta.duration):calendar.getDefaultEventEnd(dateSpan.allDay,start);var instance=core.createEventInstance(def.defId,{start:start,end:end});return{def:def,instance:instance};}
function getDragMetaFromEl(el){var str=getEmbeddedElData(el,'event');var obj=str?JSON.parse(str):{create:false};return core.parseDragMeta(obj);}
core.config.dataAttrPrefix='';function getEmbeddedElData(el,name){var prefix=core.config.dataAttrPrefix;var prefixedName=(prefix?prefix+'-':'')+name;return el.getAttribute('data-'+prefixedName)||'';}
var ExternalDraggable=(function(){function ExternalDraggable(el,settings){var _this=this;if(settings===void 0){settings={};}
this.handlePointerDown=function(ev){var dragging=_this.dragging;var _a=_this.settings,minDistance=_a.minDistance,longPressDelay=_a.longPressDelay;dragging.minDistance=minDistance!=null?minDistance:(ev.isTouch?0:core.globalDefaults.eventDragMinDistance);dragging.delay=ev.isTouch?(longPressDelay!=null?longPressDelay:core.globalDefaults.longPressDelay):0;};this.handleDragStart=function(ev){if(ev.isTouch&&_this.dragging.delay&&ev.subjectEl.classList.contains('fc-event')){_this.dragging.mirror.getMirrorEl().classList.add('fc-selected');}};this.settings=settings;var dragging=this.dragging=new FeaturefulElementDragging(el);dragging.touchScrollAllowed=false;if(settings.itemSelector!=null){dragging.pointer.selector=settings.itemSelector;}
if(settings.appendTo!=null){dragging.mirror.parentNode=settings.appendTo;}
dragging.emitter.on('pointerdown',this.handlePointerDown);dragging.emitter.on('dragstart',this.handleDragStart);new ExternalElementDragging(dragging,settings.eventData);}
ExternalDraggable.prototype.destroy=function(){this.dragging.destroy();};return ExternalDraggable;}());var InferredElementDragging=(function(_super){__extends(InferredElementDragging,_super);function InferredElementDragging(containerEl){var _this=_super.call(this,containerEl)||this;_this.shouldIgnoreMove=false;_this.mirrorSelector='';_this.currentMirrorEl=null;_this.handlePointerDown=function(ev){_this.emitter.trigger('pointerdown',ev);if(!_this.shouldIgnoreMove){_this.emitter.trigger('dragstart',ev);}};_this.handlePointerMove=function(ev){if(!_this.shouldIgnoreMove){_this.emitter.trigger('dragmove',ev);}};_this.handlePointerUp=function(ev){_this.emitter.trigger('pointerup',ev);if(!_this.shouldIgnoreMove){_this.emitter.trigger('dragend',ev);}};var pointer=_this.pointer=new PointerDragging(containerEl);pointer.emitter.on('pointerdown',_this.handlePointerDown);pointer.emitter.on('pointermove',_this.handlePointerMove);pointer.emitter.on('pointerup',_this.handlePointerUp);return _this;}
InferredElementDragging.prototype.destroy=function(){this.pointer.destroy();};InferredElementDragging.prototype.setIgnoreMove=function(bool){this.shouldIgnoreMove=bool;};InferredElementDragging.prototype.setMirrorIsVisible=function(bool){if(bool){if(this.currentMirrorEl){this.currentMirrorEl.style.visibility='';this.currentMirrorEl=null;}}
else{var mirrorEl=this.mirrorSelector?document.querySelector(this.mirrorSelector):null;if(mirrorEl){this.currentMirrorEl=mirrorEl;mirrorEl.style.visibility='hidden';}}};return InferredElementDragging;}(core.ElementDragging));var ThirdPartyDraggable=(function(){function ThirdPartyDraggable(containerOrSettings,settings){var containerEl=document;if(containerOrSettings===document||containerOrSettings instanceof Element){containerEl=containerOrSettings;settings=settings||{};}
else{settings=(containerOrSettings||{});}
var dragging=this.dragging=new InferredElementDragging(containerEl);if(typeof settings.itemSelector==='string'){dragging.pointer.selector=settings.itemSelector;}
else if(containerEl===document){dragging.pointer.selector='[data-event]';}
if(typeof settings.mirrorSelector==='string'){dragging.mirrorSelector=settings.mirrorSelector;}
new ExternalElementDragging(dragging,settings.eventData);}
ThirdPartyDraggable.prototype.destroy=function(){this.dragging.destroy();};return ThirdPartyDraggable;}());var main=core.createPlugin({componentInteractions:[DateClicking,DateSelecting,EventDragging,EventDragging$1],calendarInteractions:[UnselectAuto],elementDraggingImpl:FeaturefulElementDragging});exports.Draggable=ExternalDraggable;exports.FeaturefulElementDragging=FeaturefulElementDragging;exports.PointerDragging=PointerDragging;exports.ThirdPartyDraggable=ThirdPartyDraggable;exports.default=main;Object.defineProperty(exports,'__esModule',{value:true});}));;

/* /web/static/lib/fullcalendar/daygrid/main.js defined in bundle 'web.tests_assets' */
(function(global,factory){typeof exports==='object'&&typeof module!=='undefined'?factory(exports,require('@fullcalendar/core')):typeof define==='function'&&define.amd?define(['exports','@fullcalendar/core'],factory):(global=global||self,factory(global.FullCalendarDayGrid={},global.FullCalendar));}(this,function(exports,core){'use strict';var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b;})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];};return extendStatics(d,b);};function __extends(d,b){extendStatics(d,b);function __(){this.constructor=d;}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __());}
var __assign=function(){__assign=Object.assign||function __assign(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p))t[p]=s[p];}
return t;};return __assign.apply(this,arguments);};var DayGridDateProfileGenerator=(function(_super){__extends(DayGridDateProfileGenerator,_super);function DayGridDateProfileGenerator(){return _super!==null&&_super.apply(this,arguments)||this;}
DayGridDateProfileGenerator.prototype.buildRenderRange=function(currentRange,currentRangeUnit,isRangeAllDay){var dateEnv=this.dateEnv;var renderRange=_super.prototype.buildRenderRange.call(this,currentRange,currentRangeUnit,isRangeAllDay);var start=renderRange.start;var end=renderRange.end;var endOfWeek;if(/^(year|month)$/.test(currentRangeUnit)){start=dateEnv.startOfWeek(start);endOfWeek=dateEnv.startOfWeek(end);if(endOfWeek.valueOf()!==end.valueOf()){end=core.addWeeks(endOfWeek,1);}}
if(this.options.monthMode&&this.options.fixedWeekCount){var rowCnt=Math.ceil(core.diffWeeks(start,end));end=core.addWeeks(end,6-rowCnt);}
return{start:start,end:end};};return DayGridDateProfileGenerator;}(core.DateProfileGenerator));var Popover=(function(){function Popover(options){var _this=this;this.isHidden=true;this.margin=10;this.documentMousedown=function(ev){if(_this.el&&!_this.el.contains(ev.target)){_this.hide();}};this.options=options;}
Popover.prototype.show=function(){if(this.isHidden){if(!this.el){this.render();}
this.el.style.display='';this.position();this.isHidden=false;this.trigger('show');}};Popover.prototype.hide=function(){if(!this.isHidden){this.el.style.display='none';this.isHidden=true;this.trigger('hide');}};Popover.prototype.render=function(){var _this=this;var options=this.options;var el=this.el=core.createElement('div',{className:'fc-popover '+(options.className||''),style:{top:'0',left:'0'}});if(typeof options.content==='function'){options.content(el);}
options.parentEl.appendChild(el);core.listenBySelector(el,'click','.fc-close',function(ev){_this.hide();});if(options.autoHide){document.addEventListener('mousedown',this.documentMousedown);}};Popover.prototype.destroy=function(){this.hide();if(this.el){core.removeElement(this.el);this.el=null;}
document.removeEventListener('mousedown',this.documentMousedown);};Popover.prototype.position=function(){var options=this.options;var el=this.el;var elDims=el.getBoundingClientRect();var origin=core.computeRect(el.offsetParent);var clippingRect=core.computeClippingRect(options.parentEl);var top;var left;top=options.top||0;if(options.left!==undefined){left=options.left;}
else if(options.right!==undefined){left=options.right-elDims.width;}
else{left=0;}
top=Math.min(top,clippingRect.bottom-elDims.height-this.margin);top=Math.max(top,clippingRect.top+this.margin);left=Math.min(left,clippingRect.right-elDims.width-this.margin);left=Math.max(left,clippingRect.left+this.margin);core.applyStyle(el,{top:top-origin.top,left:left-origin.left});};Popover.prototype.trigger=function(name){if(this.options[name]){this.options[name].apply(this,Array.prototype.slice.call(arguments,1));}};return Popover;}());var SimpleDayGridEventRenderer=(function(_super){__extends(SimpleDayGridEventRenderer,_super);function SimpleDayGridEventRenderer(){return _super!==null&&_super.apply(this,arguments)||this;}
SimpleDayGridEventRenderer.prototype.renderSegHtml=function(seg,mirrorInfo){var context=this.context;var eventRange=seg.eventRange;var eventDef=eventRange.def;var eventUi=eventRange.ui;var allDay=eventDef.allDay;var isDraggable=core.computeEventDraggable(context,eventDef,eventUi);var isResizableFromStart=allDay&&seg.isStart&&core.computeEventStartResizable(context,eventDef,eventUi);var isResizableFromEnd=allDay&&seg.isEnd&&core.computeEventEndResizable(context,eventDef,eventUi);var classes=this.getSegClasses(seg,isDraggable,isResizableFromStart||isResizableFromEnd,mirrorInfo);var skinCss=core.cssToStr(this.getSkinCss(eventUi));var timeHtml='';var timeText;var titleHtml;classes.unshift('fc-day-grid-event','fc-h-event');if(seg.isStart){timeText=this.getTimeText(eventRange);if(timeText){timeHtml='<span class="fc-time">'+core.htmlEscape(timeText)+'</span>';}}
titleHtml='<span class="fc-title">'+
(core.htmlEscape(eventDef.title||'')||'&nbsp;')+'</span>';return'<a class="'+classes.join(' ')+'"'+
(eventDef.url?' href="'+core.htmlEscape(eventDef.url)+'"':'')+
(skinCss?' style="'+skinCss+'"':'')+'>'+'<div class="fc-content">'+
(context.options.dir==='rtl'?titleHtml+' '+timeHtml:timeHtml+' '+titleHtml)+'</div>'+
(isResizableFromStart?'<div class="fc-resizer fc-start-resizer"></div>':'')+
(isResizableFromEnd?'<div class="fc-resizer fc-end-resizer"></div>':'')+'</a>';};SimpleDayGridEventRenderer.prototype.computeEventTimeFormat=function(){return{hour:'numeric',minute:'2-digit',omitZeroMinute:true,meridiem:'narrow'};};SimpleDayGridEventRenderer.prototype.computeDisplayEventEnd=function(){return false;};return SimpleDayGridEventRenderer;}(core.FgEventRenderer));var DayGridEventRenderer=(function(_super){__extends(DayGridEventRenderer,_super);function DayGridEventRenderer(dayGrid){var _this=_super.call(this)||this;_this.dayGrid=dayGrid;return _this;}
DayGridEventRenderer.prototype.attachSegs=function(segs,mirrorInfo){var rowStructs=this.rowStructs=this.renderSegRows(segs);this.dayGrid.rowEls.forEach(function(rowNode,i){rowNode.querySelector('.fc-content-skeleton > table').appendChild(rowStructs[i].tbodyEl);});if(!mirrorInfo){this.dayGrid.removeSegPopover();}};DayGridEventRenderer.prototype.detachSegs=function(){var rowStructs=this.rowStructs||[];var rowStruct;while((rowStruct=rowStructs.pop())){core.removeElement(rowStruct.tbodyEl);}
this.rowStructs=null;};DayGridEventRenderer.prototype.renderSegRows=function(segs){var rowStructs=[];var segRows;var row;segRows=this.groupSegRows(segs);for(row=0;row<segRows.length;row++){rowStructs.push(this.renderSegRow(row,segRows[row]));}
return rowStructs;};DayGridEventRenderer.prototype.renderSegRow=function(row,rowSegs){var isRtl=this.context.isRtl;var dayGrid=this.dayGrid;var colCnt=dayGrid.colCnt;var segLevels=this.buildSegLevels(rowSegs);var levelCnt=Math.max(1,segLevels.length);var tbody=document.createElement('tbody');var segMatrix=[];var cellMatrix=[];var loneCellMatrix=[];var i;var levelSegs;var col;var tr;var j;var seg;var td;function emptyCellsUntil(endCol){while(col<endCol){td=(loneCellMatrix[i-1]||[])[col];if(td){td.rowSpan=(td.rowSpan||1)+1;}
else{td=document.createElement('td');tr.appendChild(td);}
cellMatrix[i][col]=td;loneCellMatrix[i][col]=td;col++;}}
for(i=0;i<levelCnt;i++){levelSegs=segLevels[i];col=0;tr=document.createElement('tr');segMatrix.push([]);cellMatrix.push([]);loneCellMatrix.push([]);if(levelSegs){for(j=0;j<levelSegs.length;j++){seg=levelSegs[j];var leftCol=isRtl?(colCnt-1-seg.lastCol):seg.firstCol;var rightCol=isRtl?(colCnt-1-seg.firstCol):seg.lastCol;emptyCellsUntil(leftCol);td=core.createElement('td',{className:'fc-event-container'},seg.el);if(leftCol!==rightCol){td.colSpan=rightCol-leftCol+1;}
else{loneCellMatrix[i][col]=td;}
while(col<=rightCol){cellMatrix[i][col]=td;segMatrix[i][col]=seg;col++;}
tr.appendChild(td);}}
emptyCellsUntil(colCnt);var introHtml=dayGrid.renderProps.renderIntroHtml();if(introHtml){if(isRtl){core.appendToElement(tr,introHtml);}
else{core.prependToElement(tr,introHtml);}}
tbody.appendChild(tr);}
return{row:row,tbodyEl:tbody,cellMatrix:cellMatrix,segMatrix:segMatrix,segLevels:segLevels,segs:rowSegs};};DayGridEventRenderer.prototype.buildSegLevels=function(segs){var isRtl=this.context.isRtl;var colCnt=this.dayGrid.colCnt;var levels=[];var i;var seg;var j;segs=this.sortEventSegs(segs);for(i=0;i<segs.length;i++){seg=segs[i];for(j=0;j<levels.length;j++){if(!isDaySegCollision(seg,levels[j])){break;}}
seg.level=j;seg.leftCol=isRtl?(colCnt-1-seg.lastCol):seg.firstCol;seg.rightCol=isRtl?(colCnt-1-seg.firstCol):seg.lastCol;(levels[j]||(levels[j]=[])).push(seg);}
for(j=0;j<levels.length;j++){levels[j].sort(compareDaySegCols);}
return levels;};DayGridEventRenderer.prototype.groupSegRows=function(segs){var segRows=[];var i;for(i=0;i<this.dayGrid.rowCnt;i++){segRows.push([]);}
for(i=0;i<segs.length;i++){segRows[segs[i].row].push(segs[i]);}
return segRows;};DayGridEventRenderer.prototype.computeDisplayEventEnd=function(){return this.dayGrid.colCnt===1;};return DayGridEventRenderer;}(SimpleDayGridEventRenderer));function isDaySegCollision(seg,otherSegs){var i;var otherSeg;for(i=0;i<otherSegs.length;i++){otherSeg=otherSegs[i];if(otherSeg.firstCol<=seg.lastCol&&otherSeg.lastCol>=seg.firstCol){return true;}}
return false;}
function compareDaySegCols(a,b){return a.leftCol-b.leftCol;}
var DayGridMirrorRenderer=(function(_super){__extends(DayGridMirrorRenderer,_super);function DayGridMirrorRenderer(){return _super!==null&&_super.apply(this,arguments)||this;}
DayGridMirrorRenderer.prototype.attachSegs=function(segs,mirrorInfo){var sourceSeg=mirrorInfo.sourceSeg;var rowStructs=this.rowStructs=this.renderSegRows(segs);this.dayGrid.rowEls.forEach(function(rowNode,row){var skeletonEl=core.htmlToElement('<div class="fc-mirror-skeleton"><table></table></div>');var skeletonTopEl;var skeletonTop;if(sourceSeg&&sourceSeg.row===row){skeletonTopEl=sourceSeg.el;}
else{skeletonTopEl=rowNode.querySelector('.fc-content-skeleton tbody');if(!skeletonTopEl){skeletonTopEl=rowNode.querySelector('.fc-content-skeleton table');}}
skeletonTop=skeletonTopEl.getBoundingClientRect().top-
rowNode.getBoundingClientRect().top;skeletonEl.style.top=skeletonTop+'px';skeletonEl.querySelector('table').appendChild(rowStructs[row].tbodyEl);rowNode.appendChild(skeletonEl);});};return DayGridMirrorRenderer;}(DayGridEventRenderer));var EMPTY_CELL_HTML='<td style="pointer-events:none"></td>';var DayGridFillRenderer=(function(_super){__extends(DayGridFillRenderer,_super);function DayGridFillRenderer(dayGrid){var _this=_super.call(this)||this;_this.fillSegTag='td';_this.dayGrid=dayGrid;return _this;}
DayGridFillRenderer.prototype.renderSegs=function(type,context,segs){if(type==='bgEvent'){segs=segs.filter(function(seg){return seg.eventRange.def.allDay;});}
_super.prototype.renderSegs.call(this,type,context,segs);};DayGridFillRenderer.prototype.attachSegs=function(type,segs){var els=[];var i;var seg;var skeletonEl;for(i=0;i<segs.length;i++){seg=segs[i];skeletonEl=this.renderFillRow(type,seg);this.dayGrid.rowEls[seg.row].appendChild(skeletonEl);els.push(skeletonEl);}
return els;};DayGridFillRenderer.prototype.renderFillRow=function(type,seg){var dayGrid=this.dayGrid;var isRtl=this.context.isRtl;var colCnt=dayGrid.colCnt;var leftCol=isRtl?(colCnt-1-seg.lastCol):seg.firstCol;var rightCol=isRtl?(colCnt-1-seg.firstCol):seg.lastCol;var startCol=leftCol;var endCol=rightCol+1;var className;var skeletonEl;var trEl;if(type==='businessHours'){className='bgevent';}
else{className=type.toLowerCase();}
skeletonEl=core.htmlToElement('<div class="fc-'+className+'-skeleton">'+'<table><tr></tr></table>'+'</div>');trEl=skeletonEl.getElementsByTagName('tr')[0];if(startCol>0){core.appendToElement(trEl,new Array(startCol+1).join(EMPTY_CELL_HTML));}
seg.el.colSpan=endCol-startCol;trEl.appendChild(seg.el);if(endCol<colCnt){core.appendToElement(trEl,new Array(colCnt-endCol+1).join(EMPTY_CELL_HTML));}
var introHtml=dayGrid.renderProps.renderIntroHtml();if(introHtml){if(isRtl){core.appendToElement(trEl,introHtml);}
else{core.prependToElement(trEl,introHtml);}}
return skeletonEl;};return DayGridFillRenderer;}(core.FillRenderer));var DayTile=(function(_super){__extends(DayTile,_super);function DayTile(el){var _this=_super.call(this,el)||this;var eventRenderer=_this.eventRenderer=new DayTileEventRenderer(_this);var renderFrame=_this.renderFrame=core.memoizeRendering(_this._renderFrame);_this.renderFgEvents=core.memoizeRendering(eventRenderer.renderSegs.bind(eventRenderer),eventRenderer.unrender.bind(eventRenderer),[renderFrame]);_this.renderEventSelection=core.memoizeRendering(eventRenderer.selectByInstanceId.bind(eventRenderer),eventRenderer.unselectByInstanceId.bind(eventRenderer),[_this.renderFgEvents]);_this.renderEventDrag=core.memoizeRendering(eventRenderer.hideByHash.bind(eventRenderer),eventRenderer.showByHash.bind(eventRenderer),[renderFrame]);_this.renderEventResize=core.memoizeRendering(eventRenderer.hideByHash.bind(eventRenderer),eventRenderer.showByHash.bind(eventRenderer),[renderFrame]);return _this;}
DayTile.prototype.firstContext=function(context){context.calendar.registerInteractiveComponent(this,{el:this.el,useEventCenter:false});};DayTile.prototype.render=function(props,context){this.renderFrame(props.date);this.renderFgEvents(context,props.fgSegs);this.renderEventSelection(props.eventSelection);this.renderEventDrag(props.eventDragInstances);this.renderEventResize(props.eventResizeInstances);};DayTile.prototype.destroy=function(){_super.prototype.destroy.call(this);this.renderFrame.unrender();this.context.calendar.unregisterInteractiveComponent(this);};DayTile.prototype._renderFrame=function(date){var _a=this.context,theme=_a.theme,dateEnv=_a.dateEnv,options=_a.options;var title=dateEnv.format(date,core.createFormatter(options.dayPopoverFormat));this.el.innerHTML='<div class="fc-header '+theme.getClass('popoverHeader')+'">'+'<span class="fc-title">'+
core.htmlEscape(title)+'</span>'+'<span class="fc-close '+theme.getIconClass('close')+'"></span>'+'</div>'+'<div class="fc-body '+theme.getClass('popoverContent')+'">'+'<div class="fc-event-container"></div>'+'</div>';this.segContainerEl=this.el.querySelector('.fc-event-container');};DayTile.prototype.queryHit=function(positionLeft,positionTop,elWidth,elHeight){var date=this.props.date;if(positionLeft<elWidth&&positionTop<elHeight){return{component:this,dateSpan:{allDay:true,range:{start:date,end:core.addDays(date,1)}},dayEl:this.el,rect:{left:0,top:0,right:elWidth,bottom:elHeight},layer:1};}};return DayTile;}(core.DateComponent));var DayTileEventRenderer=(function(_super){__extends(DayTileEventRenderer,_super);function DayTileEventRenderer(dayTile){var _this=_super.call(this)||this;_this.dayTile=dayTile;return _this;}
DayTileEventRenderer.prototype.attachSegs=function(segs){for(var _i=0,segs_1=segs;_i<segs_1.length;_i++){var seg=segs_1[_i];this.dayTile.segContainerEl.appendChild(seg.el);}};DayTileEventRenderer.prototype.detachSegs=function(segs){for(var _i=0,segs_2=segs;_i<segs_2.length;_i++){var seg=segs_2[_i];core.removeElement(seg.el);}};return DayTileEventRenderer;}(SimpleDayGridEventRenderer));var DayBgRow=(function(){function DayBgRow(context){this.context=context;}
DayBgRow.prototype.renderHtml=function(props){var parts=[];if(props.renderIntroHtml){parts.push(props.renderIntroHtml());}
for(var _i=0,_a=props.cells;_i<_a.length;_i++){var cell=_a[_i];parts.push(renderCellHtml(cell.date,props.dateProfile,this.context,cell.htmlAttrs));}
if(!props.cells.length){parts.push('<td class="fc-day '+this.context.theme.getClass('widgetContent')+'"></td>');}
if(this.context.options.dir==='rtl'){parts.reverse();}
return'<tr>'+parts.join('')+'</tr>';};return DayBgRow;}());function renderCellHtml(date,dateProfile,context,otherAttrs){var dateEnv=context.dateEnv,theme=context.theme;var isDateValid=core.rangeContainsMarker(dateProfile.activeRange,date);var classes=core.getDayClasses(date,dateProfile,context);classes.unshift('fc-day',theme.getClass('widgetContent'));return'<td class="'+classes.join(' ')+'"'+
(isDateValid?' data-date="'+dateEnv.formatIso(date,{omitTime:true})+'"':'')+
(otherAttrs?' '+otherAttrs:'')+'></td>';}
var DAY_NUM_FORMAT=core.createFormatter({day:'numeric'});var WEEK_NUM_FORMAT=core.createFormatter({week:'numeric'});var DayGrid=(function(_super){__extends(DayGrid,_super);function DayGrid(el,renderProps){var _this=_super.call(this,el)||this;_this.bottomCoordPadding=0;_this.isCellSizesDirty=false;_this.renderProps=renderProps;var eventRenderer=_this.eventRenderer=new DayGridEventRenderer(_this);var fillRenderer=_this.fillRenderer=new DayGridFillRenderer(_this);_this.mirrorRenderer=new DayGridMirrorRenderer(_this);var renderCells=_this.renderCells=core.memoizeRendering(_this._renderCells,_this._unrenderCells);_this.renderBusinessHours=core.memoizeRendering(fillRenderer.renderSegs.bind(fillRenderer,'businessHours'),fillRenderer.unrender.bind(fillRenderer,'businessHours'),[renderCells]);_this.renderDateSelection=core.memoizeRendering(fillRenderer.renderSegs.bind(fillRenderer,'highlight'),fillRenderer.unrender.bind(fillRenderer,'highlight'),[renderCells]);_this.renderBgEvents=core.memoizeRendering(fillRenderer.renderSegs.bind(fillRenderer,'bgEvent'),fillRenderer.unrender.bind(fillRenderer,'bgEvent'),[renderCells]);_this.renderFgEvents=core.memoizeRendering(eventRenderer.renderSegs.bind(eventRenderer),eventRenderer.unrender.bind(eventRenderer),[renderCells]);_this.renderEventSelection=core.memoizeRendering(eventRenderer.selectByInstanceId.bind(eventRenderer),eventRenderer.unselectByInstanceId.bind(eventRenderer),[_this.renderFgEvents]);_this.renderEventDrag=core.memoizeRendering(_this._renderEventDrag,_this._unrenderEventDrag,[renderCells]);_this.renderEventResize=core.memoizeRendering(_this._renderEventResize,_this._unrenderEventResize,[renderCells]);return _this;}
DayGrid.prototype.render=function(props,context){var cells=props.cells;this.rowCnt=cells.length;this.colCnt=cells[0].length;this.renderCells(cells,props.isRigid);this.renderBusinessHours(context,props.businessHourSegs);this.renderDateSelection(context,props.dateSelectionSegs);this.renderBgEvents(context,props.bgEventSegs);this.renderFgEvents(context,props.fgEventSegs);this.renderEventSelection(props.eventSelection);this.renderEventDrag(props.eventDrag);this.renderEventResize(props.eventResize);if(this.segPopoverTile){this.updateSegPopoverTile();}};DayGrid.prototype.destroy=function(){_super.prototype.destroy.call(this);this.renderCells.unrender();};DayGrid.prototype.getCellRange=function(row,col){var start=this.props.cells[row][col].date;var end=core.addDays(start,1);return{start:start,end:end};};DayGrid.prototype.updateSegPopoverTile=function(date,segs){var ownProps=this.props;this.segPopoverTile.receiveProps({date:date||this.segPopoverTile.props.date,fgSegs:segs||this.segPopoverTile.props.fgSegs,eventSelection:ownProps.eventSelection,eventDragInstances:ownProps.eventDrag?ownProps.eventDrag.affectedInstances:null,eventResizeInstances:ownProps.eventResize?ownProps.eventResize.affectedInstances:null},this.context);};DayGrid.prototype._renderCells=function(cells,isRigid){var _a=this.context,calendar=_a.calendar,view=_a.view,isRtl=_a.isRtl,dateEnv=_a.dateEnv;var _b=this,rowCnt=_b.rowCnt,colCnt=_b.colCnt;var html='';var row;var col;for(row=0;row<rowCnt;row++){html+=this.renderDayRowHtml(row,isRigid);}
this.el.innerHTML=html;this.rowEls=core.findElements(this.el,'.fc-row');this.cellEls=core.findElements(this.el,'.fc-day, .fc-disabled-day');if(isRtl){this.cellEls.reverse();}
this.rowPositions=new core.PositionCache(this.el,this.rowEls,false,true);this.colPositions=new core.PositionCache(this.el,this.cellEls.slice(0,colCnt),true,false);for(row=0;row<rowCnt;row++){for(col=0;col<colCnt;col++){calendar.publiclyTrigger('dayRender',[{date:dateEnv.toDate(cells[row][col].date),el:this.getCellEl(row,col),view:view}]);}}
this.isCellSizesDirty=true;};DayGrid.prototype._unrenderCells=function(){this.removeSegPopover();};DayGrid.prototype.renderDayRowHtml=function(row,isRigid){var theme=this.context.theme;var classes=['fc-row','fc-week',theme.getClass('dayRow')];if(isRigid){classes.push('fc-rigid');}
var bgRow=new DayBgRow(this.context);return''+'<div class="'+classes.join(' ')+'">'+'<div class="fc-bg">'+'<table class="'+theme.getClass('tableGrid')+'">'+
bgRow.renderHtml({cells:this.props.cells[row],dateProfile:this.props.dateProfile,renderIntroHtml:this.renderProps.renderBgIntroHtml})+'</table>'+'</div>'+'<div class="fc-content-skeleton">'+'<table>'+
(this.getIsNumbersVisible()?'<thead>'+
this.renderNumberTrHtml(row)+'</thead>':'')+'</table>'+'</div>'+'</div>';};DayGrid.prototype.getIsNumbersVisible=function(){return this.getIsDayNumbersVisible()||this.renderProps.cellWeekNumbersVisible||this.renderProps.colWeekNumbersVisible;};DayGrid.prototype.getIsDayNumbersVisible=function(){return this.rowCnt>1;};DayGrid.prototype.renderNumberTrHtml=function(row){var isRtl=this.context.isRtl;var intro=this.renderProps.renderNumberIntroHtml(row,this);return''+'<tr>'+
(isRtl?'':intro)+
this.renderNumberCellsHtml(row)+
(isRtl?intro:'')+'</tr>';};DayGrid.prototype.renderNumberCellsHtml=function(row){var htmls=[];var col;var date;for(col=0;col<this.colCnt;col++){date=this.props.cells[row][col].date;htmls.push(this.renderNumberCellHtml(date));}
if(this.context.isRtl){htmls.reverse();}
return htmls.join('');};DayGrid.prototype.renderNumberCellHtml=function(date){var _a=this.context,dateEnv=_a.dateEnv,options=_a.options;var html='';var isDateValid=core.rangeContainsMarker(this.props.dateProfile.activeRange,date);var isDayNumberVisible=this.getIsDayNumbersVisible()&&isDateValid;var classes;var weekCalcFirstDow;if(!isDayNumberVisible&&!this.renderProps.cellWeekNumbersVisible){return'<td></td>';}
classes=core.getDayClasses(date,this.props.dateProfile,this.context);classes.unshift('fc-day-top');if(this.renderProps.cellWeekNumbersVisible){weekCalcFirstDow=dateEnv.weekDow;}
html+='<td class="'+classes.join(' ')+'"'+
(isDateValid?' data-date="'+dateEnv.formatIso(date,{omitTime:true})+'"':'')+'>';if(this.renderProps.cellWeekNumbersVisible&&(date.getUTCDay()===weekCalcFirstDow)){html+=core.buildGotoAnchorHtml(options,dateEnv,{date:date,type:'week'},{'class':'fc-week-number'},dateEnv.format(date,WEEK_NUM_FORMAT));}
if(isDayNumberVisible){html+=core.buildGotoAnchorHtml(options,dateEnv,date,{'class':'fc-day-number'},dateEnv.format(date,DAY_NUM_FORMAT));}
html+='</td>';return html;};DayGrid.prototype.updateSize=function(isResize){var calendar=this.context.calendar;var _a=this,fillRenderer=_a.fillRenderer,eventRenderer=_a.eventRenderer,mirrorRenderer=_a.mirrorRenderer;if(isResize||this.isCellSizesDirty||calendar.isEventsUpdated){this.buildPositionCaches();this.isCellSizesDirty=false;}
fillRenderer.computeSizes(isResize);eventRenderer.computeSizes(isResize);mirrorRenderer.computeSizes(isResize);fillRenderer.assignSizes(isResize);eventRenderer.assignSizes(isResize);mirrorRenderer.assignSizes(isResize);};DayGrid.prototype.buildPositionCaches=function(){this.buildColPositions();this.buildRowPositions();};DayGrid.prototype.buildColPositions=function(){this.colPositions.build();};DayGrid.prototype.buildRowPositions=function(){this.rowPositions.build();this.rowPositions.bottoms[this.rowCnt-1]+=this.bottomCoordPadding;};DayGrid.prototype.positionToHit=function(leftPosition,topPosition){var _a=this,colPositions=_a.colPositions,rowPositions=_a.rowPositions;var col=colPositions.leftToIndex(leftPosition);var row=rowPositions.topToIndex(topPosition);if(row!=null&&col!=null){return{row:row,col:col,dateSpan:{range:this.getCellRange(row,col),allDay:true},dayEl:this.getCellEl(row,col),relativeRect:{left:colPositions.lefts[col],right:colPositions.rights[col],top:rowPositions.tops[row],bottom:rowPositions.bottoms[row]}};}};DayGrid.prototype.getCellEl=function(row,col){return this.cellEls[row*this.colCnt+col];};DayGrid.prototype._renderEventDrag=function(state){if(state){this.eventRenderer.hideByHash(state.affectedInstances);this.fillRenderer.renderSegs('highlight',this.context,state.segs);}};DayGrid.prototype._unrenderEventDrag=function(state){if(state){this.eventRenderer.showByHash(state.affectedInstances);this.fillRenderer.unrender('highlight',this.context);}};DayGrid.prototype._renderEventResize=function(state){if(state){this.eventRenderer.hideByHash(state.affectedInstances);this.fillRenderer.renderSegs('highlight',this.context,state.segs);this.mirrorRenderer.renderSegs(this.context,state.segs,{isResizing:true,sourceSeg:state.sourceSeg});}};DayGrid.prototype._unrenderEventResize=function(state){if(state){this.eventRenderer.showByHash(state.affectedInstances);this.fillRenderer.unrender('highlight',this.context);this.mirrorRenderer.unrender(this.context,state.segs,{isResizing:true,sourceSeg:state.sourceSeg});}};DayGrid.prototype.removeSegPopover=function(){if(this.segPopover){this.segPopover.hide();}};DayGrid.prototype.limitRows=function(levelLimit){var rowStructs=this.eventRenderer.rowStructs||[];var row;var rowLevelLimit;for(row=0;row<rowStructs.length;row++){this.unlimitRow(row);if(!levelLimit){rowLevelLimit=false;}
else if(typeof levelLimit==='number'){rowLevelLimit=levelLimit;}
else{rowLevelLimit=this.computeRowLevelLimit(row);}
if(rowLevelLimit!==false){this.limitRow(row,rowLevelLimit);}}};DayGrid.prototype.computeRowLevelLimit=function(row){var rowEl=this.rowEls[row];var rowBottom=rowEl.getBoundingClientRect().bottom;var trEls=core.findChildren(this.eventRenderer.rowStructs[row].tbodyEl);var i;var trEl;for(i=0;i<trEls.length;i++){trEl=trEls[i];trEl.classList.remove('fc-limited');if(trEl.getBoundingClientRect().bottom>rowBottom){return i;}}
return false;};DayGrid.prototype.limitRow=function(row,levelLimit){var _this=this;var colCnt=this.colCnt;var isRtl=this.context.isRtl;var rowStruct=this.eventRenderer.rowStructs[row];var moreNodes=[];var col=0;var levelSegs;var cellMatrix;var limitedNodes;var i;var seg;var segsBelow;var totalSegsBelow;var colSegsBelow;var td;var rowSpan;var segMoreNodes;var j;var moreTd;var moreWrap;var moreLink;var emptyCellsUntil=function(endCol){while(col<endCol){segsBelow=_this.getCellSegs(row,col,levelLimit);if(segsBelow.length){td=cellMatrix[levelLimit-1][col];moreLink=_this.renderMoreLink(row,col,segsBelow);moreWrap=core.createElement('div',null,moreLink);td.appendChild(moreWrap);moreNodes.push(moreWrap);}
col++;}};if(levelLimit&&levelLimit<rowStruct.segLevels.length){levelSegs=rowStruct.segLevels[levelLimit-1];cellMatrix=rowStruct.cellMatrix;limitedNodes=core.findChildren(rowStruct.tbodyEl).slice(levelLimit);limitedNodes.forEach(function(node){node.classList.add('fc-limited');});for(i=0;i<levelSegs.length;i++){seg=levelSegs[i];var leftCol=isRtl?(colCnt-1-seg.lastCol):seg.firstCol;var rightCol=isRtl?(colCnt-1-seg.firstCol):seg.lastCol;emptyCellsUntil(leftCol);colSegsBelow=[];totalSegsBelow=0;while(col<=rightCol){segsBelow=this.getCellSegs(row,col,levelLimit);colSegsBelow.push(segsBelow);totalSegsBelow+=segsBelow.length;col++;}
if(totalSegsBelow){td=cellMatrix[levelLimit-1][leftCol];rowSpan=td.rowSpan||1;segMoreNodes=[];for(j=0;j<colSegsBelow.length;j++){moreTd=core.createElement('td',{className:'fc-more-cell',rowSpan:rowSpan});segsBelow=colSegsBelow[j];moreLink=this.renderMoreLink(row,leftCol+j,[seg].concat(segsBelow));moreWrap=core.createElement('div',null,moreLink);moreTd.appendChild(moreWrap);segMoreNodes.push(moreTd);moreNodes.push(moreTd);}
td.classList.add('fc-limited');core.insertAfterElement(td,segMoreNodes);limitedNodes.push(td);}}
emptyCellsUntil(this.colCnt);rowStruct.moreEls=moreNodes;rowStruct.limitedEls=limitedNodes;}};DayGrid.prototype.unlimitRow=function(row){var rowStruct=this.eventRenderer.rowStructs[row];if(rowStruct.moreEls){rowStruct.moreEls.forEach(core.removeElement);rowStruct.moreEls=null;}
if(rowStruct.limitedEls){rowStruct.limitedEls.forEach(function(limitedEl){limitedEl.classList.remove('fc-limited');});rowStruct.limitedEls=null;}};DayGrid.prototype.renderMoreLink=function(row,col,hiddenSegs){var _this=this;var _a=this.context,calendar=_a.calendar,view=_a.view,dateEnv=_a.dateEnv,options=_a.options,isRtl=_a.isRtl;var a=core.createElement('a',{className:'fc-more'});a.innerText=this.getMoreLinkText(hiddenSegs.length);a.addEventListener('click',function(ev){var clickOption=options.eventLimitClick;var _col=isRtl?_this.colCnt-col-1:col;var date=_this.props.cells[row][_col].date;var moreEl=ev.currentTarget;var dayEl=_this.getCellEl(row,col);var allSegs=_this.getCellSegs(row,col);var reslicedAllSegs=_this.resliceDaySegs(allSegs,date);var reslicedHiddenSegs=_this.resliceDaySegs(hiddenSegs,date);if(typeof clickOption==='function'){clickOption=calendar.publiclyTrigger('eventLimitClick',[{date:dateEnv.toDate(date),allDay:true,dayEl:dayEl,moreEl:moreEl,segs:reslicedAllSegs,hiddenSegs:reslicedHiddenSegs,jsEvent:ev,view:view}]);}
if(clickOption==='popover'){_this.showSegPopover(row,col,moreEl,reslicedAllSegs);}
else if(typeof clickOption==='string'){calendar.zoomTo(date,clickOption);}});return a;};DayGrid.prototype.showSegPopover=function(row,col,moreLink,segs){var _this=this;var _a=this.context,calendar=_a.calendar,view=_a.view,theme=_a.theme,isRtl=_a.isRtl;var _col=isRtl?this.colCnt-col-1:col;var moreWrap=moreLink.parentNode;var topEl;var options;if(this.rowCnt===1){topEl=view.el;}
else{topEl=this.rowEls[row];}
options={className:'fc-more-popover '+theme.getClass('popover'),parentEl:view.el,top:core.computeRect(topEl).top,autoHide:true,content:function(el){_this.segPopoverTile=new DayTile(el);_this.updateSegPopoverTile(_this.props.cells[row][_col].date,segs);},hide:function(){_this.segPopoverTile.destroy();_this.segPopoverTile=null;_this.segPopover.destroy();_this.segPopover=null;}};if(isRtl){options.right=core.computeRect(moreWrap).right+1;}
else{options.left=core.computeRect(moreWrap).left-1;}
this.segPopover=new Popover(options);this.segPopover.show();calendar.releaseAfterSizingTriggers();};DayGrid.prototype.resliceDaySegs=function(segs,dayDate){var dayStart=dayDate;var dayEnd=core.addDays(dayStart,1);var dayRange={start:dayStart,end:dayEnd};var newSegs=[];for(var _i=0,segs_1=segs;_i<segs_1.length;_i++){var seg=segs_1[_i];var eventRange=seg.eventRange;var origRange=eventRange.range;var slicedRange=core.intersectRanges(origRange,dayRange);if(slicedRange){newSegs.push(__assign({},seg,{eventRange:{def:eventRange.def,ui:__assign({},eventRange.ui,{durationEditable:false}),instance:eventRange.instance,range:slicedRange},isStart:seg.isStart&&slicedRange.start.valueOf()===origRange.start.valueOf(),isEnd:seg.isEnd&&slicedRange.end.valueOf()===origRange.end.valueOf()}));}}
return newSegs;};DayGrid.prototype.getMoreLinkText=function(num){var opt=this.context.options.eventLimitText;if(typeof opt==='function'){return opt(num);}
else{return'+'+num+' '+opt;}};DayGrid.prototype.getCellSegs=function(row,col,startLevel){var segMatrix=this.eventRenderer.rowStructs[row].segMatrix;var level=startLevel||0;var segs=[];var seg;while(level<segMatrix.length){seg=segMatrix[level][col];if(seg){segs.push(seg);}
level++;}
return segs;};return DayGrid;}(core.DateComponent));var WEEK_NUM_FORMAT$1=core.createFormatter({week:'numeric'});var AbstractDayGridView=(function(_super){__extends(AbstractDayGridView,_super);function AbstractDayGridView(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.processOptions=core.memoize(_this._processOptions);_this.renderSkeleton=core.memoizeRendering(_this._renderSkeleton,_this._unrenderSkeleton);_this.renderHeadIntroHtml=function(){var _a=_this.context,theme=_a.theme,options=_a.options;if(_this.colWeekNumbersVisible){return''+'<th class="fc-week-number '+theme.getClass('widgetHeader')+'" '+_this.weekNumberStyleAttr()+'>'+'<span>'+
core.htmlEscape(options.weekLabel)+'</span>'+'</th>';}
return'';};_this.renderDayGridNumberIntroHtml=function(row,dayGrid){var _a=_this.context,options=_a.options,dateEnv=_a.dateEnv;var weekStart=dayGrid.props.cells[row][0].date;if(_this.colWeekNumbersVisible){return''+'<td class="fc-week-number" '+_this.weekNumberStyleAttr()+'>'+
core.buildGotoAnchorHtml(options,dateEnv,{date:weekStart,type:'week',forceOff:dayGrid.colCnt===1},dateEnv.format(weekStart,WEEK_NUM_FORMAT$1))+'</td>';}
return'';};_this.renderDayGridBgIntroHtml=function(){var theme=_this.context.theme;if(_this.colWeekNumbersVisible){return'<td class="fc-week-number '+theme.getClass('widgetContent')+'" '+_this.weekNumberStyleAttr()+'></td>';}
return'';};_this.renderDayGridIntroHtml=function(){if(_this.colWeekNumbersVisible){return'<td class="fc-week-number" '+_this.weekNumberStyleAttr()+'></td>';}
return'';};return _this;}
AbstractDayGridView.prototype._processOptions=function(options){if(options.weekNumbers){if(options.weekNumbersWithinDays){this.cellWeekNumbersVisible=true;this.colWeekNumbersVisible=false;}
else{this.cellWeekNumbersVisible=false;this.colWeekNumbersVisible=true;}}
else{this.colWeekNumbersVisible=false;this.cellWeekNumbersVisible=false;}};AbstractDayGridView.prototype.render=function(props,context){_super.prototype.render.call(this,props,context);this.processOptions(context.options);this.renderSkeleton(context);};AbstractDayGridView.prototype.destroy=function(){_super.prototype.destroy.call(this);this.renderSkeleton.unrender();};AbstractDayGridView.prototype._renderSkeleton=function(context){this.el.classList.add('fc-dayGrid-view');this.el.innerHTML=this.renderSkeletonHtml();this.scroller=new core.ScrollComponent('hidden','auto');var dayGridContainerEl=this.scroller.el;this.el.querySelector('.fc-body > tr > td').appendChild(dayGridContainerEl);dayGridContainerEl.classList.add('fc-day-grid-container');var dayGridEl=core.createElement('div',{className:'fc-day-grid'});dayGridContainerEl.appendChild(dayGridEl);this.dayGrid=new DayGrid(dayGridEl,{renderNumberIntroHtml:this.renderDayGridNumberIntroHtml,renderBgIntroHtml:this.renderDayGridBgIntroHtml,renderIntroHtml:this.renderDayGridIntroHtml,colWeekNumbersVisible:this.colWeekNumbersVisible,cellWeekNumbersVisible:this.cellWeekNumbersVisible});};AbstractDayGridView.prototype._unrenderSkeleton=function(){this.el.classList.remove('fc-dayGrid-view');this.dayGrid.destroy();this.scroller.destroy();};AbstractDayGridView.prototype.renderSkeletonHtml=function(){var _a=this.context,theme=_a.theme,options=_a.options;return''+'<table class="'+theme.getClass('tableGrid')+'">'+
(options.columnHeader?'<thead class="fc-head">'+'<tr>'+'<td class="fc-head-container '+theme.getClass('widgetHeader')+'">&nbsp;</td>'+'</tr>'+'</thead>':'')+'<tbody class="fc-body">'+'<tr>'+'<td class="'+theme.getClass('widgetContent')+'"></td>'+'</tr>'+'</tbody>'+'</table>';};AbstractDayGridView.prototype.weekNumberStyleAttr=function(){if(this.weekNumberWidth!=null){return'style="width:'+this.weekNumberWidth+'px"';}
return'';};AbstractDayGridView.prototype.hasRigidRows=function(){var eventLimit=this.context.options.eventLimit;return eventLimit&&typeof eventLimit!=='number';};AbstractDayGridView.prototype.updateSize=function(isResize,viewHeight,isAuto){_super.prototype.updateSize.call(this,isResize,viewHeight,isAuto);this.dayGrid.updateSize(isResize);};AbstractDayGridView.prototype.updateBaseSize=function(isResize,viewHeight,isAuto){var dayGrid=this.dayGrid;var eventLimit=this.context.options.eventLimit;var headRowEl=this.header?this.header.el:null;var scrollerHeight;var scrollbarWidths;if(!dayGrid.rowEls){if(!isAuto){scrollerHeight=this.computeScrollerHeight(viewHeight);this.scroller.setHeight(scrollerHeight);}
return;}
if(this.colWeekNumbersVisible){this.weekNumberWidth=core.matchCellWidths(core.findElements(this.el,'.fc-week-number'));}
this.scroller.clear();if(headRowEl){core.uncompensateScroll(headRowEl);}
dayGrid.removeSegPopover();if(eventLimit&&typeof eventLimit==='number'){dayGrid.limitRows(eventLimit);}
scrollerHeight=this.computeScrollerHeight(viewHeight);this.setGridHeight(scrollerHeight,isAuto);if(eventLimit&&typeof eventLimit!=='number'){dayGrid.limitRows(eventLimit);}
if(!isAuto){this.scroller.setHeight(scrollerHeight);scrollbarWidths=this.scroller.getScrollbarWidths();if(scrollbarWidths.left||scrollbarWidths.right){if(headRowEl){core.compensateScroll(headRowEl,scrollbarWidths);}
scrollerHeight=this.computeScrollerHeight(viewHeight);this.scroller.setHeight(scrollerHeight);}
this.scroller.lockOverflow(scrollbarWidths);}};AbstractDayGridView.prototype.computeScrollerHeight=function(viewHeight){return viewHeight-
core.subtractInnerElHeight(this.el,this.scroller.el);};AbstractDayGridView.prototype.setGridHeight=function(height,isAuto){if(this.context.options.monthMode){if(isAuto){height*=this.dayGrid.rowCnt/6;}
core.distributeHeight(this.dayGrid.rowEls,height,!isAuto);}
else{if(isAuto){core.undistributeHeight(this.dayGrid.rowEls);}
else{core.distributeHeight(this.dayGrid.rowEls,height,true);}}};AbstractDayGridView.prototype.computeDateScroll=function(duration){return{top:0};};AbstractDayGridView.prototype.queryDateScroll=function(){return{top:this.scroller.getScrollTop()};};AbstractDayGridView.prototype.applyDateScroll=function(scroll){if(scroll.top!==undefined){this.scroller.setScrollTop(scroll.top);}};return AbstractDayGridView;}(core.View));AbstractDayGridView.prototype.dateProfileGeneratorClass=DayGridDateProfileGenerator;var SimpleDayGrid=(function(_super){__extends(SimpleDayGrid,_super);function SimpleDayGrid(dayGrid){var _this=_super.call(this,dayGrid.el)||this;_this.slicer=new DayGridSlicer();_this.dayGrid=dayGrid;return _this;}
SimpleDayGrid.prototype.firstContext=function(context){context.calendar.registerInteractiveComponent(this,{el:this.dayGrid.el});};SimpleDayGrid.prototype.destroy=function(){_super.prototype.destroy.call(this);this.context.calendar.unregisterInteractiveComponent(this);};SimpleDayGrid.prototype.render=function(props,context){var dayGrid=this.dayGrid;var dateProfile=props.dateProfile,dayTable=props.dayTable;dayGrid.receiveProps(__assign({},this.slicer.sliceProps(props,dateProfile,props.nextDayThreshold,context.calendar,dayGrid,dayTable),{dateProfile:dateProfile,cells:dayTable.cells,isRigid:props.isRigid}),context);};SimpleDayGrid.prototype.buildPositionCaches=function(){this.dayGrid.buildPositionCaches();};SimpleDayGrid.prototype.queryHit=function(positionLeft,positionTop){var rawHit=this.dayGrid.positionToHit(positionLeft,positionTop);if(rawHit){return{component:this.dayGrid,dateSpan:rawHit.dateSpan,dayEl:rawHit.dayEl,rect:{left:rawHit.relativeRect.left,right:rawHit.relativeRect.right,top:rawHit.relativeRect.top,bottom:rawHit.relativeRect.bottom},layer:0};}};return SimpleDayGrid;}(core.DateComponent));var DayGridSlicer=(function(_super){__extends(DayGridSlicer,_super);function DayGridSlicer(){return _super!==null&&_super.apply(this,arguments)||this;}
DayGridSlicer.prototype.sliceRange=function(dateRange,dayTable){return dayTable.sliceRange(dateRange);};return DayGridSlicer;}(core.Slicer));var DayGridView=(function(_super){__extends(DayGridView,_super);function DayGridView(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.buildDayTable=core.memoize(buildDayTable);return _this;}
DayGridView.prototype.render=function(props,context){_super.prototype.render.call(this,props,context);var dateProfile=this.props.dateProfile;var dayTable=this.dayTable=this.buildDayTable(dateProfile,props.dateProfileGenerator);if(this.header){this.header.receiveProps({dateProfile:dateProfile,dates:dayTable.headerDates,datesRepDistinctDays:dayTable.rowCnt===1,renderIntroHtml:this.renderHeadIntroHtml},context);}
this.simpleDayGrid.receiveProps({dateProfile:dateProfile,dayTable:dayTable,businessHours:props.businessHours,dateSelection:props.dateSelection,eventStore:props.eventStore,eventUiBases:props.eventUiBases,eventSelection:props.eventSelection,eventDrag:props.eventDrag,eventResize:props.eventResize,isRigid:this.hasRigidRows(),nextDayThreshold:this.context.nextDayThreshold},context);};DayGridView.prototype._renderSkeleton=function(context){_super.prototype._renderSkeleton.call(this,context);if(context.options.columnHeader){this.header=new core.DayHeader(this.el.querySelector('.fc-head-container'));}
this.simpleDayGrid=new SimpleDayGrid(this.dayGrid);};DayGridView.prototype._unrenderSkeleton=function(){_super.prototype._unrenderSkeleton.call(this);if(this.header){this.header.destroy();}
this.simpleDayGrid.destroy();};return DayGridView;}(AbstractDayGridView));function buildDayTable(dateProfile,dateProfileGenerator){var daySeries=new core.DaySeries(dateProfile.renderRange,dateProfileGenerator);return new core.DayTable(daySeries,/year|month|week/.test(dateProfile.currentRangeUnit));}
var main=core.createPlugin({defaultView:'dayGridMonth',views:{dayGrid:DayGridView,dayGridDay:{type:'dayGrid',duration:{days:1}},dayGridWeek:{type:'dayGrid',duration:{weeks:1}},dayGridMonth:{type:'dayGrid',duration:{months:1},monthMode:true,fixedWeekCount:true}}});exports.AbstractDayGridView=AbstractDayGridView;exports.DayBgRow=DayBgRow;exports.DayGrid=DayGrid;exports.DayGridSlicer=DayGridSlicer;exports.DayGridView=DayGridView;exports.SimpleDayGrid=SimpleDayGrid;exports.buildBasicDayTable=buildDayTable;exports.default=main;Object.defineProperty(exports,'__esModule',{value:true});}));;

/* /web/static/lib/fullcalendar/timegrid/main.js defined in bundle 'web.tests_assets' */
(function(global,factory){typeof exports==='object'&&typeof module!=='undefined'?factory(exports,require('@fullcalendar/core'),require('@fullcalendar/daygrid')):typeof define==='function'&&define.amd?define(['exports','@fullcalendar/core','@fullcalendar/daygrid'],factory):(global=global||self,factory(global.FullCalendarTimeGrid={},global.FullCalendar,global.FullCalendarDayGrid));}(this,function(exports,core,daygrid){'use strict';var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b;})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];};return extendStatics(d,b);};function __extends(d,b){extendStatics(d,b);function __(){this.constructor=d;}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __());}
var __assign=function(){__assign=Object.assign||function __assign(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p))t[p]=s[p];}
return t;};return __assign.apply(this,arguments);};var TimeGridEventRenderer=(function(_super){__extends(TimeGridEventRenderer,_super);function TimeGridEventRenderer(timeGrid){var _this=_super.call(this)||this;_this.timeGrid=timeGrid;return _this;}
TimeGridEventRenderer.prototype.renderSegs=function(context,segs,mirrorInfo){_super.prototype.renderSegs.call(this,context,segs,mirrorInfo);this.fullTimeFormat=core.createFormatter({hour:'numeric',minute:'2-digit',separator:this.context.options.defaultRangeSeparator});};TimeGridEventRenderer.prototype.attachSegs=function(segs,mirrorInfo){var segsByCol=this.timeGrid.groupSegsByCol(segs);for(var col=0;col<segsByCol.length;col++){segsByCol[col]=this.sortEventSegs(segsByCol[col]);}
this.segsByCol=segsByCol;this.timeGrid.attachSegsByCol(segsByCol,this.timeGrid.fgContainerEls);};TimeGridEventRenderer.prototype.detachSegs=function(segs){segs.forEach(function(seg){core.removeElement(seg.el);});this.segsByCol=null;};TimeGridEventRenderer.prototype.computeSegSizes=function(allSegs){var _a=this,timeGrid=_a.timeGrid,segsByCol=_a.segsByCol;var colCnt=timeGrid.colCnt;timeGrid.computeSegVerticals(allSegs);if(segsByCol){for(var col=0;col<colCnt;col++){this.computeSegHorizontals(segsByCol[col]);}}};TimeGridEventRenderer.prototype.assignSegSizes=function(allSegs){var _a=this,timeGrid=_a.timeGrid,segsByCol=_a.segsByCol;var colCnt=timeGrid.colCnt;timeGrid.assignSegVerticals(allSegs);if(segsByCol){for(var col=0;col<colCnt;col++){this.assignSegCss(segsByCol[col]);}}};TimeGridEventRenderer.prototype.computeEventTimeFormat=function(){return{hour:'numeric',minute:'2-digit',meridiem:false};};TimeGridEventRenderer.prototype.computeDisplayEventEnd=function(){return true;};TimeGridEventRenderer.prototype.renderSegHtml=function(seg,mirrorInfo){var eventRange=seg.eventRange;var eventDef=eventRange.def;var eventUi=eventRange.ui;var allDay=eventDef.allDay;var isDraggable=core.computeEventDraggable(this.context,eventDef,eventUi);var isResizableFromStart=seg.isStart&&core.computeEventStartResizable(this.context,eventDef,eventUi);var isResizableFromEnd=seg.isEnd&&core.computeEventEndResizable(this.context,eventDef,eventUi);var classes=this.getSegClasses(seg,isDraggable,isResizableFromStart||isResizableFromEnd,mirrorInfo);var skinCss=core.cssToStr(this.getSkinCss(eventUi));var timeText;var fullTimeText;var startTimeText;classes.unshift('fc-time-grid-event');if(core.isMultiDayRange(eventRange.range)){if(seg.isStart||seg.isEnd){var unzonedStart=seg.start;var unzonedEnd=seg.end;timeText=this._getTimeText(unzonedStart,unzonedEnd,allDay);fullTimeText=this._getTimeText(unzonedStart,unzonedEnd,allDay,this.fullTimeFormat);startTimeText=this._getTimeText(unzonedStart,unzonedEnd,allDay,null,false);}}
else{timeText=this.getTimeText(eventRange);fullTimeText=this.getTimeText(eventRange,this.fullTimeFormat);startTimeText=this.getTimeText(eventRange,null,false);}
return'<a class="'+classes.join(' ')+'"'+
(eventDef.url?' href="'+core.htmlEscape(eventDef.url)+'"':'')+
(skinCss?' style="'+skinCss+'"':'')+'>'+'<div class="fc-content">'+
(timeText?'<div class="fc-time"'+' data-start="'+core.htmlEscape(startTimeText)+'"'+' data-full="'+core.htmlEscape(fullTimeText)+'"'+'>'+'<span>'+core.htmlEscape(timeText)+'</span>'+'</div>':'')+
(eventDef.title?'<div class="fc-title">'+
core.htmlEscape(eventDef.title)+'</div>':'')+'</div>'+
(isResizableFromEnd?'<div class="fc-resizer fc-end-resizer"></div>':'')+'</a>';};TimeGridEventRenderer.prototype.computeSegHorizontals=function(segs){var levels;var level0;var i;levels=buildSlotSegLevels(segs);computeForwardSlotSegs(levels);if((level0=levels[0])){for(i=0;i<level0.length;i++){computeSlotSegPressures(level0[i]);}
for(i=0;i<level0.length;i++){this.computeSegForwardBack(level0[i],0,0);}}};TimeGridEventRenderer.prototype.computeSegForwardBack=function(seg,seriesBackwardPressure,seriesBackwardCoord){var forwardSegs=seg.forwardSegs;var i;if(seg.forwardCoord===undefined){if(!forwardSegs.length){seg.forwardCoord=1;}
else{this.sortForwardSegs(forwardSegs);this.computeSegForwardBack(forwardSegs[0],seriesBackwardPressure+1,seriesBackwardCoord);seg.forwardCoord=forwardSegs[0].backwardCoord;}
seg.backwardCoord=seg.forwardCoord-
(seg.forwardCoord-seriesBackwardCoord)/(seriesBackwardPressure+1);for(i=0;i<forwardSegs.length;i++){this.computeSegForwardBack(forwardSegs[i],0,seg.forwardCoord);}}};TimeGridEventRenderer.prototype.sortForwardSegs=function(forwardSegs){var objs=forwardSegs.map(buildTimeGridSegCompareObj);var specs=[{field:'forwardPressure',order:-1},{field:'backwardCoord',order:1}].concat(this.context.eventOrderSpecs);objs.sort(function(obj0,obj1){return core.compareByFieldSpecs(obj0,obj1,specs);});return objs.map(function(c){return c._seg;});};TimeGridEventRenderer.prototype.assignSegCss=function(segs){for(var _i=0,segs_1=segs;_i<segs_1.length;_i++){var seg=segs_1[_i];core.applyStyle(seg.el,this.generateSegCss(seg));if(seg.level>0){seg.el.classList.add('fc-time-grid-event-inset');}
if(seg.bottom-seg.top<30){seg.el.classList.add('fc-short');}}};TimeGridEventRenderer.prototype.generateSegCss=function(seg){var shouldOverlap=this.context.options.slotEventOverlap;var backwardCoord=seg.backwardCoord;var forwardCoord=seg.forwardCoord;var props=this.timeGrid.generateSegVerticalCss(seg);var isRtl=this.context.isRtl;var left;var right;if(shouldOverlap){forwardCoord=Math.min(1,backwardCoord+(forwardCoord-backwardCoord)*2);}
if(isRtl){left=1-forwardCoord;right=backwardCoord;}
else{left=backwardCoord;right=1-forwardCoord;}
props.zIndex=seg.level+1;props.left=left*100+'%';props.right=right*100+'%';if(shouldOverlap&&seg.forwardPressure){props[isRtl?'marginLeft':'marginRight']=10*2;}
return props;};return TimeGridEventRenderer;}(core.FgEventRenderer));function buildSlotSegLevels(segs){var levels=[];var i;var seg;var j;for(i=0;i<segs.length;i++){seg=segs[i];for(j=0;j<levels.length;j++){if(!computeSlotSegCollisions(seg,levels[j]).length){break;}}
seg.level=j;(levels[j]||(levels[j]=[])).push(seg);}
return levels;}
function computeForwardSlotSegs(levels){var i;var level;var j;var seg;var k;for(i=0;i<levels.length;i++){level=levels[i];for(j=0;j<level.length;j++){seg=level[j];seg.forwardSegs=[];for(k=i+1;k<levels.length;k++){computeSlotSegCollisions(seg,levels[k],seg.forwardSegs);}}}}
function computeSlotSegPressures(seg){var forwardSegs=seg.forwardSegs;var forwardPressure=0;var i;var forwardSeg;if(seg.forwardPressure===undefined){for(i=0;i<forwardSegs.length;i++){forwardSeg=forwardSegs[i];computeSlotSegPressures(forwardSeg);forwardPressure=Math.max(forwardPressure,1+forwardSeg.forwardPressure);}
seg.forwardPressure=forwardPressure;}}
function computeSlotSegCollisions(seg,otherSegs,results){if(results===void 0){results=[];}
for(var i=0;i<otherSegs.length;i++){if(isSlotSegCollision(seg,otherSegs[i])){results.push(otherSegs[i]);}}
return results;}
function isSlotSegCollision(seg1,seg2){return seg1.bottom>seg2.top&&seg1.top<seg2.bottom;}
function buildTimeGridSegCompareObj(seg){var obj=core.buildSegCompareObj(seg);obj.forwardPressure=seg.forwardPressure;obj.backwardCoord=seg.backwardCoord;return obj;}
var TimeGridMirrorRenderer=(function(_super){__extends(TimeGridMirrorRenderer,_super);function TimeGridMirrorRenderer(){return _super!==null&&_super.apply(this,arguments)||this;}
TimeGridMirrorRenderer.prototype.attachSegs=function(segs,mirrorInfo){this.segsByCol=this.timeGrid.groupSegsByCol(segs);this.timeGrid.attachSegsByCol(this.segsByCol,this.timeGrid.mirrorContainerEls);this.sourceSeg=mirrorInfo.sourceSeg;};TimeGridMirrorRenderer.prototype.generateSegCss=function(seg){var props=_super.prototype.generateSegCss.call(this,seg);var sourceSeg=this.sourceSeg;if(sourceSeg&&sourceSeg.col===seg.col){var sourceSegProps=_super.prototype.generateSegCss.call(this,sourceSeg);props.left=sourceSegProps.left;props.right=sourceSegProps.right;props.marginLeft=sourceSegProps.marginLeft;props.marginRight=sourceSegProps.marginRight;}
return props;};return TimeGridMirrorRenderer;}(TimeGridEventRenderer));var TimeGridFillRenderer=(function(_super){__extends(TimeGridFillRenderer,_super);function TimeGridFillRenderer(timeGrid){var _this=_super.call(this)||this;_this.timeGrid=timeGrid;return _this;}
TimeGridFillRenderer.prototype.attachSegs=function(type,segs){var timeGrid=this.timeGrid;var containerEls;if(type==='bgEvent'){containerEls=timeGrid.bgContainerEls;}
else if(type==='businessHours'){containerEls=timeGrid.businessContainerEls;}
else if(type==='highlight'){containerEls=timeGrid.highlightContainerEls;}
timeGrid.attachSegsByCol(timeGrid.groupSegsByCol(segs),containerEls);return segs.map(function(seg){return seg.el;});};TimeGridFillRenderer.prototype.computeSegSizes=function(segs){this.timeGrid.computeSegVerticals(segs);};TimeGridFillRenderer.prototype.assignSegSizes=function(segs){this.timeGrid.assignSegVerticals(segs);};return TimeGridFillRenderer;}(core.FillRenderer));var AGENDA_STOCK_SUB_DURATIONS=[{hours:1},{minutes:30},{minutes:15},{seconds:30},{seconds:15}];var TimeGrid=(function(_super){__extends(TimeGrid,_super);function TimeGrid(el,renderProps){var _this=_super.call(this,el)||this;_this.isSlatSizesDirty=false;_this.isColSizesDirty=false;_this.processOptions=core.memoize(_this._processOptions);_this.renderSkeleton=core.memoizeRendering(_this._renderSkeleton);_this.renderSlats=core.memoizeRendering(_this._renderSlats,null,[_this.renderSkeleton]);_this.renderColumns=core.memoizeRendering(_this._renderColumns,_this._unrenderColumns,[_this.renderSkeleton]);_this.renderProps=renderProps;var renderColumns=_this.renderColumns;var eventRenderer=_this.eventRenderer=new TimeGridEventRenderer(_this);var fillRenderer=_this.fillRenderer=new TimeGridFillRenderer(_this);_this.mirrorRenderer=new TimeGridMirrorRenderer(_this);_this.renderBusinessHours=core.memoizeRendering(fillRenderer.renderSegs.bind(fillRenderer,'businessHours'),fillRenderer.unrender.bind(fillRenderer,'businessHours'),[renderColumns]);_this.renderDateSelection=core.memoizeRendering(_this._renderDateSelection,_this._unrenderDateSelection,[renderColumns]);_this.renderFgEvents=core.memoizeRendering(eventRenderer.renderSegs.bind(eventRenderer),eventRenderer.unrender.bind(eventRenderer),[renderColumns]);_this.renderBgEvents=core.memoizeRendering(fillRenderer.renderSegs.bind(fillRenderer,'bgEvent'),fillRenderer.unrender.bind(fillRenderer,'bgEvent'),[renderColumns]);_this.renderEventSelection=core.memoizeRendering(eventRenderer.selectByInstanceId.bind(eventRenderer),eventRenderer.unselectByInstanceId.bind(eventRenderer),[_this.renderFgEvents]);_this.renderEventDrag=core.memoizeRendering(_this._renderEventDrag,_this._unrenderEventDrag,[renderColumns]);_this.renderEventResize=core.memoizeRendering(_this._renderEventResize,_this._unrenderEventResize,[renderColumns]);return _this;}
TimeGrid.prototype._processOptions=function(options){var slotDuration=options.slotDuration,snapDuration=options.snapDuration;var snapsPerSlot;var input;slotDuration=core.createDuration(slotDuration);snapDuration=snapDuration?core.createDuration(snapDuration):slotDuration;snapsPerSlot=core.wholeDivideDurations(slotDuration,snapDuration);if(snapsPerSlot===null){snapDuration=slotDuration;snapsPerSlot=1;}
this.slotDuration=slotDuration;this.snapDuration=snapDuration;this.snapsPerSlot=snapsPerSlot;input=options.slotLabelFormat;if(Array.isArray(input)){input=input[input.length-1];}
this.labelFormat=core.createFormatter(input||{hour:'numeric',minute:'2-digit',omitZeroMinute:true,meridiem:'short'});input=options.slotLabelInterval;this.labelInterval=input?core.createDuration(input):this.computeLabelInterval(slotDuration);};TimeGrid.prototype.computeLabelInterval=function(slotDuration){var i;var labelInterval;var slotsPerLabel;for(i=AGENDA_STOCK_SUB_DURATIONS.length-1;i>=0;i--){labelInterval=core.createDuration(AGENDA_STOCK_SUB_DURATIONS[i]);slotsPerLabel=core.wholeDivideDurations(labelInterval,slotDuration);if(slotsPerLabel!==null&&slotsPerLabel>1){return labelInterval;}}
return slotDuration;};TimeGrid.prototype.render=function(props,context){this.processOptions(context.options);var cells=props.cells;this.colCnt=cells.length;this.renderSkeleton(context.theme);this.renderSlats(props.dateProfile);this.renderColumns(props.cells,props.dateProfile);this.renderBusinessHours(context,props.businessHourSegs);this.renderDateSelection(props.dateSelectionSegs);this.renderFgEvents(context,props.fgEventSegs);this.renderBgEvents(context,props.bgEventSegs);this.renderEventSelection(props.eventSelection);this.renderEventDrag(props.eventDrag);this.renderEventResize(props.eventResize);};TimeGrid.prototype.destroy=function(){_super.prototype.destroy.call(this);this.renderSlats.unrender();this.renderColumns.unrender();this.renderSkeleton.unrender();};TimeGrid.prototype.updateSize=function(isResize){var _a=this,fillRenderer=_a.fillRenderer,eventRenderer=_a.eventRenderer,mirrorRenderer=_a.mirrorRenderer;if(isResize||this.isSlatSizesDirty){this.buildSlatPositions();this.isSlatSizesDirty=false;}
if(isResize||this.isColSizesDirty){this.buildColPositions();this.isColSizesDirty=false;}
fillRenderer.computeSizes(isResize);eventRenderer.computeSizes(isResize);mirrorRenderer.computeSizes(isResize);fillRenderer.assignSizes(isResize);eventRenderer.assignSizes(isResize);mirrorRenderer.assignSizes(isResize);};TimeGrid.prototype._renderSkeleton=function(theme){var el=this.el;el.innerHTML='<div class="fc-bg"></div>'+'<div class="fc-slats"></div>'+'<hr class="fc-divider '+theme.getClass('widgetHeader')+'" style="display:none" />';this.rootBgContainerEl=el.querySelector('.fc-bg');this.slatContainerEl=el.querySelector('.fc-slats');this.bottomRuleEl=el.querySelector('.fc-divider');};TimeGrid.prototype._renderSlats=function(dateProfile){var theme=this.context.theme;this.slatContainerEl.innerHTML='<table class="'+theme.getClass('tableGrid')+'">'+
this.renderSlatRowHtml(dateProfile)+'</table>';this.slatEls=core.findElements(this.slatContainerEl,'tr');this.slatPositions=new core.PositionCache(this.el,this.slatEls,false,true);this.isSlatSizesDirty=true;};TimeGrid.prototype.renderSlatRowHtml=function(dateProfile){var _a=this.context,dateEnv=_a.dateEnv,theme=_a.theme,isRtl=_a.isRtl;var html='';var dayStart=core.startOfDay(dateProfile.renderRange.start);var slotTime=dateProfile.minTime;var slotIterator=core.createDuration(0);var slotDate;var isLabeled;var axisHtml;while(core.asRoughMs(slotTime)<core.asRoughMs(dateProfile.maxTime)){slotDate=dateEnv.add(dayStart,slotTime);isLabeled=core.wholeDivideDurations(slotIterator,this.labelInterval)!==null;axisHtml='<td class="fc-axis fc-time '+theme.getClass('widgetContent')+'">'+
(isLabeled?'<span>'+
core.htmlEscape(dateEnv.format(slotDate,this.labelFormat))+'</span>':'')+'</td>';html+='<tr data-time="'+core.formatIsoTimeString(slotDate)+'"'+
(isLabeled?'':' class="fc-minor"')+'>'+
(!isRtl?axisHtml:'')+'<td class="'+theme.getClass('widgetContent')+'"></td>'+
(isRtl?axisHtml:'')+'</tr>';slotTime=core.addDurations(slotTime,this.slotDuration);slotIterator=core.addDurations(slotIterator,this.slotDuration);}
return html;};TimeGrid.prototype._renderColumns=function(cells,dateProfile){var _a=this.context,calendar=_a.calendar,view=_a.view,isRtl=_a.isRtl,theme=_a.theme,dateEnv=_a.dateEnv;var bgRow=new daygrid.DayBgRow(this.context);this.rootBgContainerEl.innerHTML='<table class="'+theme.getClass('tableGrid')+'">'+
bgRow.renderHtml({cells:cells,dateProfile:dateProfile,renderIntroHtml:this.renderProps.renderBgIntroHtml})+'</table>';this.colEls=core.findElements(this.el,'.fc-day, .fc-disabled-day');for(var col=0;col<this.colCnt;col++){calendar.publiclyTrigger('dayRender',[{date:dateEnv.toDate(cells[col].date),el:this.colEls[col],view:view}]);}
if(isRtl){this.colEls.reverse();}
this.colPositions=new core.PositionCache(this.el,this.colEls,true,false);this.renderContentSkeleton();this.isColSizesDirty=true;};TimeGrid.prototype._unrenderColumns=function(){this.unrenderContentSkeleton();};TimeGrid.prototype.renderContentSkeleton=function(){var isRtl=this.context.isRtl;var parts=[];var skeletonEl;parts.push(this.renderProps.renderIntroHtml());for(var i=0;i<this.colCnt;i++){parts.push('<td>'+'<div class="fc-content-col">'+'<div class="fc-event-container fc-mirror-container"></div>'+'<div class="fc-event-container"></div>'+'<div class="fc-highlight-container"></div>'+'<div class="fc-bgevent-container"></div>'+'<div class="fc-business-container"></div>'+'</div>'+'</td>');}
if(isRtl){parts.reverse();}
skeletonEl=this.contentSkeletonEl=core.htmlToElement('<div class="fc-content-skeleton">'+'<table>'+'<tr>'+parts.join('')+'</tr>'+'</table>'+'</div>');this.colContainerEls=core.findElements(skeletonEl,'.fc-content-col');this.mirrorContainerEls=core.findElements(skeletonEl,'.fc-mirror-container');this.fgContainerEls=core.findElements(skeletonEl,'.fc-event-container:not(.fc-mirror-container)');this.bgContainerEls=core.findElements(skeletonEl,'.fc-bgevent-container');this.highlightContainerEls=core.findElements(skeletonEl,'.fc-highlight-container');this.businessContainerEls=core.findElements(skeletonEl,'.fc-business-container');if(isRtl){this.colContainerEls.reverse();this.mirrorContainerEls.reverse();this.fgContainerEls.reverse();this.bgContainerEls.reverse();this.highlightContainerEls.reverse();this.businessContainerEls.reverse();}
this.el.appendChild(skeletonEl);};TimeGrid.prototype.unrenderContentSkeleton=function(){core.removeElement(this.contentSkeletonEl);};TimeGrid.prototype.groupSegsByCol=function(segs){var segsByCol=[];var i;for(i=0;i<this.colCnt;i++){segsByCol.push([]);}
for(i=0;i<segs.length;i++){segsByCol[segs[i].col].push(segs[i]);}
return segsByCol;};TimeGrid.prototype.attachSegsByCol=function(segsByCol,containerEls){var col;var segs;var i;for(col=0;col<this.colCnt;col++){segs=segsByCol[col];for(i=0;i<segs.length;i++){containerEls[col].appendChild(segs[i].el);}}};TimeGrid.prototype.getNowIndicatorUnit=function(){return'minute';};TimeGrid.prototype.renderNowIndicator=function(segs,date){if(!this.colContainerEls){return;}
var top=this.computeDateTop(date);var nodes=[];var i;for(i=0;i<segs.length;i++){var lineEl=core.createElement('div',{className:'fc-now-indicator fc-now-indicator-line'});lineEl.style.top=top+'px';this.colContainerEls[segs[i].col].appendChild(lineEl);nodes.push(lineEl);}
if(segs.length>0){var arrowEl=core.createElement('div',{className:'fc-now-indicator fc-now-indicator-arrow'});arrowEl.style.top=top+'px';this.contentSkeletonEl.appendChild(arrowEl);nodes.push(arrowEl);}
this.nowIndicatorEls=nodes;};TimeGrid.prototype.unrenderNowIndicator=function(){if(this.nowIndicatorEls){this.nowIndicatorEls.forEach(core.removeElement);this.nowIndicatorEls=null;}};TimeGrid.prototype.getTotalSlatHeight=function(){return this.slatContainerEl.getBoundingClientRect().height;};TimeGrid.prototype.computeDateTop=function(when,startOfDayDate){if(!startOfDayDate){startOfDayDate=core.startOfDay(when);}
return this.computeTimeTop(core.createDuration(when.valueOf()-startOfDayDate.valueOf()));};TimeGrid.prototype.computeTimeTop=function(duration){var len=this.slatEls.length;var dateProfile=this.props.dateProfile;var slatCoverage=(duration.milliseconds-core.asRoughMs(dateProfile.minTime))/core.asRoughMs(this.slotDuration);var slatIndex;var slatRemainder;slatCoverage=Math.max(0,slatCoverage);slatCoverage=Math.min(len,slatCoverage);slatIndex=Math.floor(slatCoverage);slatIndex=Math.min(slatIndex,len-1);slatRemainder=slatCoverage-slatIndex;return this.slatPositions.tops[slatIndex]+
this.slatPositions.getHeight(slatIndex)*slatRemainder;};TimeGrid.prototype.computeSegVerticals=function(segs){var options=this.context.options;var eventMinHeight=options.timeGridEventMinHeight;var i;var seg;var dayDate;for(i=0;i<segs.length;i++){seg=segs[i];dayDate=this.props.cells[seg.col].date;seg.top=this.computeDateTop(seg.start,dayDate);seg.bottom=Math.max(seg.top+eventMinHeight,this.computeDateTop(seg.end,dayDate));}};TimeGrid.prototype.assignSegVerticals=function(segs){var i;var seg;for(i=0;i<segs.length;i++){seg=segs[i];core.applyStyle(seg.el,this.generateSegVerticalCss(seg));}};TimeGrid.prototype.generateSegVerticalCss=function(seg){return{top:seg.top,bottom:-seg.bottom};};TimeGrid.prototype.buildPositionCaches=function(){this.buildColPositions();this.buildSlatPositions();};TimeGrid.prototype.buildColPositions=function(){this.colPositions.build();};TimeGrid.prototype.buildSlatPositions=function(){this.slatPositions.build();};TimeGrid.prototype.positionToHit=function(positionLeft,positionTop){var dateEnv=this.context.dateEnv;var _a=this,snapsPerSlot=_a.snapsPerSlot,slatPositions=_a.slatPositions,colPositions=_a.colPositions;var colIndex=colPositions.leftToIndex(positionLeft);var slatIndex=slatPositions.topToIndex(positionTop);if(colIndex!=null&&slatIndex!=null){var slatTop=slatPositions.tops[slatIndex];var slatHeight=slatPositions.getHeight(slatIndex);var partial=(positionTop-slatTop)/slatHeight;var localSnapIndex=Math.floor(partial*snapsPerSlot);var snapIndex=slatIndex*snapsPerSlot+localSnapIndex;var dayDate=this.props.cells[colIndex].date;var time=core.addDurations(this.props.dateProfile.minTime,core.multiplyDuration(this.snapDuration,snapIndex));var start=dateEnv.add(dayDate,time);var end=dateEnv.add(start,this.snapDuration);return{col:colIndex,dateSpan:{range:{start:start,end:end},allDay:false},dayEl:this.colEls[colIndex],relativeRect:{left:colPositions.lefts[colIndex],right:colPositions.rights[colIndex],top:slatTop,bottom:slatTop+slatHeight}};}};TimeGrid.prototype._renderEventDrag=function(state){if(state){this.eventRenderer.hideByHash(state.affectedInstances);if(state.isEvent){this.mirrorRenderer.renderSegs(this.context,state.segs,{isDragging:true,sourceSeg:state.sourceSeg});}
else{this.fillRenderer.renderSegs('highlight',this.context,state.segs);}}};TimeGrid.prototype._unrenderEventDrag=function(state){if(state){this.eventRenderer.showByHash(state.affectedInstances);if(state.isEvent){this.mirrorRenderer.unrender(this.context,state.segs,{isDragging:true,sourceSeg:state.sourceSeg});}
else{this.fillRenderer.unrender('highlight',this.context);}}};TimeGrid.prototype._renderEventResize=function(state){if(state){this.eventRenderer.hideByHash(state.affectedInstances);this.mirrorRenderer.renderSegs(this.context,state.segs,{isResizing:true,sourceSeg:state.sourceSeg});}};TimeGrid.prototype._unrenderEventResize=function(state){if(state){this.eventRenderer.showByHash(state.affectedInstances);this.mirrorRenderer.unrender(this.context,state.segs,{isResizing:true,sourceSeg:state.sourceSeg});}};TimeGrid.prototype._renderDateSelection=function(segs){if(segs){if(this.context.options.selectMirror){this.mirrorRenderer.renderSegs(this.context,segs,{isSelecting:true});}
else{this.fillRenderer.renderSegs('highlight',this.context,segs);}}};TimeGrid.prototype._unrenderDateSelection=function(segs){if(segs){if(this.context.options.selectMirror){this.mirrorRenderer.unrender(this.context,segs,{isSelecting:true});}
else{this.fillRenderer.unrender('highlight',this.context);}}};return TimeGrid;}(core.DateComponent));var AllDaySplitter=(function(_super){__extends(AllDaySplitter,_super);function AllDaySplitter(){return _super!==null&&_super.apply(this,arguments)||this;}
AllDaySplitter.prototype.getKeyInfo=function(){return{allDay:{},timed:{}};};AllDaySplitter.prototype.getKeysForDateSpan=function(dateSpan){if(dateSpan.allDay){return['allDay'];}
else{return['timed'];}};AllDaySplitter.prototype.getKeysForEventDef=function(eventDef){if(!eventDef.allDay){return['timed'];}
else if(core.hasBgRendering(eventDef)){return['timed','allDay'];}
else{return['allDay'];}};return AllDaySplitter;}(core.Splitter));var TIMEGRID_ALL_DAY_EVENT_LIMIT=5;var WEEK_HEADER_FORMAT=core.createFormatter({week:'short'});var AbstractTimeGridView=(function(_super){__extends(AbstractTimeGridView,_super);function AbstractTimeGridView(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.splitter=new AllDaySplitter();_this.renderSkeleton=core.memoizeRendering(_this._renderSkeleton,_this._unrenderSkeleton);_this.renderHeadIntroHtml=function(){var _a=_this.context,theme=_a.theme,dateEnv=_a.dateEnv,options=_a.options;var range=_this.props.dateProfile.renderRange;var dayCnt=core.diffDays(range.start,range.end);var weekText;if(options.weekNumbers){weekText=dateEnv.format(range.start,WEEK_HEADER_FORMAT);return''+'<th class="fc-axis fc-week-number '+theme.getClass('widgetHeader')+'" '+_this.axisStyleAttr()+'>'+
core.buildGotoAnchorHtml(options,dateEnv,{date:range.start,type:'week',forceOff:dayCnt>1},core.htmlEscape(weekText))+'</th>';}
else{return'<th class="fc-axis '+theme.getClass('widgetHeader')+'" '+_this.axisStyleAttr()+'></th>';}};_this.renderTimeGridBgIntroHtml=function(){var theme=_this.context.theme;return'<td class="fc-axis '+theme.getClass('widgetContent')+'" '+_this.axisStyleAttr()+'></td>';};_this.renderTimeGridIntroHtml=function(){return'<td class="fc-axis" '+_this.axisStyleAttr()+'></td>';};_this.renderDayGridBgIntroHtml=function(){var _a=_this.context,theme=_a.theme,options=_a.options;return''+'<td class="fc-axis '+theme.getClass('widgetContent')+'" '+_this.axisStyleAttr()+'>'+'<span>'+
core.getAllDayHtml(options)+'</span>'+'</td>';};_this.renderDayGridIntroHtml=function(){return'<td class="fc-axis" '+_this.axisStyleAttr()+'></td>';};return _this;}
AbstractTimeGridView.prototype.render=function(props,context){_super.prototype.render.call(this,props,context);this.renderSkeleton(context);};AbstractTimeGridView.prototype.destroy=function(){_super.prototype.destroy.call(this);this.renderSkeleton.unrender();};AbstractTimeGridView.prototype._renderSkeleton=function(context){this.el.classList.add('fc-timeGrid-view');this.el.innerHTML=this.renderSkeletonHtml();this.scroller=new core.ScrollComponent('hidden','auto');var timeGridWrapEl=this.scroller.el;this.el.querySelector('.fc-body > tr > td').appendChild(timeGridWrapEl);timeGridWrapEl.classList.add('fc-time-grid-container');var timeGridEl=core.createElement('div',{className:'fc-time-grid'});timeGridWrapEl.appendChild(timeGridEl);this.timeGrid=new TimeGrid(timeGridEl,{renderBgIntroHtml:this.renderTimeGridBgIntroHtml,renderIntroHtml:this.renderTimeGridIntroHtml});if(context.options.allDaySlot){this.dayGrid=new daygrid.DayGrid(this.el.querySelector('.fc-day-grid'),{renderNumberIntroHtml:this.renderDayGridIntroHtml,renderBgIntroHtml:this.renderDayGridBgIntroHtml,renderIntroHtml:this.renderDayGridIntroHtml,colWeekNumbersVisible:false,cellWeekNumbersVisible:false});var dividerEl=this.el.querySelector('.fc-divider');this.dayGrid.bottomCoordPadding=dividerEl.getBoundingClientRect().height;}};AbstractTimeGridView.prototype._unrenderSkeleton=function(){this.el.classList.remove('fc-timeGrid-view');this.timeGrid.destroy();if(this.dayGrid){this.dayGrid.destroy();}
this.scroller.destroy();};AbstractTimeGridView.prototype.renderSkeletonHtml=function(){var _a=this.context,theme=_a.theme,options=_a.options;return''+'<table class="'+theme.getClass('tableGrid')+'">'+
(options.columnHeader?'<thead class="fc-head">'+'<tr>'+'<td class="fc-head-container '+theme.getClass('widgetHeader')+'">&nbsp;</td>'+'</tr>'+'</thead>':'')+'<tbody class="fc-body">'+'<tr>'+'<td class="'+theme.getClass('widgetContent')+'">'+
(options.allDaySlot?'<div class="fc-day-grid"></div>'+'<hr class="fc-divider '+theme.getClass('widgetHeader')+'" />':'')+'</td>'+'</tr>'+'</tbody>'+'</table>';};AbstractTimeGridView.prototype.getNowIndicatorUnit=function(){return this.timeGrid.getNowIndicatorUnit();};AbstractTimeGridView.prototype.unrenderNowIndicator=function(){this.timeGrid.unrenderNowIndicator();};AbstractTimeGridView.prototype.updateSize=function(isResize,viewHeight,isAuto){_super.prototype.updateSize.call(this,isResize,viewHeight,isAuto);this.timeGrid.updateSize(isResize);if(this.dayGrid){this.dayGrid.updateSize(isResize);}};AbstractTimeGridView.prototype.updateBaseSize=function(isResize,viewHeight,isAuto){var _this=this;var eventLimit;var scrollerHeight;var scrollbarWidths;this.axisWidth=core.matchCellWidths(core.findElements(this.el,'.fc-axis'));if(!this.timeGrid.colEls){if(!isAuto){scrollerHeight=this.computeScrollerHeight(viewHeight);this.scroller.setHeight(scrollerHeight);}
return;}
var noScrollRowEls=core.findElements(this.el,'.fc-row').filter(function(node){return!_this.scroller.el.contains(node);});this.timeGrid.bottomRuleEl.style.display='none';this.scroller.clear();noScrollRowEls.forEach(core.uncompensateScroll);if(this.dayGrid){this.dayGrid.removeSegPopover();eventLimit=this.context.options.eventLimit;if(eventLimit&&typeof eventLimit!=='number'){eventLimit=TIMEGRID_ALL_DAY_EVENT_LIMIT;}
if(eventLimit){this.dayGrid.limitRows(eventLimit);}}
if(!isAuto){scrollerHeight=this.computeScrollerHeight(viewHeight);this.scroller.setHeight(scrollerHeight);scrollbarWidths=this.scroller.getScrollbarWidths();if(scrollbarWidths.left||scrollbarWidths.right){noScrollRowEls.forEach(function(rowEl){core.compensateScroll(rowEl,scrollbarWidths);});scrollerHeight=this.computeScrollerHeight(viewHeight);this.scroller.setHeight(scrollerHeight);}
this.scroller.lockOverflow(scrollbarWidths);if(this.timeGrid.getTotalSlatHeight()<scrollerHeight){this.timeGrid.bottomRuleEl.style.display='';}}};AbstractTimeGridView.prototype.computeScrollerHeight=function(viewHeight){return viewHeight-
core.subtractInnerElHeight(this.el,this.scroller.el);};AbstractTimeGridView.prototype.computeDateScroll=function(duration){var top=this.timeGrid.computeTimeTop(duration);top=Math.ceil(top);if(top){top++;}
return{top:top};};AbstractTimeGridView.prototype.queryDateScroll=function(){return{top:this.scroller.getScrollTop()};};AbstractTimeGridView.prototype.applyDateScroll=function(scroll){if(scroll.top!==undefined){this.scroller.setScrollTop(scroll.top);}};AbstractTimeGridView.prototype.axisStyleAttr=function(){if(this.axisWidth!=null){return'style="width:'+this.axisWidth+'px"';}
return'';};return AbstractTimeGridView;}(core.View));AbstractTimeGridView.prototype.usesMinMaxTime=true;var SimpleTimeGrid=(function(_super){__extends(SimpleTimeGrid,_super);function SimpleTimeGrid(timeGrid){var _this=_super.call(this,timeGrid.el)||this;_this.buildDayRanges=core.memoize(buildDayRanges);_this.slicer=new TimeGridSlicer();_this.timeGrid=timeGrid;return _this;}
SimpleTimeGrid.prototype.firstContext=function(context){context.calendar.registerInteractiveComponent(this,{el:this.timeGrid.el});};SimpleTimeGrid.prototype.destroy=function(){_super.prototype.destroy.call(this);this.context.calendar.unregisterInteractiveComponent(this);};SimpleTimeGrid.prototype.render=function(props,context){var dateEnv=this.context.dateEnv;var dateProfile=props.dateProfile,dayTable=props.dayTable;var dayRanges=this.dayRanges=this.buildDayRanges(dayTable,dateProfile,dateEnv);this.timeGrid.receiveProps(__assign({},this.slicer.sliceProps(props,dateProfile,null,context.calendar,this.timeGrid,dayRanges),{dateProfile:dateProfile,cells:dayTable.cells[0]}),context);};SimpleTimeGrid.prototype.renderNowIndicator=function(date){this.timeGrid.renderNowIndicator(this.slicer.sliceNowDate(date,this.timeGrid,this.dayRanges),date);};SimpleTimeGrid.prototype.buildPositionCaches=function(){this.timeGrid.buildPositionCaches();};SimpleTimeGrid.prototype.queryHit=function(positionLeft,positionTop){var rawHit=this.timeGrid.positionToHit(positionLeft,positionTop);if(rawHit){return{component:this.timeGrid,dateSpan:rawHit.dateSpan,dayEl:rawHit.dayEl,rect:{left:rawHit.relativeRect.left,right:rawHit.relativeRect.right,top:rawHit.relativeRect.top,bottom:rawHit.relativeRect.bottom},layer:0};}};return SimpleTimeGrid;}(core.DateComponent));function buildDayRanges(dayTable,dateProfile,dateEnv){var ranges=[];for(var _i=0,_a=dayTable.headerDates;_i<_a.length;_i++){var date=_a[_i];ranges.push({start:dateEnv.add(date,dateProfile.minTime),end:dateEnv.add(date,dateProfile.maxTime)});}
return ranges;}
var TimeGridSlicer=(function(_super){__extends(TimeGridSlicer,_super);function TimeGridSlicer(){return _super!==null&&_super.apply(this,arguments)||this;}
TimeGridSlicer.prototype.sliceRange=function(range,dayRanges){var segs=[];for(var col=0;col<dayRanges.length;col++){var segRange=core.intersectRanges(range,dayRanges[col]);if(segRange){segs.push({start:segRange.start,end:segRange.end,isStart:segRange.start.valueOf()===range.start.valueOf(),isEnd:segRange.end.valueOf()===range.end.valueOf(),col:col});}}
return segs;};return TimeGridSlicer;}(core.Slicer));var TimeGridView=(function(_super){__extends(TimeGridView,_super);function TimeGridView(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.buildDayTable=core.memoize(buildDayTable);return _this;}
TimeGridView.prototype.render=function(props,context){_super.prototype.render.call(this,props,context);var _a=this.props,dateProfile=_a.dateProfile,dateProfileGenerator=_a.dateProfileGenerator;var nextDayThreshold=context.nextDayThreshold;var dayTable=this.buildDayTable(dateProfile,dateProfileGenerator);var splitProps=this.splitter.splitProps(props);if(this.header){this.header.receiveProps({dateProfile:dateProfile,dates:dayTable.headerDates,datesRepDistinctDays:true,renderIntroHtml:this.renderHeadIntroHtml},context);}
this.simpleTimeGrid.receiveProps(__assign({},splitProps['timed'],{dateProfile:dateProfile,dayTable:dayTable}),context);if(this.simpleDayGrid){this.simpleDayGrid.receiveProps(__assign({},splitProps['allDay'],{dateProfile:dateProfile,dayTable:dayTable,nextDayThreshold:nextDayThreshold,isRigid:false}),context);}
this.startNowIndicator(dateProfile,dateProfileGenerator);};TimeGridView.prototype._renderSkeleton=function(context){_super.prototype._renderSkeleton.call(this,context);if(context.options.columnHeader){this.header=new core.DayHeader(this.el.querySelector('.fc-head-container'));}
this.simpleTimeGrid=new SimpleTimeGrid(this.timeGrid);if(this.dayGrid){this.simpleDayGrid=new daygrid.SimpleDayGrid(this.dayGrid);}};TimeGridView.prototype._unrenderSkeleton=function(){_super.prototype._unrenderSkeleton.call(this);if(this.header){this.header.destroy();}
this.simpleTimeGrid.destroy();if(this.simpleDayGrid){this.simpleDayGrid.destroy();}};TimeGridView.prototype.renderNowIndicator=function(date){this.simpleTimeGrid.renderNowIndicator(date);};return TimeGridView;}(AbstractTimeGridView));function buildDayTable(dateProfile,dateProfileGenerator){var daySeries=new core.DaySeries(dateProfile.renderRange,dateProfileGenerator);return new core.DayTable(daySeries,false);}
var main=core.createPlugin({defaultView:'timeGridWeek',views:{timeGrid:{class:TimeGridView,allDaySlot:true,slotDuration:'00:30:00',slotEventOverlap:true},timeGridDay:{type:'timeGrid',duration:{days:1}},timeGridWeek:{type:'timeGrid',duration:{weeks:1}}}});exports.AbstractTimeGridView=AbstractTimeGridView;exports.TimeGrid=TimeGrid;exports.TimeGridSlicer=TimeGridSlicer;exports.TimeGridView=TimeGridView;exports.buildDayRanges=buildDayRanges;exports.buildDayTable=buildDayTable;exports.default=main;Object.defineProperty(exports,'__esModule',{value:true});}));;

/* /web/static/lib/fullcalendar/list/main.js defined in bundle 'web.tests_assets' */
(function(global,factory){typeof exports==='object'&&typeof module!=='undefined'?factory(exports,require('@fullcalendar/core')):typeof define==='function'&&define.amd?define(['exports','@fullcalendar/core'],factory):(global=global||self,factory(global.FullCalendarList={},global.FullCalendar));}(this,function(exports,core){'use strict';var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b;})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];};return extendStatics(d,b);};function __extends(d,b){extendStatics(d,b);function __(){this.constructor=d;}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __());}
var ListEventRenderer=(function(_super){__extends(ListEventRenderer,_super);function ListEventRenderer(listView){var _this=_super.call(this)||this;_this.listView=listView;return _this;}
ListEventRenderer.prototype.attachSegs=function(segs){if(!segs.length){this.listView.renderEmptyMessage();}
else{this.listView.renderSegList(segs);}};ListEventRenderer.prototype.detachSegs=function(){};ListEventRenderer.prototype.renderSegHtml=function(seg){var _a=this.context,theme=_a.theme,options=_a.options;var eventRange=seg.eventRange;var eventDef=eventRange.def;var eventInstance=eventRange.instance;var eventUi=eventRange.ui;var url=eventDef.url;var classes=['fc-list-item'].concat(eventUi.classNames);var bgColor=eventUi.backgroundColor;var timeHtml;if(eventDef.allDay){timeHtml=core.getAllDayHtml(options);}
else if(core.isMultiDayRange(eventRange.range)){if(seg.isStart){timeHtml=core.htmlEscape(this._getTimeText(eventInstance.range.start,seg.end,false));}
else if(seg.isEnd){timeHtml=core.htmlEscape(this._getTimeText(seg.start,eventInstance.range.end,false));}
else{timeHtml=core.getAllDayHtml(options);}}
else{timeHtml=core.htmlEscape(this.getTimeText(eventRange));}
if(url){classes.push('fc-has-url');}
return'<tr class="'+classes.join(' ')+'">'+
(this.displayEventTime?'<td class="fc-list-item-time '+theme.getClass('widgetContent')+'">'+
(timeHtml||'')+'</td>':'')+'<td class="fc-list-item-marker '+theme.getClass('widgetContent')+'">'+'<span class="fc-event-dot"'+
(bgColor?' style="background-color:'+bgColor+'"':'')+'></span>'+'</td>'+'<td class="fc-list-item-title '+theme.getClass('widgetContent')+'">'+'<a'+(url?' href="'+core.htmlEscape(url)+'"':'')+'>'+
core.htmlEscape(eventDef.title||'')+'</a>'+'</td>'+'</tr>';};ListEventRenderer.prototype.computeEventTimeFormat=function(){return{hour:'numeric',minute:'2-digit',meridiem:'short'};};return ListEventRenderer;}(core.FgEventRenderer));var ListView=(function(_super){__extends(ListView,_super);function ListView(viewSpec,parentEl){var _this=_super.call(this,viewSpec,parentEl)||this;_this.computeDateVars=core.memoize(computeDateVars);_this.eventStoreToSegs=core.memoize(_this._eventStoreToSegs);_this.renderSkeleton=core.memoizeRendering(_this._renderSkeleton,_this._unrenderSkeleton);var eventRenderer=_this.eventRenderer=new ListEventRenderer(_this);_this.renderContent=core.memoizeRendering(eventRenderer.renderSegs.bind(eventRenderer),eventRenderer.unrender.bind(eventRenderer),[_this.renderSkeleton]);return _this;}
ListView.prototype.firstContext=function(context){context.calendar.registerInteractiveComponent(this,{el:this.el});};ListView.prototype.render=function(props,context){_super.prototype.render.call(this,props,context);var _a=this.computeDateVars(props.dateProfile),dayDates=_a.dayDates,dayRanges=_a.dayRanges;this.dayDates=dayDates;this.renderSkeleton(context);this.renderContent(context,this.eventStoreToSegs(props.eventStore,props.eventUiBases,dayRanges));};ListView.prototype.destroy=function(){_super.prototype.destroy.call(this);this.renderSkeleton.unrender();this.renderContent.unrender();this.context.calendar.unregisterInteractiveComponent(this);};ListView.prototype._renderSkeleton=function(context){var theme=context.theme;this.el.classList.add('fc-list-view');var listViewClassNames=(theme.getClass('listView')||'').split(' ');for(var _i=0,listViewClassNames_1=listViewClassNames;_i<listViewClassNames_1.length;_i++){var listViewClassName=listViewClassNames_1[_i];if(listViewClassName){this.el.classList.add(listViewClassName);}}
this.scroller=new core.ScrollComponent('hidden','auto');this.el.appendChild(this.scroller.el);this.contentEl=this.scroller.el;};ListView.prototype._unrenderSkeleton=function(){this.scroller.destroy();};ListView.prototype.updateSize=function(isResize,viewHeight,isAuto){_super.prototype.updateSize.call(this,isResize,viewHeight,isAuto);this.eventRenderer.computeSizes(isResize);this.eventRenderer.assignSizes(isResize);this.scroller.clear();if(!isAuto){this.scroller.setHeight(this.computeScrollerHeight(viewHeight));}};ListView.prototype.computeScrollerHeight=function(viewHeight){return viewHeight-
core.subtractInnerElHeight(this.el,this.scroller.el);};ListView.prototype._eventStoreToSegs=function(eventStore,eventUiBases,dayRanges){return this.eventRangesToSegs(core.sliceEventStore(eventStore,eventUiBases,this.props.dateProfile.activeRange,this.context.nextDayThreshold).fg,dayRanges);};ListView.prototype.eventRangesToSegs=function(eventRanges,dayRanges){var segs=[];for(var _i=0,eventRanges_1=eventRanges;_i<eventRanges_1.length;_i++){var eventRange=eventRanges_1[_i];segs.push.apply(segs,this.eventRangeToSegs(eventRange,dayRanges));}
return segs;};ListView.prototype.eventRangeToSegs=function(eventRange,dayRanges){var _a=this.context,dateEnv=_a.dateEnv,nextDayThreshold=_a.nextDayThreshold;var range=eventRange.range;var allDay=eventRange.def.allDay;var dayIndex;var segRange;var seg;var segs=[];for(dayIndex=0;dayIndex<dayRanges.length;dayIndex++){segRange=core.intersectRanges(range,dayRanges[dayIndex]);if(segRange){seg={component:this,eventRange:eventRange,start:segRange.start,end:segRange.end,isStart:eventRange.isStart&&segRange.start.valueOf()===range.start.valueOf(),isEnd:eventRange.isEnd&&segRange.end.valueOf()===range.end.valueOf(),dayIndex:dayIndex};segs.push(seg);if(!seg.isEnd&&!allDay&&dayIndex+1<dayRanges.length&&range.end<dateEnv.add(dayRanges[dayIndex+1].start,nextDayThreshold)){seg.end=range.end;seg.isEnd=true;break;}}}
return segs;};ListView.prototype.renderEmptyMessage=function(){this.contentEl.innerHTML='<div class="fc-list-empty-wrap2">'+'<div class="fc-list-empty-wrap1">'+'<div class="fc-list-empty">'+
core.htmlEscape(this.context.options.noEventsMessage)+'</div>'+'</div>'+'</div>';};ListView.prototype.renderSegList=function(allSegs){var theme=this.context.theme;var segsByDay=this.groupSegsByDay(allSegs);var dayIndex;var daySegs;var i;var tableEl=core.htmlToElement('<table class="fc-list-table '+theme.getClass('tableList')+'"><tbody></tbody></table>');var tbodyEl=tableEl.querySelector('tbody');for(dayIndex=0;dayIndex<segsByDay.length;dayIndex++){daySegs=segsByDay[dayIndex];if(daySegs){tbodyEl.appendChild(this.buildDayHeaderRow(this.dayDates[dayIndex]));daySegs=this.eventRenderer.sortEventSegs(daySegs);for(i=0;i<daySegs.length;i++){tbodyEl.appendChild(daySegs[i].el);}}}
this.contentEl.innerHTML='';this.contentEl.appendChild(tableEl);};ListView.prototype.groupSegsByDay=function(segs){var segsByDay=[];var i;var seg;for(i=0;i<segs.length;i++){seg=segs[i];(segsByDay[seg.dayIndex]||(segsByDay[seg.dayIndex]=[])).push(seg);}
return segsByDay;};ListView.prototype.buildDayHeaderRow=function(dayDate){var _a=this.context,theme=_a.theme,dateEnv=_a.dateEnv,options=_a.options;var mainFormat=core.createFormatter(options.listDayFormat);var altFormat=core.createFormatter(options.listDayAltFormat);return core.createElement('tr',{className:'fc-list-heading','data-date':dateEnv.formatIso(dayDate,{omitTime:true})},'<td class="'+(theme.getClass('tableListHeading')||theme.getClass('widgetHeader'))+'" colspan="3">'+
(mainFormat?core.buildGotoAnchorHtml(options,dateEnv,dayDate,{'class':'fc-list-heading-main'},core.htmlEscape(dateEnv.format(dayDate,mainFormat))):'')+
(altFormat?core.buildGotoAnchorHtml(options,dateEnv,dayDate,{'class':'fc-list-heading-alt'},core.htmlEscape(dateEnv.format(dayDate,altFormat))):'')+'</td>');};return ListView;}(core.View));ListView.prototype.fgSegSelector='.fc-list-item';function computeDateVars(dateProfile){var dayStart=core.startOfDay(dateProfile.renderRange.start);var viewEnd=dateProfile.renderRange.end;var dayDates=[];var dayRanges=[];while(dayStart<viewEnd){dayDates.push(dayStart);dayRanges.push({start:dayStart,end:core.addDays(dayStart,1)});dayStart=core.addDays(dayStart,1);}
return{dayDates:dayDates,dayRanges:dayRanges};}
var main=core.createPlugin({views:{list:{class:ListView,buttonTextKey:'list',listDayFormat:{month:'long',day:'numeric',year:'numeric'}},listDay:{type:'list',duration:{days:1},listDayFormat:{weekday:'long'}},listWeek:{type:'list',duration:{weeks:1},listDayFormat:{weekday:'long'},listDayAltFormat:{month:'long',day:'numeric',year:'numeric'}},listMonth:{type:'list',duration:{month:1},listDayAltFormat:{weekday:'long'}},listYear:{type:'list',duration:{year:1},listDayAltFormat:{weekday:'long'}}}});exports.ListView=ListView;exports.default=main;Object.defineProperty(exports,'__esModule',{value:true});}));;

/* /web/static/lib/ace/ace.js defined in bundle 'web.tests_assets' */
(function(){var ACE_NAMESPACE="";var global=(function(){return this;})();if(!global&&typeof window!="undefined")global=window;if(!ACE_NAMESPACE&&typeof requirejs!=="undefined")
return;var define=function(module,deps,payload){if(typeof module!=="string"){if(define.original)
define.original.apply(this,arguments);else{console.error("dropping module because define wasn\'t a string.");console.trace();}
return;}
if(arguments.length==2)
payload=deps;if(!define.modules[module]){define.payloads[module]=payload;define.modules[module]=null;}};define.modules={};define.payloads={};var _require=function(parentId,module,callback){if(typeof module==="string"){var payload=lookup(parentId,module);if(payload!=undefined){callback&&callback();return payload;}}else if(Object.prototype.toString.call(module)==="[object Array]"){var params=[];for(var i=0,l=module.length;i<l;++i){var dep=lookup(parentId,module[i]);if(dep==undefined&&require.original)
return;params.push(dep);}
return callback&&callback.apply(null,params)||true;}};var require=function(module,callback){var packagedModule=_require("",module,callback);if(packagedModule==undefined&&require.original)
return require.original.apply(this,arguments);return packagedModule;};var normalizeModule=function(parentId,moduleName){if(moduleName.indexOf("!")!==-1){var chunks=moduleName.split("!");return normalizeModule(parentId,chunks[0])+"!"+normalizeModule(parentId,chunks[1]);}
if(moduleName.charAt(0)=="."){var base=parentId.split("/").slice(0,-1).join("/");moduleName=base+"/"+moduleName;while(moduleName.indexOf(".")!==-1&&previous!=moduleName){var previous=moduleName;moduleName=moduleName.replace(/\/\.\//,"/").replace(/[^\/]+\/\.\.\//,"");}}
return moduleName;};var lookup=function(parentId,moduleName){moduleName=normalizeModule(parentId,moduleName);var module=define.modules[moduleName];if(!module){module=define.payloads[moduleName];if(typeof module==='function'){var exports={};var mod={id:moduleName,uri:'',exports:exports,packaged:true};var req=function(module,callback){return _require(moduleName,module,callback);};var returnValue=module(req,exports,mod);exports=returnValue||mod.exports;define.modules[moduleName]=exports;delete define.payloads[moduleName];}
module=define.modules[moduleName]=exports||module;}
return module;};function exportAce(ns){var root=global;if(ns){if(!global[ns])
global[ns]={};root=global[ns];}
if(!root.define||!root.define.packaged){define.original=root.define;root.define=define;root.define.packaged=true;}
if(!root.require||!root.require.packaged){require.original=root.require;root.require=require;root.require.packaged=true;}}
exportAce(ACE_NAMESPACE);})();define("ace/lib/regexp",["require","exports","module"],function(require,exports,module){"use strict";var real={exec:RegExp.prototype.exec,test:RegExp.prototype.test,match:String.prototype.match,replace:String.prototype.replace,split:String.prototype.split},compliantExecNpcg=real.exec.call(/()??/,"")[1]===undefined,compliantLastIndexIncrement=function(){var x=/^/g;real.test.call(x,"");return!x.lastIndex;}();if(compliantLastIndexIncrement&&compliantExecNpcg)
return;RegExp.prototype.exec=function(str){var match=real.exec.apply(this,arguments),name,r2;if(typeof(str)=='string'&&match){if(!compliantExecNpcg&&match.length>1&&indexOf(match,"")>-1){r2=RegExp(this.source,real.replace.call(getNativeFlags(this),"g",""));real.replace.call(str.slice(match.index),r2,function(){for(var i=1;i<arguments.length-2;i++){if(arguments[i]===undefined)
match[i]=undefined;}});}
if(this._xregexp&&this._xregexp.captureNames){for(var i=1;i<match.length;i++){name=this._xregexp.captureNames[i-1];if(name)
match[name]=match[i];}}
if(!compliantLastIndexIncrement&&this.global&&!match[0].length&&(this.lastIndex>match.index))
this.lastIndex--;}
return match;};if(!compliantLastIndexIncrement){RegExp.prototype.test=function(str){var match=real.exec.call(this,str);if(match&&this.global&&!match[0].length&&(this.lastIndex>match.index))
this.lastIndex--;return!!match;};}
function getNativeFlags(regex){return(regex.global?"g":"")+
(regex.ignoreCase?"i":"")+
(regex.multiline?"m":"")+
(regex.extended?"x":"")+
(regex.sticky?"y":"");}
function indexOf(array,item,from){if(Array.prototype.indexOf)
return array.indexOf(item,from);for(var i=from||0;i<array.length;i++){if(array[i]===item)
return i;}
return-1;}});define("ace/lib/es5-shim",["require","exports","module"],function(require,exports,module){function Empty(){}
if(!Function.prototype.bind){Function.prototype.bind=function bind(that){var target=this;if(typeof target!="function"){throw new TypeError("Function.prototype.bind called on incompatible "+target);}
var args=slice.call(arguments,1);var bound=function(){if(this instanceof bound){var result=target.apply(this,args.concat(slice.call(arguments)));if(Object(result)===result){return result;}
return this;}else{return target.apply(that,args.concat(slice.call(arguments)));}};if(target.prototype){Empty.prototype=target.prototype;bound.prototype=new Empty();Empty.prototype=null;}
return bound;};}
var call=Function.prototype.call;var prototypeOfArray=Array.prototype;var prototypeOfObject=Object.prototype;var slice=prototypeOfArray.slice;var _toString=call.bind(prototypeOfObject.toString);var owns=call.bind(prototypeOfObject.hasOwnProperty);var defineGetter;var defineSetter;var lookupGetter;var lookupSetter;var supportsAccessors;if((supportsAccessors=owns(prototypeOfObject,"__defineGetter__"))){defineGetter=call.bind(prototypeOfObject.__defineGetter__);defineSetter=call.bind(prototypeOfObject.__defineSetter__);lookupGetter=call.bind(prototypeOfObject.__lookupGetter__);lookupSetter=call.bind(prototypeOfObject.__lookupSetter__);}
if([1,2].splice(0).length!=2){if(function(){function makeArray(l){var a=new Array(l+2);a[0]=a[1]=0;return a;}
var array=[],lengthBefore;array.splice.apply(array,makeArray(20));array.splice.apply(array,makeArray(26));lengthBefore=array.length;array.splice(5,0,"XXX");lengthBefore+1==array.length
if(lengthBefore+1==array.length){return true;}}()){var array_splice=Array.prototype.splice;Array.prototype.splice=function(start,deleteCount){if(!arguments.length){return[];}else{return array_splice.apply(this,[start===void 0?0:start,deleteCount===void 0?(this.length-start):deleteCount].concat(slice.call(arguments,2)))}};}else{Array.prototype.splice=function(pos,removeCount){var length=this.length;if(pos>0){if(pos>length)
pos=length;}else if(pos==void 0){pos=0;}else if(pos<0){pos=Math.max(length+pos,0);}
if(!(pos+removeCount<length))
removeCount=length-pos;var removed=this.slice(pos,pos+removeCount);var insert=slice.call(arguments,2);var add=insert.length;if(pos===length){if(add){this.push.apply(this,insert);}}else{var remove=Math.min(removeCount,length-pos);var tailOldPos=pos+remove;var tailNewPos=tailOldPos+add-remove;var tailCount=length-tailOldPos;var lengthAfterRemove=length-remove;if(tailNewPos<tailOldPos){for(var i=0;i<tailCount;++i){this[tailNewPos+i]=this[tailOldPos+i];}}else if(tailNewPos>tailOldPos){for(i=tailCount;i--;){this[tailNewPos+i]=this[tailOldPos+i];}}
if(add&&pos===lengthAfterRemove){this.length=lengthAfterRemove;this.push.apply(this,insert);}else{this.length=lengthAfterRemove+add;for(i=0;i<add;++i){this[pos+i]=insert[i];}}}
return removed;};}}
if(!Array.isArray){Array.isArray=function isArray(obj){return _toString(obj)=="[object Array]";};}
var boxedString=Object("a"),splitString=boxedString[0]!="a"||!(0 in boxedString);if(!Array.prototype.forEach){Array.prototype.forEach=function forEach(fun){var object=toObject(this),self=splitString&&_toString(this)=="[object String]"?this.split(""):object,thisp=arguments[1],i=-1,length=self.length>>>0;if(_toString(fun)!="[object Function]"){throw new TypeError();}
while(++i<length){if(i in self){fun.call(thisp,self[i],i,object);}}};}
if(!Array.prototype.map){Array.prototype.map=function map(fun){var object=toObject(this),self=splitString&&_toString(this)=="[object String]"?this.split(""):object,length=self.length>>>0,result=Array(length),thisp=arguments[1];if(_toString(fun)!="[object Function]"){throw new TypeError(fun+" is not a function");}
for(var i=0;i<length;i++){if(i in self)
result[i]=fun.call(thisp,self[i],i,object);}
return result;};}
if(!Array.prototype.filter){Array.prototype.filter=function filter(fun){var object=toObject(this),self=splitString&&_toString(this)=="[object String]"?this.split(""):object,length=self.length>>>0,result=[],value,thisp=arguments[1];if(_toString(fun)!="[object Function]"){throw new TypeError(fun+" is not a function");}
for(var i=0;i<length;i++){if(i in self){value=self[i];if(fun.call(thisp,value,i,object)){result.push(value);}}}
return result;};}
if(!Array.prototype.every){Array.prototype.every=function every(fun){var object=toObject(this),self=splitString&&_toString(this)=="[object String]"?this.split(""):object,length=self.length>>>0,thisp=arguments[1];if(_toString(fun)!="[object Function]"){throw new TypeError(fun+" is not a function");}
for(var i=0;i<length;i++){if(i in self&&!fun.call(thisp,self[i],i,object)){return false;}}
return true;};}
if(!Array.prototype.some){Array.prototype.some=function some(fun){var object=toObject(this),self=splitString&&_toString(this)=="[object String]"?this.split(""):object,length=self.length>>>0,thisp=arguments[1];if(_toString(fun)!="[object Function]"){throw new TypeError(fun+" is not a function");}
for(var i=0;i<length;i++){if(i in self&&fun.call(thisp,self[i],i,object)){return true;}}
return false;};}
if(!Array.prototype.reduce){Array.prototype.reduce=function reduce(fun){var object=toObject(this),self=splitString&&_toString(this)=="[object String]"?this.split(""):object,length=self.length>>>0;if(_toString(fun)!="[object Function]"){throw new TypeError(fun+" is not a function");}
if(!length&&arguments.length==1){throw new TypeError("reduce of empty array with no initial value");}
var i=0;var result;if(arguments.length>=2){result=arguments[1];}else{do{if(i in self){result=self[i++];break;}
if(++i>=length){throw new TypeError("reduce of empty array with no initial value");}}while(true);}
for(;i<length;i++){if(i in self){result=fun.call(void 0,result,self[i],i,object);}}
return result;};}
if(!Array.prototype.reduceRight){Array.prototype.reduceRight=function reduceRight(fun){var object=toObject(this),self=splitString&&_toString(this)=="[object String]"?this.split(""):object,length=self.length>>>0;if(_toString(fun)!="[object Function]"){throw new TypeError(fun+" is not a function");}
if(!length&&arguments.length==1){throw new TypeError("reduceRight of empty array with no initial value");}
var result,i=length-1;if(arguments.length>=2){result=arguments[1];}else{do{if(i in self){result=self[i--];break;}
if(--i<0){throw new TypeError("reduceRight of empty array with no initial value");}}while(true);}
do{if(i in this){result=fun.call(void 0,result,self[i],i,object);}}while(i--);return result;};}
if(!Array.prototype.indexOf||([0,1].indexOf(1,2)!=-1)){Array.prototype.indexOf=function indexOf(sought){var self=splitString&&_toString(this)=="[object String]"?this.split(""):toObject(this),length=self.length>>>0;if(!length){return-1;}
var i=0;if(arguments.length>1){i=toInteger(arguments[1]);}
i=i>=0?i:Math.max(0,length+i);for(;i<length;i++){if(i in self&&self[i]===sought){return i;}}
return-1;};}
if(!Array.prototype.lastIndexOf||([0,1].lastIndexOf(0,-3)!=-1)){Array.prototype.lastIndexOf=function lastIndexOf(sought){var self=splitString&&_toString(this)=="[object String]"?this.split(""):toObject(this),length=self.length>>>0;if(!length){return-1;}
var i=length-1;if(arguments.length>1){i=Math.min(i,toInteger(arguments[1]));}
i=i>=0?i:length-Math.abs(i);for(;i>=0;i--){if(i in self&&sought===self[i]){return i;}}
return-1;};}
if(!Object.getPrototypeOf){Object.getPrototypeOf=function getPrototypeOf(object){return object.__proto__||(object.constructor?object.constructor.prototype:prototypeOfObject);};}
if(!Object.getOwnPropertyDescriptor){var ERR_NON_OBJECT="Object.getOwnPropertyDescriptor called on a "+"non-object: ";Object.getOwnPropertyDescriptor=function getOwnPropertyDescriptor(object,property){if((typeof object!="object"&&typeof object!="function")||object===null)
throw new TypeError(ERR_NON_OBJECT+object);if(!owns(object,property))
return;var descriptor,getter,setter;descriptor={enumerable:true,configurable:true};if(supportsAccessors){var prototype=object.__proto__;object.__proto__=prototypeOfObject;var getter=lookupGetter(object,property);var setter=lookupSetter(object,property);object.__proto__=prototype;if(getter||setter){if(getter)descriptor.get=getter;if(setter)descriptor.set=setter;return descriptor;}}
descriptor.value=object[property];return descriptor;};}
if(!Object.getOwnPropertyNames){Object.getOwnPropertyNames=function getOwnPropertyNames(object){return Object.keys(object);};}
if(!Object.create){var createEmpty;if(Object.prototype.__proto__===null){createEmpty=function(){return{"__proto__":null};};}else{createEmpty=function(){var empty={};for(var i in empty)
empty[i]=null;empty.constructor=empty.hasOwnProperty=empty.propertyIsEnumerable=empty.isPrototypeOf=empty.toLocaleString=empty.toString=empty.valueOf=empty.__proto__=null;return empty;}}
Object.create=function create(prototype,properties){var object;if(prototype===null){object=createEmpty();}else{if(typeof prototype!="object")
throw new TypeError("typeof prototype["+(typeof prototype)+"] != 'object'");var Type=function(){};Type.prototype=prototype;object=new Type();object.__proto__=prototype;}
if(properties!==void 0)
Object.defineProperties(object,properties);return object;};}
function doesDefinePropertyWork(object){try{Object.defineProperty(object,"sentinel",{});return"sentinel"in object;}catch(exception){}}
if(Object.defineProperty){var definePropertyWorksOnObject=doesDefinePropertyWork({});var definePropertyWorksOnDom=typeof document=="undefined"||doesDefinePropertyWork(document.createElement("div"));if(!definePropertyWorksOnObject||!definePropertyWorksOnDom){var definePropertyFallback=Object.defineProperty;}}
if(!Object.defineProperty||definePropertyFallback){var ERR_NON_OBJECT_DESCRIPTOR="Property description must be an object: ";var ERR_NON_OBJECT_TARGET="Object.defineProperty called on non-object: "
var ERR_ACCESSORS_NOT_SUPPORTED="getters & setters can not be defined "+"on this javascript engine";Object.defineProperty=function defineProperty(object,property,descriptor){if((typeof object!="object"&&typeof object!="function")||object===null)
throw new TypeError(ERR_NON_OBJECT_TARGET+object);if((typeof descriptor!="object"&&typeof descriptor!="function")||descriptor===null)
throw new TypeError(ERR_NON_OBJECT_DESCRIPTOR+descriptor);if(definePropertyFallback){try{return definePropertyFallback.call(Object,object,property,descriptor);}catch(exception){}}
if(owns(descriptor,"value")){if(supportsAccessors&&(lookupGetter(object,property)||lookupSetter(object,property)))
{var prototype=object.__proto__;object.__proto__=prototypeOfObject;delete object[property];object[property]=descriptor.value;object.__proto__=prototype;}else{object[property]=descriptor.value;}}else{if(!supportsAccessors)
throw new TypeError(ERR_ACCESSORS_NOT_SUPPORTED);if(owns(descriptor,"get"))
defineGetter(object,property,descriptor.get);if(owns(descriptor,"set"))
defineSetter(object,property,descriptor.set);}
return object;};}
if(!Object.defineProperties){Object.defineProperties=function defineProperties(object,properties){for(var property in properties){if(owns(properties,property))
Object.defineProperty(object,property,properties[property]);}
return object;};}
if(!Object.seal){Object.seal=function seal(object){return object;};}
if(!Object.freeze){Object.freeze=function freeze(object){return object;};}
try{Object.freeze(function(){});}catch(exception){Object.freeze=(function freeze(freezeObject){return function freeze(object){if(typeof object=="function"){return object;}else{return freezeObject(object);}};})(Object.freeze);}
if(!Object.preventExtensions){Object.preventExtensions=function preventExtensions(object){return object;};}
if(!Object.isSealed){Object.isSealed=function isSealed(object){return false;};}
if(!Object.isFrozen){Object.isFrozen=function isFrozen(object){return false;};}
if(!Object.isExtensible){Object.isExtensible=function isExtensible(object){if(Object(object)===object){throw new TypeError();}
var name='';while(owns(object,name)){name+='?';}
object[name]=true;var returnValue=owns(object,name);delete object[name];return returnValue;};}
if(!Object.keys){var hasDontEnumBug=true,dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],dontEnumsLength=dontEnums.length;for(var key in{"toString":null}){hasDontEnumBug=false;}
Object.keys=function keys(object){if((typeof object!="object"&&typeof object!="function")||object===null){throw new TypeError("Object.keys called on a non-object");}
var keys=[];for(var name in object){if(owns(object,name)){keys.push(name);}}
if(hasDontEnumBug){for(var i=0,ii=dontEnumsLength;i<ii;i++){var dontEnum=dontEnums[i];if(owns(object,dontEnum)){keys.push(dontEnum);}}}
return keys;};}
if(!Date.now){Date.now=function now(){return new Date().getTime();};}
var ws="\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003"+"\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028"+"\u2029\uFEFF";if(!String.prototype.trim||ws.trim()){ws="["+ws+"]";var trimBeginRegexp=new RegExp("^"+ws+ws+"*"),trimEndRegexp=new RegExp(ws+ws+"*$");String.prototype.trim=function trim(){return String(this).replace(trimBeginRegexp,"").replace(trimEndRegexp,"");};}
function toInteger(n){n=+n;if(n!==n){n=0;}else if(n!==0&&n!==(1/0)&&n!==-(1/0)){n=(n>0||-1)*Math.floor(Math.abs(n));}
return n;}
function isPrimitive(input){var type=typeof input;return(input===null||type==="undefined"||type==="boolean"||type==="number"||type==="string");}
function toPrimitive(input){var val,valueOf,toString;if(isPrimitive(input)){return input;}
valueOf=input.valueOf;if(typeof valueOf==="function"){val=valueOf.call(input);if(isPrimitive(val)){return val;}}
toString=input.toString;if(typeof toString==="function"){val=toString.call(input);if(isPrimitive(val)){return val;}}
throw new TypeError();}
var toObject=function(o){if(o==null){throw new TypeError("can't convert "+o+" to object");}
return Object(o);};});define("ace/lib/fixoldbrowsers",["require","exports","module","ace/lib/regexp","ace/lib/es5-shim"],function(require,exports,module){"use strict";require("./regexp");require("./es5-shim");});define("ace/lib/dom",["require","exports","module"],function(require,exports,module){"use strict";var XHTML_NS="http://www.w3.org/1999/xhtml";exports.buildDom=function buildDom(arr,parent,refs){if(typeof arr=="string"&&arr){var txt=document.createTextNode(arr);if(parent)
parent.appendChild(txt);return txt;}
if(!Array.isArray(arr))
return arr;if(typeof arr[0]!="string"||!arr[0]){var els=[];for(var i=0;i<arr.length;i++){var ch=buildDom(arr[i],parent,refs);ch&&els.push(ch);}
return els;}
var el=document.createElement(arr[0]);var options=arr[1];var childIndex=1;if(options&&typeof options=="object"&&!Array.isArray(options))
childIndex=2;for(var i=childIndex;i<arr.length;i++)
buildDom(arr[i],el,refs);if(childIndex==2){Object.keys(options).forEach(function(n){var val=options[n];if(n==="class"){el.className=Array.isArray(val)?val.join(" "):val;}else if(typeof val=="function"||n=="value"){el[n]=val;}else if(n==="ref"){if(refs)refs[val]=el;}else if(val!=null){el.setAttribute(n,val);}});}
if(parent)
parent.appendChild(el);return el;};exports.getDocumentHead=function(doc){if(!doc)
doc=document;return doc.head||doc.getElementsByTagName("head")[0]||doc.documentElement;};exports.createElement=function(tag,ns){return document.createElementNS?document.createElementNS(ns||XHTML_NS,tag):document.createElement(tag);};exports.hasCssClass=function(el,name){var classes=(el.className+"").split(/\s+/g);return classes.indexOf(name)!==-1;};exports.addCssClass=function(el,name){if(!exports.hasCssClass(el,name)){el.className+=" "+name;}};exports.removeCssClass=function(el,name){var classes=el.className.split(/\s+/g);while(true){var index=classes.indexOf(name);if(index==-1){break;}
classes.splice(index,1);}
el.className=classes.join(" ");};exports.toggleCssClass=function(el,name){var classes=el.className.split(/\s+/g),add=true;while(true){var index=classes.indexOf(name);if(index==-1){break;}
add=false;classes.splice(index,1);}
if(add)
classes.push(name);el.className=classes.join(" ");return add;};exports.setCssClass=function(node,className,include){if(include){exports.addCssClass(node,className);}else{exports.removeCssClass(node,className);}};exports.hasCssString=function(id,doc){var index=0,sheets;doc=doc||document;if(doc.createStyleSheet&&(sheets=doc.styleSheets)){while(index<sheets.length)
if(sheets[index++].owningElement.id===id)return true;}else if((sheets=doc.getElementsByTagName("style"))){while(index<sheets.length)
if(sheets[index++].id===id)return true;}
return false;};exports.importCssString=function importCssString(cssText,id,doc){doc=doc||document;if(id&&exports.hasCssString(id,doc))
return null;var style;if(id)
cssText+="\n/*# sourceURL=ace/css/"+id+" */";if(doc.createStyleSheet){style=doc.createStyleSheet();style.cssText=cssText;if(id)
style.owningElement.id=id;}else{style=exports.createElement("style");style.appendChild(doc.createTextNode(cssText));if(id)
style.id=id;exports.getDocumentHead(doc).appendChild(style);}};exports.importCssStylsheet=function(uri,doc){if(doc.createStyleSheet){doc.createStyleSheet(uri);}else{var link=exports.createElement('link');link.rel='stylesheet';link.href=uri;exports.getDocumentHead(doc).appendChild(link);}};exports.getInnerWidth=function(element){return(parseInt(exports.computedStyle(element,"paddingLeft"),10)+
parseInt(exports.computedStyle(element,"paddingRight"),10)+
element.clientWidth);};exports.getInnerHeight=function(element){return(parseInt(exports.computedStyle(element,"paddingTop"),10)+
parseInt(exports.computedStyle(element,"paddingBottom"),10)+
element.clientHeight);};exports.scrollbarWidth=function(document){var inner=exports.createElement("ace_inner");inner.style.width="100%";inner.style.minWidth="0px";inner.style.height="200px";inner.style.display="block";var outer=exports.createElement("ace_outer");var style=outer.style;style.position="absolute";style.left="-10000px";style.overflow="hidden";style.width="200px";style.minWidth="0px";style.height="150px";style.display="block";outer.appendChild(inner);var body=document.documentElement;body.appendChild(outer);var noScrollbar=inner.offsetWidth;style.overflow="scroll";var withScrollbar=inner.offsetWidth;if(noScrollbar==withScrollbar){withScrollbar=outer.clientWidth;}
body.removeChild(outer);return noScrollbar-withScrollbar;};if(typeof document=="undefined"){exports.importCssString=function(){};return;}
if(window.pageYOffset!==undefined){exports.getPageScrollTop=function(){return window.pageYOffset;};exports.getPageScrollLeft=function(){return window.pageXOffset;};}
else{exports.getPageScrollTop=function(){return document.body.scrollTop;};exports.getPageScrollLeft=function(){return document.body.scrollLeft;};}
if(window.getComputedStyle)
exports.computedStyle=function(element,style){if(style)
return(window.getComputedStyle(element,"")||{})[style]||"";return window.getComputedStyle(element,"")||{};};else
exports.computedStyle=function(element,style){if(style)
return element.currentStyle[style];return element.currentStyle;};exports.setInnerHtml=function(el,innerHtml){var element=el.cloneNode(false);element.innerHTML=innerHtml;el.parentNode.replaceChild(element,el);return element;};if("textContent"in document.documentElement){exports.setInnerText=function(el,innerText){el.textContent=innerText;};exports.getInnerText=function(el){return el.textContent;};}
else{exports.setInnerText=function(el,innerText){el.innerText=innerText;};exports.getInnerText=function(el){return el.innerText;};}
exports.getParentWindow=function(document){return document.defaultView||document.parentWindow;};});define("ace/lib/oop",["require","exports","module"],function(require,exports,module){"use strict";exports.inherits=function(ctor,superCtor){ctor.super_=superCtor;ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:false,writable:true,configurable:true}});};exports.mixin=function(obj,mixin){for(var key in mixin){obj[key]=mixin[key];}
return obj;};exports.implement=function(proto,mixin){exports.mixin(proto,mixin);};});define("ace/lib/keys",["require","exports","module","ace/lib/fixoldbrowsers","ace/lib/oop"],function(require,exports,module){"use strict";require("./fixoldbrowsers");var oop=require("./oop");var Keys=(function(){var ret={MODIFIER_KEYS:{16:'Shift',17:'Ctrl',18:'Alt',224:'Meta'},KEY_MODS:{"ctrl":1,"alt":2,"option":2,"shift":4,"super":8,"meta":8,"command":8,"cmd":8},FUNCTION_KEYS:{8:"Backspace",9:"Tab",13:"Return",19:"Pause",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"Print",45:"Insert",46:"Delete",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9",'-13':"NumpadEnter",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"Numlock",145:"Scrolllock"},PRINTABLE_KEYS:{32:' ',48:'0',49:'1',50:'2',51:'3',52:'4',53:'5',54:'6',55:'7',56:'8',57:'9',59:';',61:'=',65:'a',66:'b',67:'c',68:'d',69:'e',70:'f',71:'g',72:'h',73:'i',74:'j',75:'k',76:'l',77:'m',78:'n',79:'o',80:'p',81:'q',82:'r',83:'s',84:'t',85:'u',86:'v',87:'w',88:'x',89:'y',90:'z',107:'+',109:'-',110:'.',186:';',187:'=',188:',',189:'-',190:'.',191:'/',192:'`',219:'[',220:'\\',221:']',222:"'",111:'/',106:'*'}};var name,i;for(i in ret.FUNCTION_KEYS){name=ret.FUNCTION_KEYS[i].toLowerCase();ret[name]=parseInt(i,10);}
for(i in ret.PRINTABLE_KEYS){name=ret.PRINTABLE_KEYS[i].toLowerCase();ret[name]=parseInt(i,10);}
oop.mixin(ret,ret.MODIFIER_KEYS);oop.mixin(ret,ret.PRINTABLE_KEYS);oop.mixin(ret,ret.FUNCTION_KEYS);ret.enter=ret["return"];ret.escape=ret.esc;ret.del=ret["delete"];ret[173]='-';(function(){var mods=["cmd","ctrl","alt","shift"];for(var i=Math.pow(2,mods.length);i--;){ret.KEY_MODS[i]=mods.filter(function(x){return i&ret.KEY_MODS[x];}).join("-")+"-";}})();ret.KEY_MODS[0]="";ret.KEY_MODS[-1]="input-";return ret;})();oop.mixin(exports,Keys);exports.keyCodeToString=function(keyCode){var keyString=Keys[keyCode];if(typeof keyString!="string")
keyString=String.fromCharCode(keyCode);return keyString.toLowerCase();};});define("ace/lib/useragent",["require","exports","module"],function(require,exports,module){"use strict";exports.OS={LINUX:"LINUX",MAC:"MAC",WINDOWS:"WINDOWS"};exports.getOS=function(){if(exports.isMac){return exports.OS.MAC;}else if(exports.isLinux){return exports.OS.LINUX;}else{return exports.OS.WINDOWS;}};if(typeof navigator!="object")
return;var os=(navigator.platform.match(/mac|win|linux/i)||["other"])[0].toLowerCase();var ua=navigator.userAgent;exports.isWin=(os=="win");exports.isMac=(os=="mac");exports.isLinux=(os=="linux");exports.isIE=(navigator.appName=="Microsoft Internet Explorer"||navigator.appName.indexOf("MSAppHost")>=0)?parseFloat((ua.match(/(?:MSIE |Trident\/[0-9]+[\.0-9]+;.*rv:)([0-9]+[\.0-9]+)/)||[])[1]):parseFloat((ua.match(/(?:Trident\/[0-9]+[\.0-9]+;.*rv:)([0-9]+[\.0-9]+)/)||[])[1]);exports.isOldIE=exports.isIE&&exports.isIE<9;exports.isGecko=exports.isMozilla=ua.match(/ Gecko\/\d+/);exports.isOpera=window.opera&&Object.prototype.toString.call(window.opera)=="[object Opera]";exports.isWebKit=parseFloat(ua.split("WebKit/")[1])||undefined;exports.isChrome=parseFloat(ua.split(" Chrome/")[1])||undefined;exports.isAIR=ua.indexOf("AdobeAIR")>=0;exports.isIPad=ua.indexOf("iPad")>=0;exports.isChromeOS=ua.indexOf(" CrOS ")>=0;exports.isIOS=/iPad|iPhone|iPod/.test(ua)&&!window.MSStream;if(exports.isIOS)exports.isMac=true;});define("ace/lib/event",["require","exports","module","ace/lib/keys","ace/lib/useragent"],function(require,exports,module){"use strict";var keys=require("./keys");var useragent=require("./useragent");var pressedKeys=null;var ts=0;exports.addListener=function(elem,type,callback){if(elem.addEventListener){return elem.addEventListener(type,callback,false);}
if(elem.attachEvent){var wrapper=function(){callback.call(elem,window.event);};callback._wrapper=wrapper;elem.attachEvent("on"+type,wrapper);}};exports.removeListener=function(elem,type,callback){if(elem.removeEventListener){return elem.removeEventListener(type,callback,false);}
if(elem.detachEvent){elem.detachEvent("on"+type,callback._wrapper||callback);}};exports.stopEvent=function(e){exports.stopPropagation(e);exports.preventDefault(e);return false;};exports.stopPropagation=function(e){if(e.stopPropagation)
e.stopPropagation();else
e.cancelBubble=true;};exports.preventDefault=function(e){if(e.preventDefault)
e.preventDefault();else
e.returnValue=false;};exports.getButton=function(e){if(e.type=="dblclick")
return 0;if(e.type=="contextmenu"||(useragent.isMac&&(e.ctrlKey&&!e.altKey&&!e.shiftKey)))
return 2;if(e.preventDefault){return e.button;}
else{return{1:0,2:2,4:1}[e.button];}};exports.capture=function(el,eventHandler,releaseCaptureHandler){function onMouseUp(e){eventHandler&&eventHandler(e);releaseCaptureHandler&&releaseCaptureHandler(e);exports.removeListener(document,"mousemove",eventHandler,true);exports.removeListener(document,"mouseup",onMouseUp,true);exports.removeListener(document,"dragstart",onMouseUp,true);}
exports.addListener(document,"mousemove",eventHandler,true);exports.addListener(document,"mouseup",onMouseUp,true);exports.addListener(document,"dragstart",onMouseUp,true);return onMouseUp;};exports.addTouchMoveListener=function(el,callback){var startx,starty;exports.addListener(el,"touchstart",function(e){var touches=e.touches;var touchObj=touches[0];startx=touchObj.clientX;starty=touchObj.clientY;});exports.addListener(el,"touchmove",function(e){var touches=e.touches;if(touches.length>1)return;var touchObj=touches[0];e.wheelX=startx-touchObj.clientX;e.wheelY=starty-touchObj.clientY;startx=touchObj.clientX;starty=touchObj.clientY;callback(e);});};exports.addMouseWheelListener=function(el,callback){if("onmousewheel"in el){exports.addListener(el,"mousewheel",function(e){var factor=8;if(e.wheelDeltaX!==undefined){e.wheelX=-e.wheelDeltaX/factor;e.wheelY=-e.wheelDeltaY/factor;}else{e.wheelX=0;e.wheelY=-e.wheelDelta/factor;}
callback(e);});}else if("onwheel"in el){exports.addListener(el,"wheel",function(e){var factor=0.35;switch(e.deltaMode){case e.DOM_DELTA_PIXEL:e.wheelX=e.deltaX*factor||0;e.wheelY=e.deltaY*factor||0;break;case e.DOM_DELTA_LINE:case e.DOM_DELTA_PAGE:e.wheelX=(e.deltaX||0)*5;e.wheelY=(e.deltaY||0)*5;break;}
callback(e);});}else{exports.addListener(el,"DOMMouseScroll",function(e){if(e.axis&&e.axis==e.HORIZONTAL_AXIS){e.wheelX=(e.detail||0)*5;e.wheelY=0;}else{e.wheelX=0;e.wheelY=(e.detail||0)*5;}
callback(e);});}};exports.addMultiMouseDownListener=function(elements,timeouts,eventHandler,callbackName){var clicks=0;var startX,startY,timer;var eventNames={2:"dblclick",3:"tripleclick",4:"quadclick"};function onMousedown(e){if(exports.getButton(e)!==0){clicks=0;}else if(e.detail>1){clicks++;if(clicks>4)
clicks=1;}else{clicks=1;}
if(useragent.isIE){var isNewClick=Math.abs(e.clientX-startX)>5||Math.abs(e.clientY-startY)>5;if(!timer||isNewClick)
clicks=1;if(timer)
clearTimeout(timer);timer=setTimeout(function(){timer=null;},timeouts[clicks-1]||600);if(clicks==1){startX=e.clientX;startY=e.clientY;}}
e._clicks=clicks;eventHandler[callbackName]("mousedown",e);if(clicks>4)
clicks=0;else if(clicks>1)
return eventHandler[callbackName](eventNames[clicks],e);}
function onDblclick(e){clicks=2;if(timer)
clearTimeout(timer);timer=setTimeout(function(){timer=null;},timeouts[clicks-1]||600);eventHandler[callbackName]("mousedown",e);eventHandler[callbackName](eventNames[clicks],e);}
if(!Array.isArray(elements))
elements=[elements];elements.forEach(function(el){exports.addListener(el,"mousedown",onMousedown);if(useragent.isOldIE)
exports.addListener(el,"dblclick",onDblclick);});};var getModifierHash=useragent.isMac&&useragent.isOpera&&!("KeyboardEvent"in window)?function(e){return 0|(e.metaKey?1:0)|(e.altKey?2:0)|(e.shiftKey?4:0)|(e.ctrlKey?8:0);}:function(e){return 0|(e.ctrlKey?1:0)|(e.altKey?2:0)|(e.shiftKey?4:0)|(e.metaKey?8:0);};exports.getModifierString=function(e){return keys.KEY_MODS[getModifierHash(e)];};function normalizeCommandKeys(callback,e,keyCode){var hashId=getModifierHash(e);if(!useragent.isMac&&pressedKeys){if(e.getModifierState&&(e.getModifierState("OS")||e.getModifierState("Win")))
hashId|=8;if(pressedKeys.altGr){if((3&hashId)!=3)
pressedKeys.altGr=0;else
return;}
if(keyCode===18||keyCode===17){var location="location"in e?e.location:e.keyLocation;if(keyCode===17&&location===1){if(pressedKeys[keyCode]==1)
ts=e.timeStamp;}else if(keyCode===18&&hashId===3&&location===2){var dt=e.timeStamp-ts;if(dt<50)
pressedKeys.altGr=true;}}}
if(keyCode in keys.MODIFIER_KEYS){keyCode=-1;}
if(hashId&8&&(keyCode>=91&&keyCode<=93)){keyCode=-1;}
if(!hashId&&keyCode===13){var location="location"in e?e.location:e.keyLocation;if(location===3){callback(e,hashId,-keyCode);if(e.defaultPrevented)
return;}}
if(useragent.isChromeOS&&hashId&8){callback(e,hashId,keyCode);if(e.defaultPrevented)
return;else
hashId&=~8;}
if(!hashId&&!(keyCode in keys.FUNCTION_KEYS)&&!(keyCode in keys.PRINTABLE_KEYS)){return false;}
return callback(e,hashId,keyCode);}
exports.addCommandKeyListener=function(el,callback){var addListener=exports.addListener;if(useragent.isOldGecko||(useragent.isOpera&&!("KeyboardEvent"in window))){var lastKeyDownKeyCode=null;addListener(el,"keydown",function(e){lastKeyDownKeyCode=e.keyCode;});addListener(el,"keypress",function(e){return normalizeCommandKeys(callback,e,lastKeyDownKeyCode);});}else{var lastDefaultPrevented=null;addListener(el,"keydown",function(e){pressedKeys[e.keyCode]=(pressedKeys[e.keyCode]||0)+1;var result=normalizeCommandKeys(callback,e,e.keyCode);lastDefaultPrevented=e.defaultPrevented;return result;});addListener(el,"keypress",function(e){if(lastDefaultPrevented&&(e.ctrlKey||e.altKey||e.shiftKey||e.metaKey)){exports.stopEvent(e);lastDefaultPrevented=null;}});addListener(el,"keyup",function(e){pressedKeys[e.keyCode]=null;});if(!pressedKeys){resetPressedKeys();addListener(window,"focus",resetPressedKeys);}}};function resetPressedKeys(){pressedKeys=Object.create(null);}
if(typeof window=="object"&&window.postMessage&&!useragent.isOldIE){var postMessageId=1;exports.nextTick=function(callback,win){win=win||window;var messageName="zero-timeout-message-"+postMessageId;exports.addListener(win,"message",function listener(e){if(e.data==messageName){exports.stopPropagation(e);exports.removeListener(win,"message",listener);callback();}});win.postMessage(messageName,"*");};}
exports.nextFrame=typeof window=="object"&&(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame);if(exports.nextFrame)
exports.nextFrame=exports.nextFrame.bind(window);else
exports.nextFrame=function(callback){setTimeout(callback,17);};});define("ace/range",["require","exports","module"],function(require,exports,module){"use strict";var comparePoints=function(p1,p2){return p1.row-p2.row||p1.column-p2.column;};var Range=function(startRow,startColumn,endRow,endColumn){this.start={row:startRow,column:startColumn};this.end={row:endRow,column:endColumn};};(function(){this.isEqual=function(range){return this.start.row===range.start.row&&this.end.row===range.end.row&&this.start.column===range.start.column&&this.end.column===range.end.column;};this.toString=function(){return("Range: ["+this.start.row+"/"+this.start.column+"] -> ["+this.end.row+"/"+this.end.column+"]");};this.contains=function(row,column){return this.compare(row,column)==0;};this.compareRange=function(range){var cmp,end=range.end,start=range.start;cmp=this.compare(end.row,end.column);if(cmp==1){cmp=this.compare(start.row,start.column);if(cmp==1){return 2;}else if(cmp==0){return 1;}else{return 0;}}else if(cmp==-1){return-2;}else{cmp=this.compare(start.row,start.column);if(cmp==-1){return-1;}else if(cmp==1){return 42;}else{return 0;}}};this.comparePoint=function(p){return this.compare(p.row,p.column);};this.containsRange=function(range){return this.comparePoint(range.start)==0&&this.comparePoint(range.end)==0;};this.intersects=function(range){var cmp=this.compareRange(range);return(cmp==-1||cmp==0||cmp==1);};this.isEnd=function(row,column){return this.end.row==row&&this.end.column==column;};this.isStart=function(row,column){return this.start.row==row&&this.start.column==column;};this.setStart=function(row,column){if(typeof row=="object"){this.start.column=row.column;this.start.row=row.row;}else{this.start.row=row;this.start.column=column;}};this.setEnd=function(row,column){if(typeof row=="object"){this.end.column=row.column;this.end.row=row.row;}else{this.end.row=row;this.end.column=column;}};this.inside=function(row,column){if(this.compare(row,column)==0){if(this.isEnd(row,column)||this.isStart(row,column)){return false;}else{return true;}}
return false;};this.insideStart=function(row,column){if(this.compare(row,column)==0){if(this.isEnd(row,column)){return false;}else{return true;}}
return false;};this.insideEnd=function(row,column){if(this.compare(row,column)==0){if(this.isStart(row,column)){return false;}else{return true;}}
return false;};this.compare=function(row,column){if(!this.isMultiLine()){if(row===this.start.row){return column<this.start.column?-1:(column>this.end.column?1:0);}}
if(row<this.start.row)
return-1;if(row>this.end.row)
return 1;if(this.start.row===row)
return column>=this.start.column?0:-1;if(this.end.row===row)
return column<=this.end.column?0:1;return 0;};this.compareStart=function(row,column){if(this.start.row==row&&this.start.column==column){return-1;}else{return this.compare(row,column);}};this.compareEnd=function(row,column){if(this.end.row==row&&this.end.column==column){return 1;}else{return this.compare(row,column);}};this.compareInside=function(row,column){if(this.end.row==row&&this.end.column==column){return 1;}else if(this.start.row==row&&this.start.column==column){return-1;}else{return this.compare(row,column);}};this.clipRows=function(firstRow,lastRow){if(this.end.row>lastRow)
var end={row:lastRow+1,column:0};else if(this.end.row<firstRow)
var end={row:firstRow,column:0};if(this.start.row>lastRow)
var start={row:lastRow+1,column:0};else if(this.start.row<firstRow)
var start={row:firstRow,column:0};return Range.fromPoints(start||this.start,end||this.end);};this.extend=function(row,column){var cmp=this.compare(row,column);if(cmp==0)
return this;else if(cmp==-1)
var start={row:row,column:column};else
var end={row:row,column:column};return Range.fromPoints(start||this.start,end||this.end);};this.isEmpty=function(){return(this.start.row===this.end.row&&this.start.column===this.end.column);};this.isMultiLine=function(){return(this.start.row!==this.end.row);};this.clone=function(){return Range.fromPoints(this.start,this.end);};this.collapseRows=function(){if(this.end.column==0)
return new Range(this.start.row,0,Math.max(this.start.row,this.end.row-1),0);else
return new Range(this.start.row,0,this.end.row,0);};this.toScreenRange=function(session){var screenPosStart=session.documentToScreenPosition(this.start);var screenPosEnd=session.documentToScreenPosition(this.end);return new Range(screenPosStart.row,screenPosStart.column,screenPosEnd.row,screenPosEnd.column);};this.moveBy=function(row,column){this.start.row+=row;this.start.column+=column;this.end.row+=row;this.end.column+=column;};}).call(Range.prototype);Range.fromPoints=function(start,end){return new Range(start.row,start.column,end.row,end.column);};Range.comparePoints=comparePoints;Range.comparePoints=function(p1,p2){return p1.row-p2.row||p1.column-p2.column;};exports.Range=Range;});define("ace/lib/lang",["require","exports","module"],function(require,exports,module){"use strict";exports.last=function(a){return a[a.length-1];};exports.stringReverse=function(string){return string.split("").reverse().join("");};exports.stringRepeat=function(string,count){var result='';while(count>0){if(count&1)
result+=string;if(count>>=1)
string+=string;}
return result;};var trimBeginRegexp=/^\s\s*/;var trimEndRegexp=/\s\s*$/;exports.stringTrimLeft=function(string){return string.replace(trimBeginRegexp,'');};exports.stringTrimRight=function(string){return string.replace(trimEndRegexp,'');};exports.copyObject=function(obj){var copy={};for(var key in obj){copy[key]=obj[key];}
return copy;};exports.copyArray=function(array){var copy=[];for(var i=0,l=array.length;i<l;i++){if(array[i]&&typeof array[i]=="object")
copy[i]=this.copyObject(array[i]);else
copy[i]=array[i];}
return copy;};exports.deepCopy=function deepCopy(obj){if(typeof obj!=="object"||!obj)
return obj;var copy;if(Array.isArray(obj)){copy=[];for(var key=0;key<obj.length;key++){copy[key]=deepCopy(obj[key]);}
return copy;}
if(Object.prototype.toString.call(obj)!=="[object Object]")
return obj;copy={};for(var key in obj)
copy[key]=deepCopy(obj[key]);return copy;};exports.arrayToMap=function(arr){var map={};for(var i=0;i<arr.length;i++){map[arr[i]]=1;}
return map;};exports.createMap=function(props){var map=Object.create(null);for(var i in props){map[i]=props[i];}
return map;};exports.arrayRemove=function(array,value){for(var i=0;i<=array.length;i++){if(value===array[i]){array.splice(i,1);}}};exports.escapeRegExp=function(str){return str.replace(/([.*+?^${}()|[\]\/\\])/g,'\\$1');};exports.escapeHTML=function(str){return str.replace(/&/g,"&#38;").replace(/"/g,"&#34;").replace(/'/g,"&#39;").replace(/</g,"&#60;");};exports.getMatchOffsets=function(string,regExp){var matches=[];string.replace(regExp,function(str){matches.push({offset:arguments[arguments.length-2],length:str.length});});return matches;};exports.deferredCall=function(fcn){var timer=null;var callback=function(){timer=null;fcn();};var deferred=function(timeout){deferred.cancel();timer=setTimeout(callback,timeout||0);return deferred;};deferred.schedule=deferred;deferred.call=function(){this.cancel();fcn();return deferred;};deferred.cancel=function(){clearTimeout(timer);timer=null;return deferred;};deferred.isPending=function(){return timer;};return deferred;};exports.delayedCall=function(fcn,defaultTimeout){var timer=null;var callback=function(){timer=null;fcn();};var _self=function(timeout){if(timer==null)
timer=setTimeout(callback,timeout||defaultTimeout);};_self.delay=function(timeout){timer&&clearTimeout(timer);timer=setTimeout(callback,timeout||defaultTimeout);};_self.schedule=_self;_self.call=function(){this.cancel();fcn();};_self.cancel=function(){timer&&clearTimeout(timer);timer=null;};_self.isPending=function(){return timer;};return _self;};});define("ace/keyboard/textinput_ios",["require","exports","module","ace/lib/event","ace/lib/useragent","ace/lib/dom","ace/lib/lang","ace/lib/keys"],function(require,exports,module){"use strict";var event=require("../lib/event");var useragent=require("../lib/useragent");var dom=require("../lib/dom");var lang=require("../lib/lang");var KEYS=require("../lib/keys");var MODS=KEYS.KEY_MODS;var BROKEN_SETDATA=useragent.isChrome<18;var USE_IE_MIME_TYPE=useragent.isIE;var TextInput=function(parentNode,host){var self=this;var text=dom.createElement("textarea");text.className=useragent.isIOS?"ace_text-input ace_text-input-ios":"ace_text-input";if(useragent.isTouchPad)
text.setAttribute("x-palm-disable-auto-cap",true);text.setAttribute("wrap","off");text.setAttribute("autocorrect","off");text.setAttribute("autocapitalize","off");text.setAttribute("spellcheck",false);text.style.opacity="0";parentNode.insertBefore(text,parentNode.firstChild);var PLACEHOLDER="\n aaaa a\n";var copied=false;var cut=false;var pasted=false;var inComposition=false;var tempStyle='';var isSelectionEmpty=true;try{var isFocused=document.activeElement===text;}catch(e){}
event.addListener(text,"blur",function(e){host.onBlur(e);isFocused=false;});event.addListener(text,"focus",function(e){isFocused=true;host.onFocus(e);resetSelection();});this.focus=function(){if(tempStyle)return text.focus();text.style.position="fixed";text.focus();};this.blur=function(){text.blur();};this.isFocused=function(){return isFocused;};var syncSelection=lang.delayedCall(function(){isFocused&&resetSelection(isSelectionEmpty);});var syncValue=lang.delayedCall(function(){if(!inComposition){text.value=PLACEHOLDER;isFocused&&resetSelection();}});function resetSelection(isEmpty){if(inComposition)
return;inComposition=true;if(inputHandler){selectionStart=0;selectionEnd=isEmpty?0:text.value.length-1;}else{var selectionStart=4;var selectionEnd=5;}
try{text.setSelectionRange(selectionStart,selectionEnd);}catch(e){}
inComposition=false;}
function resetValue(){if(inComposition)
return;text.value=PLACEHOLDER;if(useragent.isWebKit)
syncValue.schedule();}
useragent.isWebKit||host.addEventListener('changeSelection',function(){if(host.selection.isEmpty()!=isSelectionEmpty){isSelectionEmpty=!isSelectionEmpty;syncSelection.schedule();}});resetValue();if(isFocused)
host.onFocus();var isAllSelected=function(text){return text.selectionStart===0&&text.selectionEnd===text.value.length;};var onSelect=function(e){if(isAllSelected(text)){host.selectAll();resetSelection();}else if(inputHandler){resetSelection(host.selection.isEmpty());}};var inputHandler=null;this.setInputHandler=function(cb){inputHandler=cb;};this.getInputHandler=function(){return inputHandler;};var afterContextMenu=false;var sendText=function(data){if(text.selectionStart===4&&text.selectionEnd===5){return;}
if(inputHandler){data=inputHandler(data);inputHandler=null;}
if(pasted){resetSelection();if(data)
host.onPaste(data);pasted=false;}else if(data==PLACEHOLDER.substr(0)&&text.selectionStart===4){if(afterContextMenu)
host.execCommand("del",{source:"ace"});else
host.execCommand("backspace",{source:"ace"});}else if(!copied){if(data.substring(0,9)==PLACEHOLDER&&data.length>PLACEHOLDER.length)
data=data.substr(9);else if(data.substr(0,4)==PLACEHOLDER.substr(0,4))
data=data.substr(4,data.length-PLACEHOLDER.length+1);else if(data.charAt(data.length-1)==PLACEHOLDER.charAt(0))
data=data.slice(0,-1);if(data==PLACEHOLDER.charAt(0)){}else if(data.charAt(data.length-1)==PLACEHOLDER.charAt(0))
data=data.slice(0,-1);if(data)
host.onTextInput(data);}
if(copied){copied=false;}
if(afterContextMenu)
afterContextMenu=false;};var onInput=function(e){if(inComposition)
return;var data=text.value;sendText(data);resetValue();};var handleClipboardData=function(e,data,forceIEMime){var clipboardData=e.clipboardData||window.clipboardData;if(!clipboardData||BROKEN_SETDATA)
return;var mime=USE_IE_MIME_TYPE||forceIEMime?"Text":"text/plain";try{if(data){return clipboardData.setData(mime,data)!==false;}else{return clipboardData.getData(mime);}}catch(e){if(!forceIEMime)
return handleClipboardData(e,data,true);}};var doCopy=function(e,isCut){var data=host.getCopyText();if(!data)
return event.preventDefault(e);if(handleClipboardData(e,data)){if(useragent.isIOS){cut=isCut;text.value="\n aa"+data+"a a\n";text.setSelectionRange(4,4+data.length);copied={value:data};}
isCut?host.onCut():host.onCopy();if(!useragent.isIOS)event.preventDefault(e);}else{copied=true;text.value=data;text.select();setTimeout(function(){copied=false;resetValue();resetSelection();isCut?host.onCut():host.onCopy();});}};var onCut=function(e){doCopy(e,true);};var onCopy=function(e){doCopy(e,false);};var onPaste=function(e){var data=handleClipboardData(e);if(typeof data=="string"){if(data)
host.onPaste(data,e);if(useragent.isIE)
setTimeout(resetSelection);event.preventDefault(e);}
else{text.value="";pasted=true;}};event.addCommandKeyListener(text,host.onCommandKey.bind(host));event.addListener(text,"select",onSelect);event.addListener(text,"input",onInput);event.addListener(text,"cut",onCut);event.addListener(text,"copy",onCopy);event.addListener(text,"paste",onPaste);var onCompositionStart=function(e){if(inComposition||!host.onCompositionStart||host.$readOnly)
return;inComposition={};inComposition.canUndo=host.session.$undoManager;host.onCompositionStart();setTimeout(onCompositionUpdate,0);host.on("mousedown",onCompositionEnd);if(inComposition.canUndo&&!host.selection.isEmpty()){host.insert("");host.session.markUndoGroup();host.selection.clearSelection();}
host.session.markUndoGroup();};var onCompositionUpdate=function(){if(!inComposition||!host.onCompositionUpdate||host.$readOnly)
return;var val=text.value.replace(/\x01/g,"");if(inComposition.lastValue===val)return;host.onCompositionUpdate(val);if(inComposition.lastValue)
host.undo();if(inComposition.canUndo)
inComposition.lastValue=val;if(inComposition.lastValue){var r=host.selection.getRange();host.insert(inComposition.lastValue);host.session.markUndoGroup();inComposition.range=host.selection.getRange();host.selection.setRange(r);host.selection.clearSelection();}};var onCompositionEnd=function(e){if(!host.onCompositionEnd||host.$readOnly)return;var c=inComposition;inComposition=false;var timer=setTimeout(function(){timer=null;var str=text.value.replace(/\x01/g,"");if(inComposition)
return;else if(str==c.lastValue)
resetValue();else if(!c.lastValue&&str){resetValue();sendText(str);}});inputHandler=function compositionInputHandler(str){if(timer)
clearTimeout(timer);str=str.replace(/\x01/g,"");if(str==c.lastValue)
return"";if(c.lastValue&&timer)
host.undo();return str;};host.onCompositionEnd();host.removeListener("mousedown",onCompositionEnd);if(e.type=="compositionend"&&c.range){host.selection.setRange(c.range);}
var needsOnInput=(!!useragent.isChrome&&useragent.isChrome>=53)||(!!useragent.isWebKit&&useragent.isWebKit>=603);if(needsOnInput){onInput();}};var syncComposition=lang.delayedCall(onCompositionUpdate,50);event.addListener(text,"compositionstart",onCompositionStart);event.addListener(text,"compositionupdate",function(){syncComposition.schedule();});event.addListener(text,"keyup",function(){syncComposition.schedule();});event.addListener(text,"keydown",function(){syncComposition.schedule();});event.addListener(text,"compositionend",onCompositionEnd);this.getElement=function(){return text;};this.setReadOnly=function(readOnly){text.readOnly=readOnly;};this.onContextMenu=function(e){afterContextMenu=true;resetSelection(host.selection.isEmpty());host._emit("nativecontextmenu",{target:host,domEvent:e});this.moveToMouse(e,true);};this.moveToMouse=function(e,bringToFront){if(!tempStyle)
tempStyle=text.style.cssText;text.style.cssText=(bringToFront?"z-index:100000;":"")
+"height:"+text.style.height+";"
+(useragent.isIE?"opacity:0.1;":"");var rect=host.container.getBoundingClientRect();var style=dom.computedStyle(host.container);var top=rect.top+(parseInt(style.borderTopWidth)||0);var left=rect.left+(parseInt(rect.borderLeftWidth)||0);var maxTop=rect.bottom-top-text.clientHeight-2;var move=function(e){text.style.left=e.clientX-left-2+"px";text.style.top=Math.min(e.clientY-top-2,maxTop)+"px";};move(e);if(e.type!="mousedown")
return;if(host.renderer.$keepTextAreaAtCursor)
host.renderer.$keepTextAreaAtCursor=null;clearTimeout(closeTimeout);if(useragent.isWin)
event.capture(host.container,move,onContextMenuClose);};this.onContextMenuClose=onContextMenuClose;var closeTimeout;function onContextMenuClose(){clearTimeout(closeTimeout);closeTimeout=setTimeout(function(){if(tempStyle){text.style.cssText=tempStyle;tempStyle='';}
if(host.renderer.$keepTextAreaAtCursor==null){host.renderer.$keepTextAreaAtCursor=true;host.renderer.$moveTextAreaToCursor();}},0);}
var onContextMenu=function(e){host.textInput.onContextMenu(e);onContextMenuClose();};event.addListener(text,"mouseup",onContextMenu);event.addListener(text,"mousedown",function(e){e.preventDefault();onContextMenuClose();});event.addListener(host.renderer.scroller,"contextmenu",onContextMenu);event.addListener(text,"contextmenu",onContextMenu);if(useragent.isIOS){var typingResetTimeout=null;var typing=false;parentNode.addEventListener("keydown",function(e){if(typingResetTimeout)clearTimeout(typingResetTimeout);typing=true;});parentNode.addEventListener("keyup",function(e){typingResetTimeout=setTimeout(function(){typing=false;},100);});var detectArrowKeys=function(e){if(document.activeElement!==text)return;if(typing)return;if(cut){return setTimeout(function(){cut=false;},100);}
var selectionStart=text.selectionStart;var selectionEnd=text.selectionEnd;text.setSelectionRange(4,5);if(selectionStart==selectionEnd){switch(selectionStart){case 0:host.onCommandKey(null,0,KEYS.up);break;case 1:host.onCommandKey(null,0,KEYS.home);break;case 2:host.onCommandKey(null,MODS.option,KEYS.left);break;case 4:host.onCommandKey(null,0,KEYS.left);break;case 5:host.onCommandKey(null,0,KEYS.right);break;case 7:host.onCommandKey(null,MODS.option,KEYS.right);break;case 8:host.onCommandKey(null,0,KEYS.end);break;case 9:host.onCommandKey(null,0,KEYS.down);break;}}else{switch(selectionEnd){case 6:host.onCommandKey(null,MODS.shift,KEYS.right);break;case 7:host.onCommandKey(null,MODS.shift|MODS.option,KEYS.right);break;case 8:host.onCommandKey(null,MODS.shift,KEYS.end);break;case 9:host.onCommandKey(null,MODS.shift,KEYS.down);break;}
switch(selectionStart){case 0:host.onCommandKey(null,MODS.shift,KEYS.up);break;case 1:host.onCommandKey(null,MODS.shift,KEYS.home);break;case 2:host.onCommandKey(null,MODS.shift|MODS.option,KEYS.left);break;case 3:host.onCommandKey(null,MODS.shift,KEYS.left);break;}}};document.addEventListener("selectionchange",detectArrowKeys);host.on("destroy",function(){document.removeEventListener("selectionchange",detectArrowKeys);});}};exports.TextInput=TextInput;});define("ace/keyboard/textinput",["require","exports","module","ace/lib/event","ace/lib/useragent","ace/lib/dom","ace/lib/lang","ace/keyboard/textinput_ios"],function(require,exports,module){"use strict";var event=require("../lib/event");var useragent=require("../lib/useragent");var dom=require("../lib/dom");var lang=require("../lib/lang");var BROKEN_SETDATA=useragent.isChrome<18;var USE_IE_MIME_TYPE=useragent.isIE;var HAS_FOCUS_ARGS=useragent.isChrome>63;var TextInputIOS=require("./textinput_ios").TextInput;var TextInput=function(parentNode,host){if(useragent.isIOS)
return TextInputIOS.call(this,parentNode,host);var text=dom.createElement("textarea");text.className="ace_text-input";text.setAttribute("wrap","off");text.setAttribute("autocorrect","off");text.setAttribute("autocapitalize","off");text.setAttribute("spellcheck",false);text.style.opacity="0";parentNode.insertBefore(text,parentNode.firstChild);var PLACEHOLDER=useragent.isIE?"\x01\x01":"\u2028\u2028";var PLACEHOLDER_RE=useragent.isIE?/\x01/g:/\u2028/g;var copied=false;var pasted=false;var inComposition=false;var tempStyle='';var isSelectionEmpty=true;var copyWithEmptySelection=false;var commandMode=false;try{var isFocused=document.activeElement===text;}catch(e){}
event.addListener(text,"blur",function(e){host.onBlur(e);isFocused=false;});event.addListener(text,"focus",function(e){isFocused=true;host.onFocus(e);resetSelection();});this.$focusScroll=false;this.focus=function(){if(tempStyle||HAS_FOCUS_ARGS||this.$focusScroll=="browser")
return text.focus({preventScroll:true});var top=text.style.top;text.style.position="fixed";text.style.top="0px";var isTransformed=text.getBoundingClientRect().top!=0;var ancestors=[];if(isTransformed){var t=text.parentElement;while(t){ancestors.push(t);t.setAttribute("ace_nocontext",true);t=t.parentElement;}}
text.focus({preventScroll:true});if(isTransformed){ancestors.forEach(function(p){p.removeAttribute("ace_nocontext");});}
setTimeout(function(){text.style.position="";if(text.style.top=="0px")
text.style.top=top;},0);};this.blur=function(){text.blur();};this.isFocused=function(){return isFocused;};var syncSelection=lang.delayedCall(function(){isFocused&&resetSelection(isSelectionEmpty);});var syncValue=lang.delayedCall(function(){if(!inComposition){text.value=PLACEHOLDER;isFocused&&resetSelection();}});function resetSelection(isEmpty){isEmpty=copyWithEmptySelection?false:isEmpty;if(inComposition)
return;inComposition=true;if(inputHandler){var selectionStart=0;var selectionEnd=isEmpty?0:text.value.length-1;}else{var selectionStart=isEmpty?2:1;var selectionEnd=2;}
try{text.setSelectionRange(selectionStart,selectionEnd);}catch(e){}
inComposition=false;}
function resetValue(){if(inComposition)
return;text.value=PLACEHOLDER;if(useragent.isWebKit)
syncValue.schedule();}
useragent.isWebKit||host.addEventListener('changeSelection',function(){if(host.selection.isEmpty()!=isSelectionEmpty){isSelectionEmpty=!isSelectionEmpty;syncSelection.schedule();}});resetValue();if(isFocused)
host.onFocus();var isAllSelected=function(text){return text.selectionStart===0&&text.selectionEnd===text.value.length;};var onSelect=function(e){if(copied){copied=false;}else if(isAllSelected(text)){host.selectAll();resetSelection();}else if(inputHandler){resetSelection(host.selection.isEmpty());}};var inputHandler=null;this.setInputHandler=function(cb){inputHandler=cb;};this.getInputHandler=function(){return inputHandler;};var afterContextMenu=false;var sendText=function(data){if(inputHandler){data=inputHandler(data);inputHandler=null;}
if(pasted){resetSelection();if(data)
host.onPaste(data);pasted=false;}else if(data==PLACEHOLDER.charAt(0)){if(afterContextMenu)
host.execCommand("del",{source:"ace"});else
host.execCommand("backspace",{source:"ace"});}else{if(data.substring(0,2)==PLACEHOLDER)
data=data.substr(2);else if(data.charAt(0)==PLACEHOLDER.charAt(0))
data=data.substr(1);else if(data.charAt(data.length-1)==PLACEHOLDER.charAt(0))
data=data.slice(0,-1);if(data.charAt(data.length-1)==PLACEHOLDER.charAt(0))
data=data.slice(0,-1);if(data)
host.onTextInput(data);}
if(afterContextMenu)
afterContextMenu=false;};var onInput=function(e){if(inComposition)
return;var data=text.value;sendText(data);resetValue();};var handleClipboardData=function(e,data,forceIEMime){var clipboardData=e.clipboardData||window.clipboardData;if(!clipboardData||BROKEN_SETDATA)
return;var mime=USE_IE_MIME_TYPE||forceIEMime?"Text":"text/plain";try{if(data){return clipboardData.setData(mime,data)!==false;}else{return clipboardData.getData(mime);}}catch(e){if(!forceIEMime)
return handleClipboardData(e,data,true);}};var doCopy=function(e,isCut){var data=host.getCopyText();if(!data)
return event.preventDefault(e);if(handleClipboardData(e,data)){isCut?host.onCut():host.onCopy();event.preventDefault(e);}else{copied=true;text.value=data;text.select();setTimeout(function(){copied=false;resetValue();resetSelection();isCut?host.onCut():host.onCopy();});}};var onCut=function(e){doCopy(e,true);};var onCopy=function(e){doCopy(e,false);};var onPaste=function(e){var data=handleClipboardData(e);if(typeof data=="string"){if(data)
host.onPaste(data,e);if(useragent.isIE)
setTimeout(resetSelection);event.preventDefault(e);}
else{text.value="";pasted=true;}};event.addCommandKeyListener(text,host.onCommandKey.bind(host));event.addListener(text,"select",onSelect);event.addListener(text,"input",onInput);event.addListener(text,"cut",onCut);event.addListener(text,"copy",onCopy);event.addListener(text,"paste",onPaste);if(!('oncut'in text)||!('oncopy'in text)||!('onpaste'in text)){event.addListener(parentNode,"keydown",function(e){if((useragent.isMac&&!e.metaKey)||!e.ctrlKey)
return;switch(e.keyCode){case 67:onCopy(e);break;case 86:onPaste(e);break;case 88:onCut(e);break;}});}
var onCompositionStart=function(e){if(inComposition||!host.onCompositionStart||host.$readOnly)
return;inComposition={};inComposition.canUndo=host.session.$undoManager;host.onCompositionStart();setTimeout(onCompositionUpdate,0);host.on("mousedown",onCompositionEnd);if(inComposition.canUndo&&!host.selection.isEmpty()){host.insert("");host.session.markUndoGroup();host.selection.clearSelection();}
host.session.markUndoGroup();};var onCompositionUpdate=function(){if(!inComposition||!host.onCompositionUpdate||host.$readOnly)
return;var val=text.value.replace(PLACEHOLDER_RE,"");if(inComposition.lastValue===val)return;host.onCompositionUpdate(val);if(inComposition.lastValue)
host.undo();if(inComposition.canUndo)
inComposition.lastValue=val;if(inComposition.lastValue){var r=host.selection.getRange();host.insert(inComposition.lastValue);host.session.markUndoGroup();inComposition.range=host.selection.getRange();host.selection.setRange(r);host.selection.clearSelection();}};var onCompositionEnd=function(e){if(!host.onCompositionEnd||host.$readOnly)return;var c=inComposition;inComposition=false;var timer=setTimeout(function(){timer=null;var str=text.value.replace(PLACEHOLDER_RE,"");if(inComposition)
return;else if(str==c.lastValue)
resetValue();else if(!c.lastValue&&str){resetValue();sendText(str);}});inputHandler=function compositionInputHandler(str){if(timer)
clearTimeout(timer);str=str.replace(PLACEHOLDER_RE,"");if(str==c.lastValue)
return"";if(c.lastValue&&timer)
host.undo();return str;};host.onCompositionEnd();host.removeListener("mousedown",onCompositionEnd);if(e.type=="compositionend"&&c.range){host.selection.setRange(c.range);}
var needsOnInput=useragent.isIE||(useragent.isChrome&&useragent.isChrome>=53)||(useragent.isWebKit&&useragent.isWebKit>=603);if(needsOnInput){onInput();}};var syncComposition=lang.delayedCall(onCompositionUpdate,50);event.addListener(text,"compositionstart",onCompositionStart);event.addListener(text,"compositionupdate",function(){syncComposition.schedule();});event.addListener(text,"keyup",function(){syncComposition.schedule();});event.addListener(text,"keydown",function(){syncComposition.schedule();});event.addListener(text,"compositionend",onCompositionEnd);this.getElement=function(){return text;};this.setCommandMode=function(value){commandMode=value;text.readOnly=false;};this.setReadOnly=function(readOnly){if(!commandMode)
text.readOnly=readOnly;};this.setCopyWithEmptySelection=function(value){copyWithEmptySelection=value;};this.onContextMenu=function(e){afterContextMenu=true;resetSelection(host.selection.isEmpty());host._emit("nativecontextmenu",{target:host,domEvent:e});this.moveToMouse(e,true);};this.moveToMouse=function(e,bringToFront){if(!tempStyle)
tempStyle=text.style.cssText;text.style.cssText=(bringToFront?"z-index:100000;":"")
+"height:"+text.style.height+";"
+(useragent.isIE?"opacity:0.1;":"");var rect=host.container.getBoundingClientRect();var style=dom.computedStyle(host.container);var top=rect.top+(parseInt(style.borderTopWidth)||0);var left=rect.left+(parseInt(rect.borderLeftWidth)||0);var maxTop=rect.bottom-top-text.clientHeight-2;var move=function(e){text.style.left=e.clientX-left-2+"px";text.style.top=Math.min(e.clientY-top-2,maxTop)+"px";};move(e);if(e.type!="mousedown")
return;if(host.renderer.$keepTextAreaAtCursor)
host.renderer.$keepTextAreaAtCursor=null;clearTimeout(closeTimeout);if(useragent.isWin)
event.capture(host.container,move,onContextMenuClose);};this.onContextMenuClose=onContextMenuClose;var closeTimeout;function onContextMenuClose(){clearTimeout(closeTimeout);closeTimeout=setTimeout(function(){if(tempStyle){text.style.cssText=tempStyle;tempStyle='';}
if(host.renderer.$keepTextAreaAtCursor==null){host.renderer.$keepTextAreaAtCursor=true;host.renderer.$moveTextAreaToCursor();}},0);}
var onContextMenu=function(e){host.textInput.onContextMenu(e);onContextMenuClose();};event.addListener(text,"mouseup",onContextMenu);event.addListener(text,"mousedown",function(e){e.preventDefault();onContextMenuClose();});event.addListener(host.renderer.scroller,"contextmenu",onContextMenu);event.addListener(text,"contextmenu",onContextMenu);};exports.TextInput=TextInput;});define("ace/mouse/default_handlers",["require","exports","module","ace/lib/dom","ace/lib/event","ace/lib/useragent"],function(require,exports,module){"use strict";var dom=require("../lib/dom");var event=require("../lib/event");var useragent=require("../lib/useragent");var DRAG_OFFSET=0;var SCROLL_COOLDOWN_T=250;function DefaultHandlers(mouseHandler){mouseHandler.$clickSelection=null;var editor=mouseHandler.editor;editor.setDefaultHandler("mousedown",this.onMouseDown.bind(mouseHandler));editor.setDefaultHandler("dblclick",this.onDoubleClick.bind(mouseHandler));editor.setDefaultHandler("tripleclick",this.onTripleClick.bind(mouseHandler));editor.setDefaultHandler("quadclick",this.onQuadClick.bind(mouseHandler));editor.setDefaultHandler("mousewheel",this.onMouseWheel.bind(mouseHandler));editor.setDefaultHandler("touchmove",this.onTouchMove.bind(mouseHandler));var exports=["select","startSelect","selectEnd","selectAllEnd","selectByWordsEnd","selectByLinesEnd","dragWait","dragWaitEnd","focusWait"];exports.forEach(function(x){mouseHandler[x]=this[x];},this);mouseHandler.selectByLines=this.extendSelectionBy.bind(mouseHandler,"getLineRange");mouseHandler.selectByWords=this.extendSelectionBy.bind(mouseHandler,"getWordRange");}
(function(){this.onMouseDown=function(ev){var inSelection=ev.inSelection();var pos=ev.getDocumentPosition();this.mousedownEvent=ev;var editor=this.editor;var button=ev.getButton();if(button!==0){var selectionRange=editor.getSelectionRange();var selectionEmpty=selectionRange.isEmpty();if(selectionEmpty||button==1)
editor.selection.moveToPosition(pos);if(button==2){editor.textInput.onContextMenu(ev.domEvent);if(!useragent.isMozilla)
ev.preventDefault();}
return;}
this.mousedownEvent.time=Date.now();if(inSelection&&!editor.isFocused()){editor.focus();if(this.$focusTimeout&&!this.$clickSelection&&!editor.inMultiSelectMode){this.setState("focusWait");this.captureMouse(ev);return;}}
this.captureMouse(ev);this.startSelect(pos,ev.domEvent._clicks>1);return ev.preventDefault();};this.startSelect=function(pos,waitForClickSelection){pos=pos||this.editor.renderer.screenToTextCoordinates(this.x,this.y);var editor=this.editor;if(this.mousedownEvent.getShiftKey())
editor.selection.selectToPosition(pos);else if(!waitForClickSelection)
editor.selection.moveToPosition(pos);if(!waitForClickSelection)
this.select();if(editor.renderer.scroller.setCapture){editor.renderer.scroller.setCapture();}
editor.setStyle("ace_selecting");this.setState("select");};this.select=function(){var anchor,editor=this.editor;var cursor=editor.renderer.screenToTextCoordinates(this.x,this.y);if(this.$clickSelection){var cmp=this.$clickSelection.comparePoint(cursor);if(cmp==-1){anchor=this.$clickSelection.end;}else if(cmp==1){anchor=this.$clickSelection.start;}else{var orientedRange=calcRangeOrientation(this.$clickSelection,cursor);cursor=orientedRange.cursor;anchor=orientedRange.anchor;}
editor.selection.setSelectionAnchor(anchor.row,anchor.column);}
editor.selection.selectToPosition(cursor);editor.renderer.scrollCursorIntoView();};this.extendSelectionBy=function(unitName){var anchor,editor=this.editor;var cursor=editor.renderer.screenToTextCoordinates(this.x,this.y);var range=editor.selection[unitName](cursor.row,cursor.column);if(this.$clickSelection){var cmpStart=this.$clickSelection.comparePoint(range.start);var cmpEnd=this.$clickSelection.comparePoint(range.end);if(cmpStart==-1&&cmpEnd<=0){anchor=this.$clickSelection.end;if(range.end.row!=cursor.row||range.end.column!=cursor.column)
cursor=range.start;}else if(cmpEnd==1&&cmpStart>=0){anchor=this.$clickSelection.start;if(range.start.row!=cursor.row||range.start.column!=cursor.column)
cursor=range.end;}else if(cmpStart==-1&&cmpEnd==1){cursor=range.end;anchor=range.start;}else{var orientedRange=calcRangeOrientation(this.$clickSelection,cursor);cursor=orientedRange.cursor;anchor=orientedRange.anchor;}
editor.selection.setSelectionAnchor(anchor.row,anchor.column);}
editor.selection.selectToPosition(cursor);editor.renderer.scrollCursorIntoView();};this.selectEnd=this.selectAllEnd=this.selectByWordsEnd=this.selectByLinesEnd=function(){this.$clickSelection=null;this.editor.unsetStyle("ace_selecting");if(this.editor.renderer.scroller.releaseCapture){this.editor.renderer.scroller.releaseCapture();}};this.focusWait=function(){var distance=calcDistance(this.mousedownEvent.x,this.mousedownEvent.y,this.x,this.y);var time=Date.now();if(distance>DRAG_OFFSET||time-this.mousedownEvent.time>this.$focusTimeout)
this.startSelect(this.mousedownEvent.getDocumentPosition());};this.onDoubleClick=function(ev){var pos=ev.getDocumentPosition();var editor=this.editor;var session=editor.session;var range=session.getBracketRange(pos);if(range){if(range.isEmpty()){range.start.column--;range.end.column++;}
this.setState("select");}else{range=editor.selection.getWordRange(pos.row,pos.column);this.setState("selectByWords");}
this.$clickSelection=range;this.select();};this.onTripleClick=function(ev){var pos=ev.getDocumentPosition();var editor=this.editor;this.setState("selectByLines");var range=editor.getSelectionRange();if(range.isMultiLine()&&range.contains(pos.row,pos.column)){this.$clickSelection=editor.selection.getLineRange(range.start.row);this.$clickSelection.end=editor.selection.getLineRange(range.end.row).end;}else{this.$clickSelection=editor.selection.getLineRange(pos.row);}
this.select();};this.onQuadClick=function(ev){var editor=this.editor;editor.selectAll();this.$clickSelection=editor.getSelectionRange();this.setState("selectAll");};this.onMouseWheel=function(ev){if(ev.getAccelKey())
return;if(ev.getShiftKey()&&ev.wheelY&&!ev.wheelX){ev.wheelX=ev.wheelY;ev.wheelY=0;}
var editor=this.editor;if(!this.$lastScroll)
this.$lastScroll={t:0,vx:0,vy:0,allowed:0};var prevScroll=this.$lastScroll;var t=ev.domEvent.timeStamp;var dt=t-prevScroll.t;var vx=dt?ev.wheelX/dt:prevScroll.vx;var vy=dt?ev.wheelY/dt:prevScroll.vy;if(dt<SCROLL_COOLDOWN_T){vx=(vx+prevScroll.vx)/2;vy=(vy+prevScroll.vy)/2;}
var direction=Math.abs(vx/vy);var canScroll=false;if(direction>=1&&editor.renderer.isScrollableBy(ev.wheelX*ev.speed,0))
canScroll=true;if(direction<=1&&editor.renderer.isScrollableBy(0,ev.wheelY*ev.speed))
canScroll=true;if(canScroll){prevScroll.allowed=t;}else if(t-prevScroll.allowed<SCROLL_COOLDOWN_T){var isSlower=Math.abs(vx)<=1.1*Math.abs(prevScroll.vx)&&Math.abs(vy)<=1.1*Math.abs(prevScroll.vy);if(isSlower){canScroll=true;prevScroll.allowed=t;}
else{prevScroll.allowed=0;}}
prevScroll.t=t;prevScroll.vx=vx;prevScroll.vy=vy;if(canScroll){editor.renderer.scrollBy(ev.wheelX*ev.speed,ev.wheelY*ev.speed);return ev.stop();}};this.onTouchMove=function(ev){this.editor._emit("mousewheel",ev);};}).call(DefaultHandlers.prototype);exports.DefaultHandlers=DefaultHandlers;function calcDistance(ax,ay,bx,by){return Math.sqrt(Math.pow(bx-ax,2)+Math.pow(by-ay,2));}
function calcRangeOrientation(range,cursor){if(range.start.row==range.end.row)
var cmp=2*cursor.column-range.start.column-range.end.column;else if(range.start.row==range.end.row-1&&!range.start.column&&!range.end.column)
var cmp=cursor.column-4;else
var cmp=2*cursor.row-range.start.row-range.end.row;if(cmp<0)
return{cursor:range.start,anchor:range.end};else
return{cursor:range.end,anchor:range.start};}});define("ace/tooltip",["require","exports","module","ace/lib/oop","ace/lib/dom"],function(require,exports,module){"use strict";var oop=require("./lib/oop");var dom=require("./lib/dom");function Tooltip(parentNode){this.isOpen=false;this.$element=null;this.$parentNode=parentNode;}
(function(){this.$init=function(){this.$element=dom.createElement("div");this.$element.className="ace_tooltip";this.$element.style.display="none";this.$parentNode.appendChild(this.$element);return this.$element;};this.getElement=function(){return this.$element||this.$init();};this.setText=function(text){dom.setInnerText(this.getElement(),text);};this.setHtml=function(html){this.getElement().innerHTML=html;};this.setPosition=function(x,y){this.getElement().style.left=x+"px";this.getElement().style.top=y+"px";};this.setClassName=function(className){dom.addCssClass(this.getElement(),className);};this.show=function(text,x,y){if(text!=null)
this.setText(text);if(x!=null&&y!=null)
this.setPosition(x,y);if(!this.isOpen){this.getElement().style.display="block";this.isOpen=true;}};this.hide=function(){if(this.isOpen){this.getElement().style.display="none";this.isOpen=false;}};this.getHeight=function(){return this.getElement().offsetHeight;};this.getWidth=function(){return this.getElement().offsetWidth;};this.destroy=function(){this.isOpen=false;if(this.$element&&this.$element.parentNode){this.$element.parentNode.removeChild(this.$element);}};}).call(Tooltip.prototype);exports.Tooltip=Tooltip;});define("ace/mouse/default_gutter_handler",["require","exports","module","ace/lib/dom","ace/lib/oop","ace/lib/event","ace/tooltip"],function(require,exports,module){"use strict";var dom=require("../lib/dom");var oop=require("../lib/oop");var event=require("../lib/event");var Tooltip=require("../tooltip").Tooltip;function GutterHandler(mouseHandler){var editor=mouseHandler.editor;var gutter=editor.renderer.$gutterLayer;var tooltip=new GutterTooltip(editor.container);mouseHandler.editor.setDefaultHandler("guttermousedown",function(e){if(!editor.isFocused()||e.getButton()!=0)
return;var gutterRegion=gutter.getRegion(e);if(gutterRegion=="foldWidgets")
return;var row=e.getDocumentPosition().row;var selection=editor.session.selection;if(e.getShiftKey())
selection.selectTo(row,0);else{if(e.domEvent.detail==2){editor.selectAll();return e.preventDefault();}
mouseHandler.$clickSelection=editor.selection.getLineRange(row);}
mouseHandler.setState("selectByLines");mouseHandler.captureMouse(e);return e.preventDefault();});var tooltipTimeout,mouseEvent,tooltipAnnotation;function showTooltip(){var row=mouseEvent.getDocumentPosition().row;var annotation=gutter.$annotations[row];if(!annotation)
return hideTooltip();var maxRow=editor.session.getLength();if(row==maxRow){var screenRow=editor.renderer.pixelToScreenCoordinates(0,mouseEvent.y).row;var pos=mouseEvent.$pos;if(screenRow>editor.session.documentToScreenRow(pos.row,pos.column))
return hideTooltip();}
if(tooltipAnnotation==annotation)
return;tooltipAnnotation=annotation.text.join("<br/>");tooltip.setHtml(tooltipAnnotation);tooltip.show();editor._signal("showGutterTooltip",tooltip);editor.on("mousewheel",hideTooltip);if(mouseHandler.$tooltipFollowsMouse){moveTooltip(mouseEvent);}else{var gutterElement=mouseEvent.domEvent.target;var rect=gutterElement.getBoundingClientRect();var style=tooltip.getElement().style;style.left=rect.right+"px";style.top=rect.bottom+"px";}}
function hideTooltip(){if(tooltipTimeout)
tooltipTimeout=clearTimeout(tooltipTimeout);if(tooltipAnnotation){tooltip.hide();tooltipAnnotation=null;editor._signal("hideGutterTooltip",tooltip);editor.removeEventListener("mousewheel",hideTooltip);}}
function moveTooltip(e){tooltip.setPosition(e.x,e.y);}
mouseHandler.editor.setDefaultHandler("guttermousemove",function(e){var target=e.domEvent.target||e.domEvent.srcElement;if(dom.hasCssClass(target,"ace_fold-widget"))
return hideTooltip();if(tooltipAnnotation&&mouseHandler.$tooltipFollowsMouse)
moveTooltip(e);mouseEvent=e;if(tooltipTimeout)
return;tooltipTimeout=setTimeout(function(){tooltipTimeout=null;if(mouseEvent&&!mouseHandler.isMousePressed)
showTooltip();else
hideTooltip();},50);});event.addListener(editor.renderer.$gutter,"mouseout",function(e){mouseEvent=null;if(!tooltipAnnotation||tooltipTimeout)
return;tooltipTimeout=setTimeout(function(){tooltipTimeout=null;hideTooltip();},50);});editor.on("changeSession",hideTooltip);}
function GutterTooltip(parentNode){Tooltip.call(this,parentNode);}
oop.inherits(GutterTooltip,Tooltip);(function(){this.setPosition=function(x,y){var windowWidth=window.innerWidth||document.documentElement.clientWidth;var windowHeight=window.innerHeight||document.documentElement.clientHeight;var width=this.getWidth();var height=this.getHeight();x+=15;y+=15;if(x+width>windowWidth){x-=(x+width)-windowWidth;}
if(y+height>windowHeight){y-=20+height;}
Tooltip.prototype.setPosition.call(this,x,y);};}).call(GutterTooltip.prototype);exports.GutterHandler=GutterHandler;});define("ace/mouse/mouse_event",["require","exports","module","ace/lib/event","ace/lib/useragent"],function(require,exports,module){"use strict";var event=require("../lib/event");var useragent=require("../lib/useragent");var MouseEvent=exports.MouseEvent=function(domEvent,editor){this.domEvent=domEvent;this.editor=editor;this.x=this.clientX=domEvent.clientX;this.y=this.clientY=domEvent.clientY;this.$pos=null;this.$inSelection=null;this.propagationStopped=false;this.defaultPrevented=false;};(function(){this.stopPropagation=function(){event.stopPropagation(this.domEvent);this.propagationStopped=true;};this.preventDefault=function(){event.preventDefault(this.domEvent);this.defaultPrevented=true;};this.stop=function(){this.stopPropagation();this.preventDefault();};this.getDocumentPosition=function(){if(this.$pos)
return this.$pos;this.$pos=this.editor.renderer.screenToTextCoordinates(this.clientX,this.clientY);return this.$pos;};this.inSelection=function(){if(this.$inSelection!==null)
return this.$inSelection;var editor=this.editor;var selectionRange=editor.getSelectionRange();if(selectionRange.isEmpty())
this.$inSelection=false;else{var pos=this.getDocumentPosition();this.$inSelection=selectionRange.contains(pos.row,pos.column);}
return this.$inSelection;};this.getButton=function(){return event.getButton(this.domEvent);};this.getShiftKey=function(){return this.domEvent.shiftKey;};this.getAccelKey=useragent.isMac?function(){return this.domEvent.metaKey;}:function(){return this.domEvent.ctrlKey;};}).call(MouseEvent.prototype);});define("ace/mouse/dragdrop_handler",["require","exports","module","ace/lib/dom","ace/lib/event","ace/lib/useragent"],function(require,exports,module){"use strict";var dom=require("../lib/dom");var event=require("../lib/event");var useragent=require("../lib/useragent");var AUTOSCROLL_DELAY=200;var SCROLL_CURSOR_DELAY=200;var SCROLL_CURSOR_HYSTERESIS=5;function DragdropHandler(mouseHandler){var editor=mouseHandler.editor;var blankImage=dom.createElement("img");blankImage.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";if(useragent.isOpera)
blankImage.style.cssText="width:1px;height:1px;position:fixed;top:0;left:0;z-index:2147483647;opacity:0;";var exports=["dragWait","dragWaitEnd","startDrag","dragReadyEnd","onMouseDrag"];exports.forEach(function(x){mouseHandler[x]=this[x];},this);editor.addEventListener("mousedown",this.onMouseDown.bind(mouseHandler));var mouseTarget=editor.container;var dragSelectionMarker,x,y;var timerId,range;var dragCursor,counter=0;var dragOperation;var isInternal;var autoScrollStartTime;var cursorMovedTime;var cursorPointOnCaretMoved;this.onDragStart=function(e){if(this.cancelDrag||!mouseTarget.draggable){var self=this;setTimeout(function(){self.startSelect();self.captureMouse(e);},0);return e.preventDefault();}
range=editor.getSelectionRange();var dataTransfer=e.dataTransfer;dataTransfer.effectAllowed=editor.getReadOnly()?"copy":"copyMove";if(useragent.isOpera){editor.container.appendChild(blankImage);blankImage.scrollTop=0;}
dataTransfer.setDragImage&&dataTransfer.setDragImage(blankImage,0,0);if(useragent.isOpera){editor.container.removeChild(blankImage);}
dataTransfer.clearData();dataTransfer.setData("Text",editor.session.getTextRange());isInternal=true;this.setState("drag");};this.onDragEnd=function(e){mouseTarget.draggable=false;isInternal=false;this.setState(null);if(!editor.getReadOnly()){var dropEffect=e.dataTransfer.dropEffect;if(!dragOperation&&dropEffect=="move")
editor.session.remove(editor.getSelectionRange());editor.renderer.$cursorLayer.setBlinking(true);}
this.editor.unsetStyle("ace_dragging");this.editor.renderer.setCursorStyle("");};this.onDragEnter=function(e){if(editor.getReadOnly()||!canAccept(e.dataTransfer))
return;x=e.clientX;y=e.clientY;if(!dragSelectionMarker)
addDragMarker();counter++;e.dataTransfer.dropEffect=dragOperation=getDropEffect(e);return event.preventDefault(e);};this.onDragOver=function(e){if(editor.getReadOnly()||!canAccept(e.dataTransfer))
return;x=e.clientX;y=e.clientY;if(!dragSelectionMarker){addDragMarker();counter++;}
if(onMouseMoveTimer!==null)
onMouseMoveTimer=null;e.dataTransfer.dropEffect=dragOperation=getDropEffect(e);return event.preventDefault(e);};this.onDragLeave=function(e){counter--;if(counter<=0&&dragSelectionMarker){clearDragMarker();dragOperation=null;return event.preventDefault(e);}};this.onDrop=function(e){if(!dragCursor)
return;var dataTransfer=e.dataTransfer;if(isInternal){switch(dragOperation){case"move":if(range.contains(dragCursor.row,dragCursor.column)){range={start:dragCursor,end:dragCursor};}else{range=editor.moveText(range,dragCursor);}
break;case"copy":range=editor.moveText(range,dragCursor,true);break;}}else{var dropData=dataTransfer.getData('Text');range={start:dragCursor,end:editor.session.insert(dragCursor,dropData)};editor.focus();dragOperation=null;}
clearDragMarker();return event.preventDefault(e);};event.addListener(mouseTarget,"dragstart",this.onDragStart.bind(mouseHandler));event.addListener(mouseTarget,"dragend",this.onDragEnd.bind(mouseHandler));event.addListener(mouseTarget,"dragenter",this.onDragEnter.bind(mouseHandler));event.addListener(mouseTarget,"dragover",this.onDragOver.bind(mouseHandler));event.addListener(mouseTarget,"dragleave",this.onDragLeave.bind(mouseHandler));event.addListener(mouseTarget,"drop",this.onDrop.bind(mouseHandler));function scrollCursorIntoView(cursor,prevCursor){var now=Date.now();var vMovement=!prevCursor||cursor.row!=prevCursor.row;var hMovement=!prevCursor||cursor.column!=prevCursor.column;if(!cursorMovedTime||vMovement||hMovement){editor.moveCursorToPosition(cursor);cursorMovedTime=now;cursorPointOnCaretMoved={x:x,y:y};}else{var distance=calcDistance(cursorPointOnCaretMoved.x,cursorPointOnCaretMoved.y,x,y);if(distance>SCROLL_CURSOR_HYSTERESIS){cursorMovedTime=null;}else if(now-cursorMovedTime>=SCROLL_CURSOR_DELAY){editor.renderer.scrollCursorIntoView();cursorMovedTime=null;}}}
function autoScroll(cursor,prevCursor){var now=Date.now();var lineHeight=editor.renderer.layerConfig.lineHeight;var characterWidth=editor.renderer.layerConfig.characterWidth;var editorRect=editor.renderer.scroller.getBoundingClientRect();var offsets={x:{left:x-editorRect.left,right:editorRect.right-x},y:{top:y-editorRect.top,bottom:editorRect.bottom-y}};var nearestXOffset=Math.min(offsets.x.left,offsets.x.right);var nearestYOffset=Math.min(offsets.y.top,offsets.y.bottom);var scrollCursor={row:cursor.row,column:cursor.column};if(nearestXOffset/characterWidth<=2){scrollCursor.column+=(offsets.x.left<offsets.x.right?-3:+2);}
if(nearestYOffset/lineHeight<=1){scrollCursor.row+=(offsets.y.top<offsets.y.bottom?-1:+1);}
var vScroll=cursor.row!=scrollCursor.row;var hScroll=cursor.column!=scrollCursor.column;var vMovement=!prevCursor||cursor.row!=prevCursor.row;if(vScroll||(hScroll&&!vMovement)){if(!autoScrollStartTime)
autoScrollStartTime=now;else if(now-autoScrollStartTime>=AUTOSCROLL_DELAY)
editor.renderer.scrollCursorIntoView(scrollCursor);}else{autoScrollStartTime=null;}}
function onDragInterval(){var prevCursor=dragCursor;dragCursor=editor.renderer.screenToTextCoordinates(x,y);scrollCursorIntoView(dragCursor,prevCursor);autoScroll(dragCursor,prevCursor);}
function addDragMarker(){range=editor.selection.toOrientedRange();dragSelectionMarker=editor.session.addMarker(range,"ace_selection",editor.getSelectionStyle());editor.clearSelection();if(editor.isFocused())
editor.renderer.$cursorLayer.setBlinking(false);clearInterval(timerId);onDragInterval();timerId=setInterval(onDragInterval,20);counter=0;event.addListener(document,"mousemove",onMouseMove);}
function clearDragMarker(){clearInterval(timerId);editor.session.removeMarker(dragSelectionMarker);dragSelectionMarker=null;editor.selection.fromOrientedRange(range);if(editor.isFocused()&&!isInternal)
editor.renderer.$cursorLayer.setBlinking(!editor.getReadOnly());range=null;dragCursor=null;counter=0;autoScrollStartTime=null;cursorMovedTime=null;event.removeListener(document,"mousemove",onMouseMove);}
var onMouseMoveTimer=null;function onMouseMove(){if(onMouseMoveTimer==null){onMouseMoveTimer=setTimeout(function(){if(onMouseMoveTimer!=null&&dragSelectionMarker)
clearDragMarker();},20);}}
function canAccept(dataTransfer){var types=dataTransfer.types;return!types||Array.prototype.some.call(types,function(type){return type=='text/plain'||type=='Text';});}
function getDropEffect(e){var copyAllowed=['copy','copymove','all','uninitialized'];var moveAllowed=['move','copymove','linkmove','all','uninitialized'];var copyModifierState=useragent.isMac?e.altKey:e.ctrlKey;var effectAllowed="uninitialized";try{effectAllowed=e.dataTransfer.effectAllowed.toLowerCase();}catch(e){}
var dropEffect="none";if(copyModifierState&&copyAllowed.indexOf(effectAllowed)>=0)
dropEffect="copy";else if(moveAllowed.indexOf(effectAllowed)>=0)
dropEffect="move";else if(copyAllowed.indexOf(effectAllowed)>=0)
dropEffect="copy";return dropEffect;}}
(function(){this.dragWait=function(){var interval=Date.now()-this.mousedownEvent.time;if(interval>this.editor.getDragDelay())
this.startDrag();};this.dragWaitEnd=function(){var target=this.editor.container;target.draggable=false;this.startSelect(this.mousedownEvent.getDocumentPosition());this.selectEnd();};this.dragReadyEnd=function(e){this.editor.renderer.$cursorLayer.setBlinking(!this.editor.getReadOnly());this.editor.unsetStyle("ace_dragging");this.editor.renderer.setCursorStyle("");this.dragWaitEnd();};this.startDrag=function(){this.cancelDrag=false;var editor=this.editor;var target=editor.container;target.draggable=true;editor.renderer.$cursorLayer.setBlinking(false);editor.setStyle("ace_dragging");var cursorStyle=useragent.isWin?"default":"move";editor.renderer.setCursorStyle(cursorStyle);this.setState("dragReady");};this.onMouseDrag=function(e){var target=this.editor.container;if(useragent.isIE&&this.state=="dragReady"){var distance=calcDistance(this.mousedownEvent.x,this.mousedownEvent.y,this.x,this.y);if(distance>3)
target.dragDrop();}
if(this.state==="dragWait"){var distance=calcDistance(this.mousedownEvent.x,this.mousedownEvent.y,this.x,this.y);if(distance>0){target.draggable=false;this.startSelect(this.mousedownEvent.getDocumentPosition());}}};this.onMouseDown=function(e){if(!this.$dragEnabled)
return;this.mousedownEvent=e;var editor=this.editor;var inSelection=e.inSelection();var button=e.getButton();var clickCount=e.domEvent.detail||1;if(clickCount===1&&button===0&&inSelection){if(e.editor.inMultiSelectMode&&(e.getAccelKey()||e.getShiftKey()))
return;this.mousedownEvent.time=Date.now();var eventTarget=e.domEvent.target||e.domEvent.srcElement;if("unselectable"in eventTarget)
eventTarget.unselectable="on";if(editor.getDragDelay()){if(useragent.isWebKit){this.cancelDrag=true;var mouseTarget=editor.container;mouseTarget.draggable=true;}
this.setState("dragWait");}else{this.startDrag();}
this.captureMouse(e,this.onMouseDrag.bind(this));e.defaultPrevented=true;}};}).call(DragdropHandler.prototype);function calcDistance(ax,ay,bx,by){return Math.sqrt(Math.pow(bx-ax,2)+Math.pow(by-ay,2));}
exports.DragdropHandler=DragdropHandler;});define("ace/lib/net",["require","exports","module","ace/lib/dom"],function(require,exports,module){"use strict";var dom=require("./dom");exports.get=function(url,callback){var xhr=new XMLHttpRequest();xhr.open('GET',url,true);xhr.onreadystatechange=function(){if(xhr.readyState===4){callback(xhr.responseText);}};xhr.send(null);};exports.loadScript=function(path,callback){var head=dom.getDocumentHead();var s=document.createElement('script');s.src=path;head.appendChild(s);s.onload=s.onreadystatechange=function(_,isAbort){if(isAbort||!s.readyState||s.readyState=="loaded"||s.readyState=="complete"){s=s.onload=s.onreadystatechange=null;if(!isAbort)
callback();}};};exports.qualifyURL=function(url){var a=document.createElement('a');a.href=url;return a.href;};});define("ace/lib/event_emitter",["require","exports","module"],function(require,exports,module){"use strict";var EventEmitter={};var stopPropagation=function(){this.propagationStopped=true;};var preventDefault=function(){this.defaultPrevented=true;};EventEmitter._emit=EventEmitter._dispatchEvent=function(eventName,e){this._eventRegistry||(this._eventRegistry={});this._defaultHandlers||(this._defaultHandlers={});var listeners=this._eventRegistry[eventName]||[];var defaultHandler=this._defaultHandlers[eventName];if(!listeners.length&&!defaultHandler)
return;if(typeof e!="object"||!e)
e={};if(!e.type)
e.type=eventName;if(!e.stopPropagation)
e.stopPropagation=stopPropagation;if(!e.preventDefault)
e.preventDefault=preventDefault;listeners=listeners.slice();for(var i=0;i<listeners.length;i++){listeners[i](e,this);if(e.propagationStopped)
break;}
if(defaultHandler&&!e.defaultPrevented)
return defaultHandler(e,this);};EventEmitter._signal=function(eventName,e){var listeners=(this._eventRegistry||{})[eventName];if(!listeners)
return;listeners=listeners.slice();for(var i=0;i<listeners.length;i++)
listeners[i](e,this);};EventEmitter.once=function(eventName,callback){var _self=this;callback&&this.addEventListener(eventName,function newCallback(){_self.removeEventListener(eventName,newCallback);callback.apply(null,arguments);});};EventEmitter.setDefaultHandler=function(eventName,callback){var handlers=this._defaultHandlers;if(!handlers)
handlers=this._defaultHandlers={_disabled_:{}};if(handlers[eventName]){var old=handlers[eventName];var disabled=handlers._disabled_[eventName];if(!disabled)
handlers._disabled_[eventName]=disabled=[];disabled.push(old);var i=disabled.indexOf(callback);if(i!=-1)
disabled.splice(i,1);}
handlers[eventName]=callback;};EventEmitter.removeDefaultHandler=function(eventName,callback){var handlers=this._defaultHandlers;if(!handlers)
return;var disabled=handlers._disabled_[eventName];if(handlers[eventName]==callback){var old=handlers[eventName];if(disabled)
this.setDefaultHandler(eventName,disabled.pop());}else if(disabled){var i=disabled.indexOf(callback);if(i!=-1)
disabled.splice(i,1);}};EventEmitter.on=EventEmitter.addEventListener=function(eventName,callback,capturing){this._eventRegistry=this._eventRegistry||{};var listeners=this._eventRegistry[eventName];if(!listeners)
listeners=this._eventRegistry[eventName]=[];if(listeners.indexOf(callback)==-1)
listeners[capturing?"unshift":"push"](callback);return callback;};EventEmitter.off=EventEmitter.removeListener=EventEmitter.removeEventListener=function(eventName,callback){this._eventRegistry=this._eventRegistry||{};var listeners=this._eventRegistry[eventName];if(!listeners)
return;var index=listeners.indexOf(callback);if(index!==-1)
listeners.splice(index,1);};EventEmitter.removeAllListeners=function(eventName){if(this._eventRegistry)this._eventRegistry[eventName]=[];};exports.EventEmitter=EventEmitter;});define("ace/lib/app_config",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],function(require,exports,module){"no use strict";var oop=require("./oop");var EventEmitter=require("./event_emitter").EventEmitter;var optionsProvider={setOptions:function(optList){Object.keys(optList).forEach(function(key){this.setOption(key,optList[key]);},this);},getOptions:function(optionNames){var result={};if(!optionNames){var options=this.$options;optionNames=Object.keys(options).filter(function(key){return!options[key].hidden;});}else if(!Array.isArray(optionNames)){result=optionNames;optionNames=Object.keys(result);}
optionNames.forEach(function(key){result[key]=this.getOption(key);},this);return result;},setOption:function(name,value){if(this["$"+name]===value)
return;var opt=this.$options[name];if(!opt){return warn('misspelled option "'+name+'"');}
if(opt.forwardTo)
return this[opt.forwardTo]&&this[opt.forwardTo].setOption(name,value);if(!opt.handlesSet)
this["$"+name]=value;if(opt&&opt.set)
opt.set.call(this,value);},getOption:function(name){var opt=this.$options[name];if(!opt){return warn('misspelled option "'+name+'"');}
if(opt.forwardTo)
return this[opt.forwardTo]&&this[opt.forwardTo].getOption(name);return opt&&opt.get?opt.get.call(this):this["$"+name];}};function warn(message){if(typeof console!="undefined"&&console.warn)
console.warn.apply(console,arguments);}
function reportError(msg,data){var e=new Error(msg);e.data=data;if(typeof console=="object"&&console.error)
console.error(e);setTimeout(function(){throw e;});}
var AppConfig=function(){this.$defaultOptions={};};(function(){oop.implement(this,EventEmitter);this.defineOptions=function(obj,path,options){if(!obj.$options)
this.$defaultOptions[path]=obj.$options={};Object.keys(options).forEach(function(key){var opt=options[key];if(typeof opt=="string")
opt={forwardTo:opt};opt.name||(opt.name=key);obj.$options[opt.name]=opt;if("initialValue"in opt)
obj["$"+opt.name]=opt.initialValue;});oop.implement(obj,optionsProvider);return this;};this.resetOptions=function(obj){Object.keys(obj.$options).forEach(function(key){var opt=obj.$options[key];if("value"in opt)
obj.setOption(key,opt.value);});};this.setDefaultValue=function(path,name,value){var opts=this.$defaultOptions[path]||(this.$defaultOptions[path]={});if(opts[name]){if(opts.forwardTo)
this.setDefaultValue(opts.forwardTo,name,value);else
opts[name].value=value;}};this.setDefaultValues=function(path,optionHash){Object.keys(optionHash).forEach(function(key){this.setDefaultValue(path,key,optionHash[key]);},this);};this.warn=warn;this.reportError=reportError;}).call(AppConfig.prototype);exports.AppConfig=AppConfig;});define("ace/config",["require","exports","module","ace/lib/lang","ace/lib/oop","ace/lib/net","ace/lib/app_config"],function(require,exports,module){"no use strict";var lang=require("./lib/lang");var oop=require("./lib/oop");var net=require("./lib/net");var AppConfig=require("./lib/app_config").AppConfig;module.exports=exports=new AppConfig();var global=(function(){return this||typeof window!="undefined"&&window;})();var options={packaged:false,workerPath:null,modePath:null,themePath:null,basePath:"",suffix:".js",$moduleUrls:{}};exports.get=function(key){if(!options.hasOwnProperty(key))
throw new Error("Unknown config key: "+key);return options[key];};exports.set=function(key,value){if(!options.hasOwnProperty(key))
throw new Error("Unknown config key: "+key);options[key]=value;};exports.all=function(){return lang.copyObject(options);};exports.moduleUrl=function(name,component){if(options.$moduleUrls[name])
return options.$moduleUrls[name];var parts=name.split("/");component=component||parts[parts.length-2]||"";var sep=component=="snippets"?"/":"-";var base=parts[parts.length-1];if(component=="worker"&&sep=="-"){var re=new RegExp("^"+component+"[\\-_]|[\\-_]"+component+"$","g");base=base.replace(re,"");}
if((!base||base==component)&&parts.length>1)
base=parts[parts.length-2];var path=options[component+"Path"];if(path==null){path=options.basePath;}else if(sep=="/"){component=sep="";}
if(path&&path.slice(-1)!="/")
path+="/";return path+component+sep+base+this.get("suffix");};exports.setModuleUrl=function(name,subst){return options.$moduleUrls[name]=subst;};exports.$loading={};exports.loadModule=function(moduleName,onLoad){var module,moduleType;if(Array.isArray(moduleName)){moduleType=moduleName[0];moduleName=moduleName[1];}
try{module=require(moduleName);}catch(e){}
if(module&&!exports.$loading[moduleName])
return onLoad&&onLoad(module);if(!exports.$loading[moduleName])
exports.$loading[moduleName]=[];exports.$loading[moduleName].push(onLoad);if(exports.$loading[moduleName].length>1)
return;var afterLoad=function(){require([moduleName],function(module){exports._emit("load.module",{name:moduleName,module:module});var listeners=exports.$loading[moduleName];exports.$loading[moduleName]=null;listeners.forEach(function(onLoad){onLoad&&onLoad(module);});});};if(!exports.get("packaged"))
return afterLoad();net.loadScript(exports.moduleUrl(moduleName,moduleType),afterLoad);};init(true);function init(packaged){if(!global||!global.document)
return;options.packaged=packaged||require.packaged||module.packaged||(global.define&&define.packaged);var scriptOptions={};var scriptUrl="";var currentScript=(document.currentScript||document._currentScript);var currentDocument=currentScript&&currentScript.ownerDocument||document;var scripts=currentDocument.getElementsByTagName("script");for(var i=0;i<scripts.length;i++){var script=scripts[i];var src=script.src||script.getAttribute("src");if(!src)
continue;var attributes=script.attributes;for(var j=0,l=attributes.length;j<l;j++){var attr=attributes[j];if(attr.name.indexOf("data-ace-")===0){scriptOptions[deHyphenate(attr.name.replace(/^data-ace-/,""))]=attr.value;}}
var m=src.match(/^(.*)\/ace(\-\w+)?\.js(\?|$)/);if(m)
scriptUrl=m[1];}
if(scriptUrl){scriptOptions.base=scriptOptions.base||scriptUrl;scriptOptions.packaged=true;}
scriptOptions.basePath=scriptOptions.base;scriptOptions.workerPath=scriptOptions.workerPath||scriptOptions.base;scriptOptions.modePath=scriptOptions.modePath||scriptOptions.base;scriptOptions.themePath=scriptOptions.themePath||scriptOptions.base;delete scriptOptions.base;for(var key in scriptOptions)
if(typeof scriptOptions[key]!=="undefined")
exports.set(key,scriptOptions[key]);}
exports.init=init;function deHyphenate(str){return str.replace(/-(.)/g,function(m,m1){return m1.toUpperCase();});}});define("ace/mouse/mouse_handler",["require","exports","module","ace/lib/event","ace/lib/useragent","ace/mouse/default_handlers","ace/mouse/default_gutter_handler","ace/mouse/mouse_event","ace/mouse/dragdrop_handler","ace/config"],function(require,exports,module){"use strict";var event=require("../lib/event");var useragent=require("../lib/useragent");var DefaultHandlers=require("./default_handlers").DefaultHandlers;var DefaultGutterHandler=require("./default_gutter_handler").GutterHandler;var MouseEvent=require("./mouse_event").MouseEvent;var DragdropHandler=require("./dragdrop_handler").DragdropHandler;var config=require("../config");var MouseHandler=function(editor){var _self=this;this.editor=editor;new DefaultHandlers(this);new DefaultGutterHandler(this);new DragdropHandler(this);var focusEditor=function(e){var windowBlurred=!document.hasFocus||!document.hasFocus()||!editor.isFocused()&&document.activeElement==(editor.textInput&&editor.textInput.getElement());if(windowBlurred)
window.focus();editor.focus();};var mouseTarget=editor.renderer.getMouseEventTarget();event.addListener(mouseTarget,"click",this.onMouseEvent.bind(this,"click"));event.addListener(mouseTarget,"mousemove",this.onMouseMove.bind(this,"mousemove"));event.addMultiMouseDownListener([mouseTarget,editor.renderer.scrollBarV&&editor.renderer.scrollBarV.inner,editor.renderer.scrollBarH&&editor.renderer.scrollBarH.inner,editor.textInput&&editor.textInput.getElement()].filter(Boolean),[400,300,250],this,"onMouseEvent");event.addMouseWheelListener(editor.container,this.onMouseWheel.bind(this,"mousewheel"));event.addTouchMoveListener(editor.container,this.onTouchMove.bind(this,"touchmove"));var gutterEl=editor.renderer.$gutter;event.addListener(gutterEl,"mousedown",this.onMouseEvent.bind(this,"guttermousedown"));event.addListener(gutterEl,"click",this.onMouseEvent.bind(this,"gutterclick"));event.addListener(gutterEl,"dblclick",this.onMouseEvent.bind(this,"gutterdblclick"));event.addListener(gutterEl,"mousemove",this.onMouseEvent.bind(this,"guttermousemove"));event.addListener(mouseTarget,"mousedown",focusEditor);event.addListener(gutterEl,"mousedown",focusEditor);if(useragent.isIE&&editor.renderer.scrollBarV){event.addListener(editor.renderer.scrollBarV.element,"mousedown",focusEditor);event.addListener(editor.renderer.scrollBarH.element,"mousedown",focusEditor);}
editor.on("mousemove",function(e){if(_self.state||_self.$dragDelay||!_self.$dragEnabled)
return;var character=editor.renderer.screenToTextCoordinates(e.x,e.y);var range=editor.session.selection.getRange();var renderer=editor.renderer;if(!range.isEmpty()&&range.insideStart(character.row,character.column)){renderer.setCursorStyle("default");}else{renderer.setCursorStyle("");}});};(function(){this.onMouseEvent=function(name,e){this.editor._emit(name,new MouseEvent(e,this.editor));};this.onMouseMove=function(name,e){var listeners=this.editor._eventRegistry&&this.editor._eventRegistry.mousemove;if(!listeners||!listeners.length)
return;this.editor._emit(name,new MouseEvent(e,this.editor));};this.onMouseWheel=function(name,e){var mouseEvent=new MouseEvent(e,this.editor);mouseEvent.speed=this.$scrollSpeed*2;mouseEvent.wheelX=e.wheelX;mouseEvent.wheelY=e.wheelY;this.editor._emit(name,mouseEvent);};this.onTouchMove=function(name,e){var mouseEvent=new MouseEvent(e,this.editor);mouseEvent.speed=1;mouseEvent.wheelX=e.wheelX;mouseEvent.wheelY=e.wheelY;this.editor._emit(name,mouseEvent);};this.setState=function(state){this.state=state;};this.captureMouse=function(ev,mouseMoveHandler){this.x=ev.x;this.y=ev.y;this.isMousePressed=true;var editor=this.editor;var renderer=this.editor.renderer;if(renderer.$keepTextAreaAtCursor)
renderer.$keepTextAreaAtCursor=null;var self=this;var onMouseMove=function(e){if(!e)return;if(useragent.isWebKit&&!e.which&&self.releaseMouse)
return self.releaseMouse();self.x=e.clientX;self.y=e.clientY;mouseMoveHandler&&mouseMoveHandler(e);self.mouseEvent=new MouseEvent(e,self.editor);self.$mouseMoved=true;};var onCaptureEnd=function(e){editor.off("beforeEndOperation",onOperationEnd);clearInterval(timerId);onCaptureInterval();self[self.state+"End"]&&self[self.state+"End"](e);self.state="";if(renderer.$keepTextAreaAtCursor==null){renderer.$keepTextAreaAtCursor=true;renderer.$moveTextAreaToCursor();}
self.isMousePressed=false;self.$onCaptureMouseMove=self.releaseMouse=null;e&&self.onMouseEvent("mouseup",e);};var onCaptureInterval=function(){self[self.state]&&self[self.state]();self.$mouseMoved=false;};if(useragent.isOldIE&&ev.domEvent.type=="dblclick"){return setTimeout(function(){onCaptureEnd(ev);});}
var onOperationEnd=function(e){if(editor.curOp.command.name&&editor.curOp.selectionChanged){self[self.state+"End"]&&self[self.state+"End"]();self.state="";self.releaseMouse();}};editor.on("beforeEndOperation",onOperationEnd);self.$onCaptureMouseMove=onMouseMove;self.releaseMouse=event.capture(this.editor.container,onMouseMove,onCaptureEnd);var timerId=setInterval(onCaptureInterval,20);};this.releaseMouse=null;this.cancelContextMenu=function(){var stop=function(e){if(e&&e.domEvent&&e.domEvent.type!="contextmenu")
return;this.editor.off("nativecontextmenu",stop);if(e&&e.domEvent)
event.stopEvent(e.domEvent);}.bind(this);setTimeout(stop,10);this.editor.on("nativecontextmenu",stop);};}).call(MouseHandler.prototype);config.defineOptions(MouseHandler.prototype,"mouseHandler",{scrollSpeed:{initialValue:2},dragDelay:{initialValue:(useragent.isMac?150:0)},dragEnabled:{initialValue:true},focusTimeout:{initialValue:0},tooltipFollowsMouse:{initialValue:true}});exports.MouseHandler=MouseHandler;});define("ace/mouse/fold_handler",["require","exports","module","ace/lib/dom"],function(require,exports,module){"use strict";var dom=require("../lib/dom");function FoldHandler(editor){editor.on("click",function(e){var position=e.getDocumentPosition();var session=editor.session;var fold=session.getFoldAt(position.row,position.column,1);if(fold){if(e.getAccelKey())
session.removeFold(fold);else
session.expandFold(fold);e.stop();}
var target=e.domEvent&&e.domEvent.target;if(target&&dom.hasCssClass(target,"ace_inline_button")){if(dom.hasCssClass(target,"ace_toggle_wrap")){session.setOption("wrap",true);editor.renderer.scrollCursorIntoView();}}});editor.on("gutterclick",function(e){var gutterRegion=editor.renderer.$gutterLayer.getRegion(e);if(gutterRegion=="foldWidgets"){var row=e.getDocumentPosition().row;var session=editor.session;if(session.foldWidgets&&session.foldWidgets[row])
editor.session.onFoldWidgetClick(row,e);if(!editor.isFocused())
editor.focus();e.stop();}});editor.on("gutterdblclick",function(e){var gutterRegion=editor.renderer.$gutterLayer.getRegion(e);if(gutterRegion=="foldWidgets"){var row=e.getDocumentPosition().row;var session=editor.session;var data=session.getParentFoldRangeData(row,true);var range=data.range||data.firstRange;if(range){row=range.start.row;var fold=session.getFoldAt(row,session.getLine(row).length,1);if(fold){session.removeFold(fold);}else{session.addFold("...",range);editor.renderer.scrollCursorIntoView({row:range.start.row,column:0});}}
e.stop();}});}
exports.FoldHandler=FoldHandler;});define("ace/keyboard/keybinding",["require","exports","module","ace/lib/keys","ace/lib/event"],function(require,exports,module){"use strict";var keyUtil=require("../lib/keys");var event=require("../lib/event");var KeyBinding=function(editor){this.$editor=editor;this.$data={editor:editor};this.$handlers=[];this.setDefaultHandler(editor.commands);};(function(){this.setDefaultHandler=function(kb){this.removeKeyboardHandler(this.$defaultHandler);this.$defaultHandler=kb;this.addKeyboardHandler(kb,0);};this.setKeyboardHandler=function(kb){var h=this.$handlers;if(h[h.length-1]==kb)
return;while(h[h.length-1]&&h[h.length-1]!=this.$defaultHandler)
this.removeKeyboardHandler(h[h.length-1]);this.addKeyboardHandler(kb,1);};this.addKeyboardHandler=function(kb,pos){if(!kb)
return;if(typeof kb=="function"&&!kb.handleKeyboard)
kb.handleKeyboard=kb;var i=this.$handlers.indexOf(kb);if(i!=-1)
this.$handlers.splice(i,1);if(pos==undefined)
this.$handlers.push(kb);else
this.$handlers.splice(pos,0,kb);if(i==-1&&kb.attach)
kb.attach(this.$editor);};this.removeKeyboardHandler=function(kb){var i=this.$handlers.indexOf(kb);if(i==-1)
return false;this.$handlers.splice(i,1);kb.detach&&kb.detach(this.$editor);return true;};this.getKeyboardHandler=function(){return this.$handlers[this.$handlers.length-1];};this.getStatusText=function(){var data=this.$data;var editor=data.editor;return this.$handlers.map(function(h){return h.getStatusText&&h.getStatusText(editor,data)||"";}).filter(Boolean).join(" ");};this.$callKeyboardHandlers=function(hashId,keyString,keyCode,e){var toExecute;var success=false;var commands=this.$editor.commands;for(var i=this.$handlers.length;i--;){toExecute=this.$handlers[i].handleKeyboard(this.$data,hashId,keyString,keyCode,e);if(!toExecute||!toExecute.command)
continue;if(toExecute.command=="null"){success=true;}else{success=commands.exec(toExecute.command,this.$editor,toExecute.args,e);}
if(success&&e&&hashId!=-1&&toExecute.passEvent!=true&&toExecute.command.passEvent!=true){event.stopEvent(e);}
if(success)
break;}
if(!success&&hashId==-1){toExecute={command:"insertstring"};success=commands.exec("insertstring",this.$editor,keyString);}
if(success&&this.$editor._signal)
this.$editor._signal("keyboardActivity",toExecute);return success;};this.onCommandKey=function(e,hashId,keyCode){var keyString=keyUtil.keyCodeToString(keyCode);this.$callKeyboardHandlers(hashId,keyString,keyCode,e);};this.onTextInput=function(text){this.$callKeyboardHandlers(-1,text);};}).call(KeyBinding.prototype);exports.KeyBinding=KeyBinding;});define("ace/lib/bidiutil",["require","exports","module"],function(require,exports,module){"use strict";var ArabicAlefBetIntervalsBegine=['\u0621','\u0641'];var ArabicAlefBetIntervalsEnd=['\u063A','\u064a'];var dir=0,hiLevel=0;var lastArabic=false,hasUBAT_AL=false,hasUBAT_B=false,hasUBAT_S=false,hasBlockSep=false,hasSegSep=false;var impTab_LTR=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,0x11,2,0,1],[0,3,5,5,4,1,0],[0,3,0x15,0x15,4,0,1],[0,3,5,5,4,2,0]];var impTab_RTL=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,0x21,3,1,1]];var LTR=0,RTL=1;var L=0;var R=1;var EN=2;var AN=3;var ON=4;var B=5;var S=6;var AL=7;var WS=8;var CS=9;var ES=10;var ET=11;var NSM=12;var LRE=13;var RLE=14;var PDF=15;var LRO=16;var RLO=17;var BN=18;var UnicodeTBL00=[BN,BN,BN,BN,BN,BN,BN,BN,BN,S,B,S,WS,B,BN,BN,BN,BN,BN,BN,BN,BN,BN,BN,BN,BN,BN,BN,B,B,B,S,WS,ON,ON,ET,ET,ET,ON,ON,ON,ON,ON,ES,CS,ES,CS,CS,EN,EN,EN,EN,EN,EN,EN,EN,EN,EN,CS,ON,ON,ON,ON,ON,ON,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,ON,ON,ON,ON,ON,ON,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,ON,ON,ON,ON,BN,BN,BN,BN,BN,BN,B,BN,BN,BN,BN,BN,BN,BN,BN,BN,BN,BN,BN,BN,BN,BN,BN,BN,BN,BN,BN,BN,BN,BN,BN,BN,BN,CS,ON,ET,ET,ET,ET,ON,ON,ON,ON,L,ON,ON,BN,ON,ON,ET,ET,EN,EN,ON,L,ON,ON,ON,EN,L,ON,ON,ON,ON,ON];var UnicodeTBL20=[WS,WS,WS,WS,WS,WS,WS,WS,WS,WS,WS,BN,BN,BN,L,R,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,WS,B,LRE,RLE,PDF,LRO,RLO,CS,ET,ET,ET,ET,ET,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,CS,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,WS];function _computeLevels(chars,levels,len,charTypes){var impTab=dir?impTab_RTL:impTab_LTR,prevState=null,newClass=null,newLevel=null,newState=0,action=null,cond=null,condPos=-1,i=null,ix=null,classes=[];if(!charTypes){for(i=0,charTypes=[];i<len;i++){charTypes[i]=_getCharacterType(chars[i]);}}
hiLevel=dir;lastArabic=false;hasUBAT_AL=false;hasUBAT_B=false;hasUBAT_S=false;for(ix=0;ix<len;ix++){prevState=newState;classes[ix]=newClass=_getCharClass(chars,charTypes,classes,ix);newState=impTab[prevState][newClass];action=newState&0xF0;newState&=0x0F;levels[ix]=newLevel=impTab[newState][5];if(action>0){if(action==0x10){for(i=condPos;i<ix;i++){levels[i]=1;}
condPos=-1;}else{condPos=-1;}}
cond=impTab[newState][6];if(cond){if(condPos==-1){condPos=ix;}}else{if(condPos>-1){for(i=condPos;i<ix;i++){levels[i]=newLevel;}
condPos=-1;}}
if(charTypes[ix]==B){levels[ix]=0;}
hiLevel|=newLevel;}
if(hasUBAT_S){for(i=0;i<len;i++){if(charTypes[i]==S){levels[i]=dir;for(var j=i-1;j>=0;j--){if(charTypes[j]==WS){levels[j]=dir;}else{break;}}}}}}
function _invertLevel(lev,levels,_array){if(hiLevel<lev){return;}
if(lev==1&&dir==RTL&&!hasUBAT_B){_array.reverse();return;}
var len=_array.length,start=0,end,lo,hi,tmp;while(start<len){if(levels[start]>=lev){end=start+1;while(end<len&&levels[end]>=lev){end++;}
for(lo=start,hi=end-1;lo<hi;lo++,hi--){tmp=_array[lo];_array[lo]=_array[hi];_array[hi]=tmp;}
start=end;}
start++;}}
function _getCharClass(chars,types,classes,ix){var cType=types[ix],wType,nType,len,i;switch(cType){case L:case R:lastArabic=false;case ON:case AN:return cType;case EN:return lastArabic?AN:EN;case AL:lastArabic=true;hasUBAT_AL=true;return R;case WS:return ON;case CS:if(ix<1||(ix+1)>=types.length||((wType=classes[ix-1])!=EN&&wType!=AN)||((nType=types[ix+1])!=EN&&nType!=AN)){return ON;}
if(lastArabic){nType=AN;}
return nType==wType?nType:ON;case ES:wType=ix>0?classes[ix-1]:B;if(wType==EN&&(ix+1)<types.length&&types[ix+1]==EN){return EN;}
return ON;case ET:if(ix>0&&classes[ix-1]==EN){return EN;}
if(lastArabic){return ON;}
i=ix+1;len=types.length;while(i<len&&types[i]==ET){i++;}
if(i<len&&types[i]==EN){return EN;}
return ON;case NSM:len=types.length;i=ix+1;while(i<len&&types[i]==NSM){i++;}
if(i<len){var c=chars[ix],rtlCandidate=(c>=0x0591&&c<=0x08FF)||c==0xFB1E;wType=types[i];if(rtlCandidate&&(wType==R||wType==AL)){return R;}}
if(ix<1||(wType=types[ix-1])==B){return ON;}
return classes[ix-1];case B:lastArabic=false;hasUBAT_B=true;return dir;case S:hasUBAT_S=true;return ON;case LRE:case RLE:case LRO:case RLO:case PDF:lastArabic=false;case BN:return ON;}}
function _getCharacterType(ch){var uc=ch.charCodeAt(0),hi=uc>>8;if(hi==0){return((uc>0x00BF)?L:UnicodeTBL00[uc]);}else if(hi==5){return(/[\u0591-\u05f4]/.test(ch)?R:L);}else if(hi==6){if(/[\u0610-\u061a\u064b-\u065f\u06d6-\u06e4\u06e7-\u06ed]/.test(ch))
return NSM;else if(/[\u0660-\u0669\u066b-\u066c]/.test(ch))
return AN;else if(uc==0x066A)
return ET;else if(/[\u06f0-\u06f9]/.test(ch))
return EN;else
return AL;}else if(hi==0x20&&uc<=0x205F){return UnicodeTBL20[uc&0xFF];}else if(hi==0xFE){return(uc>=0xFE70?AL:ON);}
return ON;}
function _isArabicDiacritics(ch){return(ch>='\u064b'&&ch<='\u0655');}
exports.L=L;exports.R=R;exports.EN=EN;exports.ON_R=3;exports.AN=4;exports.R_H=5;exports.B=6;exports.DOT="\xB7";exports.doBidiReorder=function(text,textCharTypes,isRtl){if(text.length<2)
return{};var chars=text.split(""),logicalFromVisual=new Array(chars.length),bidiLevels=new Array(chars.length),levels=[];dir=isRtl?RTL:LTR;_computeLevels(chars,levels,chars.length,textCharTypes);for(var i=0;i<logicalFromVisual.length;logicalFromVisual[i]=i,i++);_invertLevel(2,levels,logicalFromVisual);_invertLevel(1,levels,logicalFromVisual);for(var i=0;i<logicalFromVisual.length-1;i++){if(textCharTypes[i]===AN){levels[i]=exports.AN;}else if(levels[i]===R&&((textCharTypes[i]>AL&&textCharTypes[i]<LRE)||textCharTypes[i]===ON||textCharTypes[i]===BN)){levels[i]=exports.ON_R;}else if((i>0&&chars[i-1]==='\u0644')&&/\u0622|\u0623|\u0625|\u0627/.test(chars[i])){levels[i-1]=levels[i]=exports.R_H;i++;}}
if(chars[chars.length-1]===exports.DOT)
levels[chars.length-1]=exports.B;for(var i=0;i<logicalFromVisual.length;i++){bidiLevels[i]=levels[logicalFromVisual[i]];}
return{'logicalFromVisual':logicalFromVisual,'bidiLevels':bidiLevels};};exports.hasBidiCharacters=function(text,textCharTypes){var ret=false;for(var i=0;i<text.length;i++){textCharTypes[i]=_getCharacterType(text.charAt(i));if(!ret&&(textCharTypes[i]==R||textCharTypes[i]==AL))
ret=true;}
return ret;};exports.getVisualFromLogicalIdx=function(logIdx,rowMap){for(var i=0;i<rowMap.logicalFromVisual.length;i++){if(rowMap.logicalFromVisual[i]==logIdx)
return i;}
return 0;};});define("ace/bidihandler",["require","exports","module","ace/lib/bidiutil","ace/lib/lang","ace/lib/useragent"],function(require,exports,module){"use strict";var bidiUtil=require("./lib/bidiutil");var lang=require("./lib/lang");var useragent=require("./lib/useragent");var bidiRE=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;var BidiHandler=function(session){this.session=session;this.bidiMap={};this.currentRow=null;this.bidiUtil=bidiUtil;this.charWidths=[];this.EOL="\xAC";this.showInvisibles=true;this.isRtlDir=false;this.line="";this.wrapIndent=0;this.isLastRow=false;this.EOF="\xB6";this.seenBidi=false;};(function(){this.isBidiRow=function(screenRow,docRow,splitIndex){if(!this.seenBidi)
return false;if(screenRow!==this.currentRow){this.currentRow=screenRow;this.updateRowLine(docRow,splitIndex);this.updateBidiMap();}
return this.bidiMap.bidiLevels;};this.onChange=function(delta){if(!this.seenBidi){if(delta.action=="insert"&&bidiRE.test(delta.lines.join("\n"))){this.seenBidi=true;this.currentRow=null;}}
else{this.currentRow=null;}};this.getDocumentRow=function(){var docRow=0;var rowCache=this.session.$screenRowCache;if(rowCache.length){var index=this.session.$getRowCacheIndex(rowCache,this.currentRow);if(index>=0)
docRow=this.session.$docRowCache[index];}
return docRow;};this.getSplitIndex=function(){var splitIndex=0;var rowCache=this.session.$screenRowCache;if(rowCache.length){var currentIndex,prevIndex=this.session.$getRowCacheIndex(rowCache,this.currentRow);while(this.currentRow-splitIndex>0){currentIndex=this.session.$getRowCacheIndex(rowCache,this.currentRow-splitIndex-1);if(currentIndex!==prevIndex)
break;prevIndex=currentIndex;splitIndex++;}}
return splitIndex;};this.updateRowLine=function(docRow,splitIndex){if(docRow===undefined)
docRow=this.getDocumentRow();this.wrapIndent=0;this.isLastRow=(docRow===this.session.getLength()-1);this.line=this.session.getLine(docRow);if(this.session.$useWrapMode){var splits=this.session.$wrapData[docRow];if(splits){if(splitIndex===undefined)
splitIndex=this.getSplitIndex();if(splitIndex>0&&splits.length){this.wrapIndent=splits.indent;this.line=(splitIndex<splits.length)?this.line.substring(splits[splitIndex-1],splits[splits.length-1]):this.line.substring(splits[splits.length-1]);}else{this.line=this.line.substring(0,splits[splitIndex]);}}}
var session=this.session,shift=0,size;this.line=this.line.replace(/\t|[\u1100-\u2029, \u202F-\uFFE6]/g,function(ch,i){if(ch==='\t'||session.isFullWidth(ch.charCodeAt(0))){size=(ch==='\t')?session.getScreenTabSize(i+shift):2;shift+=size-1;return lang.stringRepeat(bidiUtil.DOT,size);}
return ch;});};this.updateBidiMap=function(){var textCharTypes=[],endOfLine=this.isLastRow?this.EOF:this.EOL;var line=this.line+(this.showInvisibles?endOfLine:bidiUtil.DOT);if(bidiUtil.hasBidiCharacters(line,textCharTypes)){this.bidiMap=bidiUtil.doBidiReorder(line,textCharTypes,this.isRtlDir);}else{this.bidiMap={};}};this.markAsDirty=function(){this.currentRow=null;};this.updateCharacterWidths=function(fontMetrics){if(!this.seenBidi)
return;if(this.characterWidth===fontMetrics.$characterSize.width)
return;var characterWidth=this.characterWidth=fontMetrics.$characterSize.width;var bidiCharWidth=fontMetrics.$measureCharWidth("\u05d4");this.charWidths[bidiUtil.L]=this.charWidths[bidiUtil.EN]=this.charWidths[bidiUtil.ON_R]=characterWidth;this.charWidths[bidiUtil.R]=this.charWidths[bidiUtil.AN]=bidiCharWidth;this.charWidths[bidiUtil.R_H]=useragent.isChrome?bidiCharWidth:bidiCharWidth*0.45;this.charWidths[bidiUtil.B]=0;this.currentRow=null;};this.getShowInvisibles=function(){return this.showInvisibles;};this.setShowInvisibles=function(showInvisibles){this.showInvisibles=showInvisibles;this.currentRow=null;};this.setEolChar=function(eolChar){this.EOL=eolChar;};this.setTextDir=function(isRtlDir){this.isRtlDir=isRtlDir;};this.getPosLeft=function(col){col-=this.wrapIndent;var visualIdx=bidiUtil.getVisualFromLogicalIdx(col>0?col-1:0,this.bidiMap),levels=this.bidiMap.bidiLevels,left=0;if(col===0&&levels[visualIdx]%2!==0)
visualIdx++;for(var i=0;i<visualIdx;i++){left+=this.charWidths[levels[i]];}
if(col!==0&&levels[visualIdx]%2===0)
left+=this.charWidths[levels[visualIdx]];if(this.wrapIndent)
left+=this.wrapIndent*this.charWidths[bidiUtil.L];return left;};this.getSelections=function(startCol,endCol){var map=this.bidiMap,levels=map.bidiLevels,level,offset=this.wrapIndent*this.charWidths[bidiUtil.L],selections=[],selColMin=Math.min(startCol,endCol)-this.wrapIndent,selColMax=Math.max(startCol,endCol)-this.wrapIndent,isSelected=false,isSelectedPrev=false,selectionStart=0;for(var logIdx,visIdx=0;visIdx<levels.length;visIdx++){logIdx=map.logicalFromVisual[visIdx];level=levels[visIdx];isSelected=(logIdx>=selColMin)&&(logIdx<selColMax);if(isSelected&&!isSelectedPrev){selectionStart=offset;}else if(!isSelected&&isSelectedPrev){selections.push({left:selectionStart,width:offset-selectionStart});}
offset+=this.charWidths[level];isSelectedPrev=isSelected;}
if(isSelected&&(visIdx===levels.length)){selections.push({left:selectionStart,width:offset-selectionStart});}
return selections;};this.offsetToCol=function(posX){var logicalIdx=0,posX=Math.max(posX,0),offset=0,visualIdx=0,levels=this.bidiMap.bidiLevels,charWidth=this.charWidths[levels[visualIdx]];if(this.wrapIndent){posX-=this.wrapIndent*this.charWidths[bidiUtil.L];}
while(posX>offset+charWidth/2){offset+=charWidth;if(visualIdx===levels.length-1){charWidth=0;break;}
charWidth=this.charWidths[levels[++visualIdx]];}
if(visualIdx>0&&(levels[visualIdx-1]%2!==0)&&(levels[visualIdx]%2===0)){if(posX<offset)
visualIdx--;logicalIdx=this.bidiMap.logicalFromVisual[visualIdx];}else if(visualIdx>0&&(levels[visualIdx-1]%2===0)&&(levels[visualIdx]%2!==0)){logicalIdx=1+((posX>offset)?this.bidiMap.logicalFromVisual[visualIdx]:this.bidiMap.logicalFromVisual[visualIdx-1]);}else if((this.isRtlDir&&visualIdx===levels.length-1&&charWidth===0&&(levels[visualIdx-1]%2===0))||(!this.isRtlDir&&visualIdx===0&&(levels[visualIdx]%2!==0))){logicalIdx=1+this.bidiMap.logicalFromVisual[visualIdx];}else{if(visualIdx>0&&(levels[visualIdx-1]%2!==0)&&charWidth!==0)
visualIdx--;logicalIdx=this.bidiMap.logicalFromVisual[visualIdx];}
return(logicalIdx+this.wrapIndent);};}).call(BidiHandler.prototype);exports.BidiHandler=BidiHandler;});define("ace/selection",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/lib/event_emitter","ace/range"],function(require,exports,module){"use strict";var oop=require("./lib/oop");var lang=require("./lib/lang");var EventEmitter=require("./lib/event_emitter").EventEmitter;var Range=require("./range").Range;var Selection=function(session){this.session=session;this.doc=session.getDocument();this.clearSelection();this.cursor=this.lead=this.doc.createAnchor(0,0);this.anchor=this.doc.createAnchor(0,0);this.$silent=false;var self=this;this.cursor.on("change",function(e){self.$cursorChanged=true;if(!self.$silent)
self._emit("changeCursor");if(!self.$isEmpty&&!self.$silent)
self._emit("changeSelection");if(!self.$keepDesiredColumnOnChange&&e.old.column!=e.value.column)
self.$desiredColumn=null;});this.anchor.on("change",function(){self.$anchorChanged=true;if(!self.$isEmpty&&!self.$silent)
self._emit("changeSelection");});};(function(){oop.implement(this,EventEmitter);this.isEmpty=function(){return this.$isEmpty||(this.anchor.row==this.lead.row&&this.anchor.column==this.lead.column);};this.isMultiLine=function(){return!this.$isEmpty&&this.anchor.row!=this.cursor.row;};this.getCursor=function(){return this.lead.getPosition();};this.setSelectionAnchor=function(row,column){this.$isEmpty=false;this.anchor.setPosition(row,column);};this.getAnchor=this.getSelectionAnchor=function(){if(this.$isEmpty)
return this.getSelectionLead();return this.anchor.getPosition();};this.getSelectionLead=function(){return this.lead.getPosition();};this.isBackwards=function(){var anchor=this.anchor;var lead=this.lead;return(anchor.row>lead.row||(anchor.row==lead.row&&anchor.column>lead.column));};this.getRange=function(){var anchor=this.anchor;var lead=this.lead;if(this.$isEmpty)
return Range.fromPoints(lead,lead);return this.isBackwards()?Range.fromPoints(lead,anchor):Range.fromPoints(anchor,lead);};this.clearSelection=function(){if(!this.$isEmpty){this.$isEmpty=true;this._emit("changeSelection");}};this.selectAll=function(){this.$setSelection(0,0,Number.MAX_VALUE,Number.MAX_VALUE);};this.setRange=this.setSelectionRange=function(range,reverse){var start=reverse?range.end:range.start;var end=reverse?range.start:range.end;this.$setSelection(start.row,start.column,end.row,end.column);};this.$setSelection=function(anchorRow,anchorColumn,cursorRow,cursorColumn){var wasEmpty=this.$isEmpty;this.$silent=true;this.$cursorChanged=this.$anchorChanged=false;this.anchor.setPosition(anchorRow,anchorColumn);this.cursor.setPosition(cursorRow,cursorColumn);this.$isEmpty=!Range.comparePoints(this.anchor,this.cursor);this.$silent=false;if(this.$cursorChanged)
this._emit("changeCursor");if(this.$cursorChanged||this.$anchorChanged)
this._emit("changeSelection");};this.$moveSelection=function(mover){var lead=this.lead;if(this.$isEmpty)
this.setSelectionAnchor(lead.row,lead.column);mover.call(this);};this.selectTo=function(row,column){this.$moveSelection(function(){this.moveCursorTo(row,column);});};this.selectToPosition=function(pos){this.$moveSelection(function(){this.moveCursorToPosition(pos);});};this.moveTo=function(row,column){this.clearSelection();this.moveCursorTo(row,column);};this.moveToPosition=function(pos){this.clearSelection();this.moveCursorToPosition(pos);};this.selectUp=function(){this.$moveSelection(this.moveCursorUp);};this.selectDown=function(){this.$moveSelection(this.moveCursorDown);};this.selectRight=function(){this.$moveSelection(this.moveCursorRight);};this.selectLeft=function(){this.$moveSelection(this.moveCursorLeft);};this.selectLineStart=function(){this.$moveSelection(this.moveCursorLineStart);};this.selectLineEnd=function(){this.$moveSelection(this.moveCursorLineEnd);};this.selectFileEnd=function(){this.$moveSelection(this.moveCursorFileEnd);};this.selectFileStart=function(){this.$moveSelection(this.moveCursorFileStart);};this.selectWordRight=function(){this.$moveSelection(this.moveCursorWordRight);};this.selectWordLeft=function(){this.$moveSelection(this.moveCursorWordLeft);};this.getWordRange=function(row,column){if(typeof column=="undefined"){var cursor=row||this.lead;row=cursor.row;column=cursor.column;}
return this.session.getWordRange(row,column);};this.selectWord=function(){this.setSelectionRange(this.getWordRange());};this.selectAWord=function(){var cursor=this.getCursor();var range=this.session.getAWordRange(cursor.row,cursor.column);this.setSelectionRange(range);};this.getLineRange=function(row,excludeLastChar){var rowStart=typeof row=="number"?row:this.lead.row;var rowEnd;var foldLine=this.session.getFoldLine(rowStart);if(foldLine){rowStart=foldLine.start.row;rowEnd=foldLine.end.row;}else{rowEnd=rowStart;}
if(excludeLastChar===true)
return new Range(rowStart,0,rowEnd,this.session.getLine(rowEnd).length);else
return new Range(rowStart,0,rowEnd+1,0);};this.selectLine=function(){this.setSelectionRange(this.getLineRange());};this.moveCursorUp=function(){this.moveCursorBy(-1,0);};this.moveCursorDown=function(){this.moveCursorBy(1,0);};this.wouldMoveIntoSoftTab=function(cursor,tabSize,direction){var start=cursor.column;var end=cursor.column+tabSize;if(direction<0){start=cursor.column-tabSize;end=cursor.column;}
return this.session.isTabStop(cursor)&&this.doc.getLine(cursor.row).slice(start,end).split(" ").length-1==tabSize;};this.moveCursorLeft=function(){var cursor=this.lead.getPosition(),fold;if(fold=this.session.getFoldAt(cursor.row,cursor.column,-1)){this.moveCursorTo(fold.start.row,fold.start.column);}else if(cursor.column===0){if(cursor.row>0){this.moveCursorTo(cursor.row-1,this.doc.getLine(cursor.row-1).length);}}
else{var tabSize=this.session.getTabSize();if(this.wouldMoveIntoSoftTab(cursor,tabSize,-1)&&!this.session.getNavigateWithinSoftTabs()){this.moveCursorBy(0,-tabSize);}else{this.moveCursorBy(0,-1);}}};this.moveCursorRight=function(){var cursor=this.lead.getPosition(),fold;if(fold=this.session.getFoldAt(cursor.row,cursor.column,1)){this.moveCursorTo(fold.end.row,fold.end.column);}
else if(this.lead.column==this.doc.getLine(this.lead.row).length){if(this.lead.row<this.doc.getLength()-1){this.moveCursorTo(this.lead.row+1,0);}}
else{var tabSize=this.session.getTabSize();var cursor=this.lead;if(this.wouldMoveIntoSoftTab(cursor,tabSize,1)&&!this.session.getNavigateWithinSoftTabs()){this.moveCursorBy(0,tabSize);}else{this.moveCursorBy(0,1);}}};this.moveCursorLineStart=function(){var row=this.lead.row;var column=this.lead.column;var screenRow=this.session.documentToScreenRow(row,column);var firstColumnPosition=this.session.screenToDocumentPosition(screenRow,0);var beforeCursor=this.session.getDisplayLine(row,null,firstColumnPosition.row,firstColumnPosition.column);var leadingSpace=beforeCursor.match(/^\s*/);if(leadingSpace[0].length!=column&&!this.session.$useEmacsStyleLineStart)
firstColumnPosition.column+=leadingSpace[0].length;this.moveCursorToPosition(firstColumnPosition);};this.moveCursorLineEnd=function(){var lead=this.lead;var lineEnd=this.session.getDocumentLastRowColumnPosition(lead.row,lead.column);if(this.lead.column==lineEnd.column){var line=this.session.getLine(lineEnd.row);if(lineEnd.column==line.length){var textEnd=line.search(/\s+$/);if(textEnd>0)
lineEnd.column=textEnd;}}
this.moveCursorTo(lineEnd.row,lineEnd.column);};this.moveCursorFileEnd=function(){var row=this.doc.getLength()-1;var column=this.doc.getLine(row).length;this.moveCursorTo(row,column);};this.moveCursorFileStart=function(){this.moveCursorTo(0,0);};this.moveCursorLongWordRight=function(){var row=this.lead.row;var column=this.lead.column;var line=this.doc.getLine(row);var rightOfCursor=line.substring(column);this.session.nonTokenRe.lastIndex=0;this.session.tokenRe.lastIndex=0;var fold=this.session.getFoldAt(row,column,1);if(fold){this.moveCursorTo(fold.end.row,fold.end.column);return;}
if(this.session.nonTokenRe.exec(rightOfCursor)){column+=this.session.nonTokenRe.lastIndex;this.session.nonTokenRe.lastIndex=0;rightOfCursor=line.substring(column);}
if(column>=line.length){this.moveCursorTo(row,line.length);this.moveCursorRight();if(row<this.doc.getLength()-1)
this.moveCursorWordRight();return;}
if(this.session.tokenRe.exec(rightOfCursor)){column+=this.session.tokenRe.lastIndex;this.session.tokenRe.lastIndex=0;}
this.moveCursorTo(row,column);};this.moveCursorLongWordLeft=function(){var row=this.lead.row;var column=this.lead.column;var fold;if(fold=this.session.getFoldAt(row,column,-1)){this.moveCursorTo(fold.start.row,fold.start.column);return;}
var str=this.session.getFoldStringAt(row,column,-1);if(str==null){str=this.doc.getLine(row).substring(0,column);}
var leftOfCursor=lang.stringReverse(str);this.session.nonTokenRe.lastIndex=0;this.session.tokenRe.lastIndex=0;if(this.session.nonTokenRe.exec(leftOfCursor)){column-=this.session.nonTokenRe.lastIndex;leftOfCursor=leftOfCursor.slice(this.session.nonTokenRe.lastIndex);this.session.nonTokenRe.lastIndex=0;}
if(column<=0){this.moveCursorTo(row,0);this.moveCursorLeft();if(row>0)
this.moveCursorWordLeft();return;}
if(this.session.tokenRe.exec(leftOfCursor)){column-=this.session.tokenRe.lastIndex;this.session.tokenRe.lastIndex=0;}
this.moveCursorTo(row,column);};this.$shortWordEndIndex=function(rightOfCursor){var index=0,ch;var whitespaceRe=/\s/;var tokenRe=this.session.tokenRe;tokenRe.lastIndex=0;if(this.session.tokenRe.exec(rightOfCursor)){index=this.session.tokenRe.lastIndex;}else{while((ch=rightOfCursor[index])&&whitespaceRe.test(ch))
index++;if(index<1){tokenRe.lastIndex=0;while((ch=rightOfCursor[index])&&!tokenRe.test(ch)){tokenRe.lastIndex=0;index++;if(whitespaceRe.test(ch)){if(index>2){index--;break;}else{while((ch=rightOfCursor[index])&&whitespaceRe.test(ch))
index++;if(index>2)
break;}}}}}
tokenRe.lastIndex=0;return index;};this.moveCursorShortWordRight=function(){var row=this.lead.row;var column=this.lead.column;var line=this.doc.getLine(row);var rightOfCursor=line.substring(column);var fold=this.session.getFoldAt(row,column,1);if(fold)
return this.moveCursorTo(fold.end.row,fold.end.column);if(column==line.length){var l=this.doc.getLength();do{row++;rightOfCursor=this.doc.getLine(row);}while(row<l&&/^\s*$/.test(rightOfCursor));if(!/^\s+/.test(rightOfCursor))
rightOfCursor="";column=0;}
var index=this.$shortWordEndIndex(rightOfCursor);this.moveCursorTo(row,column+index);};this.moveCursorShortWordLeft=function(){var row=this.lead.row;var column=this.lead.column;var fold;if(fold=this.session.getFoldAt(row,column,-1))
return this.moveCursorTo(fold.start.row,fold.start.column);var line=this.session.getLine(row).substring(0,column);if(column===0){do{row--;line=this.doc.getLine(row);}while(row>0&&/^\s*$/.test(line));column=line.length;if(!/\s+$/.test(line))
line="";}
var leftOfCursor=lang.stringReverse(line);var index=this.$shortWordEndIndex(leftOfCursor);return this.moveCursorTo(row,column-index);};this.moveCursorWordRight=function(){if(this.session.$selectLongWords)
this.moveCursorLongWordRight();else
this.moveCursorShortWordRight();};this.moveCursorWordLeft=function(){if(this.session.$selectLongWords)
this.moveCursorLongWordLeft();else
this.moveCursorShortWordLeft();};this.moveCursorBy=function(rows,chars){var screenPos=this.session.documentToScreenPosition(this.lead.row,this.lead.column);var offsetX;if(chars===0){if(rows!==0){if(this.session.$bidiHandler.isBidiRow(screenPos.row,this.lead.row)){offsetX=this.session.$bidiHandler.getPosLeft(screenPos.column);screenPos.column=Math.round(offsetX/this.session.$bidiHandler.charWidths[0]);}else{offsetX=screenPos.column*this.session.$bidiHandler.charWidths[0];}}
if(this.$desiredColumn)
screenPos.column=this.$desiredColumn;else
this.$desiredColumn=screenPos.column;}
var docPos=this.session.screenToDocumentPosition(screenPos.row+rows,screenPos.column,offsetX);if(rows!==0&&chars===0&&docPos.row===this.lead.row&&docPos.column===this.lead.column){if(this.session.lineWidgets&&this.session.lineWidgets[docPos.row]){if(docPos.row>0||rows>0)
docPos.row++;}}
this.moveCursorTo(docPos.row,docPos.column+chars,chars===0);};this.moveCursorToPosition=function(position){this.moveCursorTo(position.row,position.column);};this.moveCursorTo=function(row,column,keepDesiredColumn){var fold=this.session.getFoldAt(row,column,1);if(fold){row=fold.start.row;column=fold.start.column;}
this.$keepDesiredColumnOnChange=true;var line=this.session.getLine(row);if(/[\uDC00-\uDFFF]/.test(line.charAt(column))&&line.charAt(column-1)){if(this.lead.row==row&&this.lead.column==column+1)
column=column-1;else
column=column+1;}
this.lead.setPosition(row,column);this.$keepDesiredColumnOnChange=false;if(!keepDesiredColumn)
this.$desiredColumn=null;};this.moveCursorToScreen=function(row,column,keepDesiredColumn){var pos=this.session.screenToDocumentPosition(row,column);this.moveCursorTo(pos.row,pos.column,keepDesiredColumn);};this.detach=function(){this.lead.detach();this.anchor.detach();this.session=this.doc=null;};this.fromOrientedRange=function(range){this.setSelectionRange(range,range.cursor==range.start);this.$desiredColumn=range.desiredColumn||this.$desiredColumn;};this.toOrientedRange=function(range){var r=this.getRange();if(range){range.start.column=r.start.column;range.start.row=r.start.row;range.end.column=r.end.column;range.end.row=r.end.row;}else{range=r;}
range.cursor=this.isBackwards()?range.start:range.end;range.desiredColumn=this.$desiredColumn;return range;};this.getRangeOfMovements=function(func){var start=this.getCursor();try{func(this);var end=this.getCursor();return Range.fromPoints(start,end);}catch(e){return Range.fromPoints(start,start);}finally{this.moveCursorToPosition(start);}};this.toJSON=function(){if(this.rangeCount){var data=this.ranges.map(function(r){var r1=r.clone();r1.isBackwards=r.cursor==r.start;return r1;});}else{var data=this.getRange();data.isBackwards=this.isBackwards();}
return data;};this.fromJSON=function(data){if(data.start==undefined){if(this.rangeList){this.toSingleRange(data[0]);for(var i=data.length;i--;){var r=Range.fromPoints(data[i].start,data[i].end);if(data[i].isBackwards)
r.cursor=r.start;this.addRange(r,true);}
return;}else{data=data[0];}}
if(this.rangeList)
this.toSingleRange(data);this.setSelectionRange(data,data.isBackwards);};this.isEqual=function(data){if((data.length||this.rangeCount)&&data.length!=this.rangeCount)
return false;if(!data.length||!this.ranges)
return this.getRange().isEqual(data);for(var i=this.ranges.length;i--;){if(!this.ranges[i].isEqual(data[i]))
return false;}
return true;};}).call(Selection.prototype);exports.Selection=Selection;});define("ace/tokenizer",["require","exports","module","ace/config"],function(require,exports,module){"use strict";var config=require("./config");var MAX_TOKEN_COUNT=2000;var Tokenizer=function(rules){this.states=rules;this.regExps={};this.matchMappings={};for(var key in this.states){var state=this.states[key];var ruleRegExps=[];var matchTotal=0;var mapping=this.matchMappings[key]={defaultToken:"text"};var flag="g";var splitterRurles=[];for(var i=0;i<state.length;i++){var rule=state[i];if(rule.defaultToken)
mapping.defaultToken=rule.defaultToken;if(rule.caseInsensitive)
flag="gi";if(rule.regex==null)
continue;if(rule.regex instanceof RegExp)
rule.regex=rule.regex.toString().slice(1,-1);var adjustedregex=rule.regex;var matchcount=new RegExp("(?:("+adjustedregex+")|(.))").exec("a").length-2;if(Array.isArray(rule.token)){if(rule.token.length==1||matchcount==1){rule.token=rule.token[0];}else if(matchcount-1!=rule.token.length){this.reportError("number of classes and regexp groups doesn't match",{rule:rule,groupCount:matchcount-1});rule.token=rule.token[0];}else{rule.tokenArray=rule.token;rule.token=null;rule.onMatch=this.$arrayTokens;}}else if(typeof rule.token=="function"&&!rule.onMatch){if(matchcount>1)
rule.onMatch=this.$applyToken;else
rule.onMatch=rule.token;}
if(matchcount>1){if(/\\\d/.test(rule.regex)){adjustedregex=rule.regex.replace(/\\([0-9]+)/g,function(match,digit){return"\\"+(parseInt(digit,10)+matchTotal+1);});}else{matchcount=1;adjustedregex=this.removeCapturingGroups(rule.regex);}
if(!rule.splitRegex&&typeof rule.token!="string")
splitterRurles.push(rule);}
mapping[matchTotal]=i;matchTotal+=matchcount;ruleRegExps.push(adjustedregex);if(!rule.onMatch)
rule.onMatch=null;}
if(!ruleRegExps.length){mapping[0]=0;ruleRegExps.push("$");}
splitterRurles.forEach(function(rule){rule.splitRegex=this.createSplitterRegexp(rule.regex,flag);},this);this.regExps[key]=new RegExp("("+ruleRegExps.join(")|(")+")|($)",flag);}};(function(){this.$setMaxTokenCount=function(m){MAX_TOKEN_COUNT=m|0;};this.$applyToken=function(str){var values=this.splitRegex.exec(str).slice(1);var types=this.token.apply(this,values);if(typeof types==="string")
return[{type:types,value:str}];var tokens=[];for(var i=0,l=types.length;i<l;i++){if(values[i])
tokens[tokens.length]={type:types[i],value:values[i]};}
return tokens;};this.$arrayTokens=function(str){if(!str)
return[];var values=this.splitRegex.exec(str);if(!values)
return"text";var tokens=[];var types=this.tokenArray;for(var i=0,l=types.length;i<l;i++){if(values[i+1])
tokens[tokens.length]={type:types[i],value:values[i+1]};}
return tokens;};this.removeCapturingGroups=function(src){var r=src.replace(/\[(?:\\.|[^\]])*?\]|\\.|\(\?[:=!]|(\()/g,function(x,y){return y?"(?:":x;});return r;};this.createSplitterRegexp=function(src,flag){if(src.indexOf("(?=")!=-1){var stack=0;var inChClass=false;var lastCapture={};src.replace(/(\\.)|(\((?:\?[=!])?)|(\))|([\[\]])/g,function(m,esc,parenOpen,parenClose,square,index){if(inChClass){inChClass=square!="]";}else if(square){inChClass=true;}else if(parenClose){if(stack==lastCapture.stack){lastCapture.end=index+1;lastCapture.stack=-1;}
stack--;}else if(parenOpen){stack++;if(parenOpen.length!=1){lastCapture.stack=stack;lastCapture.start=index;}}
return m;});if(lastCapture.end!=null&&/^\)*$/.test(src.substr(lastCapture.end)))
src=src.substring(0,lastCapture.start)+src.substr(lastCapture.end);}
if(src.charAt(0)!="^")src="^"+src;if(src.charAt(src.length-1)!="$")src+="$";return new RegExp(src,(flag||"").replace("g",""));};this.getLineTokens=function(line,startState){if(startState&&typeof startState!="string"){var stack=startState.slice(0);startState=stack[0];if(startState==="#tmp"){stack.shift();startState=stack.shift();}}else
var stack=[];var currentState=startState||"start";var state=this.states[currentState];if(!state){currentState="start";state=this.states[currentState];}
var mapping=this.matchMappings[currentState];var re=this.regExps[currentState];re.lastIndex=0;var match,tokens=[];var lastIndex=0;var matchAttempts=0;var token={type:null,value:""};while(match=re.exec(line)){var type=mapping.defaultToken;var rule=null;var value=match[0];var index=re.lastIndex;if(index-value.length>lastIndex){var skipped=line.substring(lastIndex,index-value.length);if(token.type==type){token.value+=skipped;}else{if(token.type)
tokens.push(token);token={type:type,value:skipped};}}
for(var i=0;i<match.length-2;i++){if(match[i+1]===undefined)
continue;rule=state[mapping[i]];if(rule.onMatch)
type=rule.onMatch(value,currentState,stack,line);else
type=rule.token;if(rule.next){if(typeof rule.next=="string"){currentState=rule.next;}else{currentState=rule.next(currentState,stack);}
state=this.states[currentState];if(!state){this.reportError("state doesn't exist",currentState);currentState="start";state=this.states[currentState];}
mapping=this.matchMappings[currentState];lastIndex=index;re=this.regExps[currentState];re.lastIndex=index;}
if(rule.consumeLineEnd)
lastIndex=index;break;}
if(value){if(typeof type==="string"){if((!rule||rule.merge!==false)&&token.type===type){token.value+=value;}else{if(token.type)
tokens.push(token);token={type:type,value:value};}}else if(type){if(token.type)
tokens.push(token);token={type:null,value:""};for(var i=0;i<type.length;i++)
tokens.push(type[i]);}}
if(lastIndex==line.length)
break;lastIndex=index;if(matchAttempts++>MAX_TOKEN_COUNT){if(matchAttempts>2*line.length){this.reportError("infinite loop with in ace tokenizer",{startState:startState,line:line});}
while(lastIndex<line.length){if(token.type)
tokens.push(token);token={value:line.substring(lastIndex,lastIndex+=2000),type:"overflow"};}
currentState="start";stack=[];break;}}
if(token.type)
tokens.push(token);if(stack.length>1){if(stack[0]!==currentState)
stack.unshift("#tmp",currentState);}
return{tokens:tokens,state:stack.length?stack:currentState};};this.reportError=config.reportError;}).call(Tokenizer.prototype);exports.Tokenizer=Tokenizer;});define("ace/mode/text_highlight_rules",["require","exports","module","ace/lib/lang"],function(require,exports,module){"use strict";var lang=require("../lib/lang");var TextHighlightRules=function(){this.$rules={"start":[{token:"empty_line",regex:'^$'},{defaultToken:"text"}]};};(function(){this.addRules=function(rules,prefix){if(!prefix){for(var key in rules)
this.$rules[key]=rules[key];return;}
for(var key in rules){var state=rules[key];for(var i=0;i<state.length;i++){var rule=state[i];if(rule.next||rule.onMatch){if(typeof rule.next=="string"){if(rule.next.indexOf(prefix)!==0)
rule.next=prefix+rule.next;}
if(rule.nextState&&rule.nextState.indexOf(prefix)!==0)
rule.nextState=prefix+rule.nextState;}}
this.$rules[prefix+key]=state;}};this.getRules=function(){return this.$rules;};this.embedRules=function(HighlightRules,prefix,escapeRules,states,append){var embedRules=typeof HighlightRules=="function"?new HighlightRules().getRules():HighlightRules;if(states){for(var i=0;i<states.length;i++)
states[i]=prefix+states[i];}else{states=[];for(var key in embedRules)
states.push(prefix+key);}
this.addRules(embedRules,prefix);if(escapeRules){var addRules=Array.prototype[append?"push":"unshift"];for(var i=0;i<states.length;i++)
addRules.apply(this.$rules[states[i]],lang.deepCopy(escapeRules));}
if(!this.$embeds)
this.$embeds=[];this.$embeds.push(prefix);};this.getEmbeds=function(){return this.$embeds;};var pushState=function(currentState,stack){if(currentState!="start"||stack.length)
stack.unshift(this.nextState,currentState);return this.nextState;};var popState=function(currentState,stack){stack.shift();return stack.shift()||"start";};this.normalizeRules=function(){var id=0;var rules=this.$rules;function processState(key){var state=rules[key];state.processed=true;for(var i=0;i<state.length;i++){var rule=state[i];var toInsert=null;if(Array.isArray(rule)){toInsert=rule;rule={};}
if(!rule.regex&&rule.start){rule.regex=rule.start;if(!rule.next)
rule.next=[];rule.next.push({defaultToken:rule.token},{token:rule.token+".end",regex:rule.end||rule.start,next:"pop"});rule.token=rule.token+".start";rule.push=true;}
var next=rule.next||rule.push;if(next&&Array.isArray(next)){var stateName=rule.stateName;if(!stateName){stateName=rule.token;if(typeof stateName!="string")
stateName=stateName[0]||"";if(rules[stateName])
stateName+=id++;}
rules[stateName]=next;rule.next=stateName;processState(stateName);}else if(next=="pop"){rule.next=popState;}
if(rule.push){rule.nextState=rule.next||rule.push;rule.next=pushState;delete rule.push;}
if(rule.rules){for(var r in rule.rules){if(rules[r]){if(rules[r].push)
rules[r].push.apply(rules[r],rule.rules[r]);}else{rules[r]=rule.rules[r];}}}
var includeName=typeof rule=="string"?rule:rule.include;if(includeName){if(Array.isArray(includeName))
toInsert=includeName.map(function(x){return rules[x];});else
toInsert=rules[includeName];}
if(toInsert){var args=[i,1].concat(toInsert);if(rule.noEscape)
args=args.filter(function(x){return!x.next;});state.splice.apply(state,args);i--;}
if(rule.keywordMap){rule.token=this.createKeywordMapper(rule.keywordMap,rule.defaultToken||"text",rule.caseInsensitive);delete rule.defaultToken;}}}
Object.keys(rules).forEach(processState,this);};this.createKeywordMapper=function(map,defaultToken,ignoreCase,splitChar){var keywords=Object.create(null);Object.keys(map).forEach(function(className){var a=map[className];if(ignoreCase)
a=a.toLowerCase();var list=a.split(splitChar||"|");for(var i=list.length;i--;)
keywords[list[i]]=className;});if(Object.getPrototypeOf(keywords)){keywords.__proto__=null;}
this.$keywordList=Object.keys(keywords);map=null;return ignoreCase?function(value){return keywords[value.toLowerCase()]||defaultToken;}:function(value){return keywords[value]||defaultToken;};};this.getKeywords=function(){return this.$keywords;};}).call(TextHighlightRules.prototype);exports.TextHighlightRules=TextHighlightRules;});define("ace/mode/behaviour",["require","exports","module"],function(require,exports,module){"use strict";var Behaviour=function(){this.$behaviours={};};(function(){this.add=function(name,action,callback){switch(undefined){case this.$behaviours:this.$behaviours={};case this.$behaviours[name]:this.$behaviours[name]={};}
this.$behaviours[name][action]=callback;};this.addBehaviours=function(behaviours){for(var key in behaviours){for(var action in behaviours[key]){this.add(key,action,behaviours[key][action]);}}};this.remove=function(name){if(this.$behaviours&&this.$behaviours[name]){delete this.$behaviours[name];}};this.inherit=function(mode,filter){if(typeof mode==="function"){var behaviours=new mode().getBehaviours(filter);}else{var behaviours=mode.getBehaviours(filter);}
this.addBehaviours(behaviours);};this.getBehaviours=function(filter){if(!filter){return this.$behaviours;}else{var ret={};for(var i=0;i<filter.length;i++){if(this.$behaviours[filter[i]]){ret[filter[i]]=this.$behaviours[filter[i]];}}
return ret;}};}).call(Behaviour.prototype);exports.Behaviour=Behaviour;});define("ace/token_iterator",["require","exports","module","ace/range"],function(require,exports,module){"use strict";var Range=require("./range").Range;var TokenIterator=function(session,initialRow,initialColumn){this.$session=session;this.$row=initialRow;this.$rowTokens=session.getTokens(initialRow);var token=session.getTokenAt(initialRow,initialColumn);this.$tokenIndex=token?token.index:-1;};(function(){this.stepBackward=function(){this.$tokenIndex-=1;while(this.$tokenIndex<0){this.$row-=1;if(this.$row<0){this.$row=0;return null;}
this.$rowTokens=this.$session.getTokens(this.$row);this.$tokenIndex=this.$rowTokens.length-1;}
return this.$rowTokens[this.$tokenIndex];};this.stepForward=function(){this.$tokenIndex+=1;var rowCount;while(this.$tokenIndex>=this.$rowTokens.length){this.$row+=1;if(!rowCount)
rowCount=this.$session.getLength();if(this.$row>=rowCount){this.$row=rowCount-1;return null;}
this.$rowTokens=this.$session.getTokens(this.$row);this.$tokenIndex=0;}
return this.$rowTokens[this.$tokenIndex];};this.getCurrentToken=function(){return this.$rowTokens[this.$tokenIndex];};this.getCurrentTokenRow=function(){return this.$row;};this.getCurrentTokenColumn=function(){var rowTokens=this.$rowTokens;var tokenIndex=this.$tokenIndex;var column=rowTokens[tokenIndex].start;if(column!==undefined)
return column;column=0;while(tokenIndex>0){tokenIndex-=1;column+=rowTokens[tokenIndex].value.length;}
return column;};this.getCurrentTokenPosition=function(){return{row:this.$row,column:this.getCurrentTokenColumn()};};this.getCurrentTokenRange=function(){var token=this.$rowTokens[this.$tokenIndex];var column=this.getCurrentTokenColumn();return new Range(this.$row,column,this.$row,column+token.value.length);};}).call(TokenIterator.prototype);exports.TokenIterator=TokenIterator;});define("ace/mode/behaviour/cstyle",["require","exports","module","ace/lib/oop","ace/mode/behaviour","ace/token_iterator","ace/lib/lang"],function(require,exports,module){"use strict";var oop=require("../../lib/oop");var Behaviour=require("../behaviour").Behaviour;var TokenIterator=require("../../token_iterator").TokenIterator;var lang=require("../../lib/lang");var SAFE_INSERT_IN_TOKENS=["text","paren.rparen","punctuation.operator"];var SAFE_INSERT_BEFORE_TOKENS=["text","paren.rparen","punctuation.operator","comment"];var context;var contextCache={};var defaultQuotes={'"':'"',"'":"'"};var initContext=function(editor){var id=-1;if(editor.multiSelect){id=editor.selection.index;if(contextCache.rangeCount!=editor.multiSelect.rangeCount)
contextCache={rangeCount:editor.multiSelect.rangeCount};}
if(contextCache[id])
return context=contextCache[id];context=contextCache[id]={autoInsertedBrackets:0,autoInsertedRow:-1,autoInsertedLineEnd:"",maybeInsertedBrackets:0,maybeInsertedRow:-1,maybeInsertedLineStart:"",maybeInsertedLineEnd:""};};var getWrapped=function(selection,selected,opening,closing){var rowDiff=selection.end.row-selection.start.row;return{text:opening+selected+closing,selection:[0,selection.start.column+1,rowDiff,selection.end.column+(rowDiff?0:1)]};};var CstyleBehaviour=function(options){this.add("braces","insertion",function(state,action,editor,session,text){var cursor=editor.getCursorPosition();var line=session.doc.getLine(cursor.row);if(text=='{'){initContext(editor);var selection=editor.getSelectionRange();var selected=session.doc.getTextRange(selection);if(selected!==""&&selected!=="{"&&editor.getWrapBehavioursEnabled()){return getWrapped(selection,selected,'{','}');}else if(CstyleBehaviour.isSaneInsertion(editor,session)){if(/[\]\}\)]/.test(line[cursor.column])||editor.inMultiSelectMode||options&&options.braces){CstyleBehaviour.recordAutoInsert(editor,session,"}");return{text:'{}',selection:[1,1]};}else{CstyleBehaviour.recordMaybeInsert(editor,session,"{");return{text:'{',selection:[1,1]};}}}else if(text=='}'){initContext(editor);var rightChar=line.substring(cursor.column,cursor.column+1);if(rightChar=='}'){var matching=session.$findOpeningBracket('}',{column:cursor.column+1,row:cursor.row});if(matching!==null&&CstyleBehaviour.isAutoInsertedClosing(cursor,line,text)){CstyleBehaviour.popAutoInsertedClosing();return{text:'',selection:[1,1]};}}}else if(text=="\n"||text=="\r\n"){initContext(editor);var closing="";if(CstyleBehaviour.isMaybeInsertedClosing(cursor,line)){closing=lang.stringRepeat("}",context.maybeInsertedBrackets);CstyleBehaviour.clearMaybeInsertedClosing();}
var rightChar=line.substring(cursor.column,cursor.column+1);if(rightChar==='}'){var openBracePos=session.findMatchingBracket({row:cursor.row,column:cursor.column+1},'}');if(!openBracePos)
return null;var next_indent=this.$getIndent(session.getLine(openBracePos.row));}else if(closing){var next_indent=this.$getIndent(line);}else{CstyleBehaviour.clearMaybeInsertedClosing();return;}
var indent=next_indent+session.getTabString();return{text:'\n'+indent+'\n'+next_indent+closing,selection:[1,indent.length,1,indent.length]};}else{CstyleBehaviour.clearMaybeInsertedClosing();}});this.add("braces","deletion",function(state,action,editor,session,range){var selected=session.doc.getTextRange(range);if(!range.isMultiLine()&&selected=='{'){initContext(editor);var line=session.doc.getLine(range.start.row);var rightChar=line.substring(range.end.column,range.end.column+1);if(rightChar=='}'){range.end.column++;return range;}else{context.maybeInsertedBrackets--;}}});this.add("parens","insertion",function(state,action,editor,session,text){if(text=='('){initContext(editor);var selection=editor.getSelectionRange();var selected=session.doc.getTextRange(selection);if(selected!==""&&editor.getWrapBehavioursEnabled()){return getWrapped(selection,selected,'(',')');}else if(CstyleBehaviour.isSaneInsertion(editor,session)){CstyleBehaviour.recordAutoInsert(editor,session,")");return{text:'()',selection:[1,1]};}}else if(text==')'){initContext(editor);var cursor=editor.getCursorPosition();var line=session.doc.getLine(cursor.row);var rightChar=line.substring(cursor.column,cursor.column+1);if(rightChar==')'){var matching=session.$findOpeningBracket(')',{column:cursor.column+1,row:cursor.row});if(matching!==null&&CstyleBehaviour.isAutoInsertedClosing(cursor,line,text)){CstyleBehaviour.popAutoInsertedClosing();return{text:'',selection:[1,1]};}}}});this.add("parens","deletion",function(state,action,editor,session,range){var selected=session.doc.getTextRange(range);if(!range.isMultiLine()&&selected=='('){initContext(editor);var line=session.doc.getLine(range.start.row);var rightChar=line.substring(range.start.column+1,range.start.column+2);if(rightChar==')'){range.end.column++;return range;}}});this.add("brackets","insertion",function(state,action,editor,session,text){if(text=='['){initContext(editor);var selection=editor.getSelectionRange();var selected=session.doc.getTextRange(selection);if(selected!==""&&editor.getWrapBehavioursEnabled()){return getWrapped(selection,selected,'[',']');}else if(CstyleBehaviour.isSaneInsertion(editor,session)){CstyleBehaviour.recordAutoInsert(editor,session,"]");return{text:'[]',selection:[1,1]};}}else if(text==']'){initContext(editor);var cursor=editor.getCursorPosition();var line=session.doc.getLine(cursor.row);var rightChar=line.substring(cursor.column,cursor.column+1);if(rightChar==']'){var matching=session.$findOpeningBracket(']',{column:cursor.column+1,row:cursor.row});if(matching!==null&&CstyleBehaviour.isAutoInsertedClosing(cursor,line,text)){CstyleBehaviour.popAutoInsertedClosing();return{text:'',selection:[1,1]};}}}});this.add("brackets","deletion",function(state,action,editor,session,range){var selected=session.doc.getTextRange(range);if(!range.isMultiLine()&&selected=='['){initContext(editor);var line=session.doc.getLine(range.start.row);var rightChar=line.substring(range.start.column+1,range.start.column+2);if(rightChar==']'){range.end.column++;return range;}}});this.add("string_dquotes","insertion",function(state,action,editor,session,text){var quotes=session.$mode.$quotes||defaultQuotes;if(text.length==1&&quotes[text]){if(this.lineCommentStart&&this.lineCommentStart.indexOf(text)!=-1)
return;initContext(editor);var quote=text;var selection=editor.getSelectionRange();var selected=session.doc.getTextRange(selection);if(selected!==""&&(selected.length!=1||!quotes[selected])&&editor.getWrapBehavioursEnabled()){return getWrapped(selection,selected,quote,quote);}else if(!selected){var cursor=editor.getCursorPosition();var line=session.doc.getLine(cursor.row);var leftChar=line.substring(cursor.column-1,cursor.column);var rightChar=line.substring(cursor.column,cursor.column+1);var token=session.getTokenAt(cursor.row,cursor.column);var rightToken=session.getTokenAt(cursor.row,cursor.column+1);if(leftChar=="\\"&&token&&/escape/.test(token.type))
return null;var stringBefore=token&&/string|escape/.test(token.type);var stringAfter=!rightToken||/string|escape/.test(rightToken.type);var pair;if(rightChar==quote){pair=stringBefore!==stringAfter;if(pair&&/string\.end/.test(rightToken.type))
pair=false;}else{if(stringBefore&&!stringAfter)
return null;if(stringBefore&&stringAfter)
return null;var wordRe=session.$mode.tokenRe;wordRe.lastIndex=0;var isWordBefore=wordRe.test(leftChar);wordRe.lastIndex=0;var isWordAfter=wordRe.test(leftChar);if(isWordBefore||isWordAfter)
return null;if(rightChar&&!/[\s;,.})\]\\]/.test(rightChar))
return null;pair=true;}
return{text:pair?quote+quote:"",selection:[1,1]};}}});this.add("string_dquotes","deletion",function(state,action,editor,session,range){var selected=session.doc.getTextRange(range);if(!range.isMultiLine()&&(selected=='"'||selected=="'")){initContext(editor);var line=session.doc.getLine(range.start.row);var rightChar=line.substring(range.start.column+1,range.start.column+2);if(rightChar==selected){range.end.column++;return range;}}});};CstyleBehaviour.isSaneInsertion=function(editor,session){var cursor=editor.getCursorPosition();var iterator=new TokenIterator(session,cursor.row,cursor.column);if(!this.$matchTokenType(iterator.getCurrentToken()||"text",SAFE_INSERT_IN_TOKENS)){var iterator2=new TokenIterator(session,cursor.row,cursor.column+1);if(!this.$matchTokenType(iterator2.getCurrentToken()||"text",SAFE_INSERT_IN_TOKENS))
return false;}
iterator.stepForward();return iterator.getCurrentTokenRow()!==cursor.row||this.$matchTokenType(iterator.getCurrentToken()||"text",SAFE_INSERT_BEFORE_TOKENS);};CstyleBehaviour.$matchTokenType=function(token,types){return types.indexOf(token.type||token)>-1;};CstyleBehaviour.recordAutoInsert=function(editor,session,bracket){var cursor=editor.getCursorPosition();var line=session.doc.getLine(cursor.row);if(!this.isAutoInsertedClosing(cursor,line,context.autoInsertedLineEnd[0]))
context.autoInsertedBrackets=0;context.autoInsertedRow=cursor.row;context.autoInsertedLineEnd=bracket+line.substr(cursor.column);context.autoInsertedBrackets++;};CstyleBehaviour.recordMaybeInsert=function(editor,session,bracket){var cursor=editor.getCursorPosition();var line=session.doc.getLine(cursor.row);if(!this.isMaybeInsertedClosing(cursor,line))
context.maybeInsertedBrackets=0;context.maybeInsertedRow=cursor.row;context.maybeInsertedLineStart=line.substr(0,cursor.column)+bracket;context.maybeInsertedLineEnd=line.substr(cursor.column);context.maybeInsertedBrackets++;};CstyleBehaviour.isAutoInsertedClosing=function(cursor,line,bracket){return context.autoInsertedBrackets>0&&cursor.row===context.autoInsertedRow&&bracket===context.autoInsertedLineEnd[0]&&line.substr(cursor.column)===context.autoInsertedLineEnd;};CstyleBehaviour.isMaybeInsertedClosing=function(cursor,line){return context.maybeInsertedBrackets>0&&cursor.row===context.maybeInsertedRow&&line.substr(cursor.column)===context.maybeInsertedLineEnd&&line.substr(0,cursor.column)==context.maybeInsertedLineStart;};CstyleBehaviour.popAutoInsertedClosing=function(){context.autoInsertedLineEnd=context.autoInsertedLineEnd.substr(1);context.autoInsertedBrackets--;};CstyleBehaviour.clearMaybeInsertedClosing=function(){if(context){context.maybeInsertedBrackets=0;context.maybeInsertedRow=-1;}};oop.inherits(CstyleBehaviour,Behaviour);exports.CstyleBehaviour=CstyleBehaviour;});define("ace/unicode",["require","exports","module"],function(require,exports,module){"use strict";var wordChars=[48,9,8,25,5,0,2,25,48,0,11,0,5,0,6,22,2,30,2,457,5,11,15,4,8,0,2,0,18,116,2,1,3,3,9,0,2,2,2,0,2,19,2,82,2,138,2,4,3,155,12,37,3,0,8,38,10,44,2,0,2,1,2,1,2,0,9,26,6,2,30,10,7,61,2,9,5,101,2,7,3,9,2,18,3,0,17,58,3,100,15,53,5,0,6,45,211,57,3,18,2,5,3,11,3,9,2,1,7,6,2,2,2,7,3,1,3,21,2,6,2,0,4,3,3,8,3,1,3,3,9,0,5,1,2,4,3,11,16,2,2,5,5,1,3,21,2,6,2,1,2,1,2,1,3,0,2,4,5,1,3,2,4,0,8,3,2,0,8,15,12,2,2,8,2,2,2,21,2,6,2,1,2,4,3,9,2,2,2,2,3,0,16,3,3,9,18,2,2,7,3,1,3,21,2,6,2,1,2,4,3,8,3,1,3,2,9,1,5,1,2,4,3,9,2,0,17,1,2,5,4,2,2,3,4,1,2,0,2,1,4,1,4,2,4,11,5,4,4,2,2,3,3,0,7,0,15,9,18,2,2,7,2,2,2,22,2,9,2,4,4,7,2,2,2,3,8,1,2,1,7,3,3,9,19,1,2,7,2,2,2,22,2,9,2,4,3,8,2,2,2,3,8,1,8,0,2,3,3,9,19,1,2,7,2,2,2,22,2,15,4,7,2,2,2,3,10,0,9,3,3,9,11,5,3,1,2,17,4,23,2,8,2,0,3,6,4,0,5,5,2,0,2,7,19,1,14,57,6,14,2,9,40,1,2,0,3,1,2,0,3,0,7,3,2,6,2,2,2,0,2,0,3,1,2,12,2,2,3,4,2,0,2,5,3,9,3,1,35,0,24,1,7,9,12,0,2,0,2,0,5,9,2,35,5,19,2,5,5,7,2,35,10,0,58,73,7,77,3,37,11,42,2,0,4,328,2,3,3,6,2,0,2,3,3,40,2,3,3,32,2,3,3,6,2,0,2,3,3,14,2,56,2,3,3,66,5,0,33,15,17,84,13,619,3,16,2,25,6,74,22,12,2,6,12,20,12,19,13,12,2,2,2,1,13,51,3,29,4,0,5,1,3,9,34,2,3,9,7,87,9,42,6,69,11,28,4,11,5,11,11,39,3,4,12,43,5,25,7,10,38,27,5,62,2,28,3,10,7,9,14,0,89,75,5,9,18,8,13,42,4,11,71,55,9,9,4,48,83,2,2,30,14,230,23,280,3,5,3,37,3,5,3,7,2,0,2,0,2,0,2,30,3,52,2,6,2,0,4,2,2,6,4,3,3,5,5,12,6,2,2,6,67,1,20,0,29,0,14,0,17,4,60,12,5,0,4,11,18,0,5,0,3,9,2,0,4,4,7,0,2,0,2,0,2,3,2,10,3,3,6,4,5,0,53,1,2684,46,2,46,2,132,7,6,15,37,11,53,10,0,17,22,10,6,2,6,2,6,2,6,2,6,2,6,2,6,2,6,2,31,48,0,470,1,36,5,2,4,6,1,5,85,3,1,3,2,2,89,2,3,6,40,4,93,18,23,57,15,513,6581,75,20939,53,1164,68,45,3,268,4,27,21,31,3,13,13,1,2,24,9,69,11,1,38,8,3,102,3,1,111,44,25,51,13,68,12,9,7,23,4,0,5,45,3,35,13,28,4,64,15,10,39,54,10,13,3,9,7,22,4,1,5,66,25,2,227,42,2,1,3,9,7,11171,13,22,5,48,8453,301,3,61,3,105,39,6,13,4,6,11,2,12,2,4,2,0,2,1,2,1,2,107,34,362,19,63,3,53,41,11,5,15,17,6,13,1,25,2,33,4,2,134,20,9,8,25,5,0,2,25,12,88,4,5,3,5,3,5,3,2];var code=0;var str=[];for(var i=0;i<wordChars.length;i+=2){str.push(code+=wordChars[i]);if(wordChars[i+1])
str.push(45,code+=wordChars[i+1]);}
exports.wordChars=String.fromCharCode.apply(null,str);});define("ace/mode/text",["require","exports","module","ace/tokenizer","ace/mode/text_highlight_rules","ace/mode/behaviour/cstyle","ace/unicode","ace/lib/lang","ace/token_iterator","ace/range"],function(require,exports,module){"use strict";var Tokenizer=require("../tokenizer").Tokenizer;var TextHighlightRules=require("./text_highlight_rules").TextHighlightRules;var CstyleBehaviour=require("./behaviour/cstyle").CstyleBehaviour;var unicode=require("../unicode");var lang=require("../lib/lang");var TokenIterator=require("../token_iterator").TokenIterator;var Range=require("../range").Range;var Mode=function(){this.HighlightRules=TextHighlightRules;};(function(){this.$defaultBehaviour=new CstyleBehaviour();this.tokenRe=new RegExp("^["+unicode.wordChars+"\\$_]+","g");this.nonTokenRe=new RegExp("^(?:[^"+unicode.wordChars+"\\$_]|\\s])+","g");this.getTokenizer=function(){if(!this.$tokenizer){this.$highlightRules=this.$highlightRules||new this.HighlightRules(this.$highlightRuleConfig);this.$tokenizer=new Tokenizer(this.$highlightRules.getRules());}
return this.$tokenizer;};this.lineCommentStart="";this.blockComment="";this.toggleCommentLines=function(state,session,startRow,endRow){var doc=session.doc;var ignoreBlankLines=true;var shouldRemove=true;var minIndent=Infinity;var tabSize=session.getTabSize();var insertAtTabStop=false;if(!this.lineCommentStart){if(!this.blockComment)
return false;var lineCommentStart=this.blockComment.start;var lineCommentEnd=this.blockComment.end;var regexpStart=new RegExp("^(\\s*)(?:"+lang.escapeRegExp(lineCommentStart)+")");var regexpEnd=new RegExp("(?:"+lang.escapeRegExp(lineCommentEnd)+")\\s*$");var comment=function(line,i){if(testRemove(line,i))
return;if(!ignoreBlankLines||/\S/.test(line)){doc.insertInLine({row:i,column:line.length},lineCommentEnd);doc.insertInLine({row:i,column:minIndent},lineCommentStart);}};var uncomment=function(line,i){var m;if(m=line.match(regexpEnd))
doc.removeInLine(i,line.length-m[0].length,line.length);if(m=line.match(regexpStart))
doc.removeInLine(i,m[1].length,m[0].length);};var testRemove=function(line,row){if(regexpStart.test(line))
return true;var tokens=session.getTokens(row);for(var i=0;i<tokens.length;i++){if(tokens[i].type==="comment")
return true;}};}else{if(Array.isArray(this.lineCommentStart)){var regexpStart=this.lineCommentStart.map(lang.escapeRegExp).join("|");var lineCommentStart=this.lineCommentStart[0];}else{var regexpStart=lang.escapeRegExp(this.lineCommentStart);var lineCommentStart=this.lineCommentStart;}
regexpStart=new RegExp("^(\\s*)(?:"+regexpStart+") ?");insertAtTabStop=session.getUseSoftTabs();var uncomment=function(line,i){var m=line.match(regexpStart);if(!m)return;var start=m[1].length,end=m[0].length;if(!shouldInsertSpace(line,start,end)&&m[0][end-1]==" ")
end--;doc.removeInLine(i,start,end);};var commentWithSpace=lineCommentStart+" ";var comment=function(line,i){if(!ignoreBlankLines||/\S/.test(line)){if(shouldInsertSpace(line,minIndent,minIndent))
doc.insertInLine({row:i,column:minIndent},commentWithSpace);else
doc.insertInLine({row:i,column:minIndent},lineCommentStart);}};var testRemove=function(line,i){return regexpStart.test(line);};var shouldInsertSpace=function(line,before,after){var spaces=0;while(before--&&line.charAt(before)==" ")
spaces++;if(spaces%tabSize!=0)
return false;var spaces=0;while(line.charAt(after++)==" ")
spaces++;if(tabSize>2)
return spaces%tabSize!=tabSize-1;else
return spaces%tabSize==0;};}
function iter(fun){for(var i=startRow;i<=endRow;i++)
fun(doc.getLine(i),i);}
var minEmptyLength=Infinity;iter(function(line,i){var indent=line.search(/\S/);if(indent!==-1){if(indent<minIndent)
minIndent=indent;if(shouldRemove&&!testRemove(line,i))
shouldRemove=false;}else if(minEmptyLength>line.length){minEmptyLength=line.length;}});if(minIndent==Infinity){minIndent=minEmptyLength;ignoreBlankLines=false;shouldRemove=false;}
if(insertAtTabStop&&minIndent%tabSize!=0)
minIndent=Math.floor(minIndent/tabSize)*tabSize;iter(shouldRemove?uncomment:comment);};this.toggleBlockComment=function(state,session,range,cursor){var comment=this.blockComment;if(!comment)
return;if(!comment.start&&comment[0])
comment=comment[0];var iterator=new TokenIterator(session,cursor.row,cursor.column);var token=iterator.getCurrentToken();var sel=session.selection;var initialRange=session.selection.toOrientedRange();var startRow,colDiff;if(token&&/comment/.test(token.type)){var startRange,endRange;while(token&&/comment/.test(token.type)){var i=token.value.indexOf(comment.start);if(i!=-1){var row=iterator.getCurrentTokenRow();var column=iterator.getCurrentTokenColumn()+i;startRange=new Range(row,column,row,column+comment.start.length);break;}
token=iterator.stepBackward();}
var iterator=new TokenIterator(session,cursor.row,cursor.column);var token=iterator.getCurrentToken();while(token&&/comment/.test(token.type)){var i=token.value.indexOf(comment.end);if(i!=-1){var row=iterator.getCurrentTokenRow();var column=iterator.getCurrentTokenColumn()+i;endRange=new Range(row,column,row,column+comment.end.length);break;}
token=iterator.stepForward();}
if(endRange)
session.remove(endRange);if(startRange){session.remove(startRange);startRow=startRange.start.row;colDiff=-comment.start.length;}}else{colDiff=comment.start.length;startRow=range.start.row;session.insert(range.end,comment.end);session.insert(range.start,comment.start);}
if(initialRange.start.row==startRow)
initialRange.start.column+=colDiff;if(initialRange.end.row==startRow)
initialRange.end.column+=colDiff;session.selection.fromOrientedRange(initialRange);};this.getNextLineIndent=function(state,line,tab){return this.$getIndent(line);};this.checkOutdent=function(state,line,input){return false;};this.autoOutdent=function(state,doc,row){};this.$getIndent=function(line){return line.match(/^\s*/)[0];};this.createWorker=function(session){return null;};this.createModeDelegates=function(mapping){this.$embeds=[];this.$modes={};for(var i in mapping){if(mapping[i]){this.$embeds.push(i);this.$modes[i]=new mapping[i]();}}
var delegations=["toggleBlockComment","toggleCommentLines","getNextLineIndent","checkOutdent","autoOutdent","transformAction","getCompletions"];for(var i=0;i<delegations.length;i++){(function(scope){var functionName=delegations[i];var defaultHandler=scope[functionName];scope[delegations[i]]=function(){return this.$delegator(functionName,arguments,defaultHandler);};}(this));}};this.$delegator=function(method,args,defaultHandler){var state=args[0];if(typeof state!="string")
state=state[0];for(var i=0;i<this.$embeds.length;i++){if(!this.$modes[this.$embeds[i]])continue;var split=state.split(this.$embeds[i]);if(!split[0]&&split[1]){args[0]=split[1];var mode=this.$modes[this.$embeds[i]];return mode[method].apply(mode,args);}}
var ret=defaultHandler.apply(this,args);return defaultHandler?ret:undefined;};this.transformAction=function(state,action,editor,session,param){if(this.$behaviour){var behaviours=this.$behaviour.getBehaviours();for(var key in behaviours){if(behaviours[key][action]){var ret=behaviours[key][action].apply(this,arguments);if(ret){return ret;}}}}};this.getKeywords=function(append){if(!this.completionKeywords){var rules=this.$tokenizer.rules;var completionKeywords=[];for(var rule in rules){var ruleItr=rules[rule];for(var r=0,l=ruleItr.length;r<l;r++){if(typeof ruleItr[r].token==="string"){if(/keyword|support|storage/.test(ruleItr[r].token))
completionKeywords.push(ruleItr[r].regex);}
else if(typeof ruleItr[r].token==="object"){for(var a=0,aLength=ruleItr[r].token.length;a<aLength;a++){if(/keyword|support|storage/.test(ruleItr[r].token[a])){var rule=ruleItr[r].regex.match(/\(.+?\)/g)[a];completionKeywords.push(rule.substr(1,rule.length-2));}}}}}
this.completionKeywords=completionKeywords;}
if(!append)
return this.$keywordList;return completionKeywords.concat(this.$keywordList||[]);};this.$createKeywordList=function(){if(!this.$highlightRules)
this.getTokenizer();return this.$keywordList=this.$highlightRules.$keywordList||[];};this.getCompletions=function(state,session,pos,prefix){var keywords=this.$keywordList||this.$createKeywordList();return keywords.map(function(word){return{name:word,value:word,score:0,meta:"keyword"};});};this.$id="ace/mode/text";}).call(Mode.prototype);exports.Mode=Mode;});define("ace/apply_delta",["require","exports","module"],function(require,exports,module){"use strict";function throwDeltaError(delta,errorText){console.log("Invalid Delta:",delta);throw"Invalid Delta: "+errorText;}
function positionInDocument(docLines,position){return position.row>=0&&position.row<docLines.length&&position.column>=0&&position.column<=docLines[position.row].length;}
function validateDelta(docLines,delta){if(delta.action!="insert"&&delta.action!="remove")
throwDeltaError(delta,"delta.action must be 'insert' or 'remove'");if(!(delta.lines instanceof Array))
throwDeltaError(delta,"delta.lines must be an Array");if(!delta.start||!delta.end)
throwDeltaError(delta,"delta.start/end must be an present");var start=delta.start;if(!positionInDocument(docLines,delta.start))
throwDeltaError(delta,"delta.start must be contained in document");var end=delta.end;if(delta.action=="remove"&&!positionInDocument(docLines,end))
throwDeltaError(delta,"delta.end must contained in document for 'remove' actions");var numRangeRows=end.row-start.row;var numRangeLastLineChars=(end.column-(numRangeRows==0?start.column:0));if(numRangeRows!=delta.lines.length-1||delta.lines[numRangeRows].length!=numRangeLastLineChars)
throwDeltaError(delta,"delta.range must match delta lines");}
exports.applyDelta=function(docLines,delta,doNotValidate){var row=delta.start.row;var startColumn=delta.start.column;var line=docLines[row]||"";switch(delta.action){case"insert":var lines=delta.lines;if(lines.length===1){docLines[row]=line.substring(0,startColumn)+delta.lines[0]+line.substring(startColumn);}else{var args=[row,1].concat(delta.lines);docLines.splice.apply(docLines,args);docLines[row]=line.substring(0,startColumn)+docLines[row];docLines[row+delta.lines.length-1]+=line.substring(startColumn);}
break;case"remove":var endColumn=delta.end.column;var endRow=delta.end.row;if(row===endRow){docLines[row]=line.substring(0,startColumn)+line.substring(endColumn);}else{docLines.splice(row,endRow-row+1,line.substring(0,startColumn)+docLines[endRow].substring(endColumn));}
break;}};});define("ace/anchor",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],function(require,exports,module){"use strict";var oop=require("./lib/oop");var EventEmitter=require("./lib/event_emitter").EventEmitter;var Anchor=exports.Anchor=function(doc,row,column){this.$onChange=this.onChange.bind(this);this.attach(doc);if(typeof column=="undefined")
this.setPosition(row.row,row.column);else
this.setPosition(row,column);};(function(){oop.implement(this,EventEmitter);this.getPosition=function(){return this.$clipPositionToDocument(this.row,this.column);};this.getDocument=function(){return this.document;};this.$insertRight=false;this.onChange=function(delta){if(delta.start.row==delta.end.row&&delta.start.row!=this.row)
return;if(delta.start.row>this.row)
return;var point=$getTransformedPoint(delta,{row:this.row,column:this.column},this.$insertRight);this.setPosition(point.row,point.column,true);};function $pointsInOrder(point1,point2,equalPointsInOrder){var bColIsAfter=equalPointsInOrder?point1.column<=point2.column:point1.column<point2.column;return(point1.row<point2.row)||(point1.row==point2.row&&bColIsAfter);}
function $getTransformedPoint(delta,point,moveIfEqual){var deltaIsInsert=delta.action=="insert";var deltaRowShift=(deltaIsInsert?1:-1)*(delta.end.row-delta.start.row);var deltaColShift=(deltaIsInsert?1:-1)*(delta.end.column-delta.start.column);var deltaStart=delta.start;var deltaEnd=deltaIsInsert?deltaStart:delta.end;if($pointsInOrder(point,deltaStart,moveIfEqual)){return{row:point.row,column:point.column};}
if($pointsInOrder(deltaEnd,point,!moveIfEqual)){return{row:point.row+deltaRowShift,column:point.column+(point.row==deltaEnd.row?deltaColShift:0)};}
return{row:deltaStart.row,column:deltaStart.column};}
this.setPosition=function(row,column,noClip){var pos;if(noClip){pos={row:row,column:column};}else{pos=this.$clipPositionToDocument(row,column);}
if(this.row==pos.row&&this.column==pos.column)
return;var old={row:this.row,column:this.column};this.row=pos.row;this.column=pos.column;this._signal("change",{old:old,value:pos});};this.detach=function(){this.document.removeEventListener("change",this.$onChange);};this.attach=function(doc){this.document=doc||this.document;this.document.on("change",this.$onChange);};this.$clipPositionToDocument=function(row,column){var pos={};if(row>=this.document.getLength()){pos.row=Math.max(0,this.document.getLength()-1);pos.column=this.document.getLine(pos.row).length;}
else if(row<0){pos.row=0;pos.column=0;}
else{pos.row=row;pos.column=Math.min(this.document.getLine(pos.row).length,Math.max(0,column));}
if(column<0)
pos.column=0;return pos;};}).call(Anchor.prototype);});define("ace/document",["require","exports","module","ace/lib/oop","ace/apply_delta","ace/lib/event_emitter","ace/range","ace/anchor"],function(require,exports,module){"use strict";var oop=require("./lib/oop");var applyDelta=require("./apply_delta").applyDelta;var EventEmitter=require("./lib/event_emitter").EventEmitter;var Range=require("./range").Range;var Anchor=require("./anchor").Anchor;var Document=function(textOrLines){this.$lines=[""];if(textOrLines.length===0){this.$lines=[""];}else if(Array.isArray(textOrLines)){this.insertMergedLines({row:0,column:0},textOrLines);}else{this.insert({row:0,column:0},textOrLines);}};(function(){oop.implement(this,EventEmitter);this.setValue=function(text){var len=this.getLength()-1;this.remove(new Range(0,0,len,this.getLine(len).length));this.insert({row:0,column:0},text);};this.getValue=function(){return this.getAllLines().join(this.getNewLineCharacter());};this.createAnchor=function(row,column){return new Anchor(this,row,column);};if("aaa".split(/a/).length===0){this.$split=function(text){return text.replace(/\r\n|\r/g,"\n").split("\n");};}else{this.$split=function(text){return text.split(/\r\n|\r|\n/);};}
this.$detectNewLine=function(text){var match=text.match(/^.*?(\r\n|\r|\n)/m);this.$autoNewLine=match?match[1]:"\n";this._signal("changeNewLineMode");};this.getNewLineCharacter=function(){switch(this.$newLineMode){case"windows":return"\r\n";case"unix":return"\n";default:return this.$autoNewLine||"\n";}};this.$autoNewLine="";this.$newLineMode="auto";this.setNewLineMode=function(newLineMode){if(this.$newLineMode===newLineMode)
return;this.$newLineMode=newLineMode;this._signal("changeNewLineMode");};this.getNewLineMode=function(){return this.$newLineMode;};this.isNewLine=function(text){return(text=="\r\n"||text=="\r"||text=="\n");};this.getLine=function(row){return this.$lines[row]||"";};this.getLines=function(firstRow,lastRow){return this.$lines.slice(firstRow,lastRow+1);};this.getAllLines=function(){return this.getLines(0,this.getLength());};this.getLength=function(){return this.$lines.length;};this.getTextRange=function(range){return this.getLinesForRange(range).join(this.getNewLineCharacter());};this.getLinesForRange=function(range){var lines;if(range.start.row===range.end.row){lines=[this.getLine(range.start.row).substring(range.start.column,range.end.column)];}else{lines=this.getLines(range.start.row,range.end.row);lines[0]=(lines[0]||"").substring(range.start.column);var l=lines.length-1;if(range.end.row-range.start.row==l)
lines[l]=lines[l].substring(0,range.end.column);}
return lines;};this.insertLines=function(row,lines){console.warn("Use of document.insertLines is deprecated. Use the insertFullLines method instead.");return this.insertFullLines(row,lines);};this.removeLines=function(firstRow,lastRow){console.warn("Use of document.removeLines is deprecated. Use the removeFullLines method instead.");return this.removeFullLines(firstRow,lastRow);};this.insertNewLine=function(position){console.warn("Use of document.insertNewLine is deprecated. Use insertMergedLines(position, ['', '']) instead.");return this.insertMergedLines(position,["",""]);};this.insert=function(position,text){if(this.getLength()<=1)
this.$detectNewLine(text);return this.insertMergedLines(position,this.$split(text));};this.insertInLine=function(position,text){var start=this.clippedPos(position.row,position.column);var end=this.pos(position.row,position.column+text.length);this.applyDelta({start:start,end:end,action:"insert",lines:[text]},true);return this.clonePos(end);};this.clippedPos=function(row,column){var length=this.getLength();if(row===undefined){row=length;}else if(row<0){row=0;}else if(row>=length){row=length-1;column=undefined;}
var line=this.getLine(row);if(column==undefined)
column=line.length;column=Math.min(Math.max(column,0),line.length);return{row:row,column:column};};this.clonePos=function(pos){return{row:pos.row,column:pos.column};};this.pos=function(row,column){return{row:row,column:column};};this.$clipPosition=function(position){var length=this.getLength();if(position.row>=length){position.row=Math.max(0,length-1);position.column=this.getLine(length-1).length;}else{position.row=Math.max(0,position.row);position.column=Math.min(Math.max(position.column,0),this.getLine(position.row).length);}
return position;};this.insertFullLines=function(row,lines){row=Math.min(Math.max(row,0),this.getLength());var column=0;if(row<this.getLength()){lines=lines.concat([""]);column=0;}else{lines=[""].concat(lines);row--;column=this.$lines[row].length;}
this.insertMergedLines({row:row,column:column},lines);};this.insertMergedLines=function(position,lines){var start=this.clippedPos(position.row,position.column);var end={row:start.row+lines.length-1,column:(lines.length==1?start.column:0)+lines[lines.length-1].length};this.applyDelta({start:start,end:end,action:"insert",lines:lines});return this.clonePos(end);};this.remove=function(range){var start=this.clippedPos(range.start.row,range.start.column);var end=this.clippedPos(range.end.row,range.end.column);this.applyDelta({start:start,end:end,action:"remove",lines:this.getLinesForRange({start:start,end:end})});return this.clonePos(start);};this.removeInLine=function(row,startColumn,endColumn){var start=this.clippedPos(row,startColumn);var end=this.clippedPos(row,endColumn);this.applyDelta({start:start,end:end,action:"remove",lines:this.getLinesForRange({start:start,end:end})},true);return this.clonePos(start);};this.removeFullLines=function(firstRow,lastRow){firstRow=Math.min(Math.max(0,firstRow),this.getLength()-1);lastRow=Math.min(Math.max(0,lastRow),this.getLength()-1);var deleteFirstNewLine=lastRow==this.getLength()-1&&firstRow>0;var deleteLastNewLine=lastRow<this.getLength()-1;var startRow=(deleteFirstNewLine?firstRow-1:firstRow);var startCol=(deleteFirstNewLine?this.getLine(startRow).length:0);var endRow=(deleteLastNewLine?lastRow+1:lastRow);var endCol=(deleteLastNewLine?0:this.getLine(endRow).length);var range=new Range(startRow,startCol,endRow,endCol);var deletedLines=this.$lines.slice(firstRow,lastRow+1);this.applyDelta({start:range.start,end:range.end,action:"remove",lines:this.getLinesForRange(range)});return deletedLines;};this.removeNewLine=function(row){if(row<this.getLength()-1&&row>=0){this.applyDelta({start:this.pos(row,this.getLine(row).length),end:this.pos(row+1,0),action:"remove",lines:["",""]});}};this.replace=function(range,text){if(!(range instanceof Range))
range=Range.fromPoints(range.start,range.end);if(text.length===0&&range.isEmpty())
return range.start;if(text==this.getTextRange(range))
return range.end;this.remove(range);var end;if(text){end=this.insert(range.start,text);}
else{end=range.start;}
return end;};this.applyDeltas=function(deltas){for(var i=0;i<deltas.length;i++){this.applyDelta(deltas[i]);}};this.revertDeltas=function(deltas){for(var i=deltas.length-1;i>=0;i--){this.revertDelta(deltas[i]);}};this.applyDelta=function(delta,doNotValidate){var isInsert=delta.action=="insert";if(isInsert?delta.lines.length<=1&&!delta.lines[0]:!Range.comparePoints(delta.start,delta.end)){return;}
if(isInsert&&delta.lines.length>20000)
this.$splitAndapplyLargeDelta(delta,20000);applyDelta(this.$lines,delta,doNotValidate);this._signal("change",delta);};this.$splitAndapplyLargeDelta=function(delta,MAX){var lines=delta.lines;var l=lines.length;var row=delta.start.row;var column=delta.start.column;var from=0,to=0;do{from=to;to+=MAX-1;var chunk=lines.slice(from,to);if(to>l){delta.lines=chunk;delta.start.row=row+from;delta.start.column=column;break;}
chunk.push("");this.applyDelta({start:this.pos(row+from,column),end:this.pos(row+to,column=0),action:delta.action,lines:chunk},true);}while(true);};this.revertDelta=function(delta){this.applyDelta({start:this.clonePos(delta.start),end:this.clonePos(delta.end),action:(delta.action=="insert"?"remove":"insert"),lines:delta.lines.slice()});};this.indexToPosition=function(index,startRow){var lines=this.$lines||this.getAllLines();var newlineLength=this.getNewLineCharacter().length;for(var i=startRow||0,l=lines.length;i<l;i++){index-=lines[i].length+newlineLength;if(index<0)
return{row:i,column:index+lines[i].length+newlineLength};}
return{row:l-1,column:lines[l-1].length};};this.positionToIndex=function(pos,startRow){var lines=this.$lines||this.getAllLines();var newlineLength=this.getNewLineCharacter().length;var index=0;var row=Math.min(pos.row,lines.length);for(var i=startRow||0;i<row;++i)
index+=lines[i].length+newlineLength;return index+pos.column;};}).call(Document.prototype);exports.Document=Document;});define("ace/background_tokenizer",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],function(require,exports,module){"use strict";var oop=require("./lib/oop");var EventEmitter=require("./lib/event_emitter").EventEmitter;var BackgroundTokenizer=function(tokenizer,editor){this.running=false;this.lines=[];this.states=[];this.currentLine=0;this.tokenizer=tokenizer;var self=this;this.$worker=function(){if(!self.running){return;}
var workerStart=new Date();var currentLine=self.currentLine;var endLine=-1;var doc=self.doc;var startLine=currentLine;while(self.lines[currentLine])
currentLine++;var len=doc.getLength();var processedLines=0;self.running=false;while(currentLine<len){self.$tokenizeRow(currentLine);endLine=currentLine;do{currentLine++;}while(self.lines[currentLine]);processedLines++;if((processedLines%5===0)&&(new Date()-workerStart)>20){self.running=setTimeout(self.$worker,20);break;}}
self.currentLine=currentLine;if(endLine==-1)
endLine=currentLine;if(startLine<=endLine)
self.fireUpdateEvent(startLine,endLine);};};(function(){oop.implement(this,EventEmitter);this.setTokenizer=function(tokenizer){this.tokenizer=tokenizer;this.lines=[];this.states=[];this.start(0);};this.setDocument=function(doc){this.doc=doc;this.lines=[];this.states=[];this.stop();};this.fireUpdateEvent=function(firstRow,lastRow){var data={first:firstRow,last:lastRow};this._signal("update",{data:data});};this.start=function(startRow){this.currentLine=Math.min(startRow||0,this.currentLine,this.doc.getLength());this.lines.splice(this.currentLine,this.lines.length);this.states.splice(this.currentLine,this.states.length);this.stop();this.running=setTimeout(this.$worker,700);};this.scheduleStart=function(){if(!this.running)
this.running=setTimeout(this.$worker,700);};this.$updateOnChange=function(delta){var startRow=delta.start.row;var len=delta.end.row-startRow;if(len===0){this.lines[startRow]=null;}else if(delta.action=="remove"){this.lines.splice(startRow,len+1,null);this.states.splice(startRow,len+1,null);}else{var args=Array(len+1);args.unshift(startRow,1);this.lines.splice.apply(this.lines,args);this.states.splice.apply(this.states,args);}
this.currentLine=Math.min(startRow,this.currentLine,this.doc.getLength());this.stop();};this.stop=function(){if(this.running)
clearTimeout(this.running);this.running=false;};this.getTokens=function(row){return this.lines[row]||this.$tokenizeRow(row);};this.getState=function(row){if(this.currentLine==row)
this.$tokenizeRow(row);return this.states[row]||"start";};this.$tokenizeRow=function(row){var line=this.doc.getLine(row);var state=this.states[row-1];var data=this.tokenizer.getLineTokens(line,state,row);if(this.states[row]+""!==data.state+""){this.states[row]=data.state;this.lines[row+1]=null;if(this.currentLine>row+1)
this.currentLine=row+1;}else if(this.currentLine==row){this.currentLine=row+1;}
return this.lines[row]=data.tokens;};}).call(BackgroundTokenizer.prototype);exports.BackgroundTokenizer=BackgroundTokenizer;});define("ace/search_highlight",["require","exports","module","ace/lib/lang","ace/lib/oop","ace/range"],function(require,exports,module){"use strict";var lang=require("./lib/lang");var oop=require("./lib/oop");var Range=require("./range").Range;var SearchHighlight=function(regExp,clazz,type){this.setRegexp(regExp);this.clazz=clazz;this.type=type||"text";};(function(){this.MAX_RANGES=500;this.setRegexp=function(regExp){if(this.regExp+""==regExp+"")
return;this.regExp=regExp;this.cache=[];};this.update=function(html,markerLayer,session,config){if(!this.regExp)
return;var start=config.firstRow,end=config.lastRow;for(var i=start;i<=end;i++){var ranges=this.cache[i];if(ranges==null){ranges=lang.getMatchOffsets(session.getLine(i),this.regExp);if(ranges.length>this.MAX_RANGES)
ranges=ranges.slice(0,this.MAX_RANGES);ranges=ranges.map(function(match){return new Range(i,match.offset,i,match.offset+match.length);});this.cache[i]=ranges.length?ranges:"";}
for(var j=ranges.length;j--;){markerLayer.drawSingleLineMarker(html,ranges[j].toScreenRange(session),this.clazz,config);}}};}).call(SearchHighlight.prototype);exports.SearchHighlight=SearchHighlight;});define("ace/edit_session/fold_line",["require","exports","module","ace/range"],function(require,exports,module){"use strict";var Range=require("../range").Range;function FoldLine(foldData,folds){this.foldData=foldData;if(Array.isArray(folds)){this.folds=folds;}else{folds=this.folds=[folds];}
var last=folds[folds.length-1];this.range=new Range(folds[0].start.row,folds[0].start.column,last.end.row,last.end.column);this.start=this.range.start;this.end=this.range.end;this.folds.forEach(function(fold){fold.setFoldLine(this);},this);}
(function(){this.shiftRow=function(shift){this.start.row+=shift;this.end.row+=shift;this.folds.forEach(function(fold){fold.start.row+=shift;fold.end.row+=shift;});};this.addFold=function(fold){if(fold.sameRow){if(fold.start.row<this.startRow||fold.endRow>this.endRow){throw new Error("Can't add a fold to this FoldLine as it has no connection");}
this.folds.push(fold);this.folds.sort(function(a,b){return-a.range.compareEnd(b.start.row,b.start.column);});if(this.range.compareEnd(fold.start.row,fold.start.column)>0){this.end.row=fold.end.row;this.end.column=fold.end.column;}else if(this.range.compareStart(fold.end.row,fold.end.column)<0){this.start.row=fold.start.row;this.start.column=fold.start.column;}}else if(fold.start.row==this.end.row){this.folds.push(fold);this.end.row=fold.end.row;this.end.column=fold.end.column;}else if(fold.end.row==this.start.row){this.folds.unshift(fold);this.start.row=fold.start.row;this.start.column=fold.start.column;}else{throw new Error("Trying to add fold to FoldRow that doesn't have a matching row");}
fold.foldLine=this;};this.containsRow=function(row){return row>=this.start.row&&row<=this.end.row;};this.walk=function(callback,endRow,endColumn){var lastEnd=0,folds=this.folds,fold,cmp,stop,isNewRow=true;if(endRow==null){endRow=this.end.row;endColumn=this.end.column;}
for(var i=0;i<folds.length;i++){fold=folds[i];cmp=fold.range.compareStart(endRow,endColumn);if(cmp==-1){callback(null,endRow,endColumn,lastEnd,isNewRow);return;}
stop=callback(null,fold.start.row,fold.start.column,lastEnd,isNewRow);stop=!stop&&callback(fold.placeholder,fold.start.row,fold.start.column,lastEnd);if(stop||cmp===0){return;}
isNewRow=!fold.sameRow;lastEnd=fold.end.column;}
callback(null,endRow,endColumn,lastEnd,isNewRow);};this.getNextFoldTo=function(row,column){var fold,cmp;for(var i=0;i<this.folds.length;i++){fold=this.folds[i];cmp=fold.range.compareEnd(row,column);if(cmp==-1){return{fold:fold,kind:"after"};}else if(cmp===0){return{fold:fold,kind:"inside"};}}
return null;};this.addRemoveChars=function(row,column,len){var ret=this.getNextFoldTo(row,column),fold,folds;if(ret){fold=ret.fold;if(ret.kind=="inside"&&fold.start.column!=column&&fold.start.row!=row)
{window.console&&window.console.log(row,column,fold);}else if(fold.start.row==row){folds=this.folds;var i=folds.indexOf(fold);if(i===0){this.start.column+=len;}
for(i;i<folds.length;i++){fold=folds[i];fold.start.column+=len;if(!fold.sameRow){return;}
fold.end.column+=len;}
this.end.column+=len;}}};this.split=function(row,column){var pos=this.getNextFoldTo(row,column);if(!pos||pos.kind=="inside")
return null;var fold=pos.fold;var folds=this.folds;var foldData=this.foldData;var i=folds.indexOf(fold);var foldBefore=folds[i-1];this.end.row=foldBefore.end.row;this.end.column=foldBefore.end.column;folds=folds.splice(i,folds.length-i);var newFoldLine=new FoldLine(foldData,folds);foldData.splice(foldData.indexOf(this)+1,0,newFoldLine);return newFoldLine;};this.merge=function(foldLineNext){var folds=foldLineNext.folds;for(var i=0;i<folds.length;i++){this.addFold(folds[i]);}
var foldData=this.foldData;foldData.splice(foldData.indexOf(foldLineNext),1);};this.toString=function(){var ret=[this.range.toString()+": ["];this.folds.forEach(function(fold){ret.push("  "+fold.toString());});ret.push("]");return ret.join("\n");};this.idxToPosition=function(idx){var lastFoldEndColumn=0;for(var i=0;i<this.folds.length;i++){var fold=this.folds[i];idx-=fold.start.column-lastFoldEndColumn;if(idx<0){return{row:fold.start.row,column:fold.start.column+idx};}
idx-=fold.placeholder.length;if(idx<0){return fold.start;}
lastFoldEndColumn=fold.end.column;}
return{row:this.end.row,column:this.end.column+idx};};}).call(FoldLine.prototype);exports.FoldLine=FoldLine;});define("ace/range_list",["require","exports","module","ace/range"],function(require,exports,module){"use strict";var Range=require("./range").Range;var comparePoints=Range.comparePoints;var RangeList=function(){this.ranges=[];};(function(){this.comparePoints=comparePoints;this.pointIndex=function(pos,excludeEdges,startIndex){var list=this.ranges;for(var i=startIndex||0;i<list.length;i++){var range=list[i];var cmpEnd=comparePoints(pos,range.end);if(cmpEnd>0)
continue;var cmpStart=comparePoints(pos,range.start);if(cmpEnd===0)
return excludeEdges&&cmpStart!==0?-i-2:i;if(cmpStart>0||(cmpStart===0&&!excludeEdges))
return i;return-i-1;}
return-i-1;};this.add=function(range){var excludeEdges=!range.isEmpty();var startIndex=this.pointIndex(range.start,excludeEdges);if(startIndex<0)
startIndex=-startIndex-1;var endIndex=this.pointIndex(range.end,excludeEdges,startIndex);if(endIndex<0)
endIndex=-endIndex-1;else
endIndex++;return this.ranges.splice(startIndex,endIndex-startIndex,range);};this.addList=function(list){var removed=[];for(var i=list.length;i--;){removed.push.apply(removed,this.add(list[i]));}
return removed;};this.substractPoint=function(pos){var i=this.pointIndex(pos);if(i>=0)
return this.ranges.splice(i,1);};this.merge=function(){var removed=[];var list=this.ranges;list=list.sort(function(a,b){return comparePoints(a.start,b.start);});var next=list[0],range;for(var i=1;i<list.length;i++){range=next;next=list[i];var cmp=comparePoints(range.end,next.start);if(cmp<0)
continue;if(cmp==0&&!range.isEmpty()&&!next.isEmpty())
continue;if(comparePoints(range.end,next.end)<0){range.end.row=next.end.row;range.end.column=next.end.column;}
list.splice(i,1);removed.push(next);next=range;i--;}
this.ranges=list;return removed;};this.contains=function(row,column){return this.pointIndex({row:row,column:column})>=0;};this.containsPoint=function(pos){return this.pointIndex(pos)>=0;};this.rangeAtPoint=function(pos){var i=this.pointIndex(pos);if(i>=0)
return this.ranges[i];};this.clipRows=function(startRow,endRow){var list=this.ranges;if(list[0].start.row>endRow||list[list.length-1].start.row<startRow)
return[];var startIndex=this.pointIndex({row:startRow,column:0});if(startIndex<0)
startIndex=-startIndex-1;var endIndex=this.pointIndex({row:endRow,column:0},startIndex);if(endIndex<0)
endIndex=-endIndex-1;var clipped=[];for(var i=startIndex;i<endIndex;i++){clipped.push(list[i]);}
return clipped;};this.removeAll=function(){return this.ranges.splice(0,this.ranges.length);};this.attach=function(session){if(this.session)
this.detach();this.session=session;this.onChange=this.$onChange.bind(this);this.session.on('change',this.onChange);};this.detach=function(){if(!this.session)
return;this.session.removeListener('change',this.onChange);this.session=null;};this.$onChange=function(delta){if(delta.action=="insert"){var start=delta.start;var end=delta.end;}else{var end=delta.start;var start=delta.end;}
var startRow=start.row;var endRow=end.row;var lineDif=endRow-startRow;var colDiff=-start.column+end.column;var ranges=this.ranges;for(var i=0,n=ranges.length;i<n;i++){var r=ranges[i];if(r.end.row<startRow)
continue;if(r.start.row>startRow)
break;if(r.start.row==startRow&&r.start.column>=start.column){if(r.start.column==start.column&&this.$insertRight){}else{r.start.column+=colDiff;r.start.row+=lineDif;}}
if(r.end.row==startRow&&r.end.column>=start.column){if(r.end.column==start.column&&this.$insertRight){continue;}
if(r.end.column==start.column&&colDiff>0&&i<n-1){if(r.end.column>r.start.column&&r.end.column==ranges[i+1].start.column)
r.end.column-=colDiff;}
r.end.column+=colDiff;r.end.row+=lineDif;}}
if(lineDif!=0&&i<n){for(;i<n;i++){var r=ranges[i];r.start.row+=lineDif;r.end.row+=lineDif;}}};}).call(RangeList.prototype);exports.RangeList=RangeList;});define("ace/edit_session/fold",["require","exports","module","ace/range","ace/range_list","ace/lib/oop"],function(require,exports,module){"use strict";var Range=require("../range").Range;var RangeList=require("../range_list").RangeList;var oop=require("../lib/oop");var Fold=exports.Fold=function(range,placeholder){this.foldLine=null;this.placeholder=placeholder;this.range=range;this.start=range.start;this.end=range.end;this.sameRow=range.start.row==range.end.row;this.subFolds=this.ranges=[];};oop.inherits(Fold,RangeList);(function(){this.toString=function(){return'"'+this.placeholder+'" '+this.range.toString();};this.setFoldLine=function(foldLine){this.foldLine=foldLine;this.subFolds.forEach(function(fold){fold.setFoldLine(foldLine);});};this.clone=function(){var range=this.range.clone();var fold=new Fold(range,this.placeholder);this.subFolds.forEach(function(subFold){fold.subFolds.push(subFold.clone());});fold.collapseChildren=this.collapseChildren;return fold;};this.addSubFold=function(fold){if(this.range.isEqual(fold))
return;if(!this.range.containsRange(fold))
throw new Error("A fold can't intersect already existing fold"+fold.range+this.range);consumeRange(fold,this.start);var row=fold.start.row,column=fold.start.column;for(var i=0,cmp=-1;i<this.subFolds.length;i++){cmp=this.subFolds[i].range.compare(row,column);if(cmp!=1)
break;}
var afterStart=this.subFolds[i];if(cmp==0)
return afterStart.addSubFold(fold);var row=fold.range.end.row,column=fold.range.end.column;for(var j=i,cmp=-1;j<this.subFolds.length;j++){cmp=this.subFolds[j].range.compare(row,column);if(cmp!=1)
break;}
var afterEnd=this.subFolds[j];if(cmp==0)
throw new Error("A fold can't intersect already existing fold"+fold.range+this.range);var consumedFolds=this.subFolds.splice(i,j-i,fold);fold.setFoldLine(this.foldLine);return fold;};this.restoreRange=function(range){return restoreRange(range,this.start);};}).call(Fold.prototype);function consumePoint(point,anchor){point.row-=anchor.row;if(point.row==0)
point.column-=anchor.column;}
function consumeRange(range,anchor){consumePoint(range.start,anchor);consumePoint(range.end,anchor);}
function restorePoint(point,anchor){if(point.row==0)
point.column+=anchor.column;point.row+=anchor.row;}
function restoreRange(range,anchor){restorePoint(range.start,anchor);restorePoint(range.end,anchor);}});define("ace/edit_session/folding",["require","exports","module","ace/range","ace/edit_session/fold_line","ace/edit_session/fold","ace/token_iterator"],function(require,exports,module){"use strict";var Range=require("../range").Range;var FoldLine=require("./fold_line").FoldLine;var Fold=require("./fold").Fold;var TokenIterator=require("../token_iterator").TokenIterator;function Folding(){this.getFoldAt=function(row,column,side){var foldLine=this.getFoldLine(row);if(!foldLine)
return null;var folds=foldLine.folds;for(var i=0;i<folds.length;i++){var fold=folds[i];if(fold.range.contains(row,column)){if(side==1&&fold.range.isEnd(row,column)){continue;}else if(side==-1&&fold.range.isStart(row,column)){continue;}
return fold;}}};this.getFoldsInRange=function(range){var start=range.start;var end=range.end;var foldLines=this.$foldData;var foundFolds=[];start.column+=1;end.column-=1;for(var i=0;i<foldLines.length;i++){var cmp=foldLines[i].range.compareRange(range);if(cmp==2){continue;}
else if(cmp==-2){break;}
var folds=foldLines[i].folds;for(var j=0;j<folds.length;j++){var fold=folds[j];cmp=fold.range.compareRange(range);if(cmp==-2){break;}else if(cmp==2){continue;}else
if(cmp==42){break;}
foundFolds.push(fold);}}
start.column-=1;end.column+=1;return foundFolds;};this.getFoldsInRangeList=function(ranges){if(Array.isArray(ranges)){var folds=[];ranges.forEach(function(range){folds=folds.concat(this.getFoldsInRange(range));},this);}else{var folds=this.getFoldsInRange(ranges);}
return folds;};this.getAllFolds=function(){var folds=[];var foldLines=this.$foldData;for(var i=0;i<foldLines.length;i++)
for(var j=0;j<foldLines[i].folds.length;j++)
folds.push(foldLines[i].folds[j]);return folds;};this.getFoldStringAt=function(row,column,trim,foldLine){foldLine=foldLine||this.getFoldLine(row);if(!foldLine)
return null;var lastFold={end:{column:0}};var str,fold;for(var i=0;i<foldLine.folds.length;i++){fold=foldLine.folds[i];var cmp=fold.range.compareEnd(row,column);if(cmp==-1){str=this.getLine(fold.start.row).substring(lastFold.end.column,fold.start.column);break;}
else if(cmp===0){return null;}
lastFold=fold;}
if(!str)
str=this.getLine(fold.start.row).substring(lastFold.end.column);if(trim==-1)
return str.substring(0,column-lastFold.end.column);else if(trim==1)
return str.substring(column-lastFold.end.column);else
return str;};this.getFoldLine=function(docRow,startFoldLine){var foldData=this.$foldData;var i=0;if(startFoldLine)
i=foldData.indexOf(startFoldLine);if(i==-1)
i=0;for(i;i<foldData.length;i++){var foldLine=foldData[i];if(foldLine.start.row<=docRow&&foldLine.end.row>=docRow){return foldLine;}else if(foldLine.end.row>docRow){return null;}}
return null;};this.getNextFoldLine=function(docRow,startFoldLine){var foldData=this.$foldData;var i=0;if(startFoldLine)
i=foldData.indexOf(startFoldLine);if(i==-1)
i=0;for(i;i<foldData.length;i++){var foldLine=foldData[i];if(foldLine.end.row>=docRow){return foldLine;}}
return null;};this.getFoldedRowCount=function(first,last){var foldData=this.$foldData,rowCount=last-first+1;for(var i=0;i<foldData.length;i++){var foldLine=foldData[i],end=foldLine.end.row,start=foldLine.start.row;if(end>=last){if(start<last){if(start>=first)
rowCount-=last-start;else
rowCount=0;}
break;}else if(end>=first){if(start>=first)
rowCount-=end-start;else
rowCount-=end-first+1;}}
return rowCount;};this.$addFoldLine=function(foldLine){this.$foldData.push(foldLine);this.$foldData.sort(function(a,b){return a.start.row-b.start.row;});return foldLine;};this.addFold=function(placeholder,range){var foldData=this.$foldData;var added=false;var fold;if(placeholder instanceof Fold)
fold=placeholder;else{fold=new Fold(range,placeholder);fold.collapseChildren=range.collapseChildren;}
this.$clipRangeToDocument(fold.range);var startRow=fold.start.row;var startColumn=fold.start.column;var endRow=fold.end.row;var endColumn=fold.end.column;if(!(startRow<endRow||startRow==endRow&&startColumn<=endColumn-2))
throw new Error("The range has to be at least 2 characters width");var startFold=this.getFoldAt(startRow,startColumn,1);var endFold=this.getFoldAt(endRow,endColumn,-1);if(startFold&&endFold==startFold)
return startFold.addSubFold(fold);if(startFold&&!startFold.range.isStart(startRow,startColumn))
this.removeFold(startFold);if(endFold&&!endFold.range.isEnd(endRow,endColumn))
this.removeFold(endFold);var folds=this.getFoldsInRange(fold.range);if(folds.length>0){this.removeFolds(folds);folds.forEach(function(subFold){fold.addSubFold(subFold);});}
for(var i=0;i<foldData.length;i++){var foldLine=foldData[i];if(endRow==foldLine.start.row){foldLine.addFold(fold);added=true;break;}else if(startRow==foldLine.end.row){foldLine.addFold(fold);added=true;if(!fold.sameRow){var foldLineNext=foldData[i+1];if(foldLineNext&&foldLineNext.start.row==endRow){foldLine.merge(foldLineNext);break;}}
break;}else if(endRow<=foldLine.start.row){break;}}
if(!added)
foldLine=this.$addFoldLine(new FoldLine(this.$foldData,fold));if(this.$useWrapMode)
this.$updateWrapData(foldLine.start.row,foldLine.start.row);else
this.$updateRowLengthCache(foldLine.start.row,foldLine.start.row);this.$modified=true;this._signal("changeFold",{data:fold,action:"add"});return fold;};this.addFolds=function(folds){folds.forEach(function(fold){this.addFold(fold);},this);};this.removeFold=function(fold){var foldLine=fold.foldLine;var startRow=foldLine.start.row;var endRow=foldLine.end.row;var foldLines=this.$foldData;var folds=foldLine.folds;if(folds.length==1){foldLines.splice(foldLines.indexOf(foldLine),1);}else
if(foldLine.range.isEnd(fold.end.row,fold.end.column)){folds.pop();foldLine.end.row=folds[folds.length-1].end.row;foldLine.end.column=folds[folds.length-1].end.column;}else
if(foldLine.range.isStart(fold.start.row,fold.start.column)){folds.shift();foldLine.start.row=folds[0].start.row;foldLine.start.column=folds[0].start.column;}else
if(fold.sameRow){folds.splice(folds.indexOf(fold),1);}else
{var newFoldLine=foldLine.split(fold.start.row,fold.start.column);folds=newFoldLine.folds;folds.shift();newFoldLine.start.row=folds[0].start.row;newFoldLine.start.column=folds[0].start.column;}
if(!this.$updating){if(this.$useWrapMode)
this.$updateWrapData(startRow,endRow);else
this.$updateRowLengthCache(startRow,endRow);}
this.$modified=true;this._signal("changeFold",{data:fold,action:"remove"});};this.removeFolds=function(folds){var cloneFolds=[];for(var i=0;i<folds.length;i++){cloneFolds.push(folds[i]);}
cloneFolds.forEach(function(fold){this.removeFold(fold);},this);this.$modified=true;};this.expandFold=function(fold){this.removeFold(fold);fold.subFolds.forEach(function(subFold){fold.restoreRange(subFold);this.addFold(subFold);},this);if(fold.collapseChildren>0){this.foldAll(fold.start.row+1,fold.end.row,fold.collapseChildren-1);}
fold.subFolds=[];};this.expandFolds=function(folds){folds.forEach(function(fold){this.expandFold(fold);},this);};this.unfold=function(location,expandInner){var range,folds;if(location==null){range=new Range(0,0,this.getLength(),0);expandInner=true;}else if(typeof location=="number")
range=new Range(location,0,location,this.getLine(location).length);else if("row"in location)
range=Range.fromPoints(location,location);else
range=location;folds=this.getFoldsInRangeList(range);if(expandInner){this.removeFolds(folds);}else{var subFolds=folds;while(subFolds.length){this.expandFolds(subFolds);subFolds=this.getFoldsInRangeList(range);}}
if(folds.length)
return folds;};this.isRowFolded=function(docRow,startFoldRow){return!!this.getFoldLine(docRow,startFoldRow);};this.getRowFoldEnd=function(docRow,startFoldRow){var foldLine=this.getFoldLine(docRow,startFoldRow);return foldLine?foldLine.end.row:docRow;};this.getRowFoldStart=function(docRow,startFoldRow){var foldLine=this.getFoldLine(docRow,startFoldRow);return foldLine?foldLine.start.row:docRow;};this.getFoldDisplayLine=function(foldLine,endRow,endColumn,startRow,startColumn){if(startRow==null)
startRow=foldLine.start.row;if(startColumn==null)
startColumn=0;if(endRow==null)
endRow=foldLine.end.row;if(endColumn==null)
endColumn=this.getLine(endRow).length;var doc=this.doc;var textLine="";foldLine.walk(function(placeholder,row,column,lastColumn){if(row<startRow)
return;if(row==startRow){if(column<startColumn)
return;lastColumn=Math.max(startColumn,lastColumn);}
if(placeholder!=null){textLine+=placeholder;}else{textLine+=doc.getLine(row).substring(lastColumn,column);}},endRow,endColumn);return textLine;};this.getDisplayLine=function(row,endColumn,startRow,startColumn){var foldLine=this.getFoldLine(row);if(!foldLine){var line;line=this.doc.getLine(row);return line.substring(startColumn||0,endColumn||line.length);}else{return this.getFoldDisplayLine(foldLine,row,endColumn,startRow,startColumn);}};this.$cloneFoldData=function(){var fd=[];fd=this.$foldData.map(function(foldLine){var folds=foldLine.folds.map(function(fold){return fold.clone();});return new FoldLine(fd,folds);});return fd;};this.toggleFold=function(tryToUnfold){var selection=this.selection;var range=selection.getRange();var fold;var bracketPos;if(range.isEmpty()){var cursor=range.start;fold=this.getFoldAt(cursor.row,cursor.column);if(fold){this.expandFold(fold);return;}else if(bracketPos=this.findMatchingBracket(cursor)){if(range.comparePoint(bracketPos)==1){range.end=bracketPos;}else{range.start=bracketPos;range.start.column++;range.end.column--;}}else if(bracketPos=this.findMatchingBracket({row:cursor.row,column:cursor.column+1})){if(range.comparePoint(bracketPos)==1)
range.end=bracketPos;else
range.start=bracketPos;range.start.column++;}else{range=this.getCommentFoldRange(cursor.row,cursor.column)||range;}}else{var folds=this.getFoldsInRange(range);if(tryToUnfold&&folds.length){this.expandFolds(folds);return;}else if(folds.length==1){fold=folds[0];}}
if(!fold)
fold=this.getFoldAt(range.start.row,range.start.column);if(fold&&fold.range.toString()==range.toString()){this.expandFold(fold);return;}
var placeholder="...";if(!range.isMultiLine()){placeholder=this.getTextRange(range);if(placeholder.length<4)
return;placeholder=placeholder.trim().substring(0,2)+"..";}
this.addFold(placeholder,range);};this.getCommentFoldRange=function(row,column,dir){var iterator=new TokenIterator(this,row,column);var token=iterator.getCurrentToken();var type=token.type;if(token&&/^comment|string/.test(type)){type=type.match(/comment|string/)[0];if(type=="comment")
type+="|doc-start";var re=new RegExp(type);var range=new Range();if(dir!=1){do{token=iterator.stepBackward();}while(token&&re.test(token.type));iterator.stepForward();}
range.start.row=iterator.getCurrentTokenRow();range.start.column=iterator.getCurrentTokenColumn()+2;iterator=new TokenIterator(this,row,column);if(dir!=-1){var lastRow=-1;do{token=iterator.stepForward();if(lastRow==-1){var state=this.getState(iterator.$row);if(!re.test(state))
lastRow=iterator.$row;}else if(iterator.$row>lastRow){break;}}while(token&&re.test(token.type));token=iterator.stepBackward();}else
token=iterator.getCurrentToken();range.end.row=iterator.getCurrentTokenRow();range.end.column=iterator.getCurrentTokenColumn()+token.value.length-2;return range;}};this.foldAll=function(startRow,endRow,depth){if(depth==undefined)
depth=100000;var foldWidgets=this.foldWidgets;if(!foldWidgets)
return;endRow=endRow||this.getLength();startRow=startRow||0;for(var row=startRow;row<endRow;row++){if(foldWidgets[row]==null)
foldWidgets[row]=this.getFoldWidget(row);if(foldWidgets[row]!="start")
continue;var range=this.getFoldWidgetRange(row);if(range&&range.isMultiLine()&&range.end.row<=endRow&&range.start.row>=startRow){row=range.end.row;try{var fold=this.addFold("...",range);if(fold)
fold.collapseChildren=depth;}catch(e){}}}};this.$foldStyles={"manual":1,"markbegin":1,"markbeginend":1};this.$foldStyle="markbegin";this.setFoldStyle=function(style){if(!this.$foldStyles[style])
throw new Error("invalid fold style: "+style+"["+Object.keys(this.$foldStyles).join(", ")+"]");if(this.$foldStyle==style)
return;this.$foldStyle=style;if(style=="manual")
this.unfold();var mode=this.$foldMode;this.$setFolding(null);this.$setFolding(mode);};this.$setFolding=function(foldMode){if(this.$foldMode==foldMode)
return;this.$foldMode=foldMode;this.off('change',this.$updateFoldWidgets);this.off('tokenizerUpdate',this.$tokenizerUpdateFoldWidgets);this._signal("changeAnnotation");if(!foldMode||this.$foldStyle=="manual"){this.foldWidgets=null;return;}
this.foldWidgets=[];this.getFoldWidget=foldMode.getFoldWidget.bind(foldMode,this,this.$foldStyle);this.getFoldWidgetRange=foldMode.getFoldWidgetRange.bind(foldMode,this,this.$foldStyle);this.$updateFoldWidgets=this.updateFoldWidgets.bind(this);this.$tokenizerUpdateFoldWidgets=this.tokenizerUpdateFoldWidgets.bind(this);this.on('change',this.$updateFoldWidgets);this.on('tokenizerUpdate',this.$tokenizerUpdateFoldWidgets);};this.getParentFoldRangeData=function(row,ignoreCurrent){var fw=this.foldWidgets;if(!fw||(ignoreCurrent&&fw[row]))
return{};var i=row-1,firstRange;while(i>=0){var c=fw[i];if(c==null)
c=fw[i]=this.getFoldWidget(i);if(c=="start"){var range=this.getFoldWidgetRange(i);if(!firstRange)
firstRange=range;if(range&&range.end.row>=row)
break;}
i--;}
return{range:i!==-1&&range,firstRange:firstRange};};this.onFoldWidgetClick=function(row,e){e=e.domEvent;var options={children:e.shiftKey,all:e.ctrlKey||e.metaKey,siblings:e.altKey};var range=this.$toggleFoldWidget(row,options);if(!range){var el=(e.target||e.srcElement);if(el&&/ace_fold-widget/.test(el.className))
el.className+=" ace_invalid";}};this.$toggleFoldWidget=function(row,options){if(!this.getFoldWidget)
return;var type=this.getFoldWidget(row);var line=this.getLine(row);var dir=type==="end"?-1:1;var fold=this.getFoldAt(row,dir===-1?0:line.length,dir);if(fold){if(options.children||options.all)
this.removeFold(fold);else
this.expandFold(fold);return fold;}
var range=this.getFoldWidgetRange(row,true);if(range&&!range.isMultiLine()){fold=this.getFoldAt(range.start.row,range.start.column,1);if(fold&&range.isEqual(fold.range)){this.removeFold(fold);return fold;}}
if(options.siblings){var data=this.getParentFoldRangeData(row);if(data.range){var startRow=data.range.start.row+1;var endRow=data.range.end.row;}
this.foldAll(startRow,endRow,options.all?10000:0);}else if(options.children){endRow=range?range.end.row:this.getLength();this.foldAll(row+1,endRow,options.all?10000:0);}else if(range){if(options.all)
range.collapseChildren=10000;this.addFold("...",range);}
return range;};this.toggleFoldWidget=function(toggleParent){var row=this.selection.getCursor().row;row=this.getRowFoldStart(row);var range=this.$toggleFoldWidget(row,{});if(range)
return;var data=this.getParentFoldRangeData(row,true);range=data.range||data.firstRange;if(range){row=range.start.row;var fold=this.getFoldAt(row,this.getLine(row).length,1);if(fold){this.removeFold(fold);}else{this.addFold("...",range);}}};this.updateFoldWidgets=function(delta){var firstRow=delta.start.row;var len=delta.end.row-firstRow;if(len===0){this.foldWidgets[firstRow]=null;}else if(delta.action=='remove'){this.foldWidgets.splice(firstRow,len+1,null);}else{var args=Array(len+1);args.unshift(firstRow,1);this.foldWidgets.splice.apply(this.foldWidgets,args);}};this.tokenizerUpdateFoldWidgets=function(e){var rows=e.data;if(rows.first!=rows.last){if(this.foldWidgets.length>rows.first)
this.foldWidgets.splice(rows.first,this.foldWidgets.length);}};}
exports.Folding=Folding;});define("ace/edit_session/bracket_match",["require","exports","module","ace/token_iterator","ace/range"],function(require,exports,module){"use strict";var TokenIterator=require("../token_iterator").TokenIterator;var Range=require("../range").Range;function BracketMatch(){this.findMatchingBracket=function(position,chr){if(position.column==0)return null;var charBeforeCursor=chr||this.getLine(position.row).charAt(position.column-1);if(charBeforeCursor=="")return null;var match=charBeforeCursor.match(/([\(\[\{])|([\)\]\}])/);if(!match)
return null;if(match[1])
return this.$findClosingBracket(match[1],position);else
return this.$findOpeningBracket(match[2],position);};this.getBracketRange=function(pos){var line=this.getLine(pos.row);var before=true,range;var chr=line.charAt(pos.column-1);var match=chr&&chr.match(/([\(\[\{])|([\)\]\}])/);if(!match){chr=line.charAt(pos.column);pos={row:pos.row,column:pos.column+1};match=chr&&chr.match(/([\(\[\{])|([\)\]\}])/);before=false;}
if(!match)
return null;if(match[1]){var bracketPos=this.$findClosingBracket(match[1],pos);if(!bracketPos)
return null;range=Range.fromPoints(pos,bracketPos);if(!before){range.end.column++;range.start.column--;}
range.cursor=range.end;}else{var bracketPos=this.$findOpeningBracket(match[2],pos);if(!bracketPos)
return null;range=Range.fromPoints(bracketPos,pos);if(!before){range.start.column++;range.end.column--;}
range.cursor=range.start;}
return range;};this.$brackets={")":"(","(":")","]":"[","[":"]","{":"}","}":"{"};this.$findOpeningBracket=function(bracket,position,typeRe){var openBracket=this.$brackets[bracket];var depth=1;var iterator=new TokenIterator(this,position.row,position.column);var token=iterator.getCurrentToken();if(!token)
token=iterator.stepForward();if(!token)
return;if(!typeRe){typeRe=new RegExp("(\\.?"+
token.type.replace(".","\\.").replace("rparen",".paren").replace(/\b(?:end)\b/,"(?:start|begin|end)")
+")+");}
var valueIndex=position.column-iterator.getCurrentTokenColumn()-2;var value=token.value;while(true){while(valueIndex>=0){var chr=value.charAt(valueIndex);if(chr==openBracket){depth-=1;if(depth==0){return{row:iterator.getCurrentTokenRow(),column:valueIndex+iterator.getCurrentTokenColumn()};}}
else if(chr==bracket){depth+=1;}
valueIndex-=1;}
do{token=iterator.stepBackward();}while(token&&!typeRe.test(token.type));if(token==null)
break;value=token.value;valueIndex=value.length-1;}
return null;};this.$findClosingBracket=function(bracket,position,typeRe){var closingBracket=this.$brackets[bracket];var depth=1;var iterator=new TokenIterator(this,position.row,position.column);var token=iterator.getCurrentToken();if(!token)
token=iterator.stepForward();if(!token)
return;if(!typeRe){typeRe=new RegExp("(\\.?"+
token.type.replace(".","\\.").replace("lparen",".paren").replace(/\b(?:start|begin)\b/,"(?:start|begin|end)")
+")+");}
var valueIndex=position.column-iterator.getCurrentTokenColumn();while(true){var value=token.value;var valueLength=value.length;while(valueIndex<valueLength){var chr=value.charAt(valueIndex);if(chr==closingBracket){depth-=1;if(depth==0){return{row:iterator.getCurrentTokenRow(),column:valueIndex+iterator.getCurrentTokenColumn()};}}
else if(chr==bracket){depth+=1;}
valueIndex+=1;}
do{token=iterator.stepForward();}while(token&&!typeRe.test(token.type));if(token==null)
break;valueIndex=0;}
return null;};}
exports.BracketMatch=BracketMatch;});define("ace/edit_session",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/bidihandler","ace/config","ace/lib/event_emitter","ace/selection","ace/mode/text","ace/range","ace/document","ace/background_tokenizer","ace/search_highlight","ace/edit_session/folding","ace/edit_session/bracket_match"],function(require,exports,module){"use strict";var oop=require("./lib/oop");var lang=require("./lib/lang");var BidiHandler=require("./bidihandler").BidiHandler;var config=require("./config");var EventEmitter=require("./lib/event_emitter").EventEmitter;var Selection=require("./selection").Selection;var TextMode=require("./mode/text").Mode;var Range=require("./range").Range;var Document=require("./document").Document;var BackgroundTokenizer=require("./background_tokenizer").BackgroundTokenizer;var SearchHighlight=require("./search_highlight").SearchHighlight;var EditSession=function(text,mode){this.$breakpoints=[];this.$decorations=[];this.$frontMarkers={};this.$backMarkers={};this.$markerId=1;this.$undoSelect=true;this.$foldData=[];this.id="session"+(++EditSession.$uid);this.$foldData.toString=function(){return this.join("\n");};this.on("changeFold",this.onChangeFold.bind(this));this.$onChange=this.onChange.bind(this);if(typeof text!="object"||!text.getLine)
text=new Document(text);this.$bidiHandler=new BidiHandler(this);this.setDocument(text);this.selection=new Selection(this);config.resetOptions(this);this.setMode(mode);config._signal("session",this);};EditSession.$uid=0;(function(){oop.implement(this,EventEmitter);this.setDocument=function(doc){if(this.doc)
this.doc.removeListener("change",this.$onChange);this.doc=doc;doc.on("change",this.$onChange);if(this.bgTokenizer)
this.bgTokenizer.setDocument(this.getDocument());this.resetCaches();};this.getDocument=function(){return this.doc;};this.$resetRowCache=function(docRow){if(!docRow){this.$docRowCache=[];this.$screenRowCache=[];return;}
var l=this.$docRowCache.length;var i=this.$getRowCacheIndex(this.$docRowCache,docRow)+1;if(l>i){this.$docRowCache.splice(i,l);this.$screenRowCache.splice(i,l);}};this.$getRowCacheIndex=function(cacheArray,val){var low=0;var hi=cacheArray.length-1;while(low<=hi){var mid=(low+hi)>>1;var c=cacheArray[mid];if(val>c)
low=mid+1;else if(val<c)
hi=mid-1;else
return mid;}
return low-1;};this.resetCaches=function(){this.$modified=true;this.$wrapData=[];this.$rowLengthCache=[];this.$resetRowCache(0);if(this.bgTokenizer)
this.bgTokenizer.start(0);};this.onChangeFold=function(e){var fold=e.data;this.$resetRowCache(fold.start.row);};this.onChange=function(delta){this.$modified=true;this.$bidiHandler.onChange(delta);this.$resetRowCache(delta.start.row);var removedFolds=this.$updateInternalDataOnChange(delta);if(!this.$fromUndo&&this.$undoManager){if(removedFolds&&removedFolds.length){this.$undoManager.add({action:"removeFolds",folds:removedFolds},this.mergeUndoDeltas);this.mergeUndoDeltas=true;}
this.$undoManager.add(delta,this.mergeUndoDeltas);this.mergeUndoDeltas=true;this.$informUndoManager.schedule();}
this.bgTokenizer&&this.bgTokenizer.$updateOnChange(delta);this._signal("change",delta);};this.setValue=function(text){this.doc.setValue(text);this.selection.moveTo(0,0);this.$resetRowCache(0);this.setUndoManager(this.$undoManager);this.getUndoManager().reset();};this.getValue=this.toString=function(){return this.doc.getValue();};this.getSelection=function(){return this.selection;};this.getState=function(row){return this.bgTokenizer.getState(row);};this.getTokens=function(row){return this.bgTokenizer.getTokens(row);};this.getTokenAt=function(row,column){var tokens=this.bgTokenizer.getTokens(row);var token,c=0;if(column==null){var i=tokens.length-1;c=this.getLine(row).length;}else{for(var i=0;i<tokens.length;i++){c+=tokens[i].value.length;if(c>=column)
break;}}
token=tokens[i];if(!token)
return null;token.index=i;token.start=c-token.value.length;return token;};this.setUndoManager=function(undoManager){this.$undoManager=undoManager;if(this.$informUndoManager)
this.$informUndoManager.cancel();if(undoManager){var self=this;undoManager.addSession(this);this.$syncInformUndoManager=function(){self.$informUndoManager.cancel();self.mergeUndoDeltas=false;};this.$informUndoManager=lang.delayedCall(this.$syncInformUndoManager);}else{this.$syncInformUndoManager=function(){};}};this.markUndoGroup=function(){if(this.$syncInformUndoManager)
this.$syncInformUndoManager();};this.$defaultUndoManager={undo:function(){},redo:function(){},reset:function(){},add:function(){},addSelection:function(){},startNewGroup:function(){},addSession:function(){}};this.getUndoManager=function(){return this.$undoManager||this.$defaultUndoManager;};this.getTabString=function(){if(this.getUseSoftTabs()){return lang.stringRepeat(" ",this.getTabSize());}else{return"\t";}};this.setUseSoftTabs=function(val){this.setOption("useSoftTabs",val);};this.getUseSoftTabs=function(){return this.$useSoftTabs&&!this.$mode.$indentWithTabs;};this.setTabSize=function(tabSize){this.setOption("tabSize",tabSize);};this.getTabSize=function(){return this.$tabSize;};this.isTabStop=function(position){return this.$useSoftTabs&&(position.column%this.$tabSize===0);};this.setNavigateWithinSoftTabs=function(navigateWithinSoftTabs){this.setOption("navigateWithinSoftTabs",navigateWithinSoftTabs);};this.getNavigateWithinSoftTabs=function(){return this.$navigateWithinSoftTabs;};this.$overwrite=false;this.setOverwrite=function(overwrite){this.setOption("overwrite",overwrite);};this.getOverwrite=function(){return this.$overwrite;};this.toggleOverwrite=function(){this.setOverwrite(!this.$overwrite);};this.addGutterDecoration=function(row,className){if(!this.$decorations[row])
this.$decorations[row]="";this.$decorations[row]+=" "+className;this._signal("changeBreakpoint",{});};this.removeGutterDecoration=function(row,className){this.$decorations[row]=(this.$decorations[row]||"").replace(" "+className,"");this._signal("changeBreakpoint",{});};this.getBreakpoints=function(){return this.$breakpoints;};this.setBreakpoints=function(rows){this.$breakpoints=[];for(var i=0;i<rows.length;i++){this.$breakpoints[rows[i]]="ace_breakpoint";}
this._signal("changeBreakpoint",{});};this.clearBreakpoints=function(){this.$breakpoints=[];this._signal("changeBreakpoint",{});};this.setBreakpoint=function(row,className){if(className===undefined)
className="ace_breakpoint";if(className)
this.$breakpoints[row]=className;else
delete this.$breakpoints[row];this._signal("changeBreakpoint",{});};this.clearBreakpoint=function(row){delete this.$breakpoints[row];this._signal("changeBreakpoint",{});};this.addMarker=function(range,clazz,type,inFront){var id=this.$markerId++;var marker={range:range,type:type||"line",renderer:typeof type=="function"?type:null,clazz:clazz,inFront:!!inFront,id:id};if(inFront){this.$frontMarkers[id]=marker;this._signal("changeFrontMarker");}else{this.$backMarkers[id]=marker;this._signal("changeBackMarker");}
return id;};this.addDynamicMarker=function(marker,inFront){if(!marker.update)
return;var id=this.$markerId++;marker.id=id;marker.inFront=!!inFront;if(inFront){this.$frontMarkers[id]=marker;this._signal("changeFrontMarker");}else{this.$backMarkers[id]=marker;this._signal("changeBackMarker");}
return marker;};this.removeMarker=function(markerId){var marker=this.$frontMarkers[markerId]||this.$backMarkers[markerId];if(!marker)
return;var markers=marker.inFront?this.$frontMarkers:this.$backMarkers;delete(markers[markerId]);this._signal(marker.inFront?"changeFrontMarker":"changeBackMarker");};this.getMarkers=function(inFront){return inFront?this.$frontMarkers:this.$backMarkers;};this.highlight=function(re){if(!this.$searchHighlight){var highlight=new SearchHighlight(null,"ace_selected-word","text");this.$searchHighlight=this.addDynamicMarker(highlight);}
this.$searchHighlight.setRegexp(re);};this.highlightLines=function(startRow,endRow,clazz,inFront){if(typeof endRow!="number"){clazz=endRow;endRow=startRow;}
if(!clazz)
clazz="ace_step";var range=new Range(startRow,0,endRow,Infinity);range.id=this.addMarker(range,clazz,"fullLine",inFront);return range;};this.setAnnotations=function(annotations){this.$annotations=annotations;this._signal("changeAnnotation",{});};this.getAnnotations=function(){return this.$annotations||[];};this.clearAnnotations=function(){this.setAnnotations([]);};this.$detectNewLine=function(text){var match=text.match(/^.*?(\r?\n)/m);if(match){this.$autoNewLine=match[1];}else{this.$autoNewLine="\n";}};this.getWordRange=function(row,column){var line=this.getLine(row);var inToken=false;if(column>0)
inToken=!!line.charAt(column-1).match(this.tokenRe);if(!inToken)
inToken=!!line.charAt(column).match(this.tokenRe);if(inToken)
var re=this.tokenRe;else if(/^\s+$/.test(line.slice(column-1,column+1)))
var re=/\s/;else
var re=this.nonTokenRe;var start=column;if(start>0){do{start--;}
while(start>=0&&line.charAt(start).match(re));start++;}
var end=column;while(end<line.length&&line.charAt(end).match(re)){end++;}
return new Range(row,start,row,end);};this.getAWordRange=function(row,column){var wordRange=this.getWordRange(row,column);var line=this.getLine(wordRange.end.row);while(line.charAt(wordRange.end.column).match(/[ \t]/)){wordRange.end.column+=1;}
return wordRange;};this.setNewLineMode=function(newLineMode){this.doc.setNewLineMode(newLineMode);};this.getNewLineMode=function(){return this.doc.getNewLineMode();};this.setUseWorker=function(useWorker){this.setOption("useWorker",useWorker);};this.getUseWorker=function(){return this.$useWorker;};this.onReloadTokenizer=function(e){var rows=e.data;this.bgTokenizer.start(rows.first);this._signal("tokenizerUpdate",e);};this.$modes={};this.$mode=null;this.$modeId=null;this.setMode=function(mode,cb){if(mode&&typeof mode==="object"){if(mode.getTokenizer)
return this.$onChangeMode(mode);var options=mode;var path=options.path;}else{path=mode||"ace/mode/text";}
if(!this.$modes["ace/mode/text"])
this.$modes["ace/mode/text"]=new TextMode();if(this.$modes[path]&&!options){this.$onChangeMode(this.$modes[path]);cb&&cb();return;}
this.$modeId=path;config.loadModule(["mode",path],function(m){if(this.$modeId!==path)
return cb&&cb();if(this.$modes[path]&&!options){this.$onChangeMode(this.$modes[path]);}else if(m&&m.Mode){m=new m.Mode(options);if(!options){this.$modes[path]=m;m.$id=path;}
this.$onChangeMode(m);}
cb&&cb();}.bind(this));if(!this.$mode)
this.$onChangeMode(this.$modes["ace/mode/text"],true);};this.$onChangeMode=function(mode,$isPlaceholder){if(!$isPlaceholder)
this.$modeId=mode.$id;if(this.$mode===mode)
return;this.$mode=mode;this.$stopWorker();if(this.$useWorker)
this.$startWorker();var tokenizer=mode.getTokenizer();if(tokenizer.addEventListener!==undefined){var onReloadTokenizer=this.onReloadTokenizer.bind(this);tokenizer.addEventListener("update",onReloadTokenizer);}
if(!this.bgTokenizer){this.bgTokenizer=new BackgroundTokenizer(tokenizer);var _self=this;this.bgTokenizer.addEventListener("update",function(e){_self._signal("tokenizerUpdate",e);});}else{this.bgTokenizer.setTokenizer(tokenizer);}
this.bgTokenizer.setDocument(this.getDocument());this.tokenRe=mode.tokenRe;this.nonTokenRe=mode.nonTokenRe;if(!$isPlaceholder){if(mode.attachToSession)
mode.attachToSession(this);this.$options.wrapMethod.set.call(this,this.$wrapMethod);this.$setFolding(mode.foldingRules);this.bgTokenizer.start(0);this._emit("changeMode");}};this.$stopWorker=function(){if(this.$worker){this.$worker.terminate();this.$worker=null;}};this.$startWorker=function(){try{this.$worker=this.$mode.createWorker(this);}catch(e){config.warn("Could not load worker",e);this.$worker=null;}};this.getMode=function(){return this.$mode;};this.$scrollTop=0;this.setScrollTop=function(scrollTop){if(this.$scrollTop===scrollTop||isNaN(scrollTop))
return;this.$scrollTop=scrollTop;this._signal("changeScrollTop",scrollTop);};this.getScrollTop=function(){return this.$scrollTop;};this.$scrollLeft=0;this.setScrollLeft=function(scrollLeft){if(this.$scrollLeft===scrollLeft||isNaN(scrollLeft))
return;this.$scrollLeft=scrollLeft;this._signal("changeScrollLeft",scrollLeft);};this.getScrollLeft=function(){return this.$scrollLeft;};this.getScreenWidth=function(){this.$computeWidth();if(this.lineWidgets)
return Math.max(this.getLineWidgetMaxWidth(),this.screenWidth);return this.screenWidth;};this.getLineWidgetMaxWidth=function(){if(this.lineWidgetsWidth!=null)return this.lineWidgetsWidth;var width=0;this.lineWidgets.forEach(function(w){if(w&&w.screenWidth>width)
width=w.screenWidth;});return this.lineWidgetWidth=width;};this.$computeWidth=function(force){if(this.$modified||force){this.$modified=false;if(this.$useWrapMode)
return this.screenWidth=this.$wrapLimit;var lines=this.doc.getAllLines();var cache=this.$rowLengthCache;var longestScreenLine=0;var foldIndex=0;var foldLine=this.$foldData[foldIndex];var foldStart=foldLine?foldLine.start.row:Infinity;var len=lines.length;for(var i=0;i<len;i++){if(i>foldStart){i=foldLine.end.row+1;if(i>=len)
break;foldLine=this.$foldData[foldIndex++];foldStart=foldLine?foldLine.start.row:Infinity;}
if(cache[i]==null)
cache[i]=this.$getStringScreenWidth(lines[i])[0];if(cache[i]>longestScreenLine)
longestScreenLine=cache[i];}
this.screenWidth=longestScreenLine;}};this.getLine=function(row){return this.doc.getLine(row);};this.getLines=function(firstRow,lastRow){return this.doc.getLines(firstRow,lastRow);};this.getLength=function(){return this.doc.getLength();};this.getTextRange=function(range){return this.doc.getTextRange(range||this.selection.getRange());};this.insert=function(position,text){return this.doc.insert(position,text);};this.remove=function(range){return this.doc.remove(range);};this.removeFullLines=function(firstRow,lastRow){return this.doc.removeFullLines(firstRow,lastRow);};this.undoChanges=function(deltas,dontSelect){if(!deltas.length)
return;this.$fromUndo=true;for(var i=deltas.length-1;i!=-1;i--){var delta=deltas[i];if(delta.action=="insert"||delta.action=="remove"){this.doc.revertDelta(delta);}else if(delta.folds){this.addFolds(delta.folds);}}
if(!dontSelect&&this.$undoSelect){if(deltas.selectionBefore)
this.selection.fromJSON(deltas.selectionBefore);else
this.selection.setRange(this.$getUndoSelection(deltas,true));}
this.$fromUndo=false;};this.redoChanges=function(deltas,dontSelect){if(!deltas.length)
return;this.$fromUndo=true;for(var i=0;i<deltas.length;i++){var delta=deltas[i];if(delta.action=="insert"||delta.action=="remove"){this.doc.applyDelta(delta);}}
if(!dontSelect&&this.$undoSelect){if(deltas.selectionAfter)
this.selection.fromJSON(deltas.selectionAfter);else
this.selection.setRange(this.$getUndoSelection(deltas,false));}
this.$fromUndo=false;};this.setUndoSelect=function(enable){this.$undoSelect=enable;};this.$getUndoSelection=function(deltas,isUndo){function isInsert(delta){return isUndo?delta.action!=="insert":delta.action==="insert";}
var range,point;var lastDeltaIsInsert;for(var i=0;i<deltas.length;i++){var delta=deltas[i];if(!delta.start)continue;if(!range){if(isInsert(delta)){range=Range.fromPoints(delta.start,delta.end);lastDeltaIsInsert=true;}else{range=Range.fromPoints(delta.start,delta.start);lastDeltaIsInsert=false;}
continue;}
if(isInsert(delta)){point=delta.start;if(range.compare(point.row,point.column)==-1){range.setStart(point);}
point=delta.end;if(range.compare(point.row,point.column)==1){range.setEnd(point);}
lastDeltaIsInsert=true;}else{point=delta.start;if(range.compare(point.row,point.column)==-1){range=Range.fromPoints(delta.start,delta.start);}
lastDeltaIsInsert=false;}}
return range;};this.replace=function(range,text){return this.doc.replace(range,text);};this.moveText=function(fromRange,toPosition,copy){var text=this.getTextRange(fromRange);var folds=this.getFoldsInRange(fromRange);var toRange=Range.fromPoints(toPosition,toPosition);if(!copy){this.remove(fromRange);var rowDiff=fromRange.start.row-fromRange.end.row;var collDiff=rowDiff?-fromRange.end.column:fromRange.start.column-fromRange.end.column;if(collDiff){if(toRange.start.row==fromRange.end.row&&toRange.start.column>fromRange.end.column)
toRange.start.column+=collDiff;if(toRange.end.row==fromRange.end.row&&toRange.end.column>fromRange.end.column)
toRange.end.column+=collDiff;}
if(rowDiff&&toRange.start.row>=fromRange.end.row){toRange.start.row+=rowDiff;toRange.end.row+=rowDiff;}}
toRange.end=this.insert(toRange.start,text);if(folds.length){var oldStart=fromRange.start;var newStart=toRange.start;var rowDiff=newStart.row-oldStart.row;var collDiff=newStart.column-oldStart.column;this.addFolds(folds.map(function(x){x=x.clone();if(x.start.row==oldStart.row)
x.start.column+=collDiff;if(x.end.row==oldStart.row)
x.end.column+=collDiff;x.start.row+=rowDiff;x.end.row+=rowDiff;return x;}));}
return toRange;};this.indentRows=function(startRow,endRow,indentString){indentString=indentString.replace(/\t/g,this.getTabString());for(var row=startRow;row<=endRow;row++)
this.doc.insertInLine({row:row,column:0},indentString);};this.outdentRows=function(range){var rowRange=range.collapseRows();var deleteRange=new Range(0,0,0,0);var size=this.getTabSize();for(var i=rowRange.start.row;i<=rowRange.end.row;++i){var line=this.getLine(i);deleteRange.start.row=i;deleteRange.end.row=i;for(var j=0;j<size;++j)
if(line.charAt(j)!=' ')
break;if(j<size&&line.charAt(j)=='\t'){deleteRange.start.column=j;deleteRange.end.column=j+1;}else{deleteRange.start.column=0;deleteRange.end.column=j;}
this.remove(deleteRange);}};this.$moveLines=function(firstRow,lastRow,dir){firstRow=this.getRowFoldStart(firstRow);lastRow=this.getRowFoldEnd(lastRow);if(dir<0){var row=this.getRowFoldStart(firstRow+dir);if(row<0)return 0;var diff=row-firstRow;}else if(dir>0){var row=this.getRowFoldEnd(lastRow+dir);if(row>this.doc.getLength()-1)return 0;var diff=row-lastRow;}else{firstRow=this.$clipRowToDocument(firstRow);lastRow=this.$clipRowToDocument(lastRow);var diff=lastRow-firstRow+1;}
var range=new Range(firstRow,0,lastRow,Number.MAX_VALUE);var folds=this.getFoldsInRange(range).map(function(x){x=x.clone();x.start.row+=diff;x.end.row+=diff;return x;});var lines=dir==0?this.doc.getLines(firstRow,lastRow):this.doc.removeFullLines(firstRow,lastRow);this.doc.insertFullLines(firstRow+diff,lines);folds.length&&this.addFolds(folds);return diff;};this.moveLinesUp=function(firstRow,lastRow){return this.$moveLines(firstRow,lastRow,-1);};this.moveLinesDown=function(firstRow,lastRow){return this.$moveLines(firstRow,lastRow,1);};this.duplicateLines=function(firstRow,lastRow){return this.$moveLines(firstRow,lastRow,0);};this.$clipRowToDocument=function(row){return Math.max(0,Math.min(row,this.doc.getLength()-1));};this.$clipColumnToRow=function(row,column){if(column<0)
return 0;return Math.min(this.doc.getLine(row).length,column);};this.$clipPositionToDocument=function(row,column){column=Math.max(0,column);if(row<0){row=0;column=0;}else{var len=this.doc.getLength();if(row>=len){row=len-1;column=this.doc.getLine(len-1).length;}else{column=Math.min(this.doc.getLine(row).length,column);}}
return{row:row,column:column};};this.$clipRangeToDocument=function(range){if(range.start.row<0){range.start.row=0;range.start.column=0;}else{range.start.column=this.$clipColumnToRow(range.start.row,range.start.column);}
var len=this.doc.getLength()-1;if(range.end.row>len){range.end.row=len;range.end.column=this.doc.getLine(len).length;}else{range.end.column=this.$clipColumnToRow(range.end.row,range.end.column);}
return range;};this.$wrapLimit=80;this.$useWrapMode=false;this.$wrapLimitRange={min:null,max:null};this.setUseWrapMode=function(useWrapMode){if(useWrapMode!=this.$useWrapMode){this.$useWrapMode=useWrapMode;this.$modified=true;this.$resetRowCache(0);if(useWrapMode){var len=this.getLength();this.$wrapData=Array(len);this.$updateWrapData(0,len-1);}
this._signal("changeWrapMode");}};this.getUseWrapMode=function(){return this.$useWrapMode;};this.setWrapLimitRange=function(min,max){if(this.$wrapLimitRange.min!==min||this.$wrapLimitRange.max!==max){this.$wrapLimitRange={min:min,max:max};this.$modified=true;this.$bidiHandler.markAsDirty();if(this.$useWrapMode)
this._signal("changeWrapMode");}};this.adjustWrapLimit=function(desiredLimit,$printMargin){var limits=this.$wrapLimitRange;if(limits.max<0)
limits={min:$printMargin,max:$printMargin};var wrapLimit=this.$constrainWrapLimit(desiredLimit,limits.min,limits.max);if(wrapLimit!=this.$wrapLimit&&wrapLimit>1){this.$wrapLimit=wrapLimit;this.$modified=true;if(this.$useWrapMode){this.$updateWrapData(0,this.getLength()-1);this.$resetRowCache(0);this._signal("changeWrapLimit");}
return true;}
return false;};this.$constrainWrapLimit=function(wrapLimit,min,max){if(min)
wrapLimit=Math.max(min,wrapLimit);if(max)
wrapLimit=Math.min(max,wrapLimit);return wrapLimit;};this.getWrapLimit=function(){return this.$wrapLimit;};this.setWrapLimit=function(limit){this.setWrapLimitRange(limit,limit);};this.getWrapLimitRange=function(){return{min:this.$wrapLimitRange.min,max:this.$wrapLimitRange.max};};this.$updateInternalDataOnChange=function(delta){var useWrapMode=this.$useWrapMode;var action=delta.action;var start=delta.start;var end=delta.end;var firstRow=start.row;var lastRow=end.row;var len=lastRow-firstRow;var removedFolds=null;this.$updating=true;if(len!=0){if(action==="remove"){this[useWrapMode?"$wrapData":"$rowLengthCache"].splice(firstRow,len);var foldLines=this.$foldData;removedFolds=this.getFoldsInRange(delta);this.removeFolds(removedFolds);var foldLine=this.getFoldLine(end.row);var idx=0;if(foldLine){foldLine.addRemoveChars(end.row,end.column,start.column-end.column);foldLine.shiftRow(-len);var foldLineBefore=this.getFoldLine(firstRow);if(foldLineBefore&&foldLineBefore!==foldLine){foldLineBefore.merge(foldLine);foldLine=foldLineBefore;}
idx=foldLines.indexOf(foldLine)+1;}
for(idx;idx<foldLines.length;idx++){var foldLine=foldLines[idx];if(foldLine.start.row>=end.row){foldLine.shiftRow(-len);}}
lastRow=firstRow;}else{var args=Array(len);args.unshift(firstRow,0);var arr=useWrapMode?this.$wrapData:this.$rowLengthCache;arr.splice.apply(arr,args);var foldLines=this.$foldData;var foldLine=this.getFoldLine(firstRow);var idx=0;if(foldLine){var cmp=foldLine.range.compareInside(start.row,start.column);if(cmp==0){foldLine=foldLine.split(start.row,start.column);if(foldLine){foldLine.shiftRow(len);foldLine.addRemoveChars(lastRow,0,end.column-start.column);}}else
if(cmp==-1){foldLine.addRemoveChars(firstRow,0,end.column-start.column);foldLine.shiftRow(len);}
idx=foldLines.indexOf(foldLine)+1;}
for(idx;idx<foldLines.length;idx++){var foldLine=foldLines[idx];if(foldLine.start.row>=firstRow){foldLine.shiftRow(len);}}}}else{len=Math.abs(delta.start.column-delta.end.column);if(action==="remove"){removedFolds=this.getFoldsInRange(delta);this.removeFolds(removedFolds);len=-len;}
var foldLine=this.getFoldLine(firstRow);if(foldLine){foldLine.addRemoveChars(firstRow,start.column,len);}}
if(useWrapMode&&this.$wrapData.length!=this.doc.getLength()){console.error("doc.getLength() and $wrapData.length have to be the same!");}
this.$updating=false;if(useWrapMode)
this.$updateWrapData(firstRow,lastRow);else
this.$updateRowLengthCache(firstRow,lastRow);return removedFolds;};this.$updateRowLengthCache=function(firstRow,lastRow,b){this.$rowLengthCache[firstRow]=null;this.$rowLengthCache[lastRow]=null;};this.$updateWrapData=function(firstRow,lastRow){var lines=this.doc.getAllLines();var tabSize=this.getTabSize();var wrapData=this.$wrapData;var wrapLimit=this.$wrapLimit;var tokens;var foldLine;var row=firstRow;lastRow=Math.min(lastRow,lines.length-1);while(row<=lastRow){foldLine=this.getFoldLine(row,foldLine);if(!foldLine){tokens=this.$getDisplayTokens(lines[row]);wrapData[row]=this.$computeWrapSplits(tokens,wrapLimit,tabSize);row++;}else{tokens=[];foldLine.walk(function(placeholder,row,column,lastColumn){var walkTokens;if(placeholder!=null){walkTokens=this.$getDisplayTokens(placeholder,tokens.length);walkTokens[0]=PLACEHOLDER_START;for(var i=1;i<walkTokens.length;i++){walkTokens[i]=PLACEHOLDER_BODY;}}else{walkTokens=this.$getDisplayTokens(lines[row].substring(lastColumn,column),tokens.length);}
tokens=tokens.concat(walkTokens);}.bind(this),foldLine.end.row,lines[foldLine.end.row].length+1);wrapData[foldLine.start.row]=this.$computeWrapSplits(tokens,wrapLimit,tabSize);row=foldLine.end.row+1;}}};var CHAR=1,CHAR_EXT=2,PLACEHOLDER_START=3,PLACEHOLDER_BODY=4,PUNCTUATION=9,SPACE=10,TAB=11,TAB_SPACE=12;this.$computeWrapSplits=function(tokens,wrapLimit,tabSize){if(tokens.length==0){return[];}
var splits=[];var displayLength=tokens.length;var lastSplit=0,lastDocSplit=0;var isCode=this.$wrapAsCode;var indentedSoftWrap=this.$indentedSoftWrap;var maxIndent=wrapLimit<=Math.max(2*tabSize,8)||indentedSoftWrap===false?0:Math.floor(wrapLimit/2);function getWrapIndent(){var indentation=0;if(maxIndent===0)
return indentation;if(indentedSoftWrap){for(var i=0;i<tokens.length;i++){var token=tokens[i];if(token==SPACE)
indentation+=1;else if(token==TAB)
indentation+=tabSize;else if(token==TAB_SPACE)
continue;else
break;}}
if(isCode&&indentedSoftWrap!==false)
indentation+=tabSize;return Math.min(indentation,maxIndent);}
function addSplit(screenPos){var displayed=tokens.slice(lastSplit,screenPos);var len=displayed.length;displayed.join("").replace(/12/g,function(){len-=1;}).replace(/2/g,function(){len-=1;});if(!splits.length){indent=getWrapIndent();splits.indent=indent;}
lastDocSplit+=len;splits.push(lastDocSplit);lastSplit=screenPos;}
var indent=0;while(displayLength-lastSplit>wrapLimit-indent){var split=lastSplit+wrapLimit-indent;if(tokens[split-1]>=SPACE&&tokens[split]>=SPACE){addSplit(split);continue;}
if(tokens[split]==PLACEHOLDER_START||tokens[split]==PLACEHOLDER_BODY){for(split;split!=lastSplit-1;split--){if(tokens[split]==PLACEHOLDER_START){break;}}
if(split>lastSplit){addSplit(split);continue;}
split=lastSplit+wrapLimit;for(split;split<tokens.length;split++){if(tokens[split]!=PLACEHOLDER_BODY){break;}}
if(split==tokens.length){break;}
addSplit(split);continue;}
var minSplit=Math.max(split-(wrapLimit-(wrapLimit>>2)),lastSplit-1);while(split>minSplit&&tokens[split]<PLACEHOLDER_START){split--;}
if(isCode){while(split>minSplit&&tokens[split]<PLACEHOLDER_START){split--;}
while(split>minSplit&&tokens[split]==PUNCTUATION){split--;}}else{while(split>minSplit&&tokens[split]<SPACE){split--;}}
if(split>minSplit){addSplit(++split);continue;}
split=lastSplit+wrapLimit;if(tokens[split]==CHAR_EXT)
split--;addSplit(split-indent);}
return splits;};this.$getDisplayTokens=function(str,offset){var arr=[];var tabSize;offset=offset||0;for(var i=0;i<str.length;i++){var c=str.charCodeAt(i);if(c==9){tabSize=this.getScreenTabSize(arr.length+offset);arr.push(TAB);for(var n=1;n<tabSize;n++){arr.push(TAB_SPACE);}}
else if(c==32){arr.push(SPACE);}else if((c>39&&c<48)||(c>57&&c<64)){arr.push(PUNCTUATION);}
else if(c>=0x1100&&isFullWidth(c)){arr.push(CHAR,CHAR_EXT);}else{arr.push(CHAR);}}
return arr;};this.$getStringScreenWidth=function(str,maxScreenColumn,screenColumn){if(maxScreenColumn==0)
return[0,0];if(maxScreenColumn==null)
maxScreenColumn=Infinity;screenColumn=screenColumn||0;var c,column;for(column=0;column<str.length;column++){c=str.charCodeAt(column);if(c==9){screenColumn+=this.getScreenTabSize(screenColumn);}
else if(c>=0x1100&&isFullWidth(c)){screenColumn+=2;}else{screenColumn+=1;}
if(screenColumn>maxScreenColumn){break;}}
return[screenColumn,column];};this.lineWidgets=null;this.getRowLength=function(row){if(this.lineWidgets)
var h=this.lineWidgets[row]&&this.lineWidgets[row].rowCount||0;else
h=0;if(!this.$useWrapMode||!this.$wrapData[row]){return 1+h;}else{return this.$wrapData[row].length+1+h;}};this.getRowLineCount=function(row){if(!this.$useWrapMode||!this.$wrapData[row]){return 1;}else{return this.$wrapData[row].length+1;}};this.getRowWrapIndent=function(screenRow){if(this.$useWrapMode){var pos=this.screenToDocumentPosition(screenRow,Number.MAX_VALUE);var splits=this.$wrapData[pos.row];return splits.length&&splits[0]<pos.column?splits.indent:0;}else{return 0;}};this.getScreenLastRowColumn=function(screenRow){var pos=this.screenToDocumentPosition(screenRow,Number.MAX_VALUE);return this.documentToScreenColumn(pos.row,pos.column);};this.getDocumentLastRowColumn=function(docRow,docColumn){var screenRow=this.documentToScreenRow(docRow,docColumn);return this.getScreenLastRowColumn(screenRow);};this.getDocumentLastRowColumnPosition=function(docRow,docColumn){var screenRow=this.documentToScreenRow(docRow,docColumn);return this.screenToDocumentPosition(screenRow,Number.MAX_VALUE/10);};this.getRowSplitData=function(row){if(!this.$useWrapMode){return undefined;}else{return this.$wrapData[row];}};this.getScreenTabSize=function(screenColumn){return this.$tabSize-screenColumn%this.$tabSize;};this.screenToDocumentRow=function(screenRow,screenColumn){return this.screenToDocumentPosition(screenRow,screenColumn).row;};this.screenToDocumentColumn=function(screenRow,screenColumn){return this.screenToDocumentPosition(screenRow,screenColumn).column;};this.screenToDocumentPosition=function(screenRow,screenColumn,offsetX){if(screenRow<0)
return{row:0,column:0};var line;var docRow=0;var docColumn=0;var column;var row=0;var rowLength=0;var rowCache=this.$screenRowCache;var i=this.$getRowCacheIndex(rowCache,screenRow);var l=rowCache.length;if(l&&i>=0){var row=rowCache[i];var docRow=this.$docRowCache[i];var doCache=screenRow>rowCache[l-1];}else{var doCache=!l;}
var maxRow=this.getLength()-1;var foldLine=this.getNextFoldLine(docRow);var foldStart=foldLine?foldLine.start.row:Infinity;while(row<=screenRow){rowLength=this.getRowLength(docRow);if(row+rowLength>screenRow||docRow>=maxRow){break;}else{row+=rowLength;docRow++;if(docRow>foldStart){docRow=foldLine.end.row+1;foldLine=this.getNextFoldLine(docRow,foldLine);foldStart=foldLine?foldLine.start.row:Infinity;}}
if(doCache){this.$docRowCache.push(docRow);this.$screenRowCache.push(row);}}
if(foldLine&&foldLine.start.row<=docRow){line=this.getFoldDisplayLine(foldLine);docRow=foldLine.start.row;}else if(row+rowLength<=screenRow||docRow>maxRow){return{row:maxRow,column:this.getLine(maxRow).length};}else{line=this.getLine(docRow);foldLine=null;}
var wrapIndent=0,splitIndex=Math.floor(screenRow-row);if(this.$useWrapMode){var splits=this.$wrapData[docRow];if(splits){column=splits[splitIndex];if(splitIndex>0&&splits.length){wrapIndent=splits.indent;docColumn=splits[splitIndex-1]||splits[splits.length-1];line=line.substring(docColumn);}}}
if(offsetX!==undefined&&this.$bidiHandler.isBidiRow(row+splitIndex,docRow,splitIndex))
screenColumn=this.$bidiHandler.offsetToCol(offsetX);docColumn+=this.$getStringScreenWidth(line,screenColumn-wrapIndent)[1];if(this.$useWrapMode&&docColumn>=column)
docColumn=column-1;if(foldLine)
return foldLine.idxToPosition(docColumn);return{row:docRow,column:docColumn};};this.documentToScreenPosition=function(docRow,docColumn){if(typeof docColumn==="undefined")
var pos=this.$clipPositionToDocument(docRow.row,docRow.column);else
pos=this.$clipPositionToDocument(docRow,docColumn);docRow=pos.row;docColumn=pos.column;var screenRow=0;var foldStartRow=null;var fold=null;fold=this.getFoldAt(docRow,docColumn,1);if(fold){docRow=fold.start.row;docColumn=fold.start.column;}
var rowEnd,row=0;var rowCache=this.$docRowCache;var i=this.$getRowCacheIndex(rowCache,docRow);var l=rowCache.length;if(l&&i>=0){var row=rowCache[i];var screenRow=this.$screenRowCache[i];var doCache=docRow>rowCache[l-1];}else{var doCache=!l;}
var foldLine=this.getNextFoldLine(row);var foldStart=foldLine?foldLine.start.row:Infinity;while(row<docRow){if(row>=foldStart){rowEnd=foldLine.end.row+1;if(rowEnd>docRow)
break;foldLine=this.getNextFoldLine(rowEnd,foldLine);foldStart=foldLine?foldLine.start.row:Infinity;}
else{rowEnd=row+1;}
screenRow+=this.getRowLength(row);row=rowEnd;if(doCache){this.$docRowCache.push(row);this.$screenRowCache.push(screenRow);}}
var textLine="";if(foldLine&&row>=foldStart){textLine=this.getFoldDisplayLine(foldLine,docRow,docColumn);foldStartRow=foldLine.start.row;}else{textLine=this.getLine(docRow).substring(0,docColumn);foldStartRow=docRow;}
var wrapIndent=0;if(this.$useWrapMode){var wrapRow=this.$wrapData[foldStartRow];if(wrapRow){var screenRowOffset=0;while(textLine.length>=wrapRow[screenRowOffset]){screenRow++;screenRowOffset++;}
textLine=textLine.substring(wrapRow[screenRowOffset-1]||0,textLine.length);wrapIndent=screenRowOffset>0?wrapRow.indent:0;}}
return{row:screenRow,column:wrapIndent+this.$getStringScreenWidth(textLine)[0]};};this.documentToScreenColumn=function(row,docColumn){return this.documentToScreenPosition(row,docColumn).column;};this.documentToScreenRow=function(docRow,docColumn){return this.documentToScreenPosition(docRow,docColumn).row;};this.getScreenLength=function(){var screenRows=0;var fold=null;if(!this.$useWrapMode){screenRows=this.getLength();var foldData=this.$foldData;for(var i=0;i<foldData.length;i++){fold=foldData[i];screenRows-=fold.end.row-fold.start.row;}}else{var lastRow=this.$wrapData.length;var row=0,i=0;var fold=this.$foldData[i++];var foldStart=fold?fold.start.row:Infinity;while(row<lastRow){var splits=this.$wrapData[row];screenRows+=splits?splits.length+1:1;row++;if(row>foldStart){row=fold.end.row+1;fold=this.$foldData[i++];foldStart=fold?fold.start.row:Infinity;}}}
if(this.lineWidgets)
screenRows+=this.$getWidgetScreenLength();return screenRows;};this.$setFontMetrics=function(fm){if(!this.$enableVarChar)return;this.$getStringScreenWidth=function(str,maxScreenColumn,screenColumn){if(maxScreenColumn===0)
return[0,0];if(!maxScreenColumn)
maxScreenColumn=Infinity;screenColumn=screenColumn||0;var c,column;for(column=0;column<str.length;column++){c=str.charAt(column);if(c==="\t"){screenColumn+=this.getScreenTabSize(screenColumn);}else{screenColumn+=fm.getCharacterWidth(c);}
if(screenColumn>maxScreenColumn){break;}}
return[screenColumn,column];};};this.destroy=function(){if(this.bgTokenizer){this.bgTokenizer.setDocument(null);this.bgTokenizer=null;}
this.$stopWorker();};this.isFullWidth=isFullWidth;function isFullWidth(c){if(c<0x1100)
return false;return c>=0x1100&&c<=0x115F||c>=0x11A3&&c<=0x11A7||c>=0x11FA&&c<=0x11FF||c>=0x2329&&c<=0x232A||c>=0x2E80&&c<=0x2E99||c>=0x2E9B&&c<=0x2EF3||c>=0x2F00&&c<=0x2FD5||c>=0x2FF0&&c<=0x2FFB||c>=0x3000&&c<=0x303E||c>=0x3041&&c<=0x3096||c>=0x3099&&c<=0x30FF||c>=0x3105&&c<=0x312D||c>=0x3131&&c<=0x318E||c>=0x3190&&c<=0x31BA||c>=0x31C0&&c<=0x31E3||c>=0x31F0&&c<=0x321E||c>=0x3220&&c<=0x3247||c>=0x3250&&c<=0x32FE||c>=0x3300&&c<=0x4DBF||c>=0x4E00&&c<=0xA48C||c>=0xA490&&c<=0xA4C6||c>=0xA960&&c<=0xA97C||c>=0xAC00&&c<=0xD7A3||c>=0xD7B0&&c<=0xD7C6||c>=0xD7CB&&c<=0xD7FB||c>=0xF900&&c<=0xFAFF||c>=0xFE10&&c<=0xFE19||c>=0xFE30&&c<=0xFE52||c>=0xFE54&&c<=0xFE66||c>=0xFE68&&c<=0xFE6B||c>=0xFF01&&c<=0xFF60||c>=0xFFE0&&c<=0xFFE6;}}).call(EditSession.prototype);require("./edit_session/folding").Folding.call(EditSession.prototype);require("./edit_session/bracket_match").BracketMatch.call(EditSession.prototype);config.defineOptions(EditSession.prototype,"session",{wrap:{set:function(value){if(!value||value=="off")
value=false;else if(value=="free")
value=true;else if(value=="printMargin")
value=-1;else if(typeof value=="string")
value=parseInt(value,10)||false;if(this.$wrap==value)
return;this.$wrap=value;if(!value){this.setUseWrapMode(false);}else{var col=typeof value=="number"?value:null;this.setWrapLimitRange(col,col);this.setUseWrapMode(true);}},get:function(){if(this.getUseWrapMode()){if(this.$wrap==-1)
return"printMargin";if(!this.getWrapLimitRange().min)
return"free";return this.$wrap;}
return"off";},handlesSet:true},wrapMethod:{set:function(val){val=val=="auto"?this.$mode.type!="text":val!="text";if(val!=this.$wrapAsCode){this.$wrapAsCode=val;if(this.$useWrapMode){this.$modified=true;this.$resetRowCache(0);this.$updateWrapData(0,this.getLength()-1);}}},initialValue:"auto"},indentedSoftWrap:{initialValue:true},firstLineNumber:{set:function(){this._signal("changeBreakpoint");},initialValue:1},useWorker:{set:function(useWorker){this.$useWorker=useWorker;this.$stopWorker();if(useWorker)
this.$startWorker();},initialValue:true},useSoftTabs:{initialValue:true},tabSize:{set:function(tabSize){if(isNaN(tabSize)||this.$tabSize===tabSize)return;this.$modified=true;this.$rowLengthCache=[];this.$tabSize=tabSize;this._signal("changeTabSize");},initialValue:4,handlesSet:true},navigateWithinSoftTabs:{initialValue:false},foldStyle:{set:function(val){this.setFoldStyle(val);},handlesSet:true},overwrite:{set:function(val){this._signal("changeOverwrite");},initialValue:false},newLineMode:{set:function(val){this.doc.setNewLineMode(val);},get:function(){return this.doc.getNewLineMode();},handlesSet:true},mode:{set:function(val){this.setMode(val);},get:function(){return this.$modeId;}}});exports.EditSession=EditSession;});define("ace/search",["require","exports","module","ace/lib/lang","ace/lib/oop","ace/range"],function(require,exports,module){"use strict";var lang=require("./lib/lang");var oop=require("./lib/oop");var Range=require("./range").Range;var Search=function(){this.$options={};};(function(){this.set=function(options){oop.mixin(this.$options,options);return this;};this.getOptions=function(){return lang.copyObject(this.$options);};this.setOptions=function(options){this.$options=options;};this.find=function(session){var options=this.$options;var iterator=this.$matchIterator(session,options);if(!iterator)
return false;var firstRange=null;iterator.forEach(function(sr,sc,er,ec){firstRange=new Range(sr,sc,er,ec);if(sc==ec&&options.start&&options.start.start&&options.skipCurrent!=false&&firstRange.isEqual(options.start)){firstRange=null;return false;}
return true;});return firstRange;};this.findAll=function(session){var options=this.$options;if(!options.needle)
return[];this.$assembleRegExp(options);var range=options.range;var lines=range?session.getLines(range.start.row,range.end.row):session.doc.getAllLines();var ranges=[];var re=options.re;if(options.$isMultiLine){var len=re.length;var maxRow=lines.length-len;var prevRange;outer:for(var row=re.offset||0;row<=maxRow;row++){for(var j=0;j<len;j++)
if(lines[row+j].search(re[j])==-1)
continue outer;var startLine=lines[row];var line=lines[row+len-1];var startIndex=startLine.length-startLine.match(re[0])[0].length;var endIndex=line.match(re[len-1])[0].length;if(prevRange&&prevRange.end.row===row&&prevRange.end.column>startIndex){continue;}
ranges.push(prevRange=new Range(row,startIndex,row+len-1,endIndex));if(len>2)
row=row+len-2;}}else{for(var i=0;i<lines.length;i++){var matches=lang.getMatchOffsets(lines[i],re);for(var j=0;j<matches.length;j++){var match=matches[j];ranges.push(new Range(i,match.offset,i,match.offset+match.length));}}}
if(range){var startColumn=range.start.column;var endColumn=range.start.column;var i=0,j=ranges.length-1;while(i<j&&ranges[i].start.column<startColumn&&ranges[i].start.row==range.start.row)
i++;while(i<j&&ranges[j].end.column>endColumn&&ranges[j].end.row==range.end.row)
j--;ranges=ranges.slice(i,j+1);for(i=0,j=ranges.length;i<j;i++){ranges[i].start.row+=range.start.row;ranges[i].end.row+=range.start.row;}}
return ranges;};this.replace=function(input,replacement){var options=this.$options;var re=this.$assembleRegExp(options);if(options.$isMultiLine)
return replacement;if(!re)
return;var match=re.exec(input);if(!match||match[0].length!=input.length)
return null;replacement=input.replace(re,replacement);if(options.preserveCase){replacement=replacement.split("");for(var i=Math.min(input.length,input.length);i--;){var ch=input[i];if(ch&&ch.toLowerCase()!=ch)
replacement[i]=replacement[i].toUpperCase();else
replacement[i]=replacement[i].toLowerCase();}
replacement=replacement.join("");}
return replacement;};this.$assembleRegExp=function(options,$disableFakeMultiline){if(options.needle instanceof RegExp)
return options.re=options.needle;var needle=options.needle;if(!options.needle)
return options.re=false;if(!options.regExp)
needle=lang.escapeRegExp(needle);if(options.wholeWord)
needle=addWordBoundary(needle,options);var modifier=options.caseSensitive?"gm":"gmi";options.$isMultiLine=!$disableFakeMultiline&&/[\n\r]/.test(needle);if(options.$isMultiLine)
return options.re=this.$assembleMultilineRegExp(needle,modifier);try{var re=new RegExp(needle,modifier);}catch(e){re=false;}
return options.re=re;};this.$assembleMultilineRegExp=function(needle,modifier){var parts=needle.replace(/\r\n|\r|\n/g,"$\n^").split("\n");var re=[];for(var i=0;i<parts.length;i++)try{re.push(new RegExp(parts[i],modifier));}catch(e){return false;}
return re;};this.$matchIterator=function(session,options){var re=this.$assembleRegExp(options);if(!re)
return false;var backwards=options.backwards==true;var skipCurrent=options.skipCurrent!=false;var range=options.range;var start=options.start;if(!start)
start=range?range[backwards?"end":"start"]:session.selection.getRange();if(start.start)
start=start[skipCurrent!=backwards?"end":"start"];var firstRow=range?range.start.row:0;var lastRow=range?range.end.row:session.getLength()-1;if(backwards){var forEach=function(callback){var row=start.row;if(forEachInLine(row,start.column,callback))
return;for(row--;row>=firstRow;row--)
if(forEachInLine(row,Number.MAX_VALUE,callback))
return;if(options.wrap==false)
return;for(row=lastRow,firstRow=start.row;row>=firstRow;row--)
if(forEachInLine(row,Number.MAX_VALUE,callback))
return;};}
else{var forEach=function(callback){var row=start.row;if(forEachInLine(row,start.column,callback))
return;for(row=row+1;row<=lastRow;row++)
if(forEachInLine(row,0,callback))
return;if(options.wrap==false)
return;for(row=firstRow,lastRow=start.row;row<=lastRow;row++)
if(forEachInLine(row,0,callback))
return;};}
if(options.$isMultiLine){var len=re.length;var forEachInLine=function(row,offset,callback){var startRow=backwards?row-len+1:row;if(startRow<0)return;var line=session.getLine(startRow);var startIndex=line.search(re[0]);if(!backwards&&startIndex<offset||startIndex===-1)return;for(var i=1;i<len;i++){line=session.getLine(startRow+i);if(line.search(re[i])==-1)
return;}
var endIndex=line.match(re[len-1])[0].length;if(backwards&&endIndex>offset)return;if(callback(startRow,startIndex,startRow+len-1,endIndex))
return true;};}
else if(backwards){var forEachInLine=function(row,endIndex,callback){var line=session.getLine(row);var matches=[];var m,last=0;re.lastIndex=0;while((m=re.exec(line))){var length=m[0].length;last=m.index;if(!length){if(last>=line.length)break;re.lastIndex=last+=1;}
if(m.index+length>endIndex)
break;matches.push(m.index,length);}
for(var i=matches.length-1;i>=0;i-=2){var column=matches[i-1];var length=matches[i];if(callback(row,column,row,column+length))
return true;}};}
else{var forEachInLine=function(row,startIndex,callback){var line=session.getLine(row);var last;var m;re.lastIndex=startIndex;while((m=re.exec(line))){var length=m[0].length;last=m.index;if(callback(row,last,row,last+length))
return true;if(!length){re.lastIndex=last+=1;if(last>=line.length)return false;}}};}
return{forEach:forEach};};}).call(Search.prototype);function addWordBoundary(needle,options){function wordBoundary(c){if(/\w/.test(c)||options.regExp)return"\\b";return"";}
return wordBoundary(needle[0])+needle
+wordBoundary(needle[needle.length-1]);}
exports.Search=Search;});define("ace/keyboard/hash_handler",["require","exports","module","ace/lib/keys","ace/lib/useragent"],function(require,exports,module){"use strict";var keyUtil=require("../lib/keys");var useragent=require("../lib/useragent");var KEY_MODS=keyUtil.KEY_MODS;function HashHandler(config,platform){this.platform=platform||(useragent.isMac?"mac":"win");this.commands={};this.commandKeyBinding={};this.addCommands(config);this.$singleCommand=true;}
function MultiHashHandler(config,platform){HashHandler.call(this,config,platform);this.$singleCommand=false;}
MultiHashHandler.prototype=HashHandler.prototype;(function(){this.addCommand=function(command){if(this.commands[command.name])
this.removeCommand(command);this.commands[command.name]=command;if(command.bindKey)
this._buildKeyHash(command);};this.removeCommand=function(command,keepCommand){var name=command&&(typeof command==='string'?command:command.name);command=this.commands[name];if(!keepCommand)
delete this.commands[name];var ckb=this.commandKeyBinding;for(var keyId in ckb){var cmdGroup=ckb[keyId];if(cmdGroup==command){delete ckb[keyId];}else if(Array.isArray(cmdGroup)){var i=cmdGroup.indexOf(command);if(i!=-1){cmdGroup.splice(i,1);if(cmdGroup.length==1)
ckb[keyId]=cmdGroup[0];}}}};this.bindKey=function(key,command,position){if(typeof key=="object"&&key){if(position==undefined)
position=key.position;key=key[this.platform];}
if(!key)
return;if(typeof command=="function")
return this.addCommand({exec:command,bindKey:key,name:command.name||key});key.split("|").forEach(function(keyPart){var chain="";if(keyPart.indexOf(" ")!=-1){var parts=keyPart.split(/\s+/);keyPart=parts.pop();parts.forEach(function(keyPart){var binding=this.parseKeys(keyPart);var id=KEY_MODS[binding.hashId]+binding.key;chain+=(chain?" ":"")+id;this._addCommandToBinding(chain,"chainKeys");},this);chain+=" ";}
var binding=this.parseKeys(keyPart);var id=KEY_MODS[binding.hashId]+binding.key;this._addCommandToBinding(chain+id,command,position);},this);};function getPosition(command){return typeof command=="object"&&command.bindKey&&command.bindKey.position||(command.isDefault?-100:0);}
this._addCommandToBinding=function(keyId,command,position){var ckb=this.commandKeyBinding,i;if(!command){delete ckb[keyId];}else if(!ckb[keyId]||this.$singleCommand){ckb[keyId]=command;}else{if(!Array.isArray(ckb[keyId])){ckb[keyId]=[ckb[keyId]];}else if((i=ckb[keyId].indexOf(command))!=-1){ckb[keyId].splice(i,1);}
if(typeof position!="number"){position=getPosition(command);}
var commands=ckb[keyId];for(i=0;i<commands.length;i++){var other=commands[i];var otherPos=getPosition(other);if(otherPos>position)
break;}
commands.splice(i,0,command);}};this.addCommands=function(commands){commands&&Object.keys(commands).forEach(function(name){var command=commands[name];if(!command)
return;if(typeof command==="string")
return this.bindKey(command,name);if(typeof command==="function")
command={exec:command};if(typeof command!=="object")
return;if(!command.name)
command.name=name;this.addCommand(command);},this);};this.removeCommands=function(commands){Object.keys(commands).forEach(function(name){this.removeCommand(commands[name]);},this);};this.bindKeys=function(keyList){Object.keys(keyList).forEach(function(key){this.bindKey(key,keyList[key]);},this);};this._buildKeyHash=function(command){this.bindKey(command.bindKey,command);};this.parseKeys=function(keys){var parts=keys.toLowerCase().split(/[\-\+]([\-\+])?/).filter(function(x){return x;});var key=parts.pop();var keyCode=keyUtil[key];if(keyUtil.FUNCTION_KEYS[keyCode])
key=keyUtil.FUNCTION_KEYS[keyCode].toLowerCase();else if(!parts.length)
return{key:key,hashId:-1};else if(parts.length==1&&parts[0]=="shift")
return{key:key.toUpperCase(),hashId:-1};var hashId=0;for(var i=parts.length;i--;){var modifier=keyUtil.KEY_MODS[parts[i]];if(modifier==null){if(typeof console!="undefined")
console.error("invalid modifier "+parts[i]+" in "+keys);return false;}
hashId|=modifier;}
return{key:key,hashId:hashId};};this.findKeyCommand=function findKeyCommand(hashId,keyString){var key=KEY_MODS[hashId]+keyString;return this.commandKeyBinding[key];};this.handleKeyboard=function(data,hashId,keyString,keyCode){if(keyCode<0)return;var key=KEY_MODS[hashId]+keyString;var command=this.commandKeyBinding[key];if(data.$keyChain){data.$keyChain+=" "+key;command=this.commandKeyBinding[data.$keyChain]||command;}
if(command){if(command=="chainKeys"||command[command.length-1]=="chainKeys"){data.$keyChain=data.$keyChain||key;return{command:"null"};}}
if(data.$keyChain){if((!hashId||hashId==4)&&keyString.length==1)
data.$keyChain=data.$keyChain.slice(0,-key.length-1);else if(hashId==-1||keyCode>0)
data.$keyChain="";}
return{command:command};};this.getStatusText=function(editor,data){return data.$keyChain||"";};}).call(HashHandler.prototype);exports.HashHandler=HashHandler;exports.MultiHashHandler=MultiHashHandler;});define("ace/commands/command_manager",["require","exports","module","ace/lib/oop","ace/keyboard/hash_handler","ace/lib/event_emitter"],function(require,exports,module){"use strict";var oop=require("../lib/oop");var MultiHashHandler=require("../keyboard/hash_handler").MultiHashHandler;var EventEmitter=require("../lib/event_emitter").EventEmitter;var CommandManager=function(platform,commands){MultiHashHandler.call(this,commands,platform);this.byName=this.commands;this.setDefaultHandler("exec",function(e){return e.command.exec(e.editor,e.args||{});});};oop.inherits(CommandManager,MultiHashHandler);(function(){oop.implement(this,EventEmitter);this.exec=function(command,editor,args){if(Array.isArray(command)){for(var i=command.length;i--;){if(this.exec(command[i],editor,args))return true;}
return false;}
if(typeof command==="string")
command=this.commands[command];if(!command)
return false;if(editor&&editor.$readOnly&&!command.readOnly)
return false;if(command.isAvailable&&!command.isAvailable(editor))
return false;var e={editor:editor,command:command,args:args};e.returnValue=this._emit("exec",e);this._signal("afterExec",e);return e.returnValue===false?false:true;};this.toggleRecording=function(editor){if(this.$inReplay)
return;editor&&editor._emit("changeStatus");if(this.recording){this.macro.pop();this.removeEventListener("exec",this.$addCommandToMacro);if(!this.macro.length)
this.macro=this.oldMacro;return this.recording=false;}
if(!this.$addCommandToMacro){this.$addCommandToMacro=function(e){this.macro.push([e.command,e.args]);}.bind(this);}
this.oldMacro=this.macro;this.macro=[];this.on("exec",this.$addCommandToMacro);return this.recording=true;};this.replay=function(editor){if(this.$inReplay||!this.macro)
return;if(this.recording)
return this.toggleRecording(editor);try{this.$inReplay=true;this.macro.forEach(function(x){if(typeof x=="string")
this.exec(x,editor);else
this.exec(x[0],editor,x[1]);},this);}finally{this.$inReplay=false;}};this.trimMacro=function(m){return m.map(function(x){if(typeof x[0]!="string")
x[0]=x[0].name;if(!x[1])
x=x[0];return x;});};}).call(CommandManager.prototype);exports.CommandManager=CommandManager;});define("ace/commands/default_commands",["require","exports","module","ace/lib/lang","ace/config","ace/range"],function(require,exports,module){"use strict";var lang=require("../lib/lang");var config=require("../config");var Range=require("../range").Range;function bindKey(win,mac){return{win:win,mac:mac};}
exports.commands=[{name:"showSettingsMenu",bindKey:bindKey("Ctrl-,","Command-,"),exec:function(editor){config.loadModule("ace/ext/settings_menu",function(module){module.init(editor);editor.showSettingsMenu();});},readOnly:true},{name:"goToNextError",bindKey:bindKey("Alt-E","F4"),exec:function(editor){config.loadModule("./ext/error_marker",function(module){module.showErrorMarker(editor,1);});},scrollIntoView:"animate",readOnly:true},{name:"goToPreviousError",bindKey:bindKey("Alt-Shift-E","Shift-F4"),exec:function(editor){config.loadModule("./ext/error_marker",function(module){module.showErrorMarker(editor,-1);});},scrollIntoView:"animate",readOnly:true},{name:"selectall",bindKey:bindKey("Ctrl-A","Command-A"),exec:function(editor){editor.selectAll();},readOnly:true},{name:"centerselection",bindKey:bindKey(null,"Ctrl-L"),exec:function(editor){editor.centerSelection();},readOnly:true},{name:"gotoline",bindKey:bindKey("Ctrl-L","Command-L"),exec:function(editor,line){if(typeof line!=="number")
line=parseInt(prompt("Enter line number:"),10);if(!isNaN(line)){editor.gotoLine(line);}},readOnly:true},{name:"fold",bindKey:bindKey("Alt-L|Ctrl-F1","Command-Alt-L|Command-F1"),exec:function(editor){editor.session.toggleFold(false);},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:true},{name:"unfold",bindKey:bindKey("Alt-Shift-L|Ctrl-Shift-F1","Command-Alt-Shift-L|Command-Shift-F1"),exec:function(editor){editor.session.toggleFold(true);},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:true},{name:"toggleFoldWidget",bindKey:bindKey("F2","F2"),exec:function(editor){editor.session.toggleFoldWidget();},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:true},{name:"toggleParentFoldWidget",bindKey:bindKey("Alt-F2","Alt-F2"),exec:function(editor){editor.session.toggleFoldWidget(true);},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:true},{name:"foldall",bindKey:bindKey(null,"Ctrl-Command-Option-0"),exec:function(editor){editor.session.foldAll();},scrollIntoView:"center",readOnly:true},{name:"foldOther",bindKey:bindKey("Alt-0","Command-Option-0"),exec:function(editor){editor.session.foldAll();editor.session.unfold(editor.selection.getAllRanges());},scrollIntoView:"center",readOnly:true},{name:"unfoldall",bindKey:bindKey("Alt-Shift-0","Command-Option-Shift-0"),exec:function(editor){editor.session.unfold();},scrollIntoView:"center",readOnly:true},{name:"findnext",bindKey:bindKey("Ctrl-K","Command-G"),exec:function(editor){editor.findNext();},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:true},{name:"findprevious",bindKey:bindKey("Ctrl-Shift-K","Command-Shift-G"),exec:function(editor){editor.findPrevious();},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:true},{name:"selectOrFindNext",bindKey:bindKey("Alt-K","Ctrl-G"),exec:function(editor){if(editor.selection.isEmpty())
editor.selection.selectWord();else
editor.findNext();},readOnly:true},{name:"selectOrFindPrevious",bindKey:bindKey("Alt-Shift-K","Ctrl-Shift-G"),exec:function(editor){if(editor.selection.isEmpty())
editor.selection.selectWord();else
editor.findPrevious();},readOnly:true},{name:"find",bindKey:bindKey("Ctrl-F","Command-F"),exec:function(editor){config.loadModule("ace/ext/searchbox",function(e){e.Search(editor);});},readOnly:true},{name:"overwrite",bindKey:"Insert",exec:function(editor){editor.toggleOverwrite();},readOnly:true},{name:"selecttostart",bindKey:bindKey("Ctrl-Shift-Home","Command-Shift-Home|Command-Shift-Up"),exec:function(editor){editor.getSelection().selectFileStart();},multiSelectAction:"forEach",readOnly:true,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"gotostart",bindKey:bindKey("Ctrl-Home","Command-Home|Command-Up"),exec:function(editor){editor.navigateFileStart();},multiSelectAction:"forEach",readOnly:true,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"selectup",bindKey:bindKey("Shift-Up","Shift-Up|Ctrl-Shift-P"),exec:function(editor){editor.getSelection().selectUp();},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:true},{name:"golineup",bindKey:bindKey("Up","Up|Ctrl-P"),exec:function(editor,args){editor.navigateUp(args.times);},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:true},{name:"selecttoend",bindKey:bindKey("Ctrl-Shift-End","Command-Shift-End|Command-Shift-Down"),exec:function(editor){editor.getSelection().selectFileEnd();},multiSelectAction:"forEach",readOnly:true,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"gotoend",bindKey:bindKey("Ctrl-End","Command-End|Command-Down"),exec:function(editor){editor.navigateFileEnd();},multiSelectAction:"forEach",readOnly:true,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"selectdown",bindKey:bindKey("Shift-Down","Shift-Down|Ctrl-Shift-N"),exec:function(editor){editor.getSelection().selectDown();},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:true},{name:"golinedown",bindKey:bindKey("Down","Down|Ctrl-N"),exec:function(editor,args){editor.navigateDown(args.times);},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:true},{name:"selectwordleft",bindKey:bindKey("Ctrl-Shift-Left","Option-Shift-Left"),exec:function(editor){editor.getSelection().selectWordLeft();},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:true},{name:"gotowordleft",bindKey:bindKey("Ctrl-Left","Option-Left"),exec:function(editor){editor.navigateWordLeft();},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:true},{name:"selecttolinestart",bindKey:bindKey("Alt-Shift-Left","Command-Shift-Left|Ctrl-Shift-A"),exec:function(editor){editor.getSelection().selectLineStart();},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:true},{name:"gotolinestart",bindKey:bindKey("Alt-Left|Home","Command-Left|Home|Ctrl-A"),exec:function(editor){editor.navigateLineStart();},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:true},{name:"selectleft",bindKey:bindKey("Shift-Left","Shift-Left|Ctrl-Shift-B"),exec:function(editor){editor.getSelection().selectLeft();},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:true},{name:"gotoleft",bindKey:bindKey("Left","Left|Ctrl-B"),exec:function(editor,args){editor.navigateLeft(args.times);},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:true},{name:"selectwordright",bindKey:bindKey("Ctrl-Shift-Right","Option-Shift-Right"),exec:function(editor){editor.getSelection().selectWordRight();},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:true},{name:"gotowordright",bindKey:bindKey("Ctrl-Right","Option-Right"),exec:function(editor){editor.navigateWordRight();},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:true},{name:"selecttolineend",bindKey:bindKey("Alt-Shift-Right","Command-Shift-Right|Shift-End|Ctrl-Shift-E"),exec:function(editor){editor.getSelection().selectLineEnd();},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:true},{name:"gotolineend",bindKey:bindKey("Alt-Right|End","Command-Right|End|Ctrl-E"),exec:function(editor){editor.navigateLineEnd();},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:true},{name:"selectright",bindKey:bindKey("Shift-Right","Shift-Right"),exec:function(editor){editor.getSelection().selectRight();},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:true},{name:"gotoright",bindKey:bindKey("Right","Right|Ctrl-F"),exec:function(editor,args){editor.navigateRight(args.times);},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:true},{name:"selectpagedown",bindKey:"Shift-PageDown",exec:function(editor){editor.selectPageDown();},readOnly:true},{name:"pagedown",bindKey:bindKey(null,"Option-PageDown"),exec:function(editor){editor.scrollPageDown();},readOnly:true},{name:"gotopagedown",bindKey:bindKey("PageDown","PageDown|Ctrl-V"),exec:function(editor){editor.gotoPageDown();},readOnly:true},{name:"selectpageup",bindKey:"Shift-PageUp",exec:function(editor){editor.selectPageUp();},readOnly:true},{name:"pageup",bindKey:bindKey(null,"Option-PageUp"),exec:function(editor){editor.scrollPageUp();},readOnly:true},{name:"gotopageup",bindKey:"PageUp",exec:function(editor){editor.gotoPageUp();},readOnly:true},{name:"scrollup",bindKey:bindKey("Ctrl-Up",null),exec:function(e){e.renderer.scrollBy(0,-2*e.renderer.layerConfig.lineHeight);},readOnly:true},{name:"scrolldown",bindKey:bindKey("Ctrl-Down",null),exec:function(e){e.renderer.scrollBy(0,2*e.renderer.layerConfig.lineHeight);},readOnly:true},{name:"selectlinestart",bindKey:"Shift-Home",exec:function(editor){editor.getSelection().selectLineStart();},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:true},{name:"selectlineend",bindKey:"Shift-End",exec:function(editor){editor.getSelection().selectLineEnd();},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:true},{name:"togglerecording",bindKey:bindKey("Ctrl-Alt-E","Command-Option-E"),exec:function(editor){editor.commands.toggleRecording(editor);},readOnly:true},{name:"replaymacro",bindKey:bindKey("Ctrl-Shift-E","Command-Shift-E"),exec:function(editor){editor.commands.replay(editor);},readOnly:true},{name:"jumptomatching",bindKey:bindKey("Ctrl-P","Ctrl-P"),exec:function(editor){editor.jumpToMatching();},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:true},{name:"selecttomatching",bindKey:bindKey("Ctrl-Shift-P","Ctrl-Shift-P"),exec:function(editor){editor.jumpToMatching(true);},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:true},{name:"expandToMatching",bindKey:bindKey("Ctrl-Shift-M","Ctrl-Shift-M"),exec:function(editor){editor.jumpToMatching(true,true);},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:true},{name:"passKeysToBrowser",bindKey:bindKey(null,null),exec:function(){},passEvent:true,readOnly:true},{name:"copy",exec:function(editor){},readOnly:true},{name:"cut",exec:function(editor){var cutLine=editor.$copyWithEmptySelection&&editor.selection.isEmpty();var range=cutLine?editor.selection.getLineRange():editor.selection.getRange();editor._emit("cut",range);if(!range.isEmpty())
editor.session.remove(range);editor.clearSelection();},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"paste",exec:function(editor,args){editor.$handlePaste(args);},scrollIntoView:"cursor"},{name:"removeline",bindKey:bindKey("Ctrl-D","Command-D"),exec:function(editor){editor.removeLines();},scrollIntoView:"cursor",multiSelectAction:"forEachLine"},{name:"duplicateSelection",bindKey:bindKey("Ctrl-Shift-D","Command-Shift-D"),exec:function(editor){editor.duplicateSelection();},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"sortlines",bindKey:bindKey("Ctrl-Alt-S","Command-Alt-S"),exec:function(editor){editor.sortLines();},scrollIntoView:"selection",multiSelectAction:"forEachLine"},{name:"togglecomment",bindKey:bindKey("Ctrl-/","Command-/"),exec:function(editor){editor.toggleCommentLines();},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"toggleBlockComment",bindKey:bindKey("Ctrl-Shift-/","Command-Shift-/"),exec:function(editor){editor.toggleBlockComment();},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"modifyNumberUp",bindKey:bindKey("Ctrl-Shift-Up","Alt-Shift-Up"),exec:function(editor){editor.modifyNumber(1);},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"modifyNumberDown",bindKey:bindKey("Ctrl-Shift-Down","Alt-Shift-Down"),exec:function(editor){editor.modifyNumber(-1);},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"replace",bindKey:bindKey("Ctrl-H","Command-Option-F"),exec:function(editor){config.loadModule("ace/ext/searchbox",function(e){e.Search(editor,true);});}},{name:"undo",bindKey:bindKey("Ctrl-Z","Command-Z"),exec:function(editor){editor.undo();}},{name:"redo",bindKey:bindKey("Ctrl-Shift-Z|Ctrl-Y","Command-Shift-Z|Command-Y"),exec:function(editor){editor.redo();}},{name:"copylinesup",bindKey:bindKey("Alt-Shift-Up","Command-Option-Up"),exec:function(editor){editor.copyLinesUp();},scrollIntoView:"cursor"},{name:"movelinesup",bindKey:bindKey("Alt-Up","Option-Up"),exec:function(editor){editor.moveLinesUp();},scrollIntoView:"cursor"},{name:"copylinesdown",bindKey:bindKey("Alt-Shift-Down","Command-Option-Down"),exec:function(editor){editor.copyLinesDown();},scrollIntoView:"cursor"},{name:"movelinesdown",bindKey:bindKey("Alt-Down","Option-Down"),exec:function(editor){editor.moveLinesDown();},scrollIntoView:"cursor"},{name:"del",bindKey:bindKey("Delete","Delete|Ctrl-D|Shift-Delete"),exec:function(editor){editor.remove("right");},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"backspace",bindKey:bindKey("Shift-Backspace|Backspace","Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"),exec:function(editor){editor.remove("left");},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"cut_or_delete",bindKey:bindKey("Shift-Delete",null),exec:function(editor){if(editor.selection.isEmpty()){editor.remove("left");}else{return false;}},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolinestart",bindKey:bindKey("Alt-Backspace","Command-Backspace"),exec:function(editor){editor.removeToLineStart();},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolineend",bindKey:bindKey("Alt-Delete","Ctrl-K|Command-Delete"),exec:function(editor){editor.removeToLineEnd();},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolinestarthard",bindKey:bindKey("Ctrl-Shift-Backspace",null),exec:function(editor){var range=editor.selection.getRange();range.start.column=0;editor.session.remove(range);},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolineendhard",bindKey:bindKey("Ctrl-Shift-Delete",null),exec:function(editor){var range=editor.selection.getRange();range.end.column=Number.MAX_VALUE;editor.session.remove(range);},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removewordleft",bindKey:bindKey("Ctrl-Backspace","Alt-Backspace|Ctrl-Alt-Backspace"),exec:function(editor){editor.removeWordLeft();},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removewordright",bindKey:bindKey("Ctrl-Delete","Alt-Delete"),exec:function(editor){editor.removeWordRight();},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"outdent",bindKey:bindKey("Shift-Tab","Shift-Tab"),exec:function(editor){editor.blockOutdent();},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"indent",bindKey:bindKey("Tab","Tab"),exec:function(editor){editor.indent();},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"blockoutdent",bindKey:bindKey("Ctrl-[","Ctrl-["),exec:function(editor){editor.blockOutdent();},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"blockindent",bindKey:bindKey("Ctrl-]","Ctrl-]"),exec:function(editor){editor.blockIndent();},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"insertstring",exec:function(editor,str){editor.insert(str);},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"inserttext",exec:function(editor,args){editor.insert(lang.stringRepeat(args.text||"",args.times||1));},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"splitline",bindKey:bindKey(null,"Ctrl-O"),exec:function(editor){editor.splitLine();},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"transposeletters",bindKey:bindKey("Alt-Shift-X","Ctrl-T"),exec:function(editor){editor.transposeLetters();},multiSelectAction:function(editor){editor.transposeSelections(1);},scrollIntoView:"cursor"},{name:"touppercase",bindKey:bindKey("Ctrl-U","Ctrl-U"),exec:function(editor){editor.toUpperCase();},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"tolowercase",bindKey:bindKey("Ctrl-Shift-U","Ctrl-Shift-U"),exec:function(editor){editor.toLowerCase();},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"expandtoline",bindKey:bindKey("Ctrl-Shift-L","Command-Shift-L"),exec:function(editor){var range=editor.selection.getRange();range.start.column=range.end.column=0;range.end.row++;editor.selection.setRange(range,false);},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:true},{name:"joinlines",bindKey:bindKey(null,null),exec:function(editor){var isBackwards=editor.selection.isBackwards();var selectionStart=isBackwards?editor.selection.getSelectionLead():editor.selection.getSelectionAnchor();var selectionEnd=isBackwards?editor.selection.getSelectionAnchor():editor.selection.getSelectionLead();var firstLineEndCol=editor.session.doc.getLine(selectionStart.row).length;var selectedText=editor.session.doc.getTextRange(editor.selection.getRange());var selectedCount=selectedText.replace(/\n\s*/," ").length;var insertLine=editor.session.doc.getLine(selectionStart.row);for(var i=selectionStart.row+1;i<=selectionEnd.row+1;i++){var curLine=lang.stringTrimLeft(lang.stringTrimRight(editor.session.doc.getLine(i)));if(curLine.length!==0){curLine=" "+curLine;}
insertLine+=curLine;}
if(selectionEnd.row+1<(editor.session.doc.getLength()-1)){insertLine+=editor.session.doc.getNewLineCharacter();}
editor.clearSelection();editor.session.doc.replace(new Range(selectionStart.row,0,selectionEnd.row+2,0),insertLine);if(selectedCount>0){editor.selection.moveCursorTo(selectionStart.row,selectionStart.column);editor.selection.selectTo(selectionStart.row,selectionStart.column+selectedCount);}else{firstLineEndCol=editor.session.doc.getLine(selectionStart.row).length>firstLineEndCol?(firstLineEndCol+1):firstLineEndCol;editor.selection.moveCursorTo(selectionStart.row,firstLineEndCol);}},multiSelectAction:"forEach",readOnly:true},{name:"invertSelection",bindKey:bindKey(null,null),exec:function(editor){var endRow=editor.session.doc.getLength()-1;var endCol=editor.session.doc.getLine(endRow).length;var ranges=editor.selection.rangeList.ranges;var newRanges=[];if(ranges.length<1){ranges=[editor.selection.getRange()];}
for(var i=0;i<ranges.length;i++){if(i==(ranges.length-1)){if(!(ranges[i].end.row===endRow&&ranges[i].end.column===endCol)){newRanges.push(new Range(ranges[i].end.row,ranges[i].end.column,endRow,endCol));}}
if(i===0){if(!(ranges[i].start.row===0&&ranges[i].start.column===0)){newRanges.push(new Range(0,0,ranges[i].start.row,ranges[i].start.column));}}else{newRanges.push(new Range(ranges[i-1].end.row,ranges[i-1].end.column,ranges[i].start.row,ranges[i].start.column));}}
editor.exitMultiSelectMode();editor.clearSelection();for(var i=0;i<newRanges.length;i++){editor.selection.addRange(newRanges[i],false);}},readOnly:true,scrollIntoView:"none"}];});define("ace/clipboard",["require","exports","module"],function(require,exports,module){"use strict";module.exports={lineMode:false};});define("ace/editor",["require","exports","module","ace/lib/fixoldbrowsers","ace/lib/oop","ace/lib/dom","ace/lib/lang","ace/lib/useragent","ace/keyboard/textinput","ace/mouse/mouse_handler","ace/mouse/fold_handler","ace/keyboard/keybinding","ace/edit_session","ace/search","ace/range","ace/lib/event_emitter","ace/commands/command_manager","ace/commands/default_commands","ace/config","ace/token_iterator","ace/clipboard"],function(require,exports,module){"use strict";require("./lib/fixoldbrowsers");var oop=require("./lib/oop");var dom=require("./lib/dom");var lang=require("./lib/lang");var useragent=require("./lib/useragent");var TextInput=require("./keyboard/textinput").TextInput;var MouseHandler=require("./mouse/mouse_handler").MouseHandler;var FoldHandler=require("./mouse/fold_handler").FoldHandler;var KeyBinding=require("./keyboard/keybinding").KeyBinding;var EditSession=require("./edit_session").EditSession;var Search=require("./search").Search;var Range=require("./range").Range;var EventEmitter=require("./lib/event_emitter").EventEmitter;var CommandManager=require("./commands/command_manager").CommandManager;var defaultCommands=require("./commands/default_commands").commands;var config=require("./config");var TokenIterator=require("./token_iterator").TokenIterator;var clipboard=require("./clipboard");var Editor=function(renderer,session,options){var container=renderer.getContainerElement();this.container=container;this.renderer=renderer;this.id="editor"+(++Editor.$uid);this.commands=new CommandManager(useragent.isMac?"mac":"win",defaultCommands);if(typeof document=="object"){this.textInput=new TextInput(renderer.getTextAreaContainer(),this);this.renderer.textarea=this.textInput.getElement();this.$mouseHandler=new MouseHandler(this);new FoldHandler(this);}
this.keyBinding=new KeyBinding(this);this.$search=new Search().set({wrap:true});this.$historyTracker=this.$historyTracker.bind(this);this.commands.on("exec",this.$historyTracker);this.$initOperationListeners();this._$emitInputEvent=lang.delayedCall(function(){this._signal("input",{});if(this.session&&this.session.bgTokenizer)
this.session.bgTokenizer.scheduleStart();}.bind(this));this.on("change",function(_,_self){_self._$emitInputEvent.schedule(31);});this.setSession(session||options&&options.session||new EditSession(""));config.resetOptions(this);if(options)
this.setOptions(options);config._signal("editor",this);};Editor.$uid=0;(function(){oop.implement(this,EventEmitter);this.$initOperationListeners=function(){this.commands.on("exec",this.startOperation.bind(this),true);this.commands.on("afterExec",this.endOperation.bind(this),true);this.$opResetTimer=lang.delayedCall(this.endOperation.bind(this));this.on("change",function(){if(!this.curOp){this.startOperation();this.curOp.selectionBefore=this.$lastSel;}
this.curOp.docChanged=true;}.bind(this),true);this.on("changeSelection",function(){if(!this.curOp){this.startOperation();this.curOp.selectionBefore=this.$lastSel;}
this.curOp.selectionChanged=true;}.bind(this),true);};this.curOp=null;this.prevOp={};this.startOperation=function(commadEvent){if(this.curOp){if(!commadEvent||this.curOp.command)
return;this.prevOp=this.curOp;}
if(!commadEvent){this.previousCommand=null;commadEvent={};}
this.$opResetTimer.schedule();this.curOp=this.session.curOp={command:commadEvent.command||{},args:commadEvent.args,scrollTop:this.renderer.scrollTop};this.curOp.selectionBefore=this.selection.toJSON();};this.endOperation=function(e){if(this.curOp){if(e&&e.returnValue===false)
return(this.curOp=null);this._signal("beforeEndOperation");var command=this.curOp.command;var scrollIntoView=command&&command.scrollIntoView;if(scrollIntoView){switch(scrollIntoView){case"center-animate":scrollIntoView="animate";case"center":this.renderer.scrollCursorIntoView(null,0.5);break;case"animate":case"cursor":this.renderer.scrollCursorIntoView();break;case"selectionPart":var range=this.selection.getRange();var config=this.renderer.layerConfig;if(range.start.row>=config.lastRow||range.end.row<=config.firstRow){this.renderer.scrollSelectionIntoView(this.selection.anchor,this.selection.lead);}
break;default:break;}
if(scrollIntoView=="animate")
this.renderer.animateScrolling(this.curOp.scrollTop);}
var sel=this.selection.toJSON();this.curOp.selectionAfter=sel;this.$lastSel=this.selection.toJSON();this.session.getUndoManager().addSelection(sel);this.prevOp=this.curOp;this.curOp=null;}};this.$mergeableCommands=["backspace","del","insertstring"];this.$historyTracker=function(e){if(!this.$mergeUndoDeltas)
return;var prev=this.prevOp;var mergeableCommands=this.$mergeableCommands;var shouldMerge=prev.command&&(e.command.name==prev.command.name);if(e.command.name=="insertstring"){var text=e.args;if(this.mergeNextCommand===undefined)
this.mergeNextCommand=true;shouldMerge=shouldMerge&&this.mergeNextCommand&&(!/\s/.test(text)||/\s/.test(prev.args));this.mergeNextCommand=true;}else{shouldMerge=shouldMerge&&mergeableCommands.indexOf(e.command.name)!==-1;}
if(this.$mergeUndoDeltas!="always"&&Date.now()-this.sequenceStartTime>2000){shouldMerge=false;}
if(shouldMerge)
this.session.mergeUndoDeltas=true;else if(mergeableCommands.indexOf(e.command.name)!==-1)
this.sequenceStartTime=Date.now();};this.setKeyboardHandler=function(keyboardHandler,cb){if(keyboardHandler&&typeof keyboardHandler==="string"&&keyboardHandler!="ace"){this.$keybindingId=keyboardHandler;var _self=this;config.loadModule(["keybinding",keyboardHandler],function(module){if(_self.$keybindingId==keyboardHandler)
_self.keyBinding.setKeyboardHandler(module&&module.handler);cb&&cb();});}else{this.$keybindingId=null;this.keyBinding.setKeyboardHandler(keyboardHandler);cb&&cb();}};this.getKeyboardHandler=function(){return this.keyBinding.getKeyboardHandler();};this.setSession=function(session){if(this.session==session)
return;if(this.curOp)this.endOperation();this.curOp={};var oldSession=this.session;if(oldSession){this.session.off("change",this.$onDocumentChange);this.session.off("changeMode",this.$onChangeMode);this.session.off("tokenizerUpdate",this.$onTokenizerUpdate);this.session.off("changeTabSize",this.$onChangeTabSize);this.session.off("changeWrapLimit",this.$onChangeWrapLimit);this.session.off("changeWrapMode",this.$onChangeWrapMode);this.session.off("changeFold",this.$onChangeFold);this.session.off("changeFrontMarker",this.$onChangeFrontMarker);this.session.off("changeBackMarker",this.$onChangeBackMarker);this.session.off("changeBreakpoint",this.$onChangeBreakpoint);this.session.off("changeAnnotation",this.$onChangeAnnotation);this.session.off("changeOverwrite",this.$onCursorChange);this.session.off("changeScrollTop",this.$onScrollTopChange);this.session.off("changeScrollLeft",this.$onScrollLeftChange);var selection=this.session.getSelection();selection.off("changeCursor",this.$onCursorChange);selection.off("changeSelection",this.$onSelectionChange);}
this.session=session;if(session){this.$onDocumentChange=this.onDocumentChange.bind(this);session.on("change",this.$onDocumentChange);this.renderer.setSession(session);this.$onChangeMode=this.onChangeMode.bind(this);session.on("changeMode",this.$onChangeMode);this.$onTokenizerUpdate=this.onTokenizerUpdate.bind(this);session.on("tokenizerUpdate",this.$onTokenizerUpdate);this.$onChangeTabSize=this.renderer.onChangeTabSize.bind(this.renderer);session.on("changeTabSize",this.$onChangeTabSize);this.$onChangeWrapLimit=this.onChangeWrapLimit.bind(this);session.on("changeWrapLimit",this.$onChangeWrapLimit);this.$onChangeWrapMode=this.onChangeWrapMode.bind(this);session.on("changeWrapMode",this.$onChangeWrapMode);this.$onChangeFold=this.onChangeFold.bind(this);session.on("changeFold",this.$onChangeFold);this.$onChangeFrontMarker=this.onChangeFrontMarker.bind(this);this.session.on("changeFrontMarker",this.$onChangeFrontMarker);this.$onChangeBackMarker=this.onChangeBackMarker.bind(this);this.session.on("changeBackMarker",this.$onChangeBackMarker);this.$onChangeBreakpoint=this.onChangeBreakpoint.bind(this);this.session.on("changeBreakpoint",this.$onChangeBreakpoint);this.$onChangeAnnotation=this.onChangeAnnotation.bind(this);this.session.on("changeAnnotation",this.$onChangeAnnotation);this.$onCursorChange=this.onCursorChange.bind(this);this.session.on("changeOverwrite",this.$onCursorChange);this.$onScrollTopChange=this.onScrollTopChange.bind(this);this.session.on("changeScrollTop",this.$onScrollTopChange);this.$onScrollLeftChange=this.onScrollLeftChange.bind(this);this.session.on("changeScrollLeft",this.$onScrollLeftChange);this.selection=session.getSelection();this.selection.on("changeCursor",this.$onCursorChange);this.$onSelectionChange=this.onSelectionChange.bind(this);this.selection.on("changeSelection",this.$onSelectionChange);this.onChangeMode();this.onCursorChange();this.onScrollTopChange();this.onScrollLeftChange();this.onSelectionChange();this.onChangeFrontMarker();this.onChangeBackMarker();this.onChangeBreakpoint();this.onChangeAnnotation();this.session.getUseWrapMode()&&this.renderer.adjustWrapLimit();this.renderer.updateFull();}else{this.selection=null;this.renderer.setSession(session);}
this._signal("changeSession",{session:session,oldSession:oldSession});this.curOp=null;oldSession&&oldSession._signal("changeEditor",{oldEditor:this});session&&session._signal("changeEditor",{editor:this});if(session&&session.bgTokenizer)
session.bgTokenizer.scheduleStart();};this.getSession=function(){return this.session;};this.setValue=function(val,cursorPos){this.session.doc.setValue(val);if(!cursorPos)
this.selectAll();else if(cursorPos==1)
this.navigateFileEnd();else if(cursorPos==-1)
this.navigateFileStart();return val;};this.getValue=function(){return this.session.getValue();};this.getSelection=function(){return this.selection;};this.resize=function(force){this.renderer.onResize(force);};this.setTheme=function(theme,cb){this.renderer.setTheme(theme,cb);};this.getTheme=function(){return this.renderer.getTheme();};this.setStyle=function(style){this.renderer.setStyle(style);};this.unsetStyle=function(style){this.renderer.unsetStyle(style);};this.getFontSize=function(){return this.getOption("fontSize")||dom.computedStyle(this.container,"fontSize");};this.setFontSize=function(size){this.setOption("fontSize",size);};this.$highlightBrackets=function(){if(this.session.$bracketHighlight){this.session.removeMarker(this.session.$bracketHighlight);this.session.$bracketHighlight=null;}
if(this.$highlightPending){return;}
var self=this;this.$highlightPending=true;setTimeout(function(){self.$highlightPending=false;var session=self.session;if(!session||!session.bgTokenizer)return;var pos=session.findMatchingBracket(self.getCursorPosition());if(pos){var range=new Range(pos.row,pos.column,pos.row,pos.column+1);}else if(session.$mode.getMatching){var range=session.$mode.getMatching(self.session);}
if(range)
session.$bracketHighlight=session.addMarker(range,"ace_bracket","text");},50);};this.$highlightTags=function(){if(this.$highlightTagPending)
return;var self=this;this.$highlightTagPending=true;setTimeout(function(){self.$highlightTagPending=false;var session=self.session;if(!session||!session.bgTokenizer)return;var pos=self.getCursorPosition();var iterator=new TokenIterator(self.session,pos.row,pos.column);var token=iterator.getCurrentToken();if(!token||!/\b(?:tag-open|tag-name)/.test(token.type)){session.removeMarker(session.$tagHighlight);session.$tagHighlight=null;return;}
if(token.type.indexOf("tag-open")!=-1){token=iterator.stepForward();if(!token)
return;}
var tag=token.value;var depth=0;var prevToken=iterator.stepBackward();if(prevToken.value=='<'){do{prevToken=token;token=iterator.stepForward();if(token&&token.value===tag&&token.type.indexOf('tag-name')!==-1){if(prevToken.value==='<'){depth++;}else if(prevToken.value==='</'){depth--;}}}while(token&&depth>=0);}else{do{token=prevToken;prevToken=iterator.stepBackward();if(token&&token.value===tag&&token.type.indexOf('tag-name')!==-1){if(prevToken.value==='<'){depth++;}else if(prevToken.value==='</'){depth--;}}}while(prevToken&&depth<=0);iterator.stepForward();}
if(!token){session.removeMarker(session.$tagHighlight);session.$tagHighlight=null;return;}
var row=iterator.getCurrentTokenRow();var column=iterator.getCurrentTokenColumn();var range=new Range(row,column,row,column+token.value.length);var sbm=session.$backMarkers[session.$tagHighlight];if(session.$tagHighlight&&sbm!=undefined&&range.compareRange(sbm.range)!==0){session.removeMarker(session.$tagHighlight);session.$tagHighlight=null;}
if(!session.$tagHighlight)
session.$tagHighlight=session.addMarker(range,"ace_bracket","text");},50);};this.focus=function(){var _self=this;setTimeout(function(){if(!_self.isFocused())
_self.textInput.focus();});this.textInput.focus();};this.isFocused=function(){return this.textInput.isFocused();};this.blur=function(){this.textInput.blur();};this.onFocus=function(e){if(this.$isFocused)
return;this.$isFocused=true;this.renderer.showCursor();this.renderer.visualizeFocus();this._emit("focus",e);};this.onBlur=function(e){if(!this.$isFocused)
return;this.$isFocused=false;this.renderer.hideCursor();this.renderer.visualizeBlur();this._emit("blur",e);};this.$cursorChange=function(){this.renderer.updateCursor();};this.onDocumentChange=function(delta){var wrap=this.session.$useWrapMode;var lastRow=(delta.start.row==delta.end.row?delta.end.row:Infinity);this.renderer.updateLines(delta.start.row,lastRow,wrap);this._signal("change",delta);this.$cursorChange();this.$updateHighlightActiveLine();};this.onTokenizerUpdate=function(e){var rows=e.data;this.renderer.updateLines(rows.first,rows.last);};this.onScrollTopChange=function(){this.renderer.scrollToY(this.session.getScrollTop());};this.onScrollLeftChange=function(){this.renderer.scrollToX(this.session.getScrollLeft());};this.onCursorChange=function(){this.$cursorChange();this.$highlightBrackets();this.$highlightTags();this.$updateHighlightActiveLine();this._signal("changeSelection");};this.$updateHighlightActiveLine=function(){var session=this.getSession();var highlight;if(this.$highlightActiveLine){if(this.$selectionStyle!="line"||!this.selection.isMultiLine())
highlight=this.getCursorPosition();if(this.renderer.theme&&this.renderer.theme.$selectionColorConflict&&!this.selection.isEmpty())
highlight=false;if(this.renderer.$maxLines&&this.session.getLength()===1&&!(this.renderer.$minLines>1))
highlight=false;}
if(session.$highlightLineMarker&&!highlight){session.removeMarker(session.$highlightLineMarker.id);session.$highlightLineMarker=null;}else if(!session.$highlightLineMarker&&highlight){var range=new Range(highlight.row,highlight.column,highlight.row,Infinity);range.id=session.addMarker(range,"ace_active-line","screenLine");session.$highlightLineMarker=range;}else if(highlight){session.$highlightLineMarker.start.row=highlight.row;session.$highlightLineMarker.end.row=highlight.row;session.$highlightLineMarker.start.column=highlight.column;session._signal("changeBackMarker");}};this.onSelectionChange=function(e){var session=this.session;if(session.$selectionMarker){session.removeMarker(session.$selectionMarker);}
session.$selectionMarker=null;if(!this.selection.isEmpty()){var range=this.selection.getRange();var style=this.getSelectionStyle();session.$selectionMarker=session.addMarker(range,"ace_selection",style);}else{this.$updateHighlightActiveLine();}
var re=this.$highlightSelectedWord&&this.$getSelectionHighLightRegexp();this.session.highlight(re);this._signal("changeSelection");};this.$getSelectionHighLightRegexp=function(){var session=this.session;var selection=this.getSelectionRange();if(selection.isEmpty()||selection.isMultiLine())
return;var startColumn=selection.start.column;var endColumn=selection.end.column;var line=session.getLine(selection.start.row);var needle=line.substring(startColumn,endColumn);if(needle.length>5000||!/[\w\d]/.test(needle))
return;var re=this.$search.$assembleRegExp({wholeWord:true,caseSensitive:true,needle:needle});var wordWithBoundary=line.substring(startColumn-1,endColumn+1);if(!re.test(wordWithBoundary))
return;return re;};this.onChangeFrontMarker=function(){this.renderer.updateFrontMarkers();};this.onChangeBackMarker=function(){this.renderer.updateBackMarkers();};this.onChangeBreakpoint=function(){this.renderer.updateBreakpoints();};this.onChangeAnnotation=function(){this.renderer.setAnnotations(this.session.getAnnotations());};this.onChangeMode=function(e){this.renderer.updateText();this._emit("changeMode",e);};this.onChangeWrapLimit=function(){this.renderer.updateFull();};this.onChangeWrapMode=function(){this.renderer.onResize(true);};this.onChangeFold=function(){this.$updateHighlightActiveLine();this.renderer.updateFull();};this.getSelectedText=function(){return this.session.getTextRange(this.getSelectionRange());};this.getCopyText=function(){var text=this.getSelectedText();var nl=this.session.doc.getNewLineCharacter();var copyLine=false;if(!text&&this.$copyWithEmptySelection){copyLine=true;var ranges=this.selection.getAllRanges();for(var i=0;i<ranges.length;i++){var range=ranges[i];if(i&&ranges[i-1].start.row==range.start.row)
continue;text+=this.session.getLine(range.start.row)+nl;}}
var e={text:text};this._signal("copy",e);clipboard.lineMode=copyLine?e.text:"";return e.text;};this.onCopy=function(){this.commands.exec("copy",this);};this.onCut=function(){this.commands.exec("cut",this);};this.onPaste=function(text,event){var e={text:text,event:event};this.commands.exec("paste",this,e);};this.$handlePaste=function(e){if(typeof e=="string")
e={text:e};this._signal("paste",e);var text=e.text;var lineMode=text==clipboard.lineMode;var session=this.session;if(!this.inMultiSelectMode||this.inVirtualSelectionMode){if(lineMode)
session.insert({row:this.selection.lead.row,column:0},text);else
this.insert(text);}else if(lineMode){this.selection.rangeList.ranges.forEach(function(range){session.insert({row:range.start.row,column:0},text);});}else{var lines=text.split(/\r\n|\r|\n/);var ranges=this.selection.rangeList.ranges;if(lines.length>ranges.length||lines.length<2||!lines[1])
return this.commands.exec("insertstring",this,text);for(var i=ranges.length;i--;){var range=ranges[i];if(!range.isEmpty())
session.remove(range);session.insert(range.start,lines[i]);}}};this.execCommand=function(command,args){return this.commands.exec(command,this,args);};this.insert=function(text,pasted){var session=this.session;var mode=session.getMode();var cursor=this.getCursorPosition();if(this.getBehavioursEnabled()&&!pasted){var transform=mode.transformAction(session.getState(cursor.row),'insertion',this,session,text);if(transform){if(text!==transform.text){if(!this.inVirtualSelectionMode){this.session.mergeUndoDeltas=false;this.mergeNextCommand=false;}}
text=transform.text;}}
if(text=="\t")
text=this.session.getTabString();if(!this.selection.isEmpty()){var range=this.getSelectionRange();cursor=this.session.remove(range);this.clearSelection();}
else if(this.session.getOverwrite()&&text.indexOf("\n")==-1){var range=new Range.fromPoints(cursor,cursor);range.end.column+=text.length;this.session.remove(range);}
if(text=="\n"||text=="\r\n"){var line=session.getLine(cursor.row);if(cursor.column>line.search(/\S|$/)){var d=line.substr(cursor.column).search(/\S|$/);session.doc.removeInLine(cursor.row,cursor.column,cursor.column+d);}}
this.clearSelection();var start=cursor.column;var lineState=session.getState(cursor.row);var line=session.getLine(cursor.row);var shouldOutdent=mode.checkOutdent(lineState,line,text);var end=session.insert(cursor,text);if(transform&&transform.selection){if(transform.selection.length==2){this.selection.setSelectionRange(new Range(cursor.row,start+transform.selection[0],cursor.row,start+transform.selection[1]));}else{this.selection.setSelectionRange(new Range(cursor.row+transform.selection[0],transform.selection[1],cursor.row+transform.selection[2],transform.selection[3]));}}
if(session.getDocument().isNewLine(text)){var lineIndent=mode.getNextLineIndent(lineState,line.slice(0,cursor.column),session.getTabString());session.insert({row:cursor.row+1,column:0},lineIndent);}
if(shouldOutdent)
mode.autoOutdent(lineState,session,cursor.row);};this.onTextInput=function(text){this.keyBinding.onTextInput(text);};this.onCommandKey=function(e,hashId,keyCode){this.keyBinding.onCommandKey(e,hashId,keyCode);};this.setOverwrite=function(overwrite){this.session.setOverwrite(overwrite);};this.getOverwrite=function(){return this.session.getOverwrite();};this.toggleOverwrite=function(){this.session.toggleOverwrite();};this.setScrollSpeed=function(speed){this.setOption("scrollSpeed",speed);};this.getScrollSpeed=function(){return this.getOption("scrollSpeed");};this.setDragDelay=function(dragDelay){this.setOption("dragDelay",dragDelay);};this.getDragDelay=function(){return this.getOption("dragDelay");};this.setSelectionStyle=function(val){this.setOption("selectionStyle",val);};this.getSelectionStyle=function(){return this.getOption("selectionStyle");};this.setHighlightActiveLine=function(shouldHighlight){this.setOption("highlightActiveLine",shouldHighlight);};this.getHighlightActiveLine=function(){return this.getOption("highlightActiveLine");};this.setHighlightGutterLine=function(shouldHighlight){this.setOption("highlightGutterLine",shouldHighlight);};this.getHighlightGutterLine=function(){return this.getOption("highlightGutterLine");};this.setHighlightSelectedWord=function(shouldHighlight){this.setOption("highlightSelectedWord",shouldHighlight);};this.getHighlightSelectedWord=function(){return this.$highlightSelectedWord;};this.setAnimatedScroll=function(shouldAnimate){this.renderer.setAnimatedScroll(shouldAnimate);};this.getAnimatedScroll=function(){return this.renderer.getAnimatedScroll();};this.setShowInvisibles=function(showInvisibles){this.renderer.setShowInvisibles(showInvisibles);};this.getShowInvisibles=function(){return this.renderer.getShowInvisibles();};this.setDisplayIndentGuides=function(display){this.renderer.setDisplayIndentGuides(display);};this.getDisplayIndentGuides=function(){return this.renderer.getDisplayIndentGuides();};this.setShowPrintMargin=function(showPrintMargin){this.renderer.setShowPrintMargin(showPrintMargin);};this.getShowPrintMargin=function(){return this.renderer.getShowPrintMargin();};this.setPrintMarginColumn=function(showPrintMargin){this.renderer.setPrintMarginColumn(showPrintMargin);};this.getPrintMarginColumn=function(){return this.renderer.getPrintMarginColumn();};this.setReadOnly=function(readOnly){this.setOption("readOnly",readOnly);};this.getReadOnly=function(){return this.getOption("readOnly");};this.setBehavioursEnabled=function(enabled){this.setOption("behavioursEnabled",enabled);};this.getBehavioursEnabled=function(){return this.getOption("behavioursEnabled");};this.setWrapBehavioursEnabled=function(enabled){this.setOption("wrapBehavioursEnabled",enabled);};this.getWrapBehavioursEnabled=function(){return this.getOption("wrapBehavioursEnabled");};this.setShowFoldWidgets=function(show){this.setOption("showFoldWidgets",show);};this.getShowFoldWidgets=function(){return this.getOption("showFoldWidgets");};this.setFadeFoldWidgets=function(fade){this.setOption("fadeFoldWidgets",fade);};this.getFadeFoldWidgets=function(){return this.getOption("fadeFoldWidgets");};this.remove=function(dir){if(this.selection.isEmpty()){if(dir=="left")
this.selection.selectLeft();else
this.selection.selectRight();}
var range=this.getSelectionRange();if(this.getBehavioursEnabled()){var session=this.session;var state=session.getState(range.start.row);var new_range=session.getMode().transformAction(state,'deletion',this,session,range);if(range.end.column===0){var text=session.getTextRange(range);if(text[text.length-1]=="\n"){var line=session.getLine(range.end.row);if(/^\s+$/.test(line)){range.end.column=line.length;}}}
if(new_range)
range=new_range;}
this.session.remove(range);this.clearSelection();};this.removeWordRight=function(){if(this.selection.isEmpty())
this.selection.selectWordRight();this.session.remove(this.getSelectionRange());this.clearSelection();};this.removeWordLeft=function(){if(this.selection.isEmpty())
this.selection.selectWordLeft();this.session.remove(this.getSelectionRange());this.clearSelection();};this.removeToLineStart=function(){if(this.selection.isEmpty())
this.selection.selectLineStart();this.session.remove(this.getSelectionRange());this.clearSelection();};this.removeToLineEnd=function(){if(this.selection.isEmpty())
this.selection.selectLineEnd();var range=this.getSelectionRange();if(range.start.column==range.end.column&&range.start.row==range.end.row){range.end.column=0;range.end.row++;}
this.session.remove(range);this.clearSelection();};this.splitLine=function(){if(!this.selection.isEmpty()){this.session.remove(this.getSelectionRange());this.clearSelection();}
var cursor=this.getCursorPosition();this.insert("\n");this.moveCursorToPosition(cursor);};this.transposeLetters=function(){if(!this.selection.isEmpty()){return;}
var cursor=this.getCursorPosition();var column=cursor.column;if(column===0)
return;var line=this.session.getLine(cursor.row);var swap,range;if(column<line.length){swap=line.charAt(column)+line.charAt(column-1);range=new Range(cursor.row,column-1,cursor.row,column+1);}
else{swap=line.charAt(column-1)+line.charAt(column-2);range=new Range(cursor.row,column-2,cursor.row,column);}
this.session.replace(range,swap);this.session.selection.moveToPosition(range.end);};this.toLowerCase=function(){var originalRange=this.getSelectionRange();if(this.selection.isEmpty()){this.selection.selectWord();}
var range=this.getSelectionRange();var text=this.session.getTextRange(range);this.session.replace(range,text.toLowerCase());this.selection.setSelectionRange(originalRange);};this.toUpperCase=function(){var originalRange=this.getSelectionRange();if(this.selection.isEmpty()){this.selection.selectWord();}
var range=this.getSelectionRange();var text=this.session.getTextRange(range);this.session.replace(range,text.toUpperCase());this.selection.setSelectionRange(originalRange);};this.indent=function(){var session=this.session;var range=this.getSelectionRange();if(range.start.row<range.end.row){var rows=this.$getSelectedRows();session.indentRows(rows.first,rows.last,"\t");return;}else if(range.start.column<range.end.column){var text=session.getTextRange(range);if(!/^\s+$/.test(text)){var rows=this.$getSelectedRows();session.indentRows(rows.first,rows.last,"\t");return;}}
var line=session.getLine(range.start.row);var position=range.start;var size=session.getTabSize();var column=session.documentToScreenColumn(position.row,position.column);if(this.session.getUseSoftTabs()){var count=(size-column%size);var indentString=lang.stringRepeat(" ",count);}else{var count=column%size;while(line[range.start.column-1]==" "&&count){range.start.column--;count--;}
this.selection.setSelectionRange(range);indentString="\t";}
return this.insert(indentString);};this.blockIndent=function(){var rows=this.$getSelectedRows();this.session.indentRows(rows.first,rows.last,"\t");};this.blockOutdent=function(){var selection=this.session.getSelection();this.session.outdentRows(selection.getRange());};this.sortLines=function(){var rows=this.$getSelectedRows();var session=this.session;var lines=[];for(var i=rows.first;i<=rows.last;i++)
lines.push(session.getLine(i));lines.sort(function(a,b){if(a.toLowerCase()<b.toLowerCase())return-1;if(a.toLowerCase()>b.toLowerCase())return 1;return 0;});var deleteRange=new Range(0,0,0,0);for(var i=rows.first;i<=rows.last;i++){var line=session.getLine(i);deleteRange.start.row=i;deleteRange.end.row=i;deleteRange.end.column=line.length;session.replace(deleteRange,lines[i-rows.first]);}};this.toggleCommentLines=function(){var state=this.session.getState(this.getCursorPosition().row);var rows=this.$getSelectedRows();this.session.getMode().toggleCommentLines(state,this.session,rows.first,rows.last);};this.toggleBlockComment=function(){var cursor=this.getCursorPosition();var state=this.session.getState(cursor.row);var range=this.getSelectionRange();this.session.getMode().toggleBlockComment(state,this.session,range,cursor);};this.getNumberAt=function(row,column){var _numberRx=/[\-]?[0-9]+(?:\.[0-9]+)?/g;_numberRx.lastIndex=0;var s=this.session.getLine(row);while(_numberRx.lastIndex<column){var m=_numberRx.exec(s);if(m.index<=column&&m.index+m[0].length>=column){var number={value:m[0],start:m.index,end:m.index+m[0].length};return number;}}
return null;};this.modifyNumber=function(amount){var row=this.selection.getCursor().row;var column=this.selection.getCursor().column;var charRange=new Range(row,column-1,row,column);var c=this.session.getTextRange(charRange);if(!isNaN(parseFloat(c))&&isFinite(c)){var nr=this.getNumberAt(row,column);if(nr){var fp=nr.value.indexOf(".")>=0?nr.start+nr.value.indexOf(".")+1:nr.end;var decimals=nr.start+nr.value.length-fp;var t=parseFloat(nr.value);t*=Math.pow(10,decimals);if(fp!==nr.end&&column<fp){amount*=Math.pow(10,nr.end-column-1);}else{amount*=Math.pow(10,nr.end-column);}
t+=amount;t/=Math.pow(10,decimals);var nnr=t.toFixed(decimals);var replaceRange=new Range(row,nr.start,row,nr.end);this.session.replace(replaceRange,nnr);this.moveCursorTo(row,Math.max(nr.start+1,column+nnr.length-nr.value.length));}}};this.removeLines=function(){var rows=this.$getSelectedRows();this.session.removeFullLines(rows.first,rows.last);this.clearSelection();};this.duplicateSelection=function(){var sel=this.selection;var doc=this.session;var range=sel.getRange();var reverse=sel.isBackwards();if(range.isEmpty()){var row=range.start.row;doc.duplicateLines(row,row);}else{var point=reverse?range.start:range.end;var endPoint=doc.insert(point,doc.getTextRange(range),false);range.start=point;range.end=endPoint;sel.setSelectionRange(range,reverse);}};this.moveLinesDown=function(){this.$moveLines(1,false);};this.moveLinesUp=function(){this.$moveLines(-1,false);};this.moveText=function(range,toPosition,copy){return this.session.moveText(range,toPosition,copy);};this.copyLinesUp=function(){this.$moveLines(-1,true);};this.copyLinesDown=function(){this.$moveLines(1,true);};this.$moveLines=function(dir,copy){var rows,moved;var selection=this.selection;if(!selection.inMultiSelectMode||this.inVirtualSelectionMode){var range=selection.toOrientedRange();rows=this.$getSelectedRows(range);moved=this.session.$moveLines(rows.first,rows.last,copy?0:dir);if(copy&&dir==-1)moved=0;range.moveBy(moved,0);selection.fromOrientedRange(range);}else{var ranges=selection.rangeList.ranges;selection.rangeList.detach(this.session);this.inVirtualSelectionMode=true;var diff=0;var totalDiff=0;var l=ranges.length;for(var i=0;i<l;i++){var rangeIndex=i;ranges[i].moveBy(diff,0);rows=this.$getSelectedRows(ranges[i]);var first=rows.first;var last=rows.last;while(++i<l){if(totalDiff)ranges[i].moveBy(totalDiff,0);var subRows=this.$getSelectedRows(ranges[i]);if(copy&&subRows.first!=last)
break;else if(!copy&&subRows.first>last+1)
break;last=subRows.last;}
i--;diff=this.session.$moveLines(first,last,copy?0:dir);if(copy&&dir==-1)rangeIndex=i+1;while(rangeIndex<=i){ranges[rangeIndex].moveBy(diff,0);rangeIndex++;}
if(!copy)diff=0;totalDiff+=diff;}
selection.fromOrientedRange(selection.ranges[0]);selection.rangeList.attach(this.session);this.inVirtualSelectionMode=false;}};this.$getSelectedRows=function(range){range=(range||this.getSelectionRange()).collapseRows();return{first:this.session.getRowFoldStart(range.start.row),last:this.session.getRowFoldEnd(range.end.row)};};this.onCompositionStart=function(text){this.renderer.showComposition(this.getCursorPosition());};this.onCompositionUpdate=function(text){this.renderer.setCompositionText(text);};this.onCompositionEnd=function(){this.renderer.hideComposition();};this.getFirstVisibleRow=function(){return this.renderer.getFirstVisibleRow();};this.getLastVisibleRow=function(){return this.renderer.getLastVisibleRow();};this.isRowVisible=function(row){return(row>=this.getFirstVisibleRow()&&row<=this.getLastVisibleRow());};this.isRowFullyVisible=function(row){return(row>=this.renderer.getFirstFullyVisibleRow()&&row<=this.renderer.getLastFullyVisibleRow());};this.$getVisibleRowCount=function(){return this.renderer.getScrollBottomRow()-this.renderer.getScrollTopRow()+1;};this.$moveByPage=function(dir,select){var renderer=this.renderer;var config=this.renderer.layerConfig;var rows=dir*Math.floor(config.height/config.lineHeight);if(select===true){this.selection.$moveSelection(function(){this.moveCursorBy(rows,0);});}else if(select===false){this.selection.moveCursorBy(rows,0);this.selection.clearSelection();}
var scrollTop=renderer.scrollTop;renderer.scrollBy(0,rows*config.lineHeight);if(select!=null)
renderer.scrollCursorIntoView(null,0.5);renderer.animateScrolling(scrollTop);};this.selectPageDown=function(){this.$moveByPage(1,true);};this.selectPageUp=function(){this.$moveByPage(-1,true);};this.gotoPageDown=function(){this.$moveByPage(1,false);};this.gotoPageUp=function(){this.$moveByPage(-1,false);};this.scrollPageDown=function(){this.$moveByPage(1);};this.scrollPageUp=function(){this.$moveByPage(-1);};this.scrollToRow=function(row){this.renderer.scrollToRow(row);};this.scrollToLine=function(line,center,animate,callback){this.renderer.scrollToLine(line,center,animate,callback);};this.centerSelection=function(){var range=this.getSelectionRange();var pos={row:Math.floor(range.start.row+(range.end.row-range.start.row)/2),column:Math.floor(range.start.column+(range.end.column-range.start.column)/2)};this.renderer.alignCursor(pos,0.5);};this.getCursorPosition=function(){return this.selection.getCursor();};this.getCursorPositionScreen=function(){return this.session.documentToScreenPosition(this.getCursorPosition());};this.getSelectionRange=function(){return this.selection.getRange();};this.selectAll=function(){this.selection.selectAll();};this.clearSelection=function(){this.selection.clearSelection();};this.moveCursorTo=function(row,column){this.selection.moveCursorTo(row,column);};this.moveCursorToPosition=function(pos){this.selection.moveCursorToPosition(pos);};this.jumpToMatching=function(select,expand){var cursor=this.getCursorPosition();var iterator=new TokenIterator(this.session,cursor.row,cursor.column);var prevToken=iterator.getCurrentToken();var token=prevToken||iterator.stepForward();if(!token)return;var matchType;var found=false;var depth={};var i=cursor.column-token.start;var bracketType;var brackets={")":"(","(":"(","]":"[","[":"[","{":"{","}":"{"};do{if(token.value.match(/[{}()\[\]]/g)){for(;i<token.value.length&&!found;i++){if(!brackets[token.value[i]]){continue;}
bracketType=brackets[token.value[i]]+'.'+token.type.replace("rparen","lparen");if(isNaN(depth[bracketType])){depth[bracketType]=0;}
switch(token.value[i]){case'(':case'[':case'{':depth[bracketType]++;break;case')':case']':case'}':depth[bracketType]--;if(depth[bracketType]===-1){matchType='bracket';found=true;}
break;}}}
else if(token.type.indexOf('tag-name')!==-1){if(isNaN(depth[token.value])){depth[token.value]=0;}
if(prevToken.value==='<'){depth[token.value]++;}
else if(prevToken.value==='</'){depth[token.value]--;}
if(depth[token.value]===-1){matchType='tag';found=true;}}
if(!found){prevToken=token;token=iterator.stepForward();i=0;}}while(token&&!found);if(!matchType)
return;var range,pos;if(matchType==='bracket'){range=this.session.getBracketRange(cursor);if(!range){range=new Range(iterator.getCurrentTokenRow(),iterator.getCurrentTokenColumn()+i-1,iterator.getCurrentTokenRow(),iterator.getCurrentTokenColumn()+i-1);pos=range.start;if(expand||pos.row===cursor.row&&Math.abs(pos.column-cursor.column)<2)
range=this.session.getBracketRange(pos);}}
else if(matchType==='tag'){if(token&&token.type.indexOf('tag-name')!==-1)
var tag=token.value;else
return;range=new Range(iterator.getCurrentTokenRow(),iterator.getCurrentTokenColumn()-2,iterator.getCurrentTokenRow(),iterator.getCurrentTokenColumn()-2);if(range.compare(cursor.row,cursor.column)===0){found=false;do{token=prevToken;prevToken=iterator.stepBackward();if(prevToken){if(prevToken.type.indexOf('tag-close')!==-1){range.setEnd(iterator.getCurrentTokenRow(),iterator.getCurrentTokenColumn()+1);}
if(token.value===tag&&token.type.indexOf('tag-name')!==-1){if(prevToken.value==='<'){depth[tag]++;}
else if(prevToken.value==='</'){depth[tag]--;}
if(depth[tag]===0)
found=true;}}}while(prevToken&&!found);}
if(token&&token.type.indexOf('tag-name')){pos=range.start;if(pos.row==cursor.row&&Math.abs(pos.column-cursor.column)<2)
pos=range.end;}}
pos=range&&range.cursor||pos;if(pos){if(select){if(range&&expand){this.selection.setRange(range);}else if(range&&range.isEqual(this.getSelectionRange())){this.clearSelection();}else{this.selection.selectTo(pos.row,pos.column);}}else{this.selection.moveTo(pos.row,pos.column);}}};this.gotoLine=function(lineNumber,column,animate){this.selection.clearSelection();this.session.unfold({row:lineNumber-1,column:column||0});this.exitMultiSelectMode&&this.exitMultiSelectMode();this.moveCursorTo(lineNumber-1,column||0);if(!this.isRowFullyVisible(lineNumber-1))
this.scrollToLine(lineNumber-1,true,animate);};this.navigateTo=function(row,column){this.selection.moveTo(row,column);};this.navigateUp=function(times){if(this.selection.isMultiLine()&&!this.selection.isBackwards()){var selectionStart=this.selection.anchor.getPosition();return this.moveCursorToPosition(selectionStart);}
this.selection.clearSelection();this.selection.moveCursorBy(-times||-1,0);};this.navigateDown=function(times){if(this.selection.isMultiLine()&&this.selection.isBackwards()){var selectionEnd=this.selection.anchor.getPosition();return this.moveCursorToPosition(selectionEnd);}
this.selection.clearSelection();this.selection.moveCursorBy(times||1,0);};this.navigateLeft=function(times){if(!this.selection.isEmpty()){var selectionStart=this.getSelectionRange().start;this.moveCursorToPosition(selectionStart);}
else{times=times||1;while(times--){this.selection.moveCursorLeft();}}
this.clearSelection();};this.navigateRight=function(times){if(!this.selection.isEmpty()){var selectionEnd=this.getSelectionRange().end;this.moveCursorToPosition(selectionEnd);}
else{times=times||1;while(times--){this.selection.moveCursorRight();}}
this.clearSelection();};this.navigateLineStart=function(){this.selection.moveCursorLineStart();this.clearSelection();};this.navigateLineEnd=function(){this.selection.moveCursorLineEnd();this.clearSelection();};this.navigateFileEnd=function(){this.selection.moveCursorFileEnd();this.clearSelection();};this.navigateFileStart=function(){this.selection.moveCursorFileStart();this.clearSelection();};this.navigateWordRight=function(){this.selection.moveCursorWordRight();this.clearSelection();};this.navigateWordLeft=function(){this.selection.moveCursorWordLeft();this.clearSelection();};this.replace=function(replacement,options){if(options)
this.$search.set(options);var range=this.$search.find(this.session);var replaced=0;if(!range)
return replaced;if(this.$tryReplace(range,replacement)){replaced=1;}
this.selection.setSelectionRange(range);this.renderer.scrollSelectionIntoView(range.start,range.end);return replaced;};this.replaceAll=function(replacement,options){if(options){this.$search.set(options);}
var ranges=this.$search.findAll(this.session);var replaced=0;if(!ranges.length)
return replaced;var selection=this.getSelectionRange();this.selection.moveTo(0,0);for(var i=ranges.length-1;i>=0;--i){if(this.$tryReplace(ranges[i],replacement)){replaced++;}}
this.selection.setSelectionRange(selection);return replaced;};this.$tryReplace=function(range,replacement){var input=this.session.getTextRange(range);replacement=this.$search.replace(input,replacement);if(replacement!==null){range.end=this.session.replace(range,replacement);return range;}else{return null;}};this.getLastSearchOptions=function(){return this.$search.getOptions();};this.find=function(needle,options,animate){if(!options)
options={};if(typeof needle=="string"||needle instanceof RegExp)
options.needle=needle;else if(typeof needle=="object")
oop.mixin(options,needle);var range=this.selection.getRange();if(options.needle==null){needle=this.session.getTextRange(range)||this.$search.$options.needle;if(!needle){range=this.session.getWordRange(range.start.row,range.start.column);needle=this.session.getTextRange(range);}
this.$search.set({needle:needle});}
this.$search.set(options);if(!options.start)
this.$search.set({start:range});var newRange=this.$search.find(this.session);if(options.preventScroll)
return newRange;if(newRange){this.revealRange(newRange,animate);return newRange;}
if(options.backwards)
range.start=range.end;else
range.end=range.start;this.selection.setRange(range);};this.findNext=function(options,animate){this.find({skipCurrent:true,backwards:false},options,animate);};this.findPrevious=function(options,animate){this.find(options,{skipCurrent:true,backwards:true},animate);};this.revealRange=function(range,animate){this.session.unfold(range);this.selection.setSelectionRange(range);var scrollTop=this.renderer.scrollTop;this.renderer.scrollSelectionIntoView(range.start,range.end,0.5);if(animate!==false)
this.renderer.animateScrolling(scrollTop);};this.undo=function(){this.session.getUndoManager().undo(this.session);this.renderer.scrollCursorIntoView(null,0.5);};this.redo=function(){this.session.getUndoManager().redo(this.session);this.renderer.scrollCursorIntoView(null,0.5);};this.destroy=function(){this.renderer.destroy();this._signal("destroy",this);if(this.session){this.session.destroy();}};this.setAutoScrollEditorIntoView=function(enable){if(!enable)
return;var rect;var self=this;var shouldScroll=false;if(!this.$scrollAnchor)
this.$scrollAnchor=document.createElement("div");var scrollAnchor=this.$scrollAnchor;scrollAnchor.style.cssText="position:absolute";this.container.insertBefore(scrollAnchor,this.container.firstChild);var onChangeSelection=this.on("changeSelection",function(){shouldScroll=true;});var onBeforeRender=this.renderer.on("beforeRender",function(){if(shouldScroll)
rect=self.renderer.container.getBoundingClientRect();});var onAfterRender=this.renderer.on("afterRender",function(){if(shouldScroll&&rect&&(self.isFocused()||self.searchBox&&self.searchBox.isFocused())){var renderer=self.renderer;var pos=renderer.$cursorLayer.$pixelPos;var config=renderer.layerConfig;var top=pos.top-config.offset;if(pos.top>=0&&top+rect.top<0){shouldScroll=true;}else if(pos.top<config.height&&pos.top+rect.top+config.lineHeight>window.innerHeight){shouldScroll=false;}else{shouldScroll=null;}
if(shouldScroll!=null){scrollAnchor.style.top=top+"px";scrollAnchor.style.left=pos.left+"px";scrollAnchor.style.height=config.lineHeight+"px";scrollAnchor.scrollIntoView(shouldScroll);}
shouldScroll=rect=null;}});this.setAutoScrollEditorIntoView=function(enable){if(enable)
return;delete this.setAutoScrollEditorIntoView;this.off("changeSelection",onChangeSelection);this.renderer.off("afterRender",onAfterRender);this.renderer.off("beforeRender",onBeforeRender);};};this.$resetCursorStyle=function(){var style=this.$cursorStyle||"ace";var cursorLayer=this.renderer.$cursorLayer;if(!cursorLayer)
return;cursorLayer.setSmoothBlinking(/smooth/.test(style));cursorLayer.isBlinking=!this.$readOnly&&style!="wide";dom.setCssClass(cursorLayer.element,"ace_slim-cursors",/slim/.test(style));};}).call(Editor.prototype);config.defineOptions(Editor.prototype,"editor",{selectionStyle:{set:function(style){this.onSelectionChange();this._signal("changeSelectionStyle",{data:style});},initialValue:"line"},highlightActiveLine:{set:function(){this.$updateHighlightActiveLine();},initialValue:true},highlightSelectedWord:{set:function(shouldHighlight){this.$onSelectionChange();},initialValue:true},readOnly:{set:function(readOnly){this.textInput.setReadOnly(readOnly);this.$resetCursorStyle();},initialValue:false},copyWithEmptySelection:{set:function(value){this.textInput.setCopyWithEmptySelection(value);},initialValue:false},cursorStyle:{set:function(val){this.$resetCursorStyle();},values:["ace","slim","smooth","wide"],initialValue:"ace"},mergeUndoDeltas:{values:[false,true,"always"],initialValue:true},behavioursEnabled:{initialValue:true},wrapBehavioursEnabled:{initialValue:true},autoScrollEditorIntoView:{set:function(val){this.setAutoScrollEditorIntoView(val);}},keyboardHandler:{set:function(val){this.setKeyboardHandler(val);},get:function(){return this.$keybindingId;},handlesSet:true},value:{set:function(val){this.session.setValue(val);},get:function(){return this.getValue();},handlesSet:true,hidden:true},session:{set:function(val){this.setSession(val);},get:function(){return this.session;},handlesSet:true,hidden:true},hScrollBarAlwaysVisible:"renderer",vScrollBarAlwaysVisible:"renderer",highlightGutterLine:"renderer",animatedScroll:"renderer",showInvisibles:"renderer",showPrintMargin:"renderer",printMarginColumn:"renderer",printMargin:"renderer",fadeFoldWidgets:"renderer",showFoldWidgets:"renderer",showLineNumbers:"renderer",showGutter:"renderer",displayIndentGuides:"renderer",fontSize:"renderer",fontFamily:"renderer",maxLines:"renderer",minLines:"renderer",scrollPastEnd:"renderer",fixedWidthGutter:"renderer",theme:"renderer",scrollSpeed:"$mouseHandler",dragDelay:"$mouseHandler",dragEnabled:"$mouseHandler",focusTimeout:"$mouseHandler",tooltipFollowsMouse:"$mouseHandler",firstLineNumber:"session",overwrite:"session",newLineMode:"session",useWorker:"session",useSoftTabs:"session",navigateWithinSoftTabs:"session",tabSize:"session",wrap:"session",indentedSoftWrap:"session",foldStyle:"session",mode:"session"});exports.Editor=Editor;});define("ace/undomanager",["require","exports","module","ace/range"],function(require,exports,module){"use strict";var UndoManager=function(){this.$maxRev=0;this.$fromUndo=false;this.reset();};(function(){this.addSession=function(session){this.$session=session;};this.add=function(delta,allowMerge,session){if(this.$fromUndo)return;if(delta==this.$lastDelta)return;if(allowMerge===false||!this.lastDeltas){this.lastDeltas=[];this.$undoStack.push(this.lastDeltas);delta.id=this.$rev=++this.$maxRev;}
if(delta.action=="remove"||delta.action=="insert")
this.$lastDelta=delta;this.lastDeltas.push(delta);};this.addSelection=function(selection,rev){this.selections.push({value:selection,rev:rev||this.$rev});};this.startNewGroup=function(){this.lastDeltas=null;return this.$rev;};this.markIgnored=function(from,to){if(to==null)to=this.$rev+1;var stack=this.$undoStack;for(var i=stack.length;i--;){var delta=stack[i][0];if(delta.id<=from)
break;if(delta.id<to)
delta.ignore=true;}
this.lastDeltas=null;};this.getSelection=function(rev,after){var stack=this.selections;for(var i=stack.length;i--;){var selection=stack[i];if(selection.rev<rev){if(after)
selection=stack[i+1];return selection;}}};this.getRevision=function(){return this.$rev;};this.getDeltas=function(from,to){if(to==null)to=this.$rev+1;var stack=this.$undoStack;var end=null,start=0;for(var i=stack.length;i--;){var delta=stack[i][0];if(delta.id<to&&!end)
end=i+1;if(delta.id<=from){start=i+1;break;}}
return stack.slice(start,end);};this.getChangedRanges=function(from,to){if(to==null)to=this.$rev+1;};this.getChangedLines=function(from,to){if(to==null)to=this.$rev+1;};this.undo=function(session,dontSelect){this.lastDeltas=null;var stack=this.$undoStack;if(!rearrangeUndoStack(stack,stack.length))
return;if(!session)
session=this.$session;if(this.$redoStackBaseRev!==this.$rev&&this.$redoStack.length)
this.$redoStack=[];this.$fromUndo=true;var deltaSet=stack.pop();var undoSelectionRange=null;if(deltaSet&&deltaSet.length){undoSelectionRange=session.undoChanges(deltaSet,dontSelect);this.$redoStack.push(deltaSet);this.$syncRev();}
this.$fromUndo=false;return undoSelectionRange;};this.redo=function(session,dontSelect){this.lastDeltas=null;if(!session)
session=this.$session;this.$fromUndo=true;if(this.$redoStackBaseRev!=this.$rev){var diff=this.getDeltas(this.$redoStackBaseRev,this.$rev+1);rebaseRedoStack(this.$redoStack,diff);this.$redoStackBaseRev=this.$rev;this.$redoStack.forEach(function(x){x[0].id=++this.$maxRev;},this);}
var deltaSet=this.$redoStack.pop();var redoSelectionRange=null;if(deltaSet){redoSelectionRange=session.redoChanges(deltaSet,dontSelect);this.$undoStack.push(deltaSet);this.$syncRev();}
this.$fromUndo=false;return redoSelectionRange;};this.$syncRev=function(){var stack=this.$undoStack;var nextDelta=stack[stack.length-1];var id=nextDelta&&nextDelta[0].id||0;this.$redoStackBaseRev=id;this.$rev=id;};this.reset=function(){this.lastDeltas=null;this.$lastDelta=null;this.$undoStack=[];this.$redoStack=[];this.$rev=0;this.mark=0;this.$redoStackBaseRev=this.$rev;this.selections=[];};this.canUndo=function(){return this.$undoStack.length>0;};this.canRedo=function(){return this.$redoStack.length>0;};this.bookmark=function(rev){if(rev==undefined)
rev=this.$rev;this.mark=rev;};this.isAtBookmark=function(){return this.$rev===this.mark;};this.toJSON=function(){};this.fromJSON=function(){};this.hasUndo=this.canUndo;this.hasRedo=this.canRedo;this.isClean=this.isAtBookmark;this.markClean=this.bookmark;}).call(UndoManager.prototype);function rearrangeUndoStack(stack,pos){for(var i=pos;i--;){var deltaSet=stack[i];if(deltaSet&&!deltaSet[0].ignore){while(i<pos-1){var swapped=swapGroups(stack[i],stack[i+1]);stack[i]=swapped[0];stack[i+1]=swapped[1];i++;}
return true;}}}
var Range=require("./range").Range;var cmp=Range.comparePoints;var comparePoints=Range.comparePoints;function $updateMarkers(delta){var isInsert=delta.action=="insert";var start=delta.start;var end=delta.end;var rowShift=(end.row-start.row)*(isInsert?1:-1);var colShift=(end.column-start.column)*(isInsert?1:-1);if(isInsert)end=start;for(var i in this.marks){var point=this.marks[i];var cmp=comparePoints(point,start);if(cmp<0){continue;}
if(cmp===0){if(isInsert){if(point.bias==1){cmp=1;}
else{point.bias==-1;continue;}}}
var cmp2=isInsert?cmp:comparePoints(point,end);if(cmp2>0){point.row+=rowShift;point.column+=point.row==end.row?colShift:0;continue;}
if(!isInsert&&cmp2<=0){point.row=start.row;point.column=start.column;if(cmp2===0)
point.bias=1;}}}
function clonePos(pos){return{row:pos.row,column:pos.column};}
function cloneDelta(d){return{start:clonePos(d.start),end:clonePos(d.end),action:d.action,lines:d.lines.slice()};}
function stringifyDelta(d){d=d||this;if(Array.isArray(d)){return d.map(stringifyDelta).join("\n");}
var type="";if(d.action){type=d.action=="insert"?"+":"-";type+="["+d.lines+"]";}else if(d.value){if(Array.isArray(d.value)){type=d.value.map(stringifyRange).join("\n");}else{type=stringifyRange(d.value);}}
if(d.start){type+=stringifyRange(d);}
if(d.id||d.rev){type+="\t("+(d.id||d.rev)+")";}
return type;}
function stringifyRange(r){return r.start.row+":"+r.start.column
+"=>"+r.end.row+":"+r.end.column;}
function swap(d1,d2){var i1=d1.action=="insert";var i2=d2.action=="insert";if(i1&&i2){if(cmp(d2.start,d1.end)>=0){shift(d2,d1,-1);}else if(cmp(d2.start,d1.start)<=0){shift(d1,d2,+1);}else{return null;}}else if(i1&&!i2){if(cmp(d2.start,d1.end)>=0){shift(d2,d1,-1);}else if(cmp(d2.end,d1.start)<=0){shift(d1,d2,-1);}else{return null;}}else if(!i1&&i2){if(cmp(d2.start,d1.start)>=0){shift(d2,d1,+1);}else if(cmp(d2.start,d1.start)<=0){shift(d1,d2,+1);}else{return null;}}else if(!i1&&!i2){if(cmp(d2.start,d1.start)>=0){shift(d2,d1,+1);}else if(cmp(d2.end,d1.start)<=0){shift(d1,d2,-1);}else{return null;}}
return[d2,d1];}
function swapGroups(ds1,ds2){for(var i=ds1.length;i--;){for(var j=0;j<ds2.length;j++){if(!swap(ds1[i],ds2[j])){while(i<ds1.length){while(j--){swap(ds2[j],ds1[i]);}
j=ds2.length;i++;}
return[ds1,ds2];}}}
ds1.selectionBefore=ds2.selectionBefore=ds1.selectionAfter=ds2.selectionAfter=null;return[ds2,ds1];}
function xform(d1,c1){var i1=d1.action=="insert";var i2=c1.action=="insert";if(i1&&i2){if(cmp(d1.start,c1.start)<0){shift(c1,d1,1);}else{shift(d1,c1,1);}}else if(i1&&!i2){if(cmp(d1.start,c1.end)>=0){shift(d1,c1,-1);}else if(cmp(d1.start,c1.start)<=0){shift(c1,d1,+1);}else{shift(d1,Range.fromPoints(c1.start,d1.start),-1);shift(c1,d1,+1);}}else if(!i1&&i2){if(cmp(c1.start,d1.end)>=0){shift(c1,d1,-1);}else if(cmp(c1.start,d1.start)<=0){shift(d1,c1,+1);}else{shift(c1,Range.fromPoints(d1.start,c1.start),-1);shift(d1,c1,+1);}}else if(!i1&&!i2){if(cmp(c1.start,d1.end)>=0){shift(c1,d1,-1);}else if(cmp(c1.end,d1.start)<=0){shift(d1,c1,-1);}else{var before,after;if(cmp(d1.start,c1.start)<0){before=d1;d1=splitDelta(d1,c1.start);}
if(cmp(d1.end,c1.end)>0){after=splitDelta(d1,c1.end);}
shiftPos(c1.end,d1.start,d1.end,-1);if(after&&!before){d1.lines=after.lines;d1.start=after.start;d1.end=after.end;after=d1;}
return[c1,before,after].filter(Boolean);}}
return[c1,d1];}
function shift(d1,d2,dir){shiftPos(d1.start,d2.start,d2.end,dir);shiftPos(d1.end,d2.start,d2.end,dir);}
function shiftPos(pos,start,end,dir){if(pos.row==(dir==1?start:end).row){pos.column+=dir*(end.column-start.column);}
pos.row+=dir*(end.row-start.row);}
function splitDelta(c,pos){var lines=c.lines;var end=c.end;c.end=clonePos(pos);var rowsBefore=c.end.row-c.start.row;var otherLines=lines.splice(rowsBefore,lines.length);var col=rowsBefore?pos.column:pos.column-c.start.column;lines.push(otherLines[0].substring(0,col));otherLines[0]=otherLines[0].substr(col);var rest={start:clonePos(pos),end:end,lines:otherLines,action:c.action};return rest;}
function moveDeltasByOne(redoStack,d){d=cloneDelta(d);for(var j=redoStack.length;j--;){var deltaSet=redoStack[j];for(var i=deltaSet.length;i-->0;){var x=deltaSet[i];var xformed=xform(x,d);d=xformed[0];if(xformed.length!=2){if(xformed[2]){redoStack.splice(i+1,1,xformed[1],xformed[2]);i++;}else if(!xformed[1]){redoStack.splice(i,1);i--;}}}}
return redoStack;}
function rebaseRedoStack(redoStack,deltaSets){for(var i=0;i<deltaSets.length;i++){var deltas=deltaSets[i];for(var j=0;j<deltas.length;j++){moveDeltasByOne(redoStack,deltas[j]);}}}
exports.UndoManager=UndoManager;});define("ace/layer/gutter",["require","exports","module","ace/lib/dom","ace/lib/oop","ace/lib/lang","ace/lib/event_emitter"],function(require,exports,module){"use strict";var dom=require("../lib/dom");var oop=require("../lib/oop");var lang=require("../lib/lang");var EventEmitter=require("../lib/event_emitter").EventEmitter;var Gutter=function(parentEl){this.element=dom.createElement("div");this.element.className="ace_layer ace_gutter-layer";parentEl.appendChild(this.element);this.setShowFoldWidgets(this.$showFoldWidgets);this.gutterWidth=0;this.$annotations=[];this.$updateAnnotations=this.$updateAnnotations.bind(this);this.$cells=[];};(function(){oop.implement(this,EventEmitter);this.setSession=function(session){if(this.session)
this.session.removeEventListener("change",this.$updateAnnotations);this.session=session;if(session)
session.on("change",this.$updateAnnotations);};this.addGutterDecoration=function(row,className){if(window.console)
console.warn&&console.warn("deprecated use session.addGutterDecoration");this.session.addGutterDecoration(row,className);};this.removeGutterDecoration=function(row,className){if(window.console)
console.warn&&console.warn("deprecated use session.removeGutterDecoration");this.session.removeGutterDecoration(row,className);};this.setAnnotations=function(annotations){this.$annotations=[];for(var i=0;i<annotations.length;i++){var annotation=annotations[i];var row=annotation.row;var rowInfo=this.$annotations[row];if(!rowInfo)
rowInfo=this.$annotations[row]={text:[]};var annoText=annotation.text;annoText=annoText?lang.escapeHTML(annoText):annotation.html||"";if(rowInfo.text.indexOf(annoText)===-1)
rowInfo.text.push(annoText);var type=annotation.type;if(type=="error")
rowInfo.className=" ace_error";else if(type=="warning"&&rowInfo.className!=" ace_error")
rowInfo.className=" ace_warning";else if(type=="info"&&(!rowInfo.className))
rowInfo.className=" ace_info";}};this.$updateAnnotations=function(delta){if(!this.$annotations.length)
return;var firstRow=delta.start.row;var len=delta.end.row-firstRow;if(len===0){}else if(delta.action=='remove'){this.$annotations.splice(firstRow,len+1,null);}else{var args=new Array(len+1);args.unshift(firstRow,1);this.$annotations.splice.apply(this.$annotations,args);}};this.update=function(config){var session=this.session;var firstRow=config.firstRow;var lastRow=Math.min(config.lastRow+config.gutterOffset,session.getLength()-1);var fold=session.getNextFoldLine(firstRow);var foldStart=fold?fold.start.row:Infinity;var foldWidgets=this.$showFoldWidgets&&session.foldWidgets;var breakpoints=session.$breakpoints;var decorations=session.$decorations;var firstLineNumber=session.$firstLineNumber;var lastLineNumber=0;var gutterRenderer=session.gutterRenderer||this.$renderer;var cell=null;var index=-1;var row=firstRow;while(true){if(row>foldStart){row=fold.end.row+1;fold=session.getNextFoldLine(row,fold);foldStart=fold?fold.start.row:Infinity;}
if(row>lastRow){while(this.$cells.length>index+1){cell=this.$cells.pop();this.element.removeChild(cell.element);}
break;}
cell=this.$cells[++index];if(!cell){cell={element:null,textNode:null,foldWidget:null};cell.element=dom.createElement("div");cell.textNode=document.createTextNode('');cell.element.appendChild(cell.textNode);this.element.appendChild(cell.element);this.$cells[index]=cell;}
var className="ace_gutter-cell ";if(breakpoints[row])
className+=breakpoints[row];if(decorations[row])
className+=decorations[row];if(this.$annotations[row])
className+=this.$annotations[row].className;if(cell.element.className!=className)
cell.element.className=className;var height=session.getRowLength(row)*config.lineHeight+"px";if(height!=cell.element.style.height)
cell.element.style.height=height;if(foldWidgets){var c=foldWidgets[row];if(c==null)
c=foldWidgets[row]=session.getFoldWidget(row);}
if(c){if(!cell.foldWidget){cell.foldWidget=dom.createElement("span");cell.element.appendChild(cell.foldWidget);}
var className="ace_fold-widget ace_"+c;if(c=="start"&&row==foldStart&&row<fold.end.row)
className+=" ace_closed";else
className+=" ace_open";if(cell.foldWidget.className!=className)
cell.foldWidget.className=className;var height=config.lineHeight+"px";if(cell.foldWidget.style.height!=height)
cell.foldWidget.style.height=height;}else{if(cell.foldWidget){cell.element.removeChild(cell.foldWidget);cell.foldWidget=null;}}
var text=lastLineNumber=gutterRenderer?gutterRenderer.getText(session,row):row+firstLineNumber;if(text!==cell.textNode.data)
cell.textNode.data=text;row++;}
this.element.style.height=config.minHeight+"px";if(this.$fixedWidth||session.$useWrapMode)
lastLineNumber=session.getLength()+firstLineNumber;var gutterWidth=gutterRenderer?gutterRenderer.getWidth(session,lastLineNumber,config):lastLineNumber.toString().length*config.characterWidth;var padding=this.$padding||this.$computePadding();gutterWidth+=padding.left+padding.right;if(gutterWidth!==this.gutterWidth&&!isNaN(gutterWidth)){this.gutterWidth=gutterWidth;this.element.style.width=Math.ceil(this.gutterWidth)+"px";this._emit("changeGutterWidth",gutterWidth);}};this.$fixedWidth=false;this.$showLineNumbers=true;this.$renderer="";this.setShowLineNumbers=function(show){this.$renderer=!show&&{getWidth:function(){return"";},getText:function(){return"";}};};this.getShowLineNumbers=function(){return this.$showLineNumbers;};this.$showFoldWidgets=true;this.setShowFoldWidgets=function(show){if(show)
dom.addCssClass(this.element,"ace_folding-enabled");else
dom.removeCssClass(this.element,"ace_folding-enabled");this.$showFoldWidgets=show;this.$padding=null;};this.getShowFoldWidgets=function(){return this.$showFoldWidgets;};this.$computePadding=function(){if(!this.element.firstChild)
return{left:0,right:0};var style=dom.computedStyle(this.element.firstChild);this.$padding={};this.$padding.left=parseInt(style.paddingLeft)+1||0;this.$padding.right=parseInt(style.paddingRight)||0;return this.$padding;};this.getRegion=function(point){var padding=this.$padding||this.$computePadding();var rect=this.element.getBoundingClientRect();if(point.x<padding.left+rect.left)
return"markers";if(this.$showFoldWidgets&&point.x>rect.right-padding.right)
return"foldWidgets";};}).call(Gutter.prototype);exports.Gutter=Gutter;});define("ace/layer/marker",["require","exports","module","ace/range","ace/lib/dom"],function(require,exports,module){"use strict";var Range=require("../range").Range;var dom=require("../lib/dom");var Marker=function(parentEl){this.element=dom.createElement("div");this.element.className="ace_layer ace_marker-layer";parentEl.appendChild(this.element);};(function(){this.$padding=0;this.setPadding=function(padding){this.$padding=padding;};this.setSession=function(session){this.session=session;};this.setMarkers=function(markers){this.markers=markers;};this.update=function(config){if(!config)return;this.config=config;var html=[];for(var key in this.markers){var marker=this.markers[key];if(!marker.range){marker.update(html,this,this.session,config);continue;}
var range=marker.range.clipRows(config.firstRow,config.lastRow);if(range.isEmpty())continue;range=range.toScreenRange(this.session);if(marker.renderer){var top=this.$getTop(range.start.row,config);var left=this.$padding+(this.session.$bidiHandler.isBidiRow(range.start.row)?this.session.$bidiHandler.getPosLeft(range.start.column):range.start.column*config.characterWidth);marker.renderer(html,range,left,top,config);}else if(marker.type=="fullLine"){this.drawFullLineMarker(html,range,marker.clazz,config);}else if(marker.type=="screenLine"){this.drawScreenLineMarker(html,range,marker.clazz,config);}else if(range.isMultiLine()){if(marker.type=="text")
this.drawTextMarker(html,range,marker.clazz,config);else
this.drawMultiLineMarker(html,range,marker.clazz,config);}else{if(this.session.$bidiHandler.isBidiRow(range.start.row)){this.drawBidiSingleLineMarker(html,range,marker.clazz+" ace_start"+" ace_br15",config);}else{this.drawSingleLineMarker(html,range,marker.clazz+" ace_start"+" ace_br15",config);}}}
this.element.innerHTML=html.join("");};this.$getTop=function(row,layerConfig){return(row-layerConfig.firstRowScreen)*layerConfig.lineHeight;};function getBorderClass(tl,tr,br,bl){return(tl?1:0)|(tr?2:0)|(br?4:0)|(bl?8:0);}
this.drawTextMarker=function(stringBuilder,range,clazz,layerConfig,extraStyle){var session=this.session;var start=range.start.row;var end=range.end.row;var row=start;var prev=0;var curr=0;var next=session.getScreenLastRowColumn(row);var clazzModified=null;var lineRange=new Range(row,range.start.column,row,curr);for(;row<=end;row++){lineRange.start.row=lineRange.end.row=row;lineRange.start.column=row==start?range.start.column:session.getRowWrapIndent(row);lineRange.end.column=next;prev=curr;curr=next;next=row+1<end?session.getScreenLastRowColumn(row+1):row==end?0:range.end.column;clazzModified=clazz+(row==start?" ace_start":"")+" ace_br"
+getBorderClass(row==start||row==start+1&&range.start.column,prev<curr,curr>next,row==end);if(this.session.$bidiHandler.isBidiRow(row)){this.drawBidiSingleLineMarker(stringBuilder,lineRange,clazzModified,layerConfig,row==end?0:1,extraStyle);}else{this.drawSingleLineMarker(stringBuilder,lineRange,clazzModified,layerConfig,row==end?0:1,extraStyle);}}};this.drawMultiLineMarker=function(stringBuilder,range,clazz,config,extraStyle){var padding=this.$padding;var height,top,left;extraStyle=extraStyle||"";if(this.session.$bidiHandler.isBidiRow(range.start.row)){var range1=range.clone();range1.end.row=range1.start.row;range1.end.column=this.session.getLine(range1.start.row).length;this.drawBidiSingleLineMarker(stringBuilder,range1,clazz+" ace_br1 ace_start",config,null,extraStyle);}else{height=config.lineHeight;top=this.$getTop(range.start.row,config);left=padding+range.start.column*config.characterWidth;stringBuilder.push("<div class='",clazz," ace_br1 ace_start' style='","height:",height,"px;","right:0;","top:",top,"px;","left:",left,"px;",extraStyle,"'></div>");}
if(this.session.$bidiHandler.isBidiRow(range.end.row)){var range1=range.clone();range1.start.row=range1.end.row;range1.start.column=0;this.drawBidiSingleLineMarker(stringBuilder,range1,clazz+" ace_br12",config,null,extraStyle);}else{var width=range.end.column*config.characterWidth;height=config.lineHeight;top=this.$getTop(range.end.row,config);stringBuilder.push("<div class='",clazz," ace_br12' style='","height:",height,"px;","width:",width,"px;","top:",top,"px;","left:",padding,"px;",extraStyle,"'></div>");}
height=(range.end.row-range.start.row-1)*config.lineHeight;if(height<=0)
return;top=this.$getTop(range.start.row+1,config);var radiusClass=(range.start.column?1:0)|(range.end.column?0:8);stringBuilder.push("<div class='",clazz,(radiusClass?" ace_br"+radiusClass:""),"' style='","height:",height,"px;","right:0;","top:",top,"px;","left:",padding,"px;",extraStyle,"'></div>");};this.drawSingleLineMarker=function(stringBuilder,range,clazz,config,extraLength,extraStyle){var height=config.lineHeight;var width=(range.end.column+(extraLength||0)-range.start.column)*config.characterWidth;var top=this.$getTop(range.start.row,config);var left=this.$padding+range.start.column*config.characterWidth;stringBuilder.push("<div class='",clazz,"' style='","height:",height,"px;","width:",width,"px;","top:",top,"px;","left:",left,"px;",extraStyle||"","'></div>");};this.drawBidiSingleLineMarker=function(stringBuilder,range,clazz,config,extraLength,extraStyle){var height=config.lineHeight,top=this.$getTop(range.start.row,config),padding=this.$padding;var selections=this.session.$bidiHandler.getSelections(range.start.column,range.end.column);selections.forEach(function(selection){stringBuilder.push("<div class='",clazz,"' style='","height:",height,"px;","width:",selection.width+(extraLength||0),"px;","top:",top,"px;","left:",padding+selection.left,"px;",extraStyle||"","'></div>");});};this.drawFullLineMarker=function(stringBuilder,range,clazz,config,extraStyle){var top=this.$getTop(range.start.row,config);var height=config.lineHeight;if(range.start.row!=range.end.row)
height+=this.$getTop(range.end.row,config)-top;stringBuilder.push("<div class='",clazz,"' style='","height:",height,"px;","top:",top,"px;","left:0;right:0;",extraStyle||"","'></div>");};this.drawScreenLineMarker=function(stringBuilder,range,clazz,config,extraStyle){var top=this.$getTop(range.start.row,config);var height=config.lineHeight;stringBuilder.push("<div class='",clazz,"' style='","height:",height,"px;","top:",top,"px;","left:0;right:0;",extraStyle||"","'></div>");};}).call(Marker.prototype);exports.Marker=Marker;});define("ace/layer/text",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/lib/lang","ace/lib/useragent","ace/lib/event_emitter"],function(require,exports,module){"use strict";var oop=require("../lib/oop");var dom=require("../lib/dom");var lang=require("../lib/lang");var useragent=require("../lib/useragent");var EventEmitter=require("../lib/event_emitter").EventEmitter;var Text=function(parentEl){this.element=dom.createElement("div");this.element.className="ace_layer ace_text-layer";parentEl.appendChild(this.element);this.$updateEolChar=this.$updateEolChar.bind(this);};(function(){oop.implement(this,EventEmitter);this.EOF_CHAR="\xB6";this.EOL_CHAR_LF="\xAC";this.EOL_CHAR_CRLF="\xa4";this.EOL_CHAR=this.EOL_CHAR_LF;this.TAB_CHAR="\u2014";this.SPACE_CHAR="\xB7";this.$padding=0;this.MAX_LINE_LENGTH=10000;this.$updateEolChar=function(){var EOL_CHAR=this.session.doc.getNewLineCharacter()=="\n"?this.EOL_CHAR_LF:this.EOL_CHAR_CRLF;if(this.EOL_CHAR!=EOL_CHAR){this.EOL_CHAR=EOL_CHAR;return true;}};this.setPadding=function(padding){this.$padding=padding;this.element.style.padding="0 "+padding+"px";};this.getLineHeight=function(){return this.$fontMetrics.$characterSize.height||0;};this.getCharacterWidth=function(){return this.$fontMetrics.$characterSize.width||0;};this.$setFontMetrics=function(measure){this.$fontMetrics=measure;this.$fontMetrics.on("changeCharacterSize",function(e){this._signal("changeCharacterSize",e);}.bind(this));this.$pollSizeChanges();};this.checkForSizeChanges=function(){this.$fontMetrics.checkForSizeChanges();};this.$pollSizeChanges=function(){return this.$pollSizeChangesTimer=this.$fontMetrics.$pollSizeChanges();};this.setSession=function(session){this.session=session;if(session)
this.$computeTabString();};this.showInvisibles=false;this.setShowInvisibles=function(showInvisibles){if(this.showInvisibles==showInvisibles)
return false;this.showInvisibles=showInvisibles;this.$computeTabString();return true;};this.displayIndentGuides=true;this.setDisplayIndentGuides=function(display){if(this.displayIndentGuides==display)
return false;this.displayIndentGuides=display;this.$computeTabString();return true;};this.$tabStrings=[];this.onChangeTabSize=this.$computeTabString=function(){var tabSize=this.session.getTabSize();this.tabSize=tabSize;var tabStr=this.$tabStrings=[0];for(var i=1;i<tabSize+1;i++){if(this.showInvisibles){tabStr.push("<span class='ace_invisible ace_invisible_tab'>"
+lang.stringRepeat(this.TAB_CHAR,i)
+"</span>");}else{tabStr.push(lang.stringRepeat(" ",i));}}
if(this.displayIndentGuides){this.$indentGuideRe=/\s\S| \t|\t |\s$/;var className="ace_indent-guide";var spaceClass="";var tabClass="";if(this.showInvisibles){className+=" ace_invisible";spaceClass=" ace_invisible_space";tabClass=" ace_invisible_tab";var spaceContent=lang.stringRepeat(this.SPACE_CHAR,this.tabSize);var tabContent=lang.stringRepeat(this.TAB_CHAR,this.tabSize);}else{var spaceContent=lang.stringRepeat(" ",this.tabSize);var tabContent=spaceContent;}
this.$tabStrings[" "]="<span class='"+className+spaceClass+"'>"+spaceContent+"</span>";this.$tabStrings["\t"]="<span class='"+className+tabClass+"'>"+tabContent+"</span>";}};this.updateLines=function(config,firstRow,lastRow){if(this.config.lastRow!=config.lastRow||this.config.firstRow!=config.firstRow){this.scrollLines(config);}
this.config=config;var first=Math.max(firstRow,config.firstRow);var last=Math.min(lastRow,config.lastRow);var lineElements=this.element.childNodes;var lineElementsIdx=0;for(var row=config.firstRow;row<first;row++){var foldLine=this.session.getFoldLine(row);if(foldLine){if(foldLine.containsRow(first)){first=foldLine.start.row;break;}else{row=foldLine.end.row;}}
lineElementsIdx++;}
var row=first;var foldLine=this.session.getNextFoldLine(row);var foldStart=foldLine?foldLine.start.row:Infinity;while(true){if(row>foldStart){row=foldLine.end.row+1;foldLine=this.session.getNextFoldLine(row,foldLine);foldStart=foldLine?foldLine.start.row:Infinity;}
if(row>last)
break;var lineElement=lineElements[lineElementsIdx++];if(lineElement){var html=[];this.$renderLine(html,row,!this.$useLineGroups(),row==foldStart?foldLine:false);lineElement.style.height=config.lineHeight*this.session.getRowLength(row)+"px";lineElement.innerHTML=html.join("");}
row++;}};this.scrollLines=function(config){var oldConfig=this.config;this.config=config;if(!oldConfig||oldConfig.lastRow<config.firstRow)
return this.update(config);if(config.lastRow<oldConfig.firstRow)
return this.update(config);var el=this.element;if(oldConfig.firstRow<config.firstRow)
for(var row=this.session.getFoldedRowCount(oldConfig.firstRow,config.firstRow-1);row>0;row--)
el.removeChild(el.firstChild);if(oldConfig.lastRow>config.lastRow)
for(var row=this.session.getFoldedRowCount(config.lastRow+1,oldConfig.lastRow);row>0;row--)
el.removeChild(el.lastChild);if(config.firstRow<oldConfig.firstRow){var fragment=this.$renderLinesFragment(config,config.firstRow,oldConfig.firstRow-1);if(el.firstChild)
el.insertBefore(fragment,el.firstChild);else
el.appendChild(fragment);}
if(config.lastRow>oldConfig.lastRow){var fragment=this.$renderLinesFragment(config,oldConfig.lastRow+1,config.lastRow);el.appendChild(fragment);}};this.$renderLinesFragment=function(config,firstRow,lastRow){var fragment=this.element.ownerDocument.createDocumentFragment();var row=firstRow;var foldLine=this.session.getNextFoldLine(row);var foldStart=foldLine?foldLine.start.row:Infinity;while(true){if(row>foldStart){row=foldLine.end.row+1;foldLine=this.session.getNextFoldLine(row,foldLine);foldStart=foldLine?foldLine.start.row:Infinity;}
if(row>lastRow)
break;var container=dom.createElement("div");var html=[];this.$renderLine(html,row,false,row==foldStart?foldLine:false);container.innerHTML=html.join("");if(this.$useLineGroups()){container.className='ace_line_group';fragment.appendChild(container);container.style.height=config.lineHeight*this.session.getRowLength(row)+"px";}else{while(container.firstChild)
fragment.appendChild(container.firstChild);}
row++;}
return fragment;};this.update=function(config){this.config=config;var html=[];var firstRow=config.firstRow,lastRow=config.lastRow;var row=firstRow;var foldLine=this.session.getNextFoldLine(row);var foldStart=foldLine?foldLine.start.row:Infinity;while(true){if(row>foldStart){row=foldLine.end.row+1;foldLine=this.session.getNextFoldLine(row,foldLine);foldStart=foldLine?foldLine.start.row:Infinity;}
if(row>lastRow)
break;if(this.$useLineGroups())
html.push("<div class='ace_line_group' style='height:",config.lineHeight*this.session.getRowLength(row),"px'>");this.$renderLine(html,row,false,row==foldStart?foldLine:false);if(this.$useLineGroups())
html.push("</div>");row++;}
this.element.innerHTML=html.join("");};this.$textToken={"text":true,"rparen":true,"lparen":true};this.$renderToken=function(stringBuilder,screenColumn,token,value){var self=this;var replaceReg=/\t|&|<|>|( +)|([\x00-\x1f\x80-\xa0\xad\u1680\u180E\u2000-\u200f\u2028\u2029\u202F\u205F\u3000\uFEFF\uFFF9-\uFFFC])|[\u1100-\u115F\u11A3-\u11A7\u11FA-\u11FF\u2329-\u232A\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3000-\u303E\u3041-\u3096\u3099-\u30FF\u3105-\u312D\u3131-\u318E\u3190-\u31BA\u31C0-\u31E3\u31F0-\u321E\u3220-\u3247\u3250-\u32FE\u3300-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFAFF\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFF01-\uFF60\uFFE0-\uFFE6]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g;var replaceFunc=function(c,a,b,tabIdx,idx4){if(a){return self.showInvisibles?"<span class='ace_invisible ace_invisible_space'>"+lang.stringRepeat(self.SPACE_CHAR,c.length)+"</span>":c;}else if(c=="&"){return"&#38;";}else if(c=="<"){return"&#60;";}else if(c==">"){return"&#62;";}else if(c=="\t"){var tabSize=self.session.getScreenTabSize(screenColumn+tabIdx);screenColumn+=tabSize-1;return self.$tabStrings[tabSize];}else if(c=="\u3000"){var classToUse=self.showInvisibles?"ace_cjk ace_invisible ace_invisible_space":"ace_cjk";var space=self.showInvisibles?self.SPACE_CHAR:"";screenColumn+=1;return"<span class='"+classToUse+"' style='width:"+
(self.config.characterWidth*2)+"px'>"+space+"</span>";}else if(b){return"<span class='ace_invisible ace_invisible_space ace_invalid'>"+self.SPACE_CHAR+"</span>";}else{screenColumn+=1;return"<span class='ace_cjk' style='width:"+
(self.config.characterWidth*2)+"px'>"+c+"</span>";}};var output=value.replace(replaceReg,replaceFunc);if(!this.$textToken[token.type]){var classes="ace_"+token.type.replace(/\./g," ace_");var style="";if(token.type=="fold")
style=" style='width:"+(token.value.length*this.config.characterWidth)+"px;' ";stringBuilder.push("<span class='",classes,"'",style,">",output,"</span>");}
else{stringBuilder.push(output);}
return screenColumn+value.length;};this.renderIndentGuide=function(stringBuilder,value,max){var cols=value.search(this.$indentGuideRe);if(cols<=0||cols>=max)
return value;if(value[0]==" "){cols-=cols%this.tabSize;stringBuilder.push(lang.stringRepeat(this.$tabStrings[" "],cols/this.tabSize));return value.substr(cols);}else if(value[0]=="\t"){stringBuilder.push(lang.stringRepeat(this.$tabStrings["\t"],cols));return value.substr(cols);}
return value;};this.$renderWrappedLine=function(stringBuilder,tokens,splits,onlyContents){var chars=0;var split=0;var splitChars=splits[0];var screenColumn=0;for(var i=0;i<tokens.length;i++){var token=tokens[i];var value=token.value;if(i==0&&this.displayIndentGuides){chars=value.length;value=this.renderIndentGuide(stringBuilder,value,splitChars);if(!value)
continue;chars-=value.length;}
if(chars+value.length<splitChars){screenColumn=this.$renderToken(stringBuilder,screenColumn,token,value);chars+=value.length;}else{while(chars+value.length>=splitChars){screenColumn=this.$renderToken(stringBuilder,screenColumn,token,value.substring(0,splitChars-chars));value=value.substring(splitChars-chars);chars=splitChars;if(!onlyContents){stringBuilder.push("</div>","<div class='ace_line' style='height:",this.config.lineHeight,"px'>");}
stringBuilder.push(lang.stringRepeat("\xa0",splits.indent));split++;screenColumn=0;splitChars=splits[split]||Number.MAX_VALUE;}
if(value.length!=0){chars+=value.length;screenColumn=this.$renderToken(stringBuilder,screenColumn,token,value);}}}};this.$renderSimpleLine=function(stringBuilder,tokens){var screenColumn=0;var token=tokens[0];var value=token.value;if(this.displayIndentGuides)
value=this.renderIndentGuide(stringBuilder,value);if(value)
screenColumn=this.$renderToken(stringBuilder,screenColumn,token,value);for(var i=1;i<tokens.length;i++){token=tokens[i];value=token.value;if(screenColumn+value.length>this.MAX_LINE_LENGTH)
return this.$renderOverflowMessage(stringBuilder,screenColumn,token,value);screenColumn=this.$renderToken(stringBuilder,screenColumn,token,value);}};this.$renderOverflowMessage=function(stringBuilder,screenColumn,token,value){this.$renderToken(stringBuilder,screenColumn,token,value.slice(0,this.MAX_LINE_LENGTH-screenColumn));stringBuilder.push("<span style='position:absolute;right:0' class='ace_inline_button ace_keyword ace_toggle_wrap'>&lt;click to see more...&gt;</span>");};this.$renderLine=function(stringBuilder,row,onlyContents,foldLine){if(!foldLine&&foldLine!=false)
foldLine=this.session.getFoldLine(row);if(foldLine)
var tokens=this.$getFoldLineTokens(row,foldLine);else
var tokens=this.session.getTokens(row);if(!onlyContents){stringBuilder.push("<div class='ace_line' style='height:",this.config.lineHeight*(this.$useLineGroups()?1:this.session.getRowLength(row)),"px'>");}
if(tokens.length){var splits=this.session.getRowSplitData(row);if(splits&&splits.length)
this.$renderWrappedLine(stringBuilder,tokens,splits,onlyContents);else
this.$renderSimpleLine(stringBuilder,tokens);}
if(this.showInvisibles){if(foldLine)
row=foldLine.end.row;stringBuilder.push("<span class='ace_invisible ace_invisible_eol'>",row==this.session.getLength()-1?this.EOF_CHAR:this.EOL_CHAR,"</span>");}
if(!onlyContents)
stringBuilder.push("</div>");};this.$getFoldLineTokens=function(row,foldLine){var session=this.session;var renderTokens=[];function addTokens(tokens,from,to){var idx=0,col=0;while((col+tokens[idx].value.length)<from){col+=tokens[idx].value.length;idx++;if(idx==tokens.length)
return;}
if(col!=from){var value=tokens[idx].value.substring(from-col);if(value.length>(to-from))
value=value.substring(0,to-from);renderTokens.push({type:tokens[idx].type,value:value});col=from+value.length;idx+=1;}
while(col<to&&idx<tokens.length){var value=tokens[idx].value;if(value.length+col>to){renderTokens.push({type:tokens[idx].type,value:value.substring(0,to-col)});}else
renderTokens.push(tokens[idx]);col+=value.length;idx+=1;}}
var tokens=session.getTokens(row);foldLine.walk(function(placeholder,row,column,lastColumn,isNewRow){if(placeholder!=null){renderTokens.push({type:"fold",value:placeholder});}else{if(isNewRow)
tokens=session.getTokens(row);if(tokens.length)
addTokens(tokens,lastColumn,column);}},foldLine.end.row,this.session.getLine(foldLine.end.row).length);return renderTokens;};this.$useLineGroups=function(){return this.session.getUseWrapMode();};this.destroy=function(){clearInterval(this.$pollSizeChangesTimer);if(this.$measureNode)
this.$measureNode.parentNode.removeChild(this.$measureNode);delete this.$measureNode;};}).call(Text.prototype);exports.Text=Text;});define("ace/layer/cursor",["require","exports","module","ace/lib/dom"],function(require,exports,module){"use strict";var dom=require("../lib/dom");var isIE8;var Cursor=function(parentEl){this.element=dom.createElement("div");this.element.className="ace_layer ace_cursor-layer";parentEl.appendChild(this.element);if(isIE8===undefined)
isIE8=!("opacity"in this.element.style);this.isVisible=false;this.isBlinking=true;this.blinkInterval=1000;this.smoothBlinking=false;this.cursors=[];this.cursor=this.addCursor();dom.addCssClass(this.element,"ace_hidden-cursors");this.$updateCursors=(isIE8?this.$updateVisibility:this.$updateOpacity).bind(this);};(function(){this.$updateVisibility=function(val){var cursors=this.cursors;for(var i=cursors.length;i--;)
cursors[i].style.visibility=val?"":"hidden";};this.$updateOpacity=function(val){var cursors=this.cursors;for(var i=cursors.length;i--;)
cursors[i].style.opacity=val?"":"0";};this.$padding=0;this.setPadding=function(padding){this.$padding=padding;};this.setSession=function(session){this.session=session;};this.setBlinking=function(blinking){if(blinking!=this.isBlinking){this.isBlinking=blinking;this.restartTimer();}};this.setBlinkInterval=function(blinkInterval){if(blinkInterval!=this.blinkInterval){this.blinkInterval=blinkInterval;this.restartTimer();}};this.setSmoothBlinking=function(smoothBlinking){if(smoothBlinking!=this.smoothBlinking&&!isIE8){this.smoothBlinking=smoothBlinking;dom.setCssClass(this.element,"ace_smooth-blinking",smoothBlinking);this.$updateCursors(true);this.$updateCursors=(this.$updateOpacity).bind(this);this.restartTimer();}};this.addCursor=function(){var el=dom.createElement("div");el.className="ace_cursor";this.element.appendChild(el);this.cursors.push(el);return el;};this.removeCursor=function(){if(this.cursors.length>1){var el=this.cursors.pop();el.parentNode.removeChild(el);return el;}};this.hideCursor=function(){this.isVisible=false;dom.addCssClass(this.element,"ace_hidden-cursors");this.restartTimer();};this.showCursor=function(){this.isVisible=true;dom.removeCssClass(this.element,"ace_hidden-cursors");this.restartTimer();};this.restartTimer=function(){var update=this.$updateCursors;clearInterval(this.intervalId);clearTimeout(this.timeoutId);if(this.smoothBlinking){dom.removeCssClass(this.element,"ace_smooth-blinking");}
update(true);if(!this.isBlinking||!this.blinkInterval||!this.isVisible)
return;if(this.smoothBlinking){setTimeout(function(){dom.addCssClass(this.element,"ace_smooth-blinking");}.bind(this));}
var blink=function(){this.timeoutId=setTimeout(function(){update(false);},0.6*this.blinkInterval);}.bind(this);this.intervalId=setInterval(function(){update(true);blink();},this.blinkInterval);blink();};this.getPixelPosition=function(position,onScreen){if(!this.config||!this.session)
return{left:0,top:0};if(!position)
position=this.session.selection.getCursor();var pos=this.session.documentToScreenPosition(position);var cursorLeft=this.$padding+(this.session.$bidiHandler.isBidiRow(pos.row,position.row)?this.session.$bidiHandler.getPosLeft(pos.column):pos.column*this.config.characterWidth);var cursorTop=(pos.row-(onScreen?this.config.firstRowScreen:0))*this.config.lineHeight;return{left:cursorLeft,top:cursorTop};};this.update=function(config){this.config=config;var selections=this.session.$selectionMarkers;var i=0,cursorIndex=0;if(selections===undefined||selections.length===0){selections=[{cursor:null}];}
for(var i=0,n=selections.length;i<n;i++){var pixelPos=this.getPixelPosition(selections[i].cursor,true);if((pixelPos.top>config.height+config.offset||pixelPos.top<0)&&i>1){continue;}
var style=(this.cursors[cursorIndex++]||this.addCursor()).style;if(!this.drawCursor){style.left=pixelPos.left+"px";style.top=pixelPos.top+"px";style.width=config.characterWidth+"px";style.height=config.lineHeight+"px";}else{this.drawCursor(style,pixelPos,config,selections[i],this.session);}}
while(this.cursors.length>cursorIndex)
this.removeCursor();var overwrite=this.session.getOverwrite();this.$setOverwrite(overwrite);this.$pixelPos=pixelPos;this.restartTimer();};this.drawCursor=null;this.$setOverwrite=function(overwrite){if(overwrite!=this.overwrite){this.overwrite=overwrite;if(overwrite)
dom.addCssClass(this.element,"ace_overwrite-cursors");else
dom.removeCssClass(this.element,"ace_overwrite-cursors");}};this.destroy=function(){clearInterval(this.intervalId);clearTimeout(this.timeoutId);};}).call(Cursor.prototype);exports.Cursor=Cursor;});define("ace/scrollbar",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/lib/event","ace/lib/event_emitter"],function(require,exports,module){"use strict";var oop=require("./lib/oop");var dom=require("./lib/dom");var event=require("./lib/event");var EventEmitter=require("./lib/event_emitter").EventEmitter;var MAX_SCROLL_H=0x8000;var ScrollBar=function(parent){this.element=dom.createElement("div");this.element.className="ace_scrollbar ace_scrollbar"+this.classSuffix;this.inner=dom.createElement("div");this.inner.className="ace_scrollbar-inner";this.element.appendChild(this.inner);parent.appendChild(this.element);this.setVisible(false);this.skipEvent=false;event.addListener(this.element,"scroll",this.onScroll.bind(this));event.addListener(this.element,"mousedown",event.preventDefault);};(function(){oop.implement(this,EventEmitter);this.setVisible=function(isVisible){this.element.style.display=isVisible?"":"none";this.isVisible=isVisible;this.coeff=1;};}).call(ScrollBar.prototype);var VScrollBar=function(parent,renderer){ScrollBar.call(this,parent);this.scrollTop=0;this.scrollHeight=0;renderer.$scrollbarWidth=this.width=dom.scrollbarWidth(parent.ownerDocument);this.inner.style.width=this.element.style.width=(this.width||15)+5+"px";this.$minWidth=0;};oop.inherits(VScrollBar,ScrollBar);(function(){this.classSuffix='-v';this.onScroll=function(){if(!this.skipEvent){this.scrollTop=this.element.scrollTop;if(this.coeff!=1){var h=this.element.clientHeight/this.scrollHeight;this.scrollTop=this.scrollTop*(1-h)/(this.coeff-h);}
this._emit("scroll",{data:this.scrollTop});}
this.skipEvent=false;};this.getWidth=function(){return Math.max(this.isVisible?this.width:0,this.$minWidth||0);};this.setHeight=function(height){this.element.style.height=height+"px";};this.setInnerHeight=this.setScrollHeight=function(height){this.scrollHeight=height;if(height>MAX_SCROLL_H){this.coeff=MAX_SCROLL_H/height;height=MAX_SCROLL_H;}else if(this.coeff!=1){this.coeff=1;}
this.inner.style.height=height+"px";};this.setScrollTop=function(scrollTop){if(this.scrollTop!=scrollTop){this.skipEvent=true;this.scrollTop=scrollTop;this.element.scrollTop=scrollTop*this.coeff;}};}).call(VScrollBar.prototype);var HScrollBar=function(parent,renderer){ScrollBar.call(this,parent);this.scrollLeft=0;this.height=renderer.$scrollbarWidth;this.inner.style.height=this.element.style.height=(this.height||15)+5+"px";};oop.inherits(HScrollBar,ScrollBar);(function(){this.classSuffix='-h';this.onScroll=function(){if(!this.skipEvent){this.scrollLeft=this.element.scrollLeft;this._emit("scroll",{data:this.scrollLeft});}
this.skipEvent=false;};this.getHeight=function(){return this.isVisible?this.height:0;};this.setWidth=function(width){this.element.style.width=width+"px";};this.setInnerWidth=function(width){this.inner.style.width=width+"px";};this.setScrollWidth=function(width){this.inner.style.width=width+"px";};this.setScrollLeft=function(scrollLeft){if(this.scrollLeft!=scrollLeft){this.skipEvent=true;this.scrollLeft=this.element.scrollLeft=scrollLeft;}};}).call(HScrollBar.prototype);exports.ScrollBar=VScrollBar;exports.ScrollBarV=VScrollBar;exports.ScrollBarH=HScrollBar;exports.VScrollBar=VScrollBar;exports.HScrollBar=HScrollBar;});define("ace/renderloop",["require","exports","module","ace/lib/event"],function(require,exports,module){"use strict";var event=require("./lib/event");var RenderLoop=function(onRender,win){this.onRender=onRender;this.pending=false;this.changes=0;this.window=win||window;};(function(){this.schedule=function(change){this.changes=this.changes|change;if(!this.pending&&this.changes){this.pending=true;var _self=this;event.nextFrame(function(){_self.pending=false;var changes;while(changes=_self.changes){_self.changes=0;_self.onRender(changes);}},this.window);}};}).call(RenderLoop.prototype);exports.RenderLoop=RenderLoop;});define("ace/layer/font_metrics",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/lib/lang","ace/lib/useragent","ace/lib/event_emitter"],function(require,exports,module){var oop=require("../lib/oop");var dom=require("../lib/dom");var lang=require("../lib/lang");var useragent=require("../lib/useragent");var EventEmitter=require("../lib/event_emitter").EventEmitter;var CHAR_COUNT=256;var USE_OBSERVER=typeof ResizeObserver=="function";var FontMetrics=exports.FontMetrics=function(parentEl){this.el=dom.createElement("div");this.$setMeasureNodeStyles(this.el.style,true);this.$main=dom.createElement("div");this.$setMeasureNodeStyles(this.$main.style);this.$measureNode=dom.createElement("div");this.$setMeasureNodeStyles(this.$measureNode.style);this.el.appendChild(this.$main);this.el.appendChild(this.$measureNode);parentEl.appendChild(this.el);this.$measureNode.innerHTML=lang.stringRepeat("X",CHAR_COUNT);this.$characterSize={width:0,height:0};if(USE_OBSERVER)
this.$addObserver();else
this.checkForSizeChanges();};(function(){oop.implement(this,EventEmitter);this.$characterSize={width:0,height:0};this.$setMeasureNodeStyles=function(style,isRoot){style.width=style.height="auto";style.left=style.top="0px";style.visibility="hidden";style.position="absolute";style.whiteSpace="pre";if(useragent.isIE<8){style["font-family"]="inherit";}else{style.font="inherit";}
style.overflow=isRoot?"hidden":"visible";};this.checkForSizeChanges=function(size){if(size===undefined)
size=this.$measureSizes();if(size&&(this.$characterSize.width!==size.width||this.$characterSize.height!==size.height)){this.$measureNode.style.fontWeight="bold";var boldSize=this.$measureSizes();this.$measureNode.style.fontWeight="";this.$characterSize=size;this.charSizes=Object.create(null);this.allowBoldFonts=boldSize&&boldSize.width===size.width&&boldSize.height===size.height;this._emit("changeCharacterSize",{data:size});}};this.$addObserver=function(){var self=this;this.$observer=new window.ResizeObserver(function(e){var rect=e[0].contentRect;self.checkForSizeChanges({height:rect.height,width:rect.width/CHAR_COUNT});});this.$observer.observe(this.$measureNode);};this.$pollSizeChanges=function(){if(this.$pollSizeChangesTimer||this.$observer)
return this.$pollSizeChangesTimer;var self=this;return this.$pollSizeChangesTimer=setInterval(function(){self.checkForSizeChanges();},500);};this.setPolling=function(val){if(val){this.$pollSizeChanges();}else if(this.$pollSizeChangesTimer){clearInterval(this.$pollSizeChangesTimer);this.$pollSizeChangesTimer=0;}};this.$measureSizes=function(node){var size={height:(node||this.$measureNode).clientHeight,width:(node||this.$measureNode).clientWidth/CHAR_COUNT};if(size.width===0||size.height===0)
return null;return size;};this.$measureCharWidth=function(ch){this.$main.innerHTML=lang.stringRepeat(ch,CHAR_COUNT);var rect=this.$main.getBoundingClientRect();return rect.width/CHAR_COUNT;};this.getCharacterWidth=function(ch){var w=this.charSizes[ch];if(w===undefined){w=this.charSizes[ch]=this.$measureCharWidth(ch)/this.$characterSize.width;}
return w;};this.destroy=function(){clearInterval(this.$pollSizeChangesTimer);if(this.el&&this.el.parentNode)
this.el.parentNode.removeChild(this.el);};}).call(FontMetrics.prototype);});define("ace/virtual_renderer",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/config","ace/lib/useragent","ace/layer/gutter","ace/layer/marker","ace/layer/text","ace/layer/cursor","ace/scrollbar","ace/scrollbar","ace/renderloop","ace/layer/font_metrics","ace/lib/event_emitter"],function(require,exports,module){"use strict";var oop=require("./lib/oop");var dom=require("./lib/dom");var config=require("./config");var useragent=require("./lib/useragent");var GutterLayer=require("./layer/gutter").Gutter;var MarkerLayer=require("./layer/marker").Marker;var TextLayer=require("./layer/text").Text;var CursorLayer=require("./layer/cursor").Cursor;var HScrollBar=require("./scrollbar").HScrollBar;var VScrollBar=require("./scrollbar").VScrollBar;var RenderLoop=require("./renderloop").RenderLoop;var FontMetrics=require("./layer/font_metrics").FontMetrics;var EventEmitter=require("./lib/event_emitter").EventEmitter;var editorCss=".ace_editor {\
position: relative;\
overflow: hidden;\
font: 12px/normal 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', 'source-code-pro', monospace;\
direction: ltr;\
text-align: left;\
-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\
}\
.ace_scroller {\
position: absolute;\
overflow: hidden;\
top: 0;\
bottom: 0;\
background-color: inherit;\
-ms-user-select: none;\
-moz-user-select: none;\
-webkit-user-select: none;\
user-select: none;\
cursor: text;\
}\
.ace_content {\
position: absolute;\
box-sizing: border-box;\
min-width: 100%;\
}\
.ace_dragging .ace_scroller:before{\
position: absolute;\
top: 0;\
left: 0;\
right: 0;\
bottom: 0;\
content: '';\
background: rgba(250, 250, 250, 0.01);\
z-index: 1000;\
}\
.ace_dragging.ace_dark .ace_scroller:before{\
background: rgba(0, 0, 0, 0.01);\
}\
.ace_selecting, .ace_selecting * {\
cursor: text !important;\
}\
.ace_gutter {\
position: absolute;\
overflow : hidden;\
width: auto;\
top: 0;\
bottom: 0;\
left: 0;\
cursor: default;\
z-index: 4;\
-ms-user-select: none;\
-moz-user-select: none;\
-webkit-user-select: none;\
user-select: none;\
}\
.ace_gutter-active-line {\
position: absolute;\
left: 0;\
right: 0;\
}\
.ace_scroller.ace_scroll-left {\
box-shadow: 17px 0 16px -16px rgba(0, 0, 0, 0.4) inset;\
}\
.ace_gutter-cell {\
padding-left: 19px;\
padding-right: 6px;\
background-repeat: no-repeat;\
}\
.ace_gutter-cell.ace_error {\
background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABOFBMVEX/////////QRswFAb/Ui4wFAYwFAYwFAaWGAfDRymzOSH/PxswFAb/SiUwFAYwFAbUPRvjQiDllog5HhHdRybsTi3/Tyv9Tir+Syj/UC3////XurebMBIwFAb/RSHbPx/gUzfdwL3kzMivKBAwFAbbvbnhPx66NhowFAYwFAaZJg8wFAaxKBDZurf/RB6mMxb/SCMwFAYwFAbxQB3+RB4wFAb/Qhy4Oh+4QifbNRcwFAYwFAYwFAb/QRzdNhgwFAYwFAbav7v/Uy7oaE68MBK5LxLewr/r2NXewLswFAaxJw4wFAbkPRy2PyYwFAaxKhLm1tMwFAazPiQwFAaUGAb/QBrfOx3bvrv/VC/maE4wFAbRPBq6MRO8Qynew8Dp2tjfwb0wFAbx6eju5+by6uns4uH9/f36+vr/GkHjAAAAYnRSTlMAGt+64rnWu/bo8eAA4InH3+DwoN7j4eLi4xP99Nfg4+b+/u9B/eDs1MD1mO7+4PHg2MXa347g7vDizMLN4eG+Pv7i5evs/v79yu7S3/DV7/498Yv24eH+4ufQ3Ozu/v7+y13sRqwAAADLSURBVHjaZc/XDsFgGIBhtDrshlitmk2IrbHFqL2pvXf/+78DPokj7+Fz9qpU/9UXJIlhmPaTaQ6QPaz0mm+5gwkgovcV6GZzd5JtCQwgsxoHOvJO15kleRLAnMgHFIESUEPmawB9ngmelTtipwwfASilxOLyiV5UVUyVAfbG0cCPHig+GBkzAENHS0AstVF6bacZIOzgLmxsHbt2OecNgJC83JERmePUYq8ARGkJx6XtFsdddBQgZE2nPR6CICZhawjA4Fb/chv+399kfR+MMMDGOQAAAABJRU5ErkJggg==\");\
background-repeat: no-repeat;\
background-position: 2px center;\
}\
.ace_gutter-cell.ace_warning {\
background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAmVBMVEX///8AAAD///8AAAAAAABPSzb/5sAAAAB/blH/73z/ulkAAAAAAAD85pkAAAAAAAACAgP/vGz/rkDerGbGrV7/pkQICAf////e0IsAAAD/oED/qTvhrnUAAAD/yHD/njcAAADuv2r/nz//oTj/p064oGf/zHAAAAA9Nir/tFIAAAD/tlTiuWf/tkIAAACynXEAAAAAAAAtIRW7zBpBAAAAM3RSTlMAABR1m7RXO8Ln31Z36zT+neXe5OzooRDfn+TZ4p3h2hTf4t3k3ucyrN1K5+Xaks52Sfs9CXgrAAAAjklEQVR42o3PbQ+CIBQFYEwboPhSYgoYunIqqLn6/z8uYdH8Vmdnu9vz4WwXgN/xTPRD2+sgOcZjsge/whXZgUaYYvT8QnuJaUrjrHUQreGczuEafQCO/SJTufTbroWsPgsllVhq3wJEk2jUSzX3CUEDJC84707djRc5MTAQxoLgupWRwW6UB5fS++NV8AbOZgnsC7BpEAAAAABJRU5ErkJggg==\");\
background-position: 2px center;\
}\
.ace_gutter-cell.ace_info {\
background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAJ0Uk5TAAB2k804AAAAPklEQVQY02NgIB68QuO3tiLznjAwpKTgNyDbMegwisCHZUETUZV0ZqOquBpXj2rtnpSJT1AEnnRmL2OgGgAAIKkRQap2htgAAAAASUVORK5CYII=\");\
background-position: 2px center;\
}\
.ace_dark .ace_gutter-cell.ace_info {\
background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAJFBMVEUAAAChoaGAgIAqKiq+vr6tra1ZWVmUlJSbm5s8PDxubm56enrdgzg3AAAAAXRSTlMAQObYZgAAAClJREFUeNpjYMAPdsMYHegyJZFQBlsUlMFVCWUYKkAZMxZAGdxlDMQBAG+TBP4B6RyJAAAAAElFTkSuQmCC\");\
}\
.ace_scrollbar {\
position: absolute;\
right: 0;\
bottom: 0;\
z-index: 6;\
}\
.ace_scrollbar-inner {\
position: absolute;\
cursor: text;\
left: 0;\
top: 0;\
}\
.ace_scrollbar-v{\
overflow-x: hidden;\
overflow-y: scroll;\
top: 0;\
}\
.ace_scrollbar-h {\
overflow-x: scroll;\
overflow-y: hidden;\
left: 0;\
}\
.ace_print-margin {\
position: absolute;\
height: 100%;\
}\
.ace_text-input {\
position: absolute;\
z-index: 0;\
width: 0.5em;\
height: 1em;\
opacity: 0;\
background: transparent;\
-moz-appearance: none;\
appearance: none;\
border: none;\
resize: none;\
outline: none;\
overflow: hidden;\
font: inherit;\
padding: 0 1px;\
margin: 0 -1px;\
text-indent: -1em;\
-ms-user-select: text;\
-moz-user-select: text;\
-webkit-user-select: text;\
user-select: text;\
white-space: pre!important;\
}\
.ace_text-input.ace_composition {\
background: inherit;\
color: inherit;\
z-index: 1000;\
opacity: 1;\
text-indent: 0;\
}\
[ace_nocontext=true] {\
transform: none!important;\
filter: none!important;\
perspective: none!important;\
clip-path: none!important;\
mask : none!important;\
contain: none!important;\
perspective: none!important;\
mix-blend-mode: initial!important;\
z-index: auto;\
}\
.ace_layer {\
z-index: 1;\
position: absolute;\
overflow: hidden;\
word-wrap: normal;\
white-space: pre;\
height: 100%;\
width: 100%;\
box-sizing: border-box;\
pointer-events: none;\
}\
.ace_gutter-layer {\
position: relative;\
width: auto;\
text-align: right;\
pointer-events: auto;\
}\
.ace_text-layer {\
font: inherit !important;\
}\
.ace_cjk {\
display: inline-block;\
text-align: center;\
}\
.ace_cursor-layer {\
z-index: 4;\
}\
.ace_cursor {\
z-index: 4;\
position: absolute;\
box-sizing: border-box;\
border-left: 2px solid;\
transform: translatez(0);\
}\
.ace_multiselect .ace_cursor {\
border-left-width: 1px;\
}\
.ace_slim-cursors .ace_cursor {\
border-left-width: 1px;\
}\
.ace_overwrite-cursors .ace_cursor {\
border-left-width: 0;\
border-bottom: 1px solid;\
}\
.ace_hidden-cursors .ace_cursor {\
opacity: 0.2;\
}\
.ace_smooth-blinking .ace_cursor {\
transition: opacity 0.18s;\
}\
.ace_marker-layer .ace_step, .ace_marker-layer .ace_stack {\
position: absolute;\
z-index: 3;\
}\
.ace_marker-layer .ace_selection {\
position: absolute;\
z-index: 5;\
}\
.ace_marker-layer .ace_bracket {\
position: absolute;\
z-index: 6;\
}\
.ace_marker-layer .ace_active-line {\
position: absolute;\
z-index: 2;\
}\
.ace_marker-layer .ace_selected-word {\
position: absolute;\
z-index: 4;\
box-sizing: border-box;\
}\
.ace_line .ace_fold {\
box-sizing: border-box;\
display: inline-block;\
height: 11px;\
margin-top: -2px;\
vertical-align: middle;\
background-image:\
url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII=\"),\
url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACJJREFUeNpi+P//fxgTAwPDBxDxD078RSX+YeEyDFMCIMAAI3INmXiwf2YAAAAASUVORK5CYII=\");\
background-repeat: no-repeat, repeat-x;\
background-position: center center, top left;\
color: transparent;\
border: 1px solid black;\
border-radius: 2px;\
cursor: pointer;\
pointer-events: auto;\
}\
.ace_dark .ace_fold {\
}\
.ace_fold:hover{\
background-image:\
url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII=\"),\
url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACBJREFUeNpi+P//fz4TAwPDZxDxD5X4i5fLMEwJgAADAEPVDbjNw87ZAAAAAElFTkSuQmCC\");\
}\
.ace_tooltip {\
background-color: #FFF;\
background-image: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.1));\
border: 1px solid gray;\
border-radius: 1px;\
box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);\
color: black;\
max-width: 100%;\
padding: 3px 4px;\
position: fixed;\
z-index: 999999;\
box-sizing: border-box;\
cursor: default;\
white-space: pre;\
word-wrap: break-word;\
line-height: normal;\
font-style: normal;\
font-weight: normal;\
letter-spacing: normal;\
pointer-events: none;\
}\
.ace_folding-enabled > .ace_gutter-cell {\
padding-right: 13px;\
}\
.ace_fold-widget {\
box-sizing: border-box;\
margin: 0 -12px 0 1px;\
display: none;\
width: 11px;\
vertical-align: top;\
background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42mWKsQ0AMAzC8ixLlrzQjzmBiEjp0A6WwBCSPgKAXoLkqSot7nN3yMwR7pZ32NzpKkVoDBUxKAAAAABJRU5ErkJggg==\");\
background-repeat: no-repeat;\
background-position: center;\
border-radius: 3px;\
border: 1px solid transparent;\
cursor: pointer;\
}\
.ace_folding-enabled .ace_fold-widget {\
display: inline-block;   \
}\
.ace_fold-widget.ace_end {\
background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42m3HwQkAMAhD0YzsRchFKI7sAikeWkrxwScEB0nh5e7KTPWimZki4tYfVbX+MNl4pyZXejUO1QAAAABJRU5ErkJggg==\");\
}\
.ace_fold-widget.ace_closed {\
background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAGCAYAAAAG5SQMAAAAOUlEQVR42jXKwQkAMAgDwKwqKD4EwQ26sSOkVWjgIIHAzPiCgaqiqnJHZnKICBERHN194O5b9vbLuAVRL+l0YWnZAAAAAElFTkSuQmCCXA==\");\
}\
.ace_fold-widget:hover {\
border: 1px solid rgba(0, 0, 0, 0.3);\
background-color: rgba(255, 255, 255, 0.2);\
box-shadow: 0 1px 1px rgba(255, 255, 255, 0.7);\
}\
.ace_fold-widget:active {\
border: 1px solid rgba(0, 0, 0, 0.4);\
background-color: rgba(0, 0, 0, 0.05);\
box-shadow: 0 1px 1px rgba(255, 255, 255, 0.8);\
}\
.ace_dark .ace_fold-widget {\
background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHklEQVQIW2P4//8/AzoGEQ7oGCaLLAhWiSwB146BAQCSTPYocqT0AAAAAElFTkSuQmCC\");\
}\
.ace_dark .ace_fold-widget.ace_end {\
background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAH0lEQVQIW2P4//8/AxQ7wNjIAjDMgC4AxjCVKBirIAAF0kz2rlhxpAAAAABJRU5ErkJggg==\");\
}\
.ace_dark .ace_fold-widget.ace_closed {\
background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAFCAYAAACAcVaiAAAAHElEQVQIW2P4//+/AxAzgDADlOOAznHAKgPWAwARji8UIDTfQQAAAABJRU5ErkJggg==\");\
}\
.ace_dark .ace_fold-widget:hover {\
box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);\
background-color: rgba(255, 255, 255, 0.1);\
}\
.ace_dark .ace_fold-widget:active {\
box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);\
}\
.ace_inline_button {\
border: 1px solid lightgray;\
display: inline-block;\
margin: -1px 8px;\
padding: 0 5px;\
pointer-events: auto;\
cursor: pointer;\
}\
.ace_inline_button:hover {\
border-color: gray;\
background: rgba(200,200,200,0.2);\
display: inline-block;\
pointer-events: auto;\
}\
.ace_fold-widget.ace_invalid {\
background-color: #FFB4B4;\
border-color: #DE5555;\
}\
.ace_fade-fold-widgets .ace_fold-widget {\
transition: opacity 0.4s ease 0.05s;\
opacity: 0;\
}\
.ace_fade-fold-widgets:hover .ace_fold-widget {\
transition: opacity 0.05s ease 0.05s;\
opacity:1;\
}\
.ace_underline {\
text-decoration: underline;\
}\
.ace_bold {\
font-weight: bold;\
}\
.ace_nobold .ace_bold {\
font-weight: normal;\
}\
.ace_italic {\
font-style: italic;\
}\
.ace_error-marker {\
background-color: rgba(255, 0, 0,0.2);\
position: absolute;\
z-index: 9;\
}\
.ace_highlight-marker {\
background-color: rgba(255, 255, 0,0.2);\
position: absolute;\
z-index: 8;\
}\
.ace_br1 {border-top-left-radius    : 3px;}\
.ace_br2 {border-top-right-radius   : 3px;}\
.ace_br3 {border-top-left-radius    : 3px; border-top-right-radius:    3px;}\
.ace_br4 {border-bottom-right-radius: 3px;}\
.ace_br5 {border-top-left-radius    : 3px; border-bottom-right-radius: 3px;}\
.ace_br6 {border-top-right-radius   : 3px; border-bottom-right-radius: 3px;}\
.ace_br7 {border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px;}\
.ace_br8 {border-bottom-left-radius : 3px;}\
.ace_br9 {border-top-left-radius    : 3px; border-bottom-left-radius:  3px;}\
.ace_br10{border-top-right-radius   : 3px; border-bottom-left-radius:  3px;}\
.ace_br11{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-left-radius:  3px;}\
.ace_br12{border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}\
.ace_br13{border-top-left-radius    : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}\
.ace_br14{border-top-right-radius   : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}\
.ace_br15{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px;}\
.ace_text-input-ios {\
position: absolute !important;\
top: -100000px !important;\
left: -100000px !important;\
}\
";dom.importCssString(editorCss,"ace_editor.css");var VirtualRenderer=function(container,theme){var _self=this;this.container=container||dom.createElement("div");dom.addCssClass(this.container,"ace_editor");this.setTheme(theme);this.$gutter=dom.createElement("div");this.$gutter.className="ace_gutter";this.container.appendChild(this.$gutter);this.$gutter.setAttribute("aria-hidden",true);this.scroller=dom.createElement("div");this.scroller.className="ace_scroller";this.container.appendChild(this.scroller);this.content=dom.createElement("div");this.content.className="ace_content";this.scroller.appendChild(this.content);this.$gutterLayer=new GutterLayer(this.$gutter);this.$gutterLayer.on("changeGutterWidth",this.onGutterResize.bind(this));this.$markerBack=new MarkerLayer(this.content);var textLayer=this.$textLayer=new TextLayer(this.content);this.canvas=textLayer.element;this.$markerFront=new MarkerLayer(this.content);this.$cursorLayer=new CursorLayer(this.content);this.$horizScroll=false;this.$vScroll=false;this.scrollBar=this.scrollBarV=new VScrollBar(this.container,this);this.scrollBarH=new HScrollBar(this.container,this);this.scrollBarV.addEventListener("scroll",function(e){if(!_self.$scrollAnimation)
_self.session.setScrollTop(e.data-_self.scrollMargin.top);});this.scrollBarH.addEventListener("scroll",function(e){if(!_self.$scrollAnimation)
_self.session.setScrollLeft(e.data-_self.scrollMargin.left);});this.scrollTop=0;this.scrollLeft=0;this.cursorPos={row:0,column:0};this.$fontMetrics=new FontMetrics(this.container);this.$textLayer.$setFontMetrics(this.$fontMetrics);this.$textLayer.addEventListener("changeCharacterSize",function(e){_self.updateCharacterSize();_self.onResize(true,_self.gutterWidth,_self.$size.width,_self.$size.height);_self._signal("changeCharacterSize",e);});this.$size={width:0,height:0,scrollerHeight:0,scrollerWidth:0,$dirty:true};this.layerConfig={width:1,padding:0,firstRow:0,firstRowScreen:0,lastRow:0,lineHeight:0,characterWidth:0,minHeight:1,maxHeight:1,offset:0,height:1,gutterOffset:1};this.scrollMargin={left:0,right:0,top:0,bottom:0,v:0,h:0};this.$loop=new RenderLoop(this.$renderChanges.bind(this),this.container.ownerDocument.defaultView);this.$loop.schedule(this.CHANGE_FULL);this.updateCharacterSize();this.setPadding(4);config.resetOptions(this);config._emit("renderer",this);};(function(){this.CHANGE_CURSOR=1;this.CHANGE_MARKER=2;this.CHANGE_GUTTER=4;this.CHANGE_SCROLL=8;this.CHANGE_LINES=16;this.CHANGE_TEXT=32;this.CHANGE_SIZE=64;this.CHANGE_MARKER_BACK=128;this.CHANGE_MARKER_FRONT=256;this.CHANGE_FULL=512;this.CHANGE_H_SCROLL=1024;oop.implement(this,EventEmitter);this.updateCharacterSize=function(){if(this.$textLayer.allowBoldFonts!=this.$allowBoldFonts){this.$allowBoldFonts=this.$textLayer.allowBoldFonts;this.setStyle("ace_nobold",!this.$allowBoldFonts);}
this.layerConfig.characterWidth=this.characterWidth=this.$textLayer.getCharacterWidth();this.layerConfig.lineHeight=this.lineHeight=this.$textLayer.getLineHeight();this.$updatePrintMargin();};this.setSession=function(session){if(this.session)
this.session.doc.off("changeNewLineMode",this.onChangeNewLineMode);this.session=session;if(session&&this.scrollMargin.top&&session.getScrollTop()<=0)
session.setScrollTop(-this.scrollMargin.top);this.$cursorLayer.setSession(session);this.$markerBack.setSession(session);this.$markerFront.setSession(session);this.$gutterLayer.setSession(session);this.$textLayer.setSession(session);if(!session)
return;this.$loop.schedule(this.CHANGE_FULL);this.session.$setFontMetrics(this.$fontMetrics);this.scrollBarH.scrollLeft=this.scrollBarV.scrollTop=null;this.onChangeNewLineMode=this.onChangeNewLineMode.bind(this);this.onChangeNewLineMode();this.session.doc.on("changeNewLineMode",this.onChangeNewLineMode);};this.updateLines=function(firstRow,lastRow,force){if(lastRow===undefined)
lastRow=Infinity;if(!this.$changedLines){this.$changedLines={firstRow:firstRow,lastRow:lastRow};}
else{if(this.$changedLines.firstRow>firstRow)
this.$changedLines.firstRow=firstRow;if(this.$changedLines.lastRow<lastRow)
this.$changedLines.lastRow=lastRow;}
if(this.$changedLines.lastRow<this.layerConfig.firstRow){if(force)
this.$changedLines.lastRow=this.layerConfig.lastRow;else
return;}
if(this.$changedLines.firstRow>this.layerConfig.lastRow)
return;this.$loop.schedule(this.CHANGE_LINES);};this.onChangeNewLineMode=function(){this.$loop.schedule(this.CHANGE_TEXT);this.$textLayer.$updateEolChar();this.session.$bidiHandler.setEolChar(this.$textLayer.EOL_CHAR);};this.onChangeTabSize=function(){this.$loop.schedule(this.CHANGE_TEXT|this.CHANGE_MARKER);this.$textLayer.onChangeTabSize();};this.updateText=function(){this.$loop.schedule(this.CHANGE_TEXT);};this.updateFull=function(force){if(force)
this.$renderChanges(this.CHANGE_FULL,true);else
this.$loop.schedule(this.CHANGE_FULL);};this.updateFontSize=function(){this.$textLayer.checkForSizeChanges();};this.$changes=0;this.$updateSizeAsync=function(){if(this.$loop.pending)
this.$size.$dirty=true;else
this.onResize();};this.onResize=function(force,gutterWidth,width,height){if(this.resizing>2)
return;else if(this.resizing>0)
this.resizing++;else
this.resizing=force?1:0;var el=this.container;if(!height)
height=el.clientHeight||el.scrollHeight;if(!width)
width=el.clientWidth||el.scrollWidth;var changes=this.$updateCachedSize(force,gutterWidth,width,height);if(!this.$size.scrollerHeight||(!width&&!height))
return this.resizing=0;if(force)
this.$gutterLayer.$padding=null;if(force)
this.$renderChanges(changes|this.$changes,true);else
this.$loop.schedule(changes|this.$changes);if(this.resizing)
this.resizing=0;this.scrollBarV.scrollLeft=this.scrollBarV.scrollTop=null;};this.$updateCachedSize=function(force,gutterWidth,width,height){height-=(this.$extraHeight||0);var changes=0;var size=this.$size;var oldSize={width:size.width,height:size.height,scrollerHeight:size.scrollerHeight,scrollerWidth:size.scrollerWidth};if(height&&(force||size.height!=height)){size.height=height;changes|=this.CHANGE_SIZE;size.scrollerHeight=size.height;if(this.$horizScroll)
size.scrollerHeight-=this.scrollBarH.getHeight();this.scrollBarV.element.style.bottom=this.scrollBarH.getHeight()+"px";changes=changes|this.CHANGE_SCROLL;}
if(width&&(force||size.width!=width)){changes|=this.CHANGE_SIZE;size.width=width;if(gutterWidth==null)
gutterWidth=this.$showGutter?this.$gutter.offsetWidth:0;this.gutterWidth=gutterWidth;this.scrollBarH.element.style.left=this.scroller.style.left=gutterWidth+"px";size.scrollerWidth=Math.max(0,width-gutterWidth-this.scrollBarV.getWidth());this.scrollBarH.element.style.right=this.scroller.style.right=this.scrollBarV.getWidth()+"px";this.scroller.style.bottom=this.scrollBarH.getHeight()+"px";if(this.session&&this.session.getUseWrapMode()&&this.adjustWrapLimit()||force)
changes|=this.CHANGE_FULL;}
size.$dirty=!width||!height;if(changes)
this._signal("resize",oldSize);return changes;};this.onGutterResize=function(){var gutterWidth=this.$showGutter?this.$gutter.offsetWidth:0;if(gutterWidth!=this.gutterWidth)
this.$changes|=this.$updateCachedSize(true,gutterWidth,this.$size.width,this.$size.height);if(this.session.getUseWrapMode()&&this.adjustWrapLimit()){this.$loop.schedule(this.CHANGE_FULL);}else if(this.$size.$dirty){this.$loop.schedule(this.CHANGE_FULL);}else{this.$computeLayerConfig();this.$loop.schedule(this.CHANGE_MARKER);}};this.adjustWrapLimit=function(){var availableWidth=this.$size.scrollerWidth-this.$padding*2;var limit=Math.floor(availableWidth/this.characterWidth);return this.session.adjustWrapLimit(limit,this.$showPrintMargin&&this.$printMarginColumn);};this.setAnimatedScroll=function(shouldAnimate){this.setOption("animatedScroll",shouldAnimate);};this.getAnimatedScroll=function(){return this.$animatedScroll;};this.setShowInvisibles=function(showInvisibles){this.setOption("showInvisibles",showInvisibles);this.session.$bidiHandler.setShowInvisibles(showInvisibles);};this.getShowInvisibles=function(){return this.getOption("showInvisibles");};this.getDisplayIndentGuides=function(){return this.getOption("displayIndentGuides");};this.setDisplayIndentGuides=function(display){this.setOption("displayIndentGuides",display);};this.setShowPrintMargin=function(showPrintMargin){this.setOption("showPrintMargin",showPrintMargin);};this.getShowPrintMargin=function(){return this.getOption("showPrintMargin");};this.setPrintMarginColumn=function(showPrintMargin){this.setOption("printMarginColumn",showPrintMargin);};this.getPrintMarginColumn=function(){return this.getOption("printMarginColumn");};this.getShowGutter=function(){return this.getOption("showGutter");};this.setShowGutter=function(show){return this.setOption("showGutter",show);};this.getFadeFoldWidgets=function(){return this.getOption("fadeFoldWidgets");};this.setFadeFoldWidgets=function(show){this.setOption("fadeFoldWidgets",show);};this.setHighlightGutterLine=function(shouldHighlight){this.setOption("highlightGutterLine",shouldHighlight);};this.getHighlightGutterLine=function(){return this.getOption("highlightGutterLine");};this.$updateGutterLineHighlight=function(){var pos=this.$cursorLayer.$pixelPos;var height=this.layerConfig.lineHeight;if(this.session.getUseWrapMode()){var cursor=this.session.selection.getCursor();cursor.column=0;pos=this.$cursorLayer.getPixelPosition(cursor,true);height*=this.session.getRowLength(cursor.row);}
this.$gutterLineHighlight.style.top=pos.top-this.layerConfig.offset+"px";this.$gutterLineHighlight.style.height=height+"px";};this.$updatePrintMargin=function(){if(!this.$showPrintMargin&&!this.$printMarginEl)
return;if(!this.$printMarginEl){var containerEl=dom.createElement("div");containerEl.className="ace_layer ace_print-margin-layer";this.$printMarginEl=dom.createElement("div");this.$printMarginEl.className="ace_print-margin";containerEl.appendChild(this.$printMarginEl);this.content.insertBefore(containerEl,this.content.firstChild);}
var style=this.$printMarginEl.style;style.left=Math.round(this.characterWidth*this.$printMarginColumn+this.$padding)+"px";style.visibility=this.$showPrintMargin?"visible":"hidden";if(this.session&&this.session.$wrap==-1)
this.adjustWrapLimit();};this.getContainerElement=function(){return this.container;};this.getMouseEventTarget=function(){return this.scroller;};this.getTextAreaContainer=function(){return this.container;};this.$moveTextAreaToCursor=function(){var style=this.textarea.style;if(!this.$keepTextAreaAtCursor){style.left=-100+"px";return;}
var config=this.layerConfig;var posTop=this.$cursorLayer.$pixelPos.top;var posLeft=this.$cursorLayer.$pixelPos.left;posTop-=config.offset;var h=this.lineHeight;if(posTop<0||posTop>config.height-h){style.top=style.left="0";return;}
var w=this.characterWidth;if(this.$composition){var val=this.textarea.value.replace(/^\x01+/,"");w*=(this.session.$getStringScreenWidth(val)[0]+2);h+=2;}
posLeft-=this.scrollLeft;if(posLeft>this.$size.scrollerWidth-w)
posLeft=this.$size.scrollerWidth-w;posLeft+=this.gutterWidth;style.height=h+"px";style.width=w+"px";style.left=Math.min(posLeft,this.$size.scrollerWidth-w)+"px";style.top=Math.min(posTop,this.$size.height-h)+"px";};this.getFirstVisibleRow=function(){return this.layerConfig.firstRow;};this.getFirstFullyVisibleRow=function(){return this.layerConfig.firstRow+(this.layerConfig.offset===0?0:1);};this.getLastFullyVisibleRow=function(){var config=this.layerConfig;var lastRow=config.lastRow;var top=this.session.documentToScreenRow(lastRow,0)*config.lineHeight;if(top-this.session.getScrollTop()>config.height-config.lineHeight)
return lastRow-1;return lastRow;};this.getLastVisibleRow=function(){return this.layerConfig.lastRow;};this.$padding=null;this.setPadding=function(padding){this.$padding=padding;this.$textLayer.setPadding(padding);this.$cursorLayer.setPadding(padding);this.$markerFront.setPadding(padding);this.$markerBack.setPadding(padding);this.$loop.schedule(this.CHANGE_FULL);this.$updatePrintMargin();};this.setScrollMargin=function(top,bottom,left,right){var sm=this.scrollMargin;sm.top=top|0;sm.bottom=bottom|0;sm.right=right|0;sm.left=left|0;sm.v=sm.top+sm.bottom;sm.h=sm.left+sm.right;if(sm.top&&this.scrollTop<=0&&this.session)
this.session.setScrollTop(-sm.top);this.updateFull();};this.getHScrollBarAlwaysVisible=function(){return this.$hScrollBarAlwaysVisible;};this.setHScrollBarAlwaysVisible=function(alwaysVisible){this.setOption("hScrollBarAlwaysVisible",alwaysVisible);};this.getVScrollBarAlwaysVisible=function(){return this.$vScrollBarAlwaysVisible;};this.setVScrollBarAlwaysVisible=function(alwaysVisible){this.setOption("vScrollBarAlwaysVisible",alwaysVisible);};this.$updateScrollBarV=function(){var scrollHeight=this.layerConfig.maxHeight;var scrollerHeight=this.$size.scrollerHeight;if(!this.$maxLines&&this.$scrollPastEnd){scrollHeight-=(scrollerHeight-this.lineHeight)*this.$scrollPastEnd;if(this.scrollTop>scrollHeight-scrollerHeight){scrollHeight=this.scrollTop+scrollerHeight;this.scrollBarV.scrollTop=null;}}
this.scrollBarV.setScrollHeight(scrollHeight+this.scrollMargin.v);this.scrollBarV.setScrollTop(this.scrollTop+this.scrollMargin.top);};this.$updateScrollBarH=function(){this.scrollBarH.setScrollWidth(this.layerConfig.width+2*this.$padding+this.scrollMargin.h);this.scrollBarH.setScrollLeft(this.scrollLeft+this.scrollMargin.left);};this.$frozen=false;this.freeze=function(){this.$frozen=true;};this.unfreeze=function(){this.$frozen=false;};this.$renderChanges=function(changes,force){if(this.$changes){changes|=this.$changes;this.$changes=0;}
if((!this.session||!this.container.offsetWidth||this.$frozen)||(!changes&&!force)){this.$changes|=changes;return;}
if(this.$size.$dirty){this.$changes|=changes;return this.onResize(true);}
if(!this.lineHeight){this.$textLayer.checkForSizeChanges();}
this._signal("beforeRender");if(this.session&&this.session.$bidiHandler)
this.session.$bidiHandler.updateCharacterWidths(this.$fontMetrics);var config=this.layerConfig;if(changes&this.CHANGE_FULL||changes&this.CHANGE_SIZE||changes&this.CHANGE_TEXT||changes&this.CHANGE_LINES||changes&this.CHANGE_SCROLL||changes&this.CHANGE_H_SCROLL){changes|=this.$computeLayerConfig();if(config.firstRow!=this.layerConfig.firstRow&&config.firstRowScreen==this.layerConfig.firstRowScreen){var st=this.scrollTop+(config.firstRow-this.layerConfig.firstRow)*this.lineHeight;if(st>0){this.scrollTop=st;changes=changes|this.CHANGE_SCROLL;changes|=this.$computeLayerConfig();}}
config=this.layerConfig;this.$updateScrollBarV();if(changes&this.CHANGE_H_SCROLL)
this.$updateScrollBarH();this.$gutterLayer.element.style.marginTop=(-config.offset)+"px";this.content.style.marginTop=(-config.offset)+"px";this.content.style.width=config.width+2*this.$padding+"px";this.content.style.height=config.minHeight+"px";}
if(changes&this.CHANGE_H_SCROLL){this.content.style.marginLeft=-this.scrollLeft+"px";this.scroller.className=this.scrollLeft<=0?"ace_scroller":"ace_scroller ace_scroll-left";}
if(changes&this.CHANGE_FULL){this.$textLayer.update(config);if(this.$showGutter)
this.$gutterLayer.update(config);this.$markerBack.update(config);this.$markerFront.update(config);this.$cursorLayer.update(config);this.$moveTextAreaToCursor();this.$highlightGutterLine&&this.$updateGutterLineHighlight();this._signal("afterRender");return;}
if(changes&this.CHANGE_SCROLL){if(changes&this.CHANGE_TEXT||changes&this.CHANGE_LINES)
this.$textLayer.update(config);else
this.$textLayer.scrollLines(config);if(this.$showGutter)
this.$gutterLayer.update(config);this.$markerBack.update(config);this.$markerFront.update(config);this.$cursorLayer.update(config);this.$highlightGutterLine&&this.$updateGutterLineHighlight();this.$moveTextAreaToCursor();this._signal("afterRender");return;}
if(changes&this.CHANGE_TEXT){this.$textLayer.update(config);if(this.$showGutter)
this.$gutterLayer.update(config);}
else if(changes&this.CHANGE_LINES){if(this.$updateLines()||(changes&this.CHANGE_GUTTER)&&this.$showGutter)
this.$gutterLayer.update(config);}
else if(changes&this.CHANGE_TEXT||changes&this.CHANGE_GUTTER){if(this.$showGutter)
this.$gutterLayer.update(config);}
if(changes&this.CHANGE_CURSOR){this.$cursorLayer.update(config);this.$moveTextAreaToCursor();this.$highlightGutterLine&&this.$updateGutterLineHighlight();}
if(changes&(this.CHANGE_MARKER|this.CHANGE_MARKER_FRONT)){this.$markerFront.update(config);}
if(changes&(this.CHANGE_MARKER|this.CHANGE_MARKER_BACK)){this.$markerBack.update(config);}
this._signal("afterRender");};this.$autosize=function(){var height=this.session.getScreenLength()*this.lineHeight;var maxHeight=this.$maxLines*this.lineHeight;var desiredHeight=Math.min(maxHeight,Math.max((this.$minLines||1)*this.lineHeight,height))+this.scrollMargin.v+(this.$extraHeight||0);if(this.$horizScroll)
desiredHeight+=this.scrollBarH.getHeight();if(this.$maxPixelHeight&&desiredHeight>this.$maxPixelHeight)
desiredHeight=this.$maxPixelHeight;var vScroll=height>maxHeight;if(desiredHeight!=this.desiredHeight||this.$size.height!=this.desiredHeight||vScroll!=this.$vScroll){if(vScroll!=this.$vScroll){this.$vScroll=vScroll;this.scrollBarV.setVisible(vScroll);}
var w=this.container.clientWidth;this.container.style.height=desiredHeight+"px";this.$updateCachedSize(true,this.$gutterWidth,w,desiredHeight);this.desiredHeight=desiredHeight;this._signal("autosize");}};this.$computeLayerConfig=function(){var session=this.session;var size=this.$size;var hideScrollbars=size.height<=2*this.lineHeight;var screenLines=this.session.getScreenLength();var maxHeight=screenLines*this.lineHeight;var longestLine=this.$getLongestLine();var horizScroll=!hideScrollbars&&(this.$hScrollBarAlwaysVisible||size.scrollerWidth-longestLine-2*this.$padding<0);var hScrollChanged=this.$horizScroll!==horizScroll;if(hScrollChanged){this.$horizScroll=horizScroll;this.scrollBarH.setVisible(horizScroll);}
var vScrollBefore=this.$vScroll;if(this.$maxLines&&this.lineHeight>1)
this.$autosize();var offset=this.scrollTop%this.lineHeight;var minHeight=size.scrollerHeight+this.lineHeight;var scrollPastEnd=!this.$maxLines&&this.$scrollPastEnd?(size.scrollerHeight-this.lineHeight)*this.$scrollPastEnd:0;maxHeight+=scrollPastEnd;var sm=this.scrollMargin;this.session.setScrollTop(Math.max(-sm.top,Math.min(this.scrollTop,maxHeight-size.scrollerHeight+sm.bottom)));this.session.setScrollLeft(Math.max(-sm.left,Math.min(this.scrollLeft,longestLine+2*this.$padding-size.scrollerWidth+sm.right)));var vScroll=!hideScrollbars&&(this.$vScrollBarAlwaysVisible||size.scrollerHeight-maxHeight+scrollPastEnd<0||this.scrollTop>sm.top);var vScrollChanged=vScrollBefore!==vScroll;if(vScrollChanged){this.$vScroll=vScroll;this.scrollBarV.setVisible(vScroll);}
var lineCount=Math.ceil(minHeight/this.lineHeight)-1;var firstRow=Math.max(0,Math.round((this.scrollTop-offset)/this.lineHeight));var lastRow=firstRow+lineCount;var firstRowScreen,firstRowHeight;var lineHeight=this.lineHeight;firstRow=session.screenToDocumentRow(firstRow,0);var foldLine=session.getFoldLine(firstRow);if(foldLine){firstRow=foldLine.start.row;}
firstRowScreen=session.documentToScreenRow(firstRow,0);firstRowHeight=session.getRowLength(firstRow)*lineHeight;lastRow=Math.min(session.screenToDocumentRow(lastRow,0),session.getLength()-1);minHeight=size.scrollerHeight+session.getRowLength(lastRow)*lineHeight+
firstRowHeight;offset=this.scrollTop-firstRowScreen*lineHeight;var changes=0;if(this.layerConfig.width!=longestLine||hScrollChanged)
changes=this.CHANGE_H_SCROLL;if(hScrollChanged||vScrollChanged){changes=this.$updateCachedSize(true,this.gutterWidth,size.width,size.height);this._signal("scrollbarVisibilityChanged");if(vScrollChanged)
longestLine=this.$getLongestLine();}
this.layerConfig={width:longestLine,padding:this.$padding,firstRow:firstRow,firstRowScreen:firstRowScreen,lastRow:lastRow,lineHeight:lineHeight,characterWidth:this.characterWidth,minHeight:minHeight,maxHeight:maxHeight,offset:offset,gutterOffset:lineHeight?Math.max(0,Math.ceil((offset+size.height-size.scrollerHeight)/lineHeight)):0,height:this.$size.scrollerHeight};return changes;};this.$updateLines=function(){if(!this.$changedLines)return;var firstRow=this.$changedLines.firstRow;var lastRow=this.$changedLines.lastRow;this.$changedLines=null;var layerConfig=this.layerConfig;if(firstRow>layerConfig.lastRow+1){return;}
if(lastRow<layerConfig.firstRow){return;}
if(lastRow===Infinity){if(this.$showGutter)
this.$gutterLayer.update(layerConfig);this.$textLayer.update(layerConfig);return;}
this.$textLayer.updateLines(layerConfig,firstRow,lastRow);return true;};this.$getLongestLine=function(){var charCount=this.session.getScreenWidth();if(this.showInvisibles&&!this.session.$useWrapMode)
charCount+=1;if(this.$textLayer&&charCount>this.$textLayer.MAX_LINE_LENGTH)
charCount=this.$textLayer.MAX_LINE_LENGTH+30;return Math.max(this.$size.scrollerWidth-2*this.$padding,Math.round(charCount*this.characterWidth));};this.updateFrontMarkers=function(){this.$markerFront.setMarkers(this.session.getMarkers(true));this.$loop.schedule(this.CHANGE_MARKER_FRONT);};this.updateBackMarkers=function(){this.$markerBack.setMarkers(this.session.getMarkers());this.$loop.schedule(this.CHANGE_MARKER_BACK);};this.addGutterDecoration=function(row,className){this.$gutterLayer.addGutterDecoration(row,className);};this.removeGutterDecoration=function(row,className){this.$gutterLayer.removeGutterDecoration(row,className);};this.updateBreakpoints=function(rows){this.$loop.schedule(this.CHANGE_GUTTER);};this.setAnnotations=function(annotations){this.$gutterLayer.setAnnotations(annotations);this.$loop.schedule(this.CHANGE_GUTTER);};this.updateCursor=function(){this.$loop.schedule(this.CHANGE_CURSOR);};this.hideCursor=function(){this.$cursorLayer.hideCursor();};this.showCursor=function(){this.$cursorLayer.showCursor();};this.scrollSelectionIntoView=function(anchor,lead,offset){this.scrollCursorIntoView(anchor,offset);this.scrollCursorIntoView(lead,offset);};this.scrollCursorIntoView=function(cursor,offset,$viewMargin){if(this.$size.scrollerHeight===0)
return;var pos=this.$cursorLayer.getPixelPosition(cursor);var left=pos.left;var top=pos.top;var topMargin=$viewMargin&&$viewMargin.top||0;var bottomMargin=$viewMargin&&$viewMargin.bottom||0;var scrollTop=this.$scrollAnimation?this.session.getScrollTop():this.scrollTop;if(scrollTop+topMargin>top){if(offset&&scrollTop+topMargin>top+this.lineHeight)
top-=offset*this.$size.scrollerHeight;if(top===0)
top=-this.scrollMargin.top;this.session.setScrollTop(top);}else if(scrollTop+this.$size.scrollerHeight-bottomMargin<top+this.lineHeight){if(offset&&scrollTop+this.$size.scrollerHeight-bottomMargin<top-this.lineHeight)
top+=offset*this.$size.scrollerHeight;this.session.setScrollTop(top+this.lineHeight-this.$size.scrollerHeight);}
var scrollLeft=this.scrollLeft;if(scrollLeft>left){if(left<this.$padding+2*this.layerConfig.characterWidth)
left=-this.scrollMargin.left;this.session.setScrollLeft(left);}else if(scrollLeft+this.$size.scrollerWidth<left+this.characterWidth){this.session.setScrollLeft(Math.round(left+this.characterWidth-this.$size.scrollerWidth));}else if(scrollLeft<=this.$padding&&left-scrollLeft<this.characterWidth){this.session.setScrollLeft(0);}};this.getScrollTop=function(){return this.session.getScrollTop();};this.getScrollLeft=function(){return this.session.getScrollLeft();};this.getScrollTopRow=function(){return this.scrollTop/this.lineHeight;};this.getScrollBottomRow=function(){return Math.max(0,Math.floor((this.scrollTop+this.$size.scrollerHeight)/this.lineHeight)-1);};this.scrollToRow=function(row){this.session.setScrollTop(row*this.lineHeight);};this.alignCursor=function(cursor,alignment){if(typeof cursor=="number")
cursor={row:cursor,column:0};var pos=this.$cursorLayer.getPixelPosition(cursor);var h=this.$size.scrollerHeight-this.lineHeight;var offset=pos.top-h*(alignment||0);this.session.setScrollTop(offset);return offset;};this.STEPS=8;this.$calcSteps=function(fromValue,toValue){var i=0;var l=this.STEPS;var steps=[];var func=function(t,x_min,dx){return dx*(Math.pow(t-1,3)+1)+x_min;};for(i=0;i<l;++i)
steps.push(func(i/this.STEPS,fromValue,toValue-fromValue));return steps;};this.scrollToLine=function(line,center,animate,callback){var pos=this.$cursorLayer.getPixelPosition({row:line,column:0});var offset=pos.top;if(center)
offset-=this.$size.scrollerHeight/2;var initialScroll=this.scrollTop;this.session.setScrollTop(offset);if(animate!==false)
this.animateScrolling(initialScroll,callback);};this.animateScrolling=function(fromValue,callback){var toValue=this.scrollTop;if(!this.$animatedScroll)
return;var _self=this;if(fromValue==toValue)
return;if(this.$scrollAnimation){var oldSteps=this.$scrollAnimation.steps;if(oldSteps.length){fromValue=oldSteps[0];if(fromValue==toValue)
return;}}
var steps=_self.$calcSteps(fromValue,toValue);this.$scrollAnimation={from:fromValue,to:toValue,steps:steps};clearInterval(this.$timer);_self.session.setScrollTop(steps.shift());_self.session.$scrollTop=toValue;this.$timer=setInterval(function(){if(steps.length){_self.session.setScrollTop(steps.shift());_self.session.$scrollTop=toValue;}else if(toValue!=null){_self.session.$scrollTop=-1;_self.session.setScrollTop(toValue);toValue=null;}else{_self.$timer=clearInterval(_self.$timer);_self.$scrollAnimation=null;callback&&callback();}},10);};this.scrollToY=function(scrollTop){if(this.scrollTop!==scrollTop){this.$loop.schedule(this.CHANGE_SCROLL);this.scrollTop=scrollTop;}};this.scrollToX=function(scrollLeft){if(this.scrollLeft!==scrollLeft)
this.scrollLeft=scrollLeft;this.$loop.schedule(this.CHANGE_H_SCROLL);};this.scrollTo=function(x,y){this.session.setScrollTop(y);this.session.setScrollLeft(y);};this.scrollBy=function(deltaX,deltaY){deltaY&&this.session.setScrollTop(this.session.getScrollTop()+deltaY);deltaX&&this.session.setScrollLeft(this.session.getScrollLeft()+deltaX);};this.isScrollableBy=function(deltaX,deltaY){if(deltaY<0&&this.session.getScrollTop()>=1-this.scrollMargin.top)
return true;if(deltaY>0&&this.session.getScrollTop()+this.$size.scrollerHeight
-this.layerConfig.maxHeight<-1+this.scrollMargin.bottom)
return true;if(deltaX<0&&this.session.getScrollLeft()>=1-this.scrollMargin.left)
return true;if(deltaX>0&&this.session.getScrollLeft()+this.$size.scrollerWidth
-this.layerConfig.width<-1+this.scrollMargin.right)
return true;};this.pixelToScreenCoordinates=function(x,y){var canvasPos=this.scroller.getBoundingClientRect();var offsetX=x+this.scrollLeft-canvasPos.left-this.$padding;var offset=offsetX/this.characterWidth;var row=Math.floor((y+this.scrollTop-canvasPos.top)/this.lineHeight);var col=Math.round(offset);return{row:row,column:col,side:offset-col>0?1:-1,offsetX:offsetX};};this.screenToTextCoordinates=function(x,y){var canvasPos=this.scroller.getBoundingClientRect();var offsetX=x+this.scrollLeft-canvasPos.left-this.$padding;var col=Math.round(offsetX/this.characterWidth);var row=(y+this.scrollTop-canvasPos.top)/this.lineHeight;return this.session.screenToDocumentPosition(row,Math.max(col,0),offsetX);};this.textToScreenCoordinates=function(row,column){var canvasPos=this.scroller.getBoundingClientRect();var pos=this.session.documentToScreenPosition(row,column);var x=this.$padding+(this.session.$bidiHandler.isBidiRow(pos.row,row)?this.session.$bidiHandler.getPosLeft(pos.column):Math.round(pos.column*this.characterWidth));var y=pos.row*this.lineHeight;return{pageX:canvasPos.left+x-this.scrollLeft,pageY:canvasPos.top+y-this.scrollTop};};this.visualizeFocus=function(){dom.addCssClass(this.container,"ace_focus");};this.visualizeBlur=function(){dom.removeCssClass(this.container,"ace_focus");};this.showComposition=function(position){if(!this.$composition)
this.$composition={keepTextAreaAtCursor:this.$keepTextAreaAtCursor,cssText:this.textarea.style.cssText};this.$keepTextAreaAtCursor=true;dom.addCssClass(this.textarea,"ace_composition");this.textarea.style.cssText="";this.$moveTextAreaToCursor();};this.setCompositionText=function(text){this.$moveTextAreaToCursor();};this.hideComposition=function(){if(!this.$composition)
return;dom.removeCssClass(this.textarea,"ace_composition");this.$keepTextAreaAtCursor=this.$composition.keepTextAreaAtCursor;this.textarea.style.cssText=this.$composition.cssText;this.$composition=null;};this.setTheme=function(theme,cb){var _self=this;this.$themeId=theme;_self._dispatchEvent('themeChange',{theme:theme});if(!theme||typeof theme=="string"){var moduleName=theme||this.$options.theme.initialValue;config.loadModule(["theme",moduleName],afterLoad);}else{afterLoad(theme);}
function afterLoad(module){if(_self.$themeId!=theme)
return cb&&cb();if(!module||!module.cssClass)
throw new Error("couldn't load module "+theme+" or it didn't call define");if(module.$id)
_self.$themeId=module.$id;dom.importCssString(module.cssText,module.cssClass,_self.container.ownerDocument);if(_self.theme)
dom.removeCssClass(_self.container,_self.theme.cssClass);var padding="padding"in module?module.padding:"padding"in(_self.theme||{})?4:_self.$padding;if(_self.$padding&&padding!=_self.$padding)
_self.setPadding(padding);_self.$theme=module.cssClass;_self.theme=module;dom.addCssClass(_self.container,module.cssClass);dom.setCssClass(_self.container,"ace_dark",module.isDark);if(_self.$size){_self.$size.width=0;_self.$updateSizeAsync();}
_self._dispatchEvent('themeLoaded',{theme:module});cb&&cb();}};this.getTheme=function(){return this.$themeId;};this.setStyle=function(style,include){dom.setCssClass(this.container,style,include!==false);};this.unsetStyle=function(style){dom.removeCssClass(this.container,style);};this.setCursorStyle=function(style){if(this.scroller.style.cursor!=style)
this.scroller.style.cursor=style;};this.setMouseCursor=function(cursorStyle){this.scroller.style.cursor=cursorStyle;};this.destroy=function(){this.$textLayer.destroy();this.$cursorLayer.destroy();};}).call(VirtualRenderer.prototype);config.defineOptions(VirtualRenderer.prototype,"renderer",{animatedScroll:{initialValue:false},showInvisibles:{set:function(value){if(this.$textLayer.setShowInvisibles(value))
this.$loop.schedule(this.CHANGE_TEXT);},initialValue:false},showPrintMargin:{set:function(){this.$updatePrintMargin();},initialValue:true},printMarginColumn:{set:function(){this.$updatePrintMargin();},initialValue:80},printMargin:{set:function(val){if(typeof val=="number")
this.$printMarginColumn=val;this.$showPrintMargin=!!val;this.$updatePrintMargin();},get:function(){return this.$showPrintMargin&&this.$printMarginColumn;}},showGutter:{set:function(show){this.$gutter.style.display=show?"block":"none";this.$loop.schedule(this.CHANGE_FULL);this.onGutterResize();},initialValue:true},fadeFoldWidgets:{set:function(show){dom.setCssClass(this.$gutter,"ace_fade-fold-widgets",show);},initialValue:false},showFoldWidgets:{set:function(show){this.$gutterLayer.setShowFoldWidgets(show);},initialValue:true},showLineNumbers:{set:function(show){this.$gutterLayer.setShowLineNumbers(show);this.$loop.schedule(this.CHANGE_GUTTER);},initialValue:true},displayIndentGuides:{set:function(show){if(this.$textLayer.setDisplayIndentGuides(show))
this.$loop.schedule(this.CHANGE_TEXT);},initialValue:true},highlightGutterLine:{set:function(shouldHighlight){if(!this.$gutterLineHighlight){this.$gutterLineHighlight=dom.createElement("div");this.$gutterLineHighlight.className="ace_gutter-active-line";this.$gutter.appendChild(this.$gutterLineHighlight);return;}
this.$gutterLineHighlight.style.display=shouldHighlight?"":"none";if(this.$cursorLayer.$pixelPos)
this.$updateGutterLineHighlight();},initialValue:false,value:true},hScrollBarAlwaysVisible:{set:function(val){if(!this.$hScrollBarAlwaysVisible||!this.$horizScroll)
this.$loop.schedule(this.CHANGE_SCROLL);},initialValue:false},vScrollBarAlwaysVisible:{set:function(val){if(!this.$vScrollBarAlwaysVisible||!this.$vScroll)
this.$loop.schedule(this.CHANGE_SCROLL);},initialValue:false},fontSize:{set:function(size){if(typeof size=="number")
size=size+"px";this.container.style.fontSize=size;this.updateFontSize();},initialValue:12},fontFamily:{set:function(name){this.container.style.fontFamily=name;this.updateFontSize();}},maxLines:{set:function(val){this.updateFull();}},minLines:{set:function(val){this.updateFull();}},maxPixelHeight:{set:function(val){this.updateFull();},initialValue:0},scrollPastEnd:{set:function(val){val=+val||0;if(this.$scrollPastEnd==val)
return;this.$scrollPastEnd=val;this.$loop.schedule(this.CHANGE_SCROLL);},initialValue:0,handlesSet:true},fixedWidthGutter:{set:function(val){this.$gutterLayer.$fixedWidth=!!val;this.$loop.schedule(this.CHANGE_GUTTER);}},theme:{set:function(val){this.setTheme(val);},get:function(){return this.$themeId||this.theme;},initialValue:"./theme/textmate",handlesSet:true}});exports.VirtualRenderer=VirtualRenderer;});define("ace/worker/worker_client",["require","exports","module","ace/lib/oop","ace/lib/net","ace/lib/event_emitter","ace/config"],function(require,exports,module){"use strict";var oop=require("../lib/oop");var net=require("../lib/net");var EventEmitter=require("../lib/event_emitter").EventEmitter;var config=require("../config");function $workerBlob(workerUrl){var script="importScripts('"+net.qualifyURL(workerUrl)+"');";try{return new Blob([script],{"type":"application/javascript"});}catch(e){var BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder;var blobBuilder=new BlobBuilder();blobBuilder.append(script);return blobBuilder.getBlob("application/javascript");}}
function createWorker(workerUrl){if(typeof Worker=="undefined")
return{postMessage:function(){},terminate:function(){}};var blob=$workerBlob(workerUrl);var URL=window.URL||window.webkitURL;var blobURL=URL.createObjectURL(blob);return new Worker(blobURL);}
var WorkerClient=function(topLevelNamespaces,mod,classname,workerUrl,importScripts){this.$sendDeltaQueue=this.$sendDeltaQueue.bind(this);this.changeListener=this.changeListener.bind(this);this.onMessage=this.onMessage.bind(this);if(require.nameToUrl&&!require.toUrl)
require.toUrl=require.nameToUrl;if(config.get("packaged")||!require.toUrl){workerUrl=workerUrl||config.moduleUrl(mod,"worker");}else{var normalizePath=this.$normalizePath;workerUrl=workerUrl||normalizePath(require.toUrl("ace/worker/worker.js",null,"_"));var tlns={};topLevelNamespaces.forEach(function(ns){tlns[ns]=normalizePath(require.toUrl(ns,null,"_").replace(/(\.js)?(\?.*)?$/,""));});}
this.$worker=createWorker(workerUrl);if(importScripts){this.send("importScripts",importScripts);}
this.$worker.postMessage({init:true,tlns:tlns,module:mod,classname:classname});this.callbackId=1;this.callbacks={};this.$worker.onmessage=this.onMessage;};(function(){oop.implement(this,EventEmitter);this.onMessage=function(e){var msg=e.data;switch(msg.type){case"event":this._signal(msg.name,{data:msg.data});break;case"call":var callback=this.callbacks[msg.id];if(callback){callback(msg.data);delete this.callbacks[msg.id];}
break;case"error":this.reportError(msg.data);break;case"log":window.console&&console.log&&console.log.apply(console,msg.data);break;}};this.reportError=function(err){window.console&&console.error&&console.error(err);};this.$normalizePath=function(path){return net.qualifyURL(path);};this.terminate=function(){this._signal("terminate",{});this.deltaQueue=null;this.$worker.terminate();this.$worker=null;if(this.$doc)
this.$doc.off("change",this.changeListener);this.$doc=null;};this.send=function(cmd,args){this.$worker.postMessage({command:cmd,args:args});};this.call=function(cmd,args,callback){if(callback){var id=this.callbackId++;this.callbacks[id]=callback;args.push(id);}
this.send(cmd,args);};this.emit=function(event,data){try{this.$worker.postMessage({event:event,data:{data:data.data}});}
catch(ex){console.error(ex.stack);}};this.attachToDocument=function(doc){if(this.$doc)
this.terminate();this.$doc=doc;this.call("setValue",[doc.getValue()]);doc.on("change",this.changeListener);};this.changeListener=function(delta){if(!this.deltaQueue){this.deltaQueue=[];setTimeout(this.$sendDeltaQueue,0);}
if(delta.action=="insert")
this.deltaQueue.push(delta.start,delta.lines);else
this.deltaQueue.push(delta.start,delta.end);};this.$sendDeltaQueue=function(){var q=this.deltaQueue;if(!q)return;this.deltaQueue=null;if(q.length>50&&q.length>this.$doc.getLength()>>1){this.call("setValue",[this.$doc.getValue()]);}else
this.emit("change",{data:q});};}).call(WorkerClient.prototype);var UIWorkerClient=function(topLevelNamespaces,mod,classname){this.$sendDeltaQueue=this.$sendDeltaQueue.bind(this);this.changeListener=this.changeListener.bind(this);this.callbackId=1;this.callbacks={};this.messageBuffer=[];var main=null;var emitSync=false;var sender=Object.create(EventEmitter);var _self=this;this.$worker={};this.$worker.terminate=function(){};this.$worker.postMessage=function(e){_self.messageBuffer.push(e);if(main){if(emitSync)
setTimeout(processNext);else
processNext();}};this.setEmitSync=function(val){emitSync=val;};var processNext=function(){var msg=_self.messageBuffer.shift();if(msg.command)
main[msg.command].apply(main,msg.args);else if(msg.event)
sender._signal(msg.event,msg.data);};sender.postMessage=function(msg){_self.onMessage({data:msg});};sender.callback=function(data,callbackId){this.postMessage({type:"call",id:callbackId,data:data});};sender.emit=function(name,data){this.postMessage({type:"event",name:name,data:data});};config.loadModule(["worker",mod],function(Main){main=new Main[classname](sender);while(_self.messageBuffer.length)
processNext();});};UIWorkerClient.prototype=WorkerClient.prototype;exports.UIWorkerClient=UIWorkerClient;exports.WorkerClient=WorkerClient;exports.createWorker=createWorker;});define("ace/placeholder",["require","exports","module","ace/range","ace/lib/event_emitter","ace/lib/oop"],function(require,exports,module){"use strict";var Range=require("./range").Range;var EventEmitter=require("./lib/event_emitter").EventEmitter;var oop=require("./lib/oop");var PlaceHolder=function(session,length,pos,others,mainClass,othersClass){var _self=this;this.length=length;this.session=session;this.doc=session.getDocument();this.mainClass=mainClass;this.othersClass=othersClass;this.$onUpdate=this.onUpdate.bind(this);this.doc.on("change",this.$onUpdate);this.$others=others;this.$onCursorChange=function(){setTimeout(function(){_self.onCursorChange();});};this.$pos=pos;var undoStack=session.getUndoManager().$undoStack||session.getUndoManager().$undostack||{length:-1};this.$undoStackDepth=undoStack.length;this.setup();session.selection.on("changeCursor",this.$onCursorChange);};(function(){oop.implement(this,EventEmitter);this.setup=function(){var _self=this;var doc=this.doc;var session=this.session;this.selectionBefore=session.selection.toJSON();if(session.selection.inMultiSelectMode)
session.selection.toSingleRange();this.pos=doc.createAnchor(this.$pos.row,this.$pos.column);var pos=this.pos;pos.$insertRight=true;pos.detach();pos.markerId=session.addMarker(new Range(pos.row,pos.column,pos.row,pos.column+this.length),this.mainClass,null,false);this.others=[];this.$others.forEach(function(other){var anchor=doc.createAnchor(other.row,other.column);anchor.$insertRight=true;anchor.detach();_self.others.push(anchor);});session.setUndoSelect(false);};this.showOtherMarkers=function(){if(this.othersActive)return;var session=this.session;var _self=this;this.othersActive=true;this.others.forEach(function(anchor){anchor.markerId=session.addMarker(new Range(anchor.row,anchor.column,anchor.row,anchor.column+_self.length),_self.othersClass,null,false);});};this.hideOtherMarkers=function(){if(!this.othersActive)return;this.othersActive=false;for(var i=0;i<this.others.length;i++){this.session.removeMarker(this.others[i].markerId);}};this.onUpdate=function(delta){if(this.$updating)
return this.updateAnchors(delta);var range=delta;if(range.start.row!==range.end.row)return;if(range.start.row!==this.pos.row)return;this.$updating=true;var lengthDiff=delta.action==="insert"?range.end.column-range.start.column:range.start.column-range.end.column;var inMainRange=range.start.column>=this.pos.column&&range.start.column<=this.pos.column+this.length+1;var distanceFromStart=range.start.column-this.pos.column;this.updateAnchors(delta);if(inMainRange)
this.length+=lengthDiff;if(inMainRange&&!this.session.$fromUndo){if(delta.action==='insert'){for(var i=this.others.length-1;i>=0;i--){var otherPos=this.others[i];var newPos={row:otherPos.row,column:otherPos.column+distanceFromStart};this.doc.insertMergedLines(newPos,delta.lines);}}else if(delta.action==='remove'){for(var i=this.others.length-1;i>=0;i--){var otherPos=this.others[i];var newPos={row:otherPos.row,column:otherPos.column+distanceFromStart};this.doc.remove(new Range(newPos.row,newPos.column,newPos.row,newPos.column-lengthDiff));}}}
this.$updating=false;this.updateMarkers();};this.updateAnchors=function(delta){this.pos.onChange(delta);for(var i=this.others.length;i--;)
this.others[i].onChange(delta);this.updateMarkers();};this.updateMarkers=function(){if(this.$updating)
return;var _self=this;var session=this.session;var updateMarker=function(pos,className){session.removeMarker(pos.markerId);pos.markerId=session.addMarker(new Range(pos.row,pos.column,pos.row,pos.column+_self.length),className,null,false);};updateMarker(this.pos,this.mainClass);for(var i=this.others.length;i--;)
updateMarker(this.others[i],this.othersClass);};this.onCursorChange=function(event){if(this.$updating||!this.session)return;var pos=this.session.selection.getCursor();if(pos.row===this.pos.row&&pos.column>=this.pos.column&&pos.column<=this.pos.column+this.length){this.showOtherMarkers();this._emit("cursorEnter",event);}else{this.hideOtherMarkers();this._emit("cursorLeave",event);}};this.detach=function(){this.session.removeMarker(this.pos&&this.pos.markerId);this.hideOtherMarkers();this.doc.removeEventListener("change",this.$onUpdate);this.session.selection.removeEventListener("changeCursor",this.$onCursorChange);this.session.setUndoSelect(true);this.session=null;};this.cancel=function(){if(this.$undoStackDepth===-1)
return;var undoManager=this.session.getUndoManager();var undosRequired=(undoManager.$undoStack||undoManager.$undostack).length-this.$undoStackDepth;for(var i=0;i<undosRequired;i++){undoManager.undo(this.session,true);}
if(this.selectionBefore)
this.session.selection.fromJSON(this.selectionBefore);};}).call(PlaceHolder.prototype);exports.PlaceHolder=PlaceHolder;});define("ace/mouse/multi_select_handler",["require","exports","module","ace/lib/event","ace/lib/useragent"],function(require,exports,module){var event=require("../lib/event");var useragent=require("../lib/useragent");function isSamePoint(p1,p2){return p1.row==p2.row&&p1.column==p2.column;}
function onMouseDown(e){var ev=e.domEvent;var alt=ev.altKey;var shift=ev.shiftKey;var ctrl=ev.ctrlKey;var accel=e.getAccelKey();var button=e.getButton();if(ctrl&&useragent.isMac)
button=ev.button;if(e.editor.inMultiSelectMode&&button==2){e.editor.textInput.onContextMenu(e.domEvent);return;}
if(!ctrl&&!alt&&!accel){if(button===0&&e.editor.inMultiSelectMode)
e.editor.exitMultiSelectMode();return;}
if(button!==0)
return;var editor=e.editor;var selection=editor.selection;var isMultiSelect=editor.inMultiSelectMode;var pos=e.getDocumentPosition();var cursor=selection.getCursor();var inSelection=e.inSelection()||(selection.isEmpty()&&isSamePoint(pos,cursor));var mouseX=e.x,mouseY=e.y;var onMouseSelection=function(e){mouseX=e.clientX;mouseY=e.clientY;};var session=editor.session;var screenAnchor=editor.renderer.pixelToScreenCoordinates(mouseX,mouseY);var screenCursor=screenAnchor;var selectionMode;if(editor.$mouseHandler.$enableJumpToDef){if(ctrl&&alt||accel&&alt)
selectionMode=shift?"block":"add";else if(alt&&editor.$blockSelectEnabled)
selectionMode="block";}else{if(accel&&!alt){selectionMode="add";if(!isMultiSelect&&shift)
return;}else if(alt&&editor.$blockSelectEnabled){selectionMode="block";}}
if(selectionMode&&useragent.isMac&&ev.ctrlKey){editor.$mouseHandler.cancelContextMenu();}
if(selectionMode=="add"){if(!isMultiSelect&&inSelection)
return;if(!isMultiSelect){var range=selection.toOrientedRange();editor.addSelectionMarker(range);}
var oldRange=selection.rangeList.rangeAtPoint(pos);editor.inVirtualSelectionMode=true;if(shift){oldRange=null;range=selection.ranges[0]||range;editor.removeSelectionMarker(range);}
editor.once("mouseup",function(){var tmpSel=selection.toOrientedRange();if(oldRange&&tmpSel.isEmpty()&&isSamePoint(oldRange.cursor,tmpSel.cursor))
selection.substractPoint(tmpSel.cursor);else{if(shift){selection.substractPoint(range.cursor);}else if(range){editor.removeSelectionMarker(range);selection.addRange(range);}
selection.addRange(tmpSel);}
editor.inVirtualSelectionMode=false;});}else if(selectionMode=="block"){e.stop();editor.inVirtualSelectionMode=true;var initialRange;var rectSel=[];var blockSelect=function(){var newCursor=editor.renderer.pixelToScreenCoordinates(mouseX,mouseY);var cursor=session.screenToDocumentPosition(newCursor.row,newCursor.column,newCursor.offsetX);if(isSamePoint(screenCursor,newCursor)&&isSamePoint(cursor,selection.lead))
return;screenCursor=newCursor;editor.selection.moveToPosition(cursor);editor.renderer.scrollCursorIntoView();editor.removeSelectionMarkers(rectSel);rectSel=selection.rectangularRangeBlock(screenCursor,screenAnchor);if(editor.$mouseHandler.$clickSelection&&rectSel.length==1&&rectSel[0].isEmpty())
rectSel[0]=editor.$mouseHandler.$clickSelection.clone();rectSel.forEach(editor.addSelectionMarker,editor);editor.updateSelectionMarkers();};if(isMultiSelect&&!accel){selection.toSingleRange();}else if(!isMultiSelect&&accel){initialRange=selection.toOrientedRange();editor.addSelectionMarker(initialRange);}
if(shift)
screenAnchor=session.documentToScreenPosition(selection.lead);else
selection.moveToPosition(pos);screenCursor={row:-1,column:-1};var onMouseSelectionEnd=function(e){clearInterval(timerId);editor.removeSelectionMarkers(rectSel);if(!rectSel.length)
rectSel=[selection.toOrientedRange()];if(initialRange){editor.removeSelectionMarker(initialRange);selection.toSingleRange(initialRange);}
for(var i=0;i<rectSel.length;i++)
selection.addRange(rectSel[i]);editor.inVirtualSelectionMode=false;editor.$mouseHandler.$clickSelection=null;};var onSelectionInterval=blockSelect;event.capture(editor.container,onMouseSelection,onMouseSelectionEnd);var timerId=setInterval(function(){onSelectionInterval();},20);return e.preventDefault();}}
exports.onMouseDown=onMouseDown;});define("ace/commands/multi_select_commands",["require","exports","module","ace/keyboard/hash_handler"],function(require,exports,module){exports.defaultCommands=[{name:"addCursorAbove",exec:function(editor){editor.selectMoreLines(-1);},bindKey:{win:"Ctrl-Alt-Up",mac:"Ctrl-Alt-Up"},scrollIntoView:"cursor",readOnly:true},{name:"addCursorBelow",exec:function(editor){editor.selectMoreLines(1);},bindKey:{win:"Ctrl-Alt-Down",mac:"Ctrl-Alt-Down"},scrollIntoView:"cursor",readOnly:true},{name:"addCursorAboveSkipCurrent",exec:function(editor){editor.selectMoreLines(-1,true);},bindKey:{win:"Ctrl-Alt-Shift-Up",mac:"Ctrl-Alt-Shift-Up"},scrollIntoView:"cursor",readOnly:true},{name:"addCursorBelowSkipCurrent",exec:function(editor){editor.selectMoreLines(1,true);},bindKey:{win:"Ctrl-Alt-Shift-Down",mac:"Ctrl-Alt-Shift-Down"},scrollIntoView:"cursor",readOnly:true},{name:"selectMoreBefore",exec:function(editor){editor.selectMore(-1);},bindKey:{win:"Ctrl-Alt-Left",mac:"Ctrl-Alt-Left"},scrollIntoView:"cursor",readOnly:true},{name:"selectMoreAfter",exec:function(editor){editor.selectMore(1);},bindKey:{win:"Ctrl-Alt-Right",mac:"Ctrl-Alt-Right"},scrollIntoView:"cursor",readOnly:true},{name:"selectNextBefore",exec:function(editor){editor.selectMore(-1,true);},bindKey:{win:"Ctrl-Alt-Shift-Left",mac:"Ctrl-Alt-Shift-Left"},scrollIntoView:"cursor",readOnly:true},{name:"selectNextAfter",exec:function(editor){editor.selectMore(1,true);},bindKey:{win:"Ctrl-Alt-Shift-Right",mac:"Ctrl-Alt-Shift-Right"},scrollIntoView:"cursor",readOnly:true},{name:"splitIntoLines",exec:function(editor){editor.multiSelect.splitIntoLines();},bindKey:{win:"Ctrl-Alt-L",mac:"Ctrl-Alt-L"},readOnly:true},{name:"alignCursors",exec:function(editor){editor.alignCursors();},bindKey:{win:"Ctrl-Alt-A",mac:"Ctrl-Alt-A"},scrollIntoView:"cursor"},{name:"findAll",exec:function(editor){editor.findAll();},bindKey:{win:"Ctrl-Alt-K",mac:"Ctrl-Alt-G"},scrollIntoView:"cursor",readOnly:true}];exports.multiSelectCommands=[{name:"singleSelection",bindKey:"esc",exec:function(editor){editor.exitMultiSelectMode();},scrollIntoView:"cursor",readOnly:true,isAvailable:function(editor){return editor&&editor.inMultiSelectMode;}}];var HashHandler=require("../keyboard/hash_handler").HashHandler;exports.keyboardHandler=new HashHandler(exports.multiSelectCommands);});define("ace/multi_select",["require","exports","module","ace/range_list","ace/range","ace/selection","ace/mouse/multi_select_handler","ace/lib/event","ace/lib/lang","ace/commands/multi_select_commands","ace/search","ace/edit_session","ace/editor","ace/config"],function(require,exports,module){var RangeList=require("./range_list").RangeList;var Range=require("./range").Range;var Selection=require("./selection").Selection;var onMouseDown=require("./mouse/multi_select_handler").onMouseDown;var event=require("./lib/event");var lang=require("./lib/lang");var commands=require("./commands/multi_select_commands");exports.commands=commands.defaultCommands.concat(commands.multiSelectCommands);var Search=require("./search").Search;var search=new Search();function find(session,needle,dir){search.$options.wrap=true;search.$options.needle=needle;search.$options.backwards=dir==-1;return search.find(session);}
var EditSession=require("./edit_session").EditSession;(function(){this.getSelectionMarkers=function(){return this.$selectionMarkers;};}).call(EditSession.prototype);(function(){this.ranges=null;this.rangeList=null;this.addRange=function(range,$blockChangeEvents){if(!range)
return;if(!this.inMultiSelectMode&&this.rangeCount===0){var oldRange=this.toOrientedRange();this.rangeList.add(oldRange);this.rangeList.add(range);if(this.rangeList.ranges.length!=2){this.rangeList.removeAll();return $blockChangeEvents||this.fromOrientedRange(range);}
this.rangeList.removeAll();this.rangeList.add(oldRange);this.$onAddRange(oldRange);}
if(!range.cursor)
range.cursor=range.end;var removed=this.rangeList.add(range);this.$onAddRange(range);if(removed.length)
this.$onRemoveRange(removed);if(this.rangeCount>1&&!this.inMultiSelectMode){this._signal("multiSelect");this.inMultiSelectMode=true;this.session.$undoSelect=false;this.rangeList.attach(this.session);}
return $blockChangeEvents||this.fromOrientedRange(range);};this.toSingleRange=function(range){range=range||this.ranges[0];var removed=this.rangeList.removeAll();if(removed.length)
this.$onRemoveRange(removed);range&&this.fromOrientedRange(range);};this.substractPoint=function(pos){var removed=this.rangeList.substractPoint(pos);if(removed){this.$onRemoveRange(removed);return removed[0];}};this.mergeOverlappingRanges=function(){var removed=this.rangeList.merge();if(removed.length)
this.$onRemoveRange(removed);else if(this.ranges[0])
this.fromOrientedRange(this.ranges[0]);};this.$onAddRange=function(range){this.rangeCount=this.rangeList.ranges.length;this.ranges.unshift(range);this._signal("addRange",{range:range});};this.$onRemoveRange=function(removed){this.rangeCount=this.rangeList.ranges.length;if(this.rangeCount==1&&this.inMultiSelectMode){var lastRange=this.rangeList.ranges.pop();removed.push(lastRange);this.rangeCount=0;}
for(var i=removed.length;i--;){var index=this.ranges.indexOf(removed[i]);this.ranges.splice(index,1);}
this._signal("removeRange",{ranges:removed});if(this.rangeCount===0&&this.inMultiSelectMode){this.inMultiSelectMode=false;this._signal("singleSelect");this.session.$undoSelect=true;this.rangeList.detach(this.session);}
lastRange=lastRange||this.ranges[0];if(lastRange&&!lastRange.isEqual(this.getRange()))
this.fromOrientedRange(lastRange);};this.$initRangeList=function(){if(this.rangeList)
return;this.rangeList=new RangeList();this.ranges=[];this.rangeCount=0;};this.getAllRanges=function(){return this.rangeCount?this.rangeList.ranges.concat():[this.getRange()];};this.splitIntoLines=function(){if(this.rangeCount>1){var ranges=this.rangeList.ranges;var lastRange=ranges[ranges.length-1];var range=Range.fromPoints(ranges[0].start,lastRange.end);this.toSingleRange();this.setSelectionRange(range,lastRange.cursor==lastRange.start);}else{var range=this.getRange();var isBackwards=this.isBackwards();var startRow=range.start.row;var endRow=range.end.row;if(startRow==endRow){if(isBackwards)
var start=range.end,end=range.start;else
var start=range.start,end=range.end;this.addRange(Range.fromPoints(end,end));this.addRange(Range.fromPoints(start,start));return;}
var rectSel=[];var r=this.getLineRange(startRow,true);r.start.column=range.start.column;rectSel.push(r);for(var i=startRow+1;i<endRow;i++)
rectSel.push(this.getLineRange(i,true));r=this.getLineRange(endRow,true);r.end.column=range.end.column;rectSel.push(r);rectSel.forEach(this.addRange,this);}};this.toggleBlockSelection=function(){if(this.rangeCount>1){var ranges=this.rangeList.ranges;var lastRange=ranges[ranges.length-1];var range=Range.fromPoints(ranges[0].start,lastRange.end);this.toSingleRange();this.setSelectionRange(range,lastRange.cursor==lastRange.start);}else{var cursor=this.session.documentToScreenPosition(this.cursor);var anchor=this.session.documentToScreenPosition(this.anchor);var rectSel=this.rectangularRangeBlock(cursor,anchor);rectSel.forEach(this.addRange,this);}};this.rectangularRangeBlock=function(screenCursor,screenAnchor,includeEmptyLines){var rectSel=[];var xBackwards=screenCursor.column<screenAnchor.column;if(xBackwards){var startColumn=screenCursor.column;var endColumn=screenAnchor.column;var startOffsetX=screenCursor.offsetX;var endOffsetX=screenAnchor.offsetX;}else{var startColumn=screenAnchor.column;var endColumn=screenCursor.column;var startOffsetX=screenAnchor.offsetX;var endOffsetX=screenCursor.offsetX;}
var yBackwards=screenCursor.row<screenAnchor.row;if(yBackwards){var startRow=screenCursor.row;var endRow=screenAnchor.row;}else{var startRow=screenAnchor.row;var endRow=screenCursor.row;}
if(startColumn<0)
startColumn=0;if(startRow<0)
startRow=0;if(startRow==endRow)
includeEmptyLines=true;var docEnd;for(var row=startRow;row<=endRow;row++){var range=Range.fromPoints(this.session.screenToDocumentPosition(row,startColumn,startOffsetX),this.session.screenToDocumentPosition(row,endColumn,endOffsetX));if(range.isEmpty()){if(docEnd&&isSamePoint(range.end,docEnd))
break;docEnd=range.end;}
range.cursor=xBackwards?range.start:range.end;rectSel.push(range);}
if(yBackwards)
rectSel.reverse();if(!includeEmptyLines){var end=rectSel.length-1;while(rectSel[end].isEmpty()&&end>0)
end--;if(end>0){var start=0;while(rectSel[start].isEmpty())
start++;}
for(var i=end;i>=start;i--){if(rectSel[i].isEmpty())
rectSel.splice(i,1);}}
return rectSel;};}).call(Selection.prototype);var Editor=require("./editor").Editor;(function(){this.updateSelectionMarkers=function(){this.renderer.updateCursor();this.renderer.updateBackMarkers();};this.addSelectionMarker=function(orientedRange){if(!orientedRange.cursor)
orientedRange.cursor=orientedRange.end;var style=this.getSelectionStyle();orientedRange.marker=this.session.addMarker(orientedRange,"ace_selection",style);this.session.$selectionMarkers.push(orientedRange);this.session.selectionMarkerCount=this.session.$selectionMarkers.length;return orientedRange;};this.removeSelectionMarker=function(range){if(!range.marker)
return;this.session.removeMarker(range.marker);var index=this.session.$selectionMarkers.indexOf(range);if(index!=-1)
this.session.$selectionMarkers.splice(index,1);this.session.selectionMarkerCount=this.session.$selectionMarkers.length;};this.removeSelectionMarkers=function(ranges){var markerList=this.session.$selectionMarkers;for(var i=ranges.length;i--;){var range=ranges[i];if(!range.marker)
continue;this.session.removeMarker(range.marker);var index=markerList.indexOf(range);if(index!=-1)
markerList.splice(index,1);}
this.session.selectionMarkerCount=markerList.length;};this.$onAddRange=function(e){this.addSelectionMarker(e.range);this.renderer.updateCursor();this.renderer.updateBackMarkers();};this.$onRemoveRange=function(e){this.removeSelectionMarkers(e.ranges);this.renderer.updateCursor();this.renderer.updateBackMarkers();};this.$onMultiSelect=function(e){if(this.inMultiSelectMode)
return;this.inMultiSelectMode=true;this.setStyle("ace_multiselect");this.keyBinding.addKeyboardHandler(commands.keyboardHandler);this.commands.setDefaultHandler("exec",this.$onMultiSelectExec);this.renderer.updateCursor();this.renderer.updateBackMarkers();};this.$onSingleSelect=function(e){if(this.session.multiSelect.inVirtualMode)
return;this.inMultiSelectMode=false;this.unsetStyle("ace_multiselect");this.keyBinding.removeKeyboardHandler(commands.keyboardHandler);this.commands.removeDefaultHandler("exec",this.$onMultiSelectExec);this.renderer.updateCursor();this.renderer.updateBackMarkers();this._emit("changeSelection");};this.$onMultiSelectExec=function(e){var command=e.command;var editor=e.editor;if(!editor.multiSelect)
return;if(!command.multiSelectAction){var result=command.exec(editor,e.args||{});editor.multiSelect.addRange(editor.multiSelect.toOrientedRange());editor.multiSelect.mergeOverlappingRanges();}else if(command.multiSelectAction=="forEach"){result=editor.forEachSelection(command,e.args);}else if(command.multiSelectAction=="forEachLine"){result=editor.forEachSelection(command,e.args,true);}else if(command.multiSelectAction=="single"){editor.exitMultiSelectMode();result=command.exec(editor,e.args||{});}else{result=command.multiSelectAction(editor,e.args||{});}
return result;};this.forEachSelection=function(cmd,args,options){if(this.inVirtualSelectionMode)
return;var keepOrder=options&&options.keepOrder;var $byLines=options==true||options&&options.$byLines;var session=this.session;var selection=this.selection;var rangeList=selection.rangeList;var ranges=(keepOrder?selection:rangeList).ranges;var result;if(!ranges.length)
return cmd.exec?cmd.exec(this,args||{}):cmd(this,args||{});var reg=selection._eventRegistry;selection._eventRegistry={};var tmpSel=new Selection(session);this.inVirtualSelectionMode=true;for(var i=ranges.length;i--;){if($byLines){while(i>0&&ranges[i].start.row==ranges[i-1].end.row)
i--;}
tmpSel.fromOrientedRange(ranges[i]);tmpSel.index=i;this.selection=session.selection=tmpSel;var cmdResult=cmd.exec?cmd.exec(this,args||{}):cmd(this,args||{});if(!result&&cmdResult!==undefined)
result=cmdResult;tmpSel.toOrientedRange(ranges[i]);}
tmpSel.detach();this.selection=session.selection=selection;this.inVirtualSelectionMode=false;selection._eventRegistry=reg;selection.mergeOverlappingRanges();var anim=this.renderer.$scrollAnimation;this.onCursorChange();this.onSelectionChange();if(anim&&anim.from==anim.to)
this.renderer.animateScrolling(anim.from);return result;};this.exitMultiSelectMode=function(){if(!this.inMultiSelectMode||this.inVirtualSelectionMode)
return;this.multiSelect.toSingleRange();};this.getSelectedText=function(){var text="";if(this.inMultiSelectMode&&!this.inVirtualSelectionMode){var ranges=this.multiSelect.rangeList.ranges;var buf=[];for(var i=0;i<ranges.length;i++){buf.push(this.session.getTextRange(ranges[i]));}
var nl=this.session.getDocument().getNewLineCharacter();text=buf.join(nl);if(text.length==(buf.length-1)*nl.length)
text="";}else if(!this.selection.isEmpty()){text=this.session.getTextRange(this.getSelectionRange());}
return text;};this.$checkMultiselectChange=function(e,anchor){if(this.inMultiSelectMode&&!this.inVirtualSelectionMode){var range=this.multiSelect.ranges[0];if(this.multiSelect.isEmpty()&&anchor==this.multiSelect.anchor)
return;var pos=anchor==this.multiSelect.anchor?range.cursor==range.start?range.end:range.start:range.cursor;if(pos.row!=anchor.row||this.session.$clipPositionToDocument(pos.row,pos.column).column!=anchor.column)
this.multiSelect.toSingleRange(this.multiSelect.toOrientedRange());}};this.findAll=function(needle,options,additive){options=options||{};options.needle=needle||options.needle;if(options.needle==undefined){var range=this.selection.isEmpty()?this.selection.getWordRange():this.selection.getRange();options.needle=this.session.getTextRange(range);}
this.$search.set(options);var ranges=this.$search.findAll(this.session);if(!ranges.length)
return 0;var selection=this.multiSelect;if(!additive)
selection.toSingleRange(ranges[0]);for(var i=ranges.length;i--;)
selection.addRange(ranges[i],true);if(range&&selection.rangeList.rangeAtPoint(range.start))
selection.addRange(range,true);return ranges.length;};this.selectMoreLines=function(dir,skip){var range=this.selection.toOrientedRange();var isBackwards=range.cursor==range.end;var screenLead=this.session.documentToScreenPosition(range.cursor);if(this.selection.$desiredColumn)
screenLead.column=this.selection.$desiredColumn;var lead=this.session.screenToDocumentPosition(screenLead.row+dir,screenLead.column);if(!range.isEmpty()){var screenAnchor=this.session.documentToScreenPosition(isBackwards?range.end:range.start);var anchor=this.session.screenToDocumentPosition(screenAnchor.row+dir,screenAnchor.column);}else{var anchor=lead;}
if(isBackwards){var newRange=Range.fromPoints(lead,anchor);newRange.cursor=newRange.start;}else{var newRange=Range.fromPoints(anchor,lead);newRange.cursor=newRange.end;}
newRange.desiredColumn=screenLead.column;if(!this.selection.inMultiSelectMode){this.selection.addRange(range);}else{if(skip)
var toRemove=range.cursor;}
this.selection.addRange(newRange);if(toRemove)
this.selection.substractPoint(toRemove);};this.transposeSelections=function(dir){var session=this.session;var sel=session.multiSelect;var all=sel.ranges;for(var i=all.length;i--;){var range=all[i];if(range.isEmpty()){var tmp=session.getWordRange(range.start.row,range.start.column);range.start.row=tmp.start.row;range.start.column=tmp.start.column;range.end.row=tmp.end.row;range.end.column=tmp.end.column;}}
sel.mergeOverlappingRanges();var words=[];for(var i=all.length;i--;){var range=all[i];words.unshift(session.getTextRange(range));}
if(dir<0)
words.unshift(words.pop());else
words.push(words.shift());for(var i=all.length;i--;){var range=all[i];var tmp=range.clone();session.replace(range,words[i]);range.start.row=tmp.start.row;range.start.column=tmp.start.column;}};this.selectMore=function(dir,skip,stopAtFirst){var session=this.session;var sel=session.multiSelect;var range=sel.toOrientedRange();if(range.isEmpty()){range=session.getWordRange(range.start.row,range.start.column);range.cursor=dir==-1?range.start:range.end;this.multiSelect.addRange(range);if(stopAtFirst)
return;}
var needle=session.getTextRange(range);var newRange=find(session,needle,dir);if(newRange){newRange.cursor=dir==-1?newRange.start:newRange.end;this.session.unfold(newRange);this.multiSelect.addRange(newRange);this.renderer.scrollCursorIntoView(null,0.5);}
if(skip)
this.multiSelect.substractPoint(range.cursor);};this.alignCursors=function(){var session=this.session;var sel=session.multiSelect;var ranges=sel.ranges;var row=-1;var sameRowRanges=ranges.filter(function(r){if(r.cursor.row==row)
return true;row=r.cursor.row;});if(!ranges.length||sameRowRanges.length==ranges.length-1){var range=this.selection.getRange();var fr=range.start.row,lr=range.end.row;var guessRange=fr==lr;if(guessRange){var max=this.session.getLength();var line;do{line=this.session.getLine(lr);}while(/[=:]/.test(line)&&++lr<max);do{line=this.session.getLine(fr);}while(/[=:]/.test(line)&&--fr>0);if(fr<0)fr=0;if(lr>=max)lr=max-1;}
var lines=this.session.removeFullLines(fr,lr);lines=this.$reAlignText(lines,guessRange);this.session.insert({row:fr,column:0},lines.join("\n")+"\n");if(!guessRange){range.start.column=0;range.end.column=lines[lines.length-1].length;}
this.selection.setRange(range);}else{sameRowRanges.forEach(function(r){sel.substractPoint(r.cursor);});var maxCol=0;var minSpace=Infinity;var spaceOffsets=ranges.map(function(r){var p=r.cursor;var line=session.getLine(p.row);var spaceOffset=line.substr(p.column).search(/\S/g);if(spaceOffset==-1)
spaceOffset=0;if(p.column>maxCol)
maxCol=p.column;if(spaceOffset<minSpace)
minSpace=spaceOffset;return spaceOffset;});ranges.forEach(function(r,i){var p=r.cursor;var l=maxCol-p.column;var d=spaceOffsets[i]-minSpace;if(l>d)
session.insert(p,lang.stringRepeat(" ",l-d));else
session.remove(new Range(p.row,p.column,p.row,p.column-l+d));r.start.column=r.end.column=maxCol;r.start.row=r.end.row=p.row;r.cursor=r.end;});sel.fromOrientedRange(ranges[0]);this.renderer.updateCursor();this.renderer.updateBackMarkers();}};this.$reAlignText=function(lines,forceLeft){var isLeftAligned=true,isRightAligned=true;var startW,textW,endW;return lines.map(function(line){var m=line.match(/(\s*)(.*?)(\s*)([=:].*)/);if(!m)
return[line];if(startW==null){startW=m[1].length;textW=m[2].length;endW=m[3].length;return m;}
if(startW+textW+endW!=m[1].length+m[2].length+m[3].length)
isRightAligned=false;if(startW!=m[1].length)
isLeftAligned=false;if(startW>m[1].length)
startW=m[1].length;if(textW<m[2].length)
textW=m[2].length;if(endW>m[3].length)
endW=m[3].length;return m;}).map(forceLeft?alignLeft:isLeftAligned?isRightAligned?alignRight:alignLeft:unAlign);function spaces(n){return lang.stringRepeat(" ",n);}
function alignLeft(m){return!m[2]?m[0]:spaces(startW)+m[2]
+spaces(textW-m[2].length+endW)
+m[4].replace(/^([=:])\s+/,"$1 ");}
function alignRight(m){return!m[2]?m[0]:spaces(startW+textW-m[2].length)+m[2]
+spaces(endW)
+m[4].replace(/^([=:])\s+/,"$1 ");}
function unAlign(m){return!m[2]?m[0]:spaces(startW)+m[2]
+spaces(endW)
+m[4].replace(/^([=:])\s+/,"$1 ");}};}).call(Editor.prototype);function isSamePoint(p1,p2){return p1.row==p2.row&&p1.column==p2.column;}
exports.onSessionChange=function(e){var session=e.session;if(session&&!session.multiSelect){session.$selectionMarkers=[];session.selection.$initRangeList();session.multiSelect=session.selection;}
this.multiSelect=session&&session.multiSelect;var oldSession=e.oldSession;if(oldSession){oldSession.multiSelect.off("addRange",this.$onAddRange);oldSession.multiSelect.off("removeRange",this.$onRemoveRange);oldSession.multiSelect.off("multiSelect",this.$onMultiSelect);oldSession.multiSelect.off("singleSelect",this.$onSingleSelect);oldSession.multiSelect.lead.off("change",this.$checkMultiselectChange);oldSession.multiSelect.anchor.off("change",this.$checkMultiselectChange);}
if(session){session.multiSelect.on("addRange",this.$onAddRange);session.multiSelect.on("removeRange",this.$onRemoveRange);session.multiSelect.on("multiSelect",this.$onMultiSelect);session.multiSelect.on("singleSelect",this.$onSingleSelect);session.multiSelect.lead.on("change",this.$checkMultiselectChange);session.multiSelect.anchor.on("change",this.$checkMultiselectChange);}
if(session&&this.inMultiSelectMode!=session.selection.inMultiSelectMode){if(session.selection.inMultiSelectMode)
this.$onMultiSelect();else
this.$onSingleSelect();}};function MultiSelect(editor){if(editor.$multiselectOnSessionChange)
return;editor.$onAddRange=editor.$onAddRange.bind(editor);editor.$onRemoveRange=editor.$onRemoveRange.bind(editor);editor.$onMultiSelect=editor.$onMultiSelect.bind(editor);editor.$onSingleSelect=editor.$onSingleSelect.bind(editor);editor.$multiselectOnSessionChange=exports.onSessionChange.bind(editor);editor.$checkMultiselectChange=editor.$checkMultiselectChange.bind(editor);editor.$multiselectOnSessionChange(editor);editor.on("changeSession",editor.$multiselectOnSessionChange);editor.on("mousedown",onMouseDown);editor.commands.addCommands(commands.defaultCommands);addAltCursorListeners(editor);}
function addAltCursorListeners(editor){var el=editor.textInput.getElement();var altCursor=false;event.addListener(el,"keydown",function(e){var altDown=e.keyCode==18&&!(e.ctrlKey||e.shiftKey||e.metaKey);if(editor.$blockSelectEnabled&&altDown){if(!altCursor){editor.renderer.setMouseCursor("crosshair");altCursor=true;}}else if(altCursor){reset();}});event.addListener(el,"keyup",reset);event.addListener(el,"blur",reset);function reset(e){if(altCursor){editor.renderer.setMouseCursor("");altCursor=false;}}}
exports.MultiSelect=MultiSelect;require("./config").defineOptions(Editor.prototype,"editor",{enableMultiselect:{set:function(val){MultiSelect(this);if(val){this.on("changeSession",this.$multiselectOnSessionChange);this.on("mousedown",onMouseDown);}else{this.off("changeSession",this.$multiselectOnSessionChange);this.off("mousedown",onMouseDown);}},value:true},enableBlockSelect:{set:function(val){this.$blockSelectEnabled=val;},value:true}});});define("ace/mode/folding/fold_mode",["require","exports","module","ace/range"],function(require,exports,module){"use strict";var Range=require("../../range").Range;var FoldMode=exports.FoldMode=function(){};(function(){this.foldingStartMarker=null;this.foldingStopMarker=null;this.getFoldWidget=function(session,foldStyle,row){var line=session.getLine(row);if(this.foldingStartMarker.test(line))
return"start";if(foldStyle=="markbeginend"&&this.foldingStopMarker&&this.foldingStopMarker.test(line))
return"end";return"";};this.getFoldWidgetRange=function(session,foldStyle,row){return null;};this.indentationBlock=function(session,row,column){var re=/\S/;var line=session.getLine(row);var startLevel=line.search(re);if(startLevel==-1)
return;var startColumn=column||line.length;var maxRow=session.getLength();var startRow=row;var endRow=row;while(++row<maxRow){var level=session.getLine(row).search(re);if(level==-1)
continue;if(level<=startLevel)
break;endRow=row;}
if(endRow>startRow){var endColumn=session.getLine(endRow).length;return new Range(startRow,startColumn,endRow,endColumn);}};this.openingBracketBlock=function(session,bracket,row,column,typeRe){var start={row:row,column:column+1};var end=session.$findClosingBracket(bracket,start,typeRe);if(!end)
return;var fw=session.foldWidgets[end.row];if(fw==null)
fw=session.getFoldWidget(end.row);if(fw=="start"&&end.row>start.row){end.row--;end.column=session.getLine(end.row).length;}
return Range.fromPoints(start,end);};this.closingBracketBlock=function(session,bracket,row,column,typeRe){var end={row:row,column:column};var start=session.$findOpeningBracket(bracket,end);if(!start)
return;start.column++;end.column--;return Range.fromPoints(start,end);};}).call(FoldMode.prototype);});define("ace/theme/textmate",["require","exports","module","ace/lib/dom"],function(require,exports,module){"use strict";exports.isDark=false;exports.cssClass="ace-tm";exports.cssText=".ace-tm .ace_gutter {\
background: #f0f0f0;\
color: #333;\
}\
.ace-tm .ace_print-margin {\
width: 1px;\
background: #e8e8e8;\
}\
.ace-tm .ace_fold {\
background-color: #6B72E6;\
}\
.ace-tm {\
background-color: #FFFFFF;\
color: black;\
}\
.ace-tm .ace_cursor {\
color: black;\
}\
.ace-tm .ace_invisible {\
color: rgb(191, 191, 191);\
}\
.ace-tm .ace_storage,\
.ace-tm .ace_keyword {\
color: blue;\
}\
.ace-tm .ace_constant {\
color: rgb(197, 6, 11);\
}\
.ace-tm .ace_constant.ace_buildin {\
color: rgb(88, 72, 246);\
}\
.ace-tm .ace_constant.ace_language {\
color: rgb(88, 92, 246);\
}\
.ace-tm .ace_constant.ace_library {\
color: rgb(6, 150, 14);\
}\
.ace-tm .ace_invalid {\
background-color: rgba(255, 0, 0, 0.1);\
color: red;\
}\
.ace-tm .ace_support.ace_function {\
color: rgb(60, 76, 114);\
}\
.ace-tm .ace_support.ace_constant {\
color: rgb(6, 150, 14);\
}\
.ace-tm .ace_support.ace_type,\
.ace-tm .ace_support.ace_class {\
color: rgb(109, 121, 222);\
}\
.ace-tm .ace_keyword.ace_operator {\
color: rgb(104, 118, 135);\
}\
.ace-tm .ace_string {\
color: rgb(3, 106, 7);\
}\
.ace-tm .ace_comment {\
color: rgb(76, 136, 107);\
}\
.ace-tm .ace_comment.ace_doc {\
color: rgb(0, 102, 255);\
}\
.ace-tm .ace_comment.ace_doc.ace_tag {\
color: rgb(128, 159, 191);\
}\
.ace-tm .ace_constant.ace_numeric {\
color: rgb(0, 0, 205);\
}\
.ace-tm .ace_variable {\
color: rgb(49, 132, 149);\
}\
.ace-tm .ace_xml-pe {\
color: rgb(104, 104, 91);\
}\
.ace-tm .ace_entity.ace_name.ace_function {\
color: #0000A2;\
}\
.ace-tm .ace_heading {\
color: rgb(12, 7, 255);\
}\
.ace-tm .ace_list {\
color:rgb(185, 6, 144);\
}\
.ace-tm .ace_meta.ace_tag {\
color:rgb(0, 22, 142);\
}\
.ace-tm .ace_string.ace_regex {\
color: rgb(255, 0, 0)\
}\
.ace-tm .ace_marker-layer .ace_selection {\
background: rgb(181, 213, 255);\
}\
.ace-tm.ace_multiselect .ace_selection.ace_start {\
box-shadow: 0 0 3px 0px white;\
}\
.ace-tm .ace_marker-layer .ace_step {\
background: rgb(252, 255, 0);\
}\
.ace-tm .ace_marker-layer .ace_stack {\
background: rgb(164, 229, 101);\
}\
.ace-tm .ace_marker-layer .ace_bracket {\
margin: -1px 0 0 -1px;\
border: 1px solid rgb(192, 192, 192);\
}\
.ace-tm .ace_marker-layer .ace_active-line {\
background: rgba(0, 0, 0, 0.07);\
}\
.ace-tm .ace_gutter-active-line {\
background-color : #dcdcdc;\
}\
.ace-tm .ace_marker-layer .ace_selected-word {\
background: rgb(250, 250, 255);\
border: 1px solid rgb(200, 200, 250);\
}\
.ace-tm .ace_indent-guide {\
background: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==\") right repeat-y;\
}\
";exports.$id="ace/theme/textmate";var dom=require("../lib/dom");dom.importCssString(exports.cssText,exports.cssClass);});define("ace/line_widgets",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/range"],function(require,exports,module){"use strict";var oop=require("./lib/oop");var dom=require("./lib/dom");var Range=require("./range").Range;function LineWidgets(session){this.session=session;this.session.widgetManager=this;this.session.getRowLength=this.getRowLength;this.session.$getWidgetScreenLength=this.$getWidgetScreenLength;this.updateOnChange=this.updateOnChange.bind(this);this.renderWidgets=this.renderWidgets.bind(this);this.measureWidgets=this.measureWidgets.bind(this);this.session._changedWidgets=[];this.$onChangeEditor=this.$onChangeEditor.bind(this);this.session.on("change",this.updateOnChange);this.session.on("changeFold",this.updateOnFold);this.session.on("changeEditor",this.$onChangeEditor);}
(function(){this.getRowLength=function(row){var h;if(this.lineWidgets)
h=this.lineWidgets[row]&&this.lineWidgets[row].rowCount||0;else
h=0;if(!this.$useWrapMode||!this.$wrapData[row]){return 1+h;}else{return this.$wrapData[row].length+1+h;}};this.$getWidgetScreenLength=function(){var screenRows=0;this.lineWidgets.forEach(function(w){if(w&&w.rowCount&&!w.hidden)
screenRows+=w.rowCount;});return screenRows;};this.$onChangeEditor=function(e){this.attach(e.editor);};this.attach=function(editor){if(editor&&editor.widgetManager&&editor.widgetManager!=this)
editor.widgetManager.detach();if(this.editor==editor)
return;this.detach();this.editor=editor;if(editor){editor.widgetManager=this;editor.renderer.on("beforeRender",this.measureWidgets);editor.renderer.on("afterRender",this.renderWidgets);}};this.detach=function(e){var editor=this.editor;if(!editor)
return;this.editor=null;editor.widgetManager=null;editor.renderer.off("beforeRender",this.measureWidgets);editor.renderer.off("afterRender",this.renderWidgets);var lineWidgets=this.session.lineWidgets;lineWidgets&&lineWidgets.forEach(function(w){if(w&&w.el&&w.el.parentNode){w._inDocument=false;w.el.parentNode.removeChild(w.el);}});};this.updateOnFold=function(e,session){var lineWidgets=session.lineWidgets;if(!lineWidgets||!e.action)
return;var fold=e.data;var start=fold.start.row;var end=fold.end.row;var hide=e.action=="add";for(var i=start+1;i<end;i++){if(lineWidgets[i])
lineWidgets[i].hidden=hide;}
if(lineWidgets[end]){if(hide){if(!lineWidgets[start])
lineWidgets[start]=lineWidgets[end];else
lineWidgets[end].hidden=hide;}else{if(lineWidgets[start]==lineWidgets[end])
lineWidgets[start]=undefined;lineWidgets[end].hidden=hide;}}};this.updateOnChange=function(delta){var lineWidgets=this.session.lineWidgets;if(!lineWidgets)return;var startRow=delta.start.row;var len=delta.end.row-startRow;if(len===0){}else if(delta.action=='remove'){var removed=lineWidgets.splice(startRow+1,len);removed.forEach(function(w){w&&this.removeLineWidget(w);},this);this.$updateRows();}else{var args=new Array(len);args.unshift(startRow,0);lineWidgets.splice.apply(lineWidgets,args);this.$updateRows();}};this.$updateRows=function(){var lineWidgets=this.session.lineWidgets;if(!lineWidgets)return;var noWidgets=true;lineWidgets.forEach(function(w,i){if(w){noWidgets=false;w.row=i;while(w.$oldWidget){w.$oldWidget.row=i;w=w.$oldWidget;}}});if(noWidgets)
this.session.lineWidgets=null;};this.addLineWidget=function(w){if(!this.session.lineWidgets)
this.session.lineWidgets=new Array(this.session.getLength());var old=this.session.lineWidgets[w.row];if(old){w.$oldWidget=old;if(old.el&&old.el.parentNode){old.el.parentNode.removeChild(old.el);old._inDocument=false;}}
this.session.lineWidgets[w.row]=w;w.session=this.session;var renderer=this.editor.renderer;if(w.html&&!w.el){w.el=dom.createElement("div");w.el.innerHTML=w.html;}
if(w.el){dom.addCssClass(w.el,"ace_lineWidgetContainer");w.el.style.position="absolute";w.el.style.zIndex=5;renderer.container.appendChild(w.el);w._inDocument=true;}
if(!w.coverGutter){w.el.style.zIndex=3;}
if(w.pixelHeight==null){w.pixelHeight=w.el.offsetHeight;}
if(w.rowCount==null){w.rowCount=w.pixelHeight/renderer.layerConfig.lineHeight;}
var fold=this.session.getFoldAt(w.row,0);w.$fold=fold;if(fold){var lineWidgets=this.session.lineWidgets;if(w.row==fold.end.row&&!lineWidgets[fold.start.row])
lineWidgets[fold.start.row]=w;else
w.hidden=true;}
this.session._emit("changeFold",{data:{start:{row:w.row}}});this.$updateRows();this.renderWidgets(null,renderer);this.onWidgetChanged(w);return w;};this.removeLineWidget=function(w){w._inDocument=false;w.session=null;if(w.el&&w.el.parentNode)
w.el.parentNode.removeChild(w.el);if(w.editor&&w.editor.destroy)try{w.editor.destroy();}catch(e){}
if(this.session.lineWidgets){var w1=this.session.lineWidgets[w.row];if(w1==w){this.session.lineWidgets[w.row]=w.$oldWidget;if(w.$oldWidget)
this.onWidgetChanged(w.$oldWidget);}else{while(w1){if(w1.$oldWidget==w){w1.$oldWidget=w.$oldWidget;break;}
w1=w1.$oldWidget;}}}
this.session._emit("changeFold",{data:{start:{row:w.row}}});this.$updateRows();};this.getWidgetsAtRow=function(row){var lineWidgets=this.session.lineWidgets;var w=lineWidgets&&lineWidgets[row];var list=[];while(w){list.push(w);w=w.$oldWidget;}
return list;};this.onWidgetChanged=function(w){this.session._changedWidgets.push(w);this.editor&&this.editor.renderer.updateFull();};this.measureWidgets=function(e,renderer){var changedWidgets=this.session._changedWidgets;var config=renderer.layerConfig;if(!changedWidgets||!changedWidgets.length)return;var min=Infinity;for(var i=0;i<changedWidgets.length;i++){var w=changedWidgets[i];if(!w||!w.el)continue;if(w.session!=this.session)continue;if(!w._inDocument){if(this.session.lineWidgets[w.row]!=w)
continue;w._inDocument=true;renderer.container.appendChild(w.el);}
w.h=w.el.offsetHeight;if(!w.fixedWidth){w.w=w.el.offsetWidth;w.screenWidth=Math.ceil(w.w/config.characterWidth);}
var rowCount=w.h/config.lineHeight;if(w.coverLine){rowCount-=this.session.getRowLineCount(w.row);if(rowCount<0)
rowCount=0;}
if(w.rowCount!=rowCount){w.rowCount=rowCount;if(w.row<min)
min=w.row;}}
if(min!=Infinity){this.session._emit("changeFold",{data:{start:{row:min}}});this.session.lineWidgetWidth=null;}
this.session._changedWidgets=[];};this.renderWidgets=function(e,renderer){var config=renderer.layerConfig;var lineWidgets=this.session.lineWidgets;if(!lineWidgets)
return;var first=Math.min(this.firstRow,config.firstRow);var last=Math.max(this.lastRow,config.lastRow,lineWidgets.length);while(first>0&&!lineWidgets[first])
first--;this.firstRow=config.firstRow;this.lastRow=config.lastRow;renderer.$cursorLayer.config=config;for(var i=first;i<=last;i++){var w=lineWidgets[i];if(!w||!w.el)continue;if(w.hidden){w.el.style.top=-100-(w.pixelHeight||0)+"px";continue;}
if(!w._inDocument){w._inDocument=true;renderer.container.appendChild(w.el);}
var top=renderer.$cursorLayer.getPixelPosition({row:i,column:0},true).top;if(!w.coverLine)
top+=config.lineHeight*this.session.getRowLineCount(w.row);w.el.style.top=top-config.offset+"px";var left=w.coverGutter?0:renderer.gutterWidth;if(!w.fixedWidth)
left-=renderer.scrollLeft;w.el.style.left=left+"px";if(w.fullWidth&&w.screenWidth){w.el.style.minWidth=config.width+2*config.padding+"px";}
if(w.fixedWidth){w.el.style.right=renderer.scrollBar.getWidth()+"px";}else{w.el.style.right="";}}};}).call(LineWidgets.prototype);exports.LineWidgets=LineWidgets;});define("ace/ext/error_marker",["require","exports","module","ace/line_widgets","ace/lib/dom","ace/range"],function(require,exports,module){"use strict";var LineWidgets=require("../line_widgets").LineWidgets;var dom=require("../lib/dom");var Range=require("../range").Range;function binarySearch(array,needle,comparator){var first=0;var last=array.length-1;while(first<=last){var mid=(first+last)>>1;var c=comparator(needle,array[mid]);if(c>0)
first=mid+1;else if(c<0)
last=mid-1;else
return mid;}
return-(first+1);}
function findAnnotations(session,row,dir){var annotations=session.getAnnotations().sort(Range.comparePoints);if(!annotations.length)
return;var i=binarySearch(annotations,{row:row,column:-1},Range.comparePoints);if(i<0)
i=-i-1;if(i>=annotations.length)
i=dir>0?0:annotations.length-1;else if(i===0&&dir<0)
i=annotations.length-1;var annotation=annotations[i];if(!annotation||!dir)
return;if(annotation.row===row){do{annotation=annotations[i+=dir];}while(annotation&&annotation.row===row);if(!annotation)
return annotations.slice();}
var matched=[];row=annotation.row;do{matched[dir<0?"unshift":"push"](annotation);annotation=annotations[i+=dir];}while(annotation&&annotation.row==row);return matched.length&&matched;}
exports.showErrorMarker=function(editor,dir){var session=editor.session;if(!session.widgetManager){session.widgetManager=new LineWidgets(session);session.widgetManager.attach(editor);}
var pos=editor.getCursorPosition();var row=pos.row;var oldWidget=session.widgetManager.getWidgetsAtRow(row).filter(function(w){return w.type=="errorMarker";})[0];if(oldWidget){oldWidget.destroy();}else{row-=dir;}
var annotations=findAnnotations(session,row,dir);var gutterAnno;if(annotations){var annotation=annotations[0];pos.column=(annotation.pos&&typeof annotation.column!="number"?annotation.pos.sc:annotation.column)||0;pos.row=annotation.row;gutterAnno=editor.renderer.$gutterLayer.$annotations[pos.row];}else if(oldWidget){return;}else{gutterAnno={text:["Looks good!"],className:"ace_ok"};}
editor.session.unfold(pos.row);editor.selection.moveToPosition(pos);var w={row:pos.row,fixedWidth:true,coverGutter:true,el:dom.createElement("div"),type:"errorMarker"};var el=w.el.appendChild(dom.createElement("div"));var arrow=w.el.appendChild(dom.createElement("div"));arrow.className="error_widget_arrow "+gutterAnno.className;var left=editor.renderer.$cursorLayer.getPixelPosition(pos).left;arrow.style.left=left+editor.renderer.gutterWidth-5+"px";w.el.className="error_widget_wrapper";el.className="error_widget "+gutterAnno.className;el.innerHTML=gutterAnno.text.join("<br>");el.appendChild(dom.createElement("div"));var kb=function(_,hashId,keyString){if(hashId===0&&(keyString==="esc"||keyString==="return")){w.destroy();return{command:"null"};}};w.destroy=function(){if(editor.$mouseHandler.isMousePressed)
return;editor.keyBinding.removeKeyboardHandler(kb);session.widgetManager.removeLineWidget(w);editor.off("changeSelection",w.destroy);editor.off("changeSession",w.destroy);editor.off("mouseup",w.destroy);editor.off("change",w.destroy);};editor.keyBinding.addKeyboardHandler(kb);editor.on("changeSelection",w.destroy);editor.on("changeSession",w.destroy);editor.on("mouseup",w.destroy);editor.on("change",w.destroy);editor.session.widgetManager.addLineWidget(w);w.el.onmousedown=editor.focus.bind(editor);editor.renderer.scrollCursorIntoView(null,0.5,{bottom:w.el.offsetHeight});};dom.importCssString("\
    .error_widget_wrapper {\
        background: inherit;\
        color: inherit;\
        border:none\
    }\
    .error_widget {\
        border-top: solid 2px;\
        border-bottom: solid 2px;\
        margin: 5px 0;\
        padding: 10px 40px;\
        white-space: pre-wrap;\
    }\
    .error_widget.ace_error, .error_widget_arrow.ace_error{\
        border-color: #ff5a5a\
    }\
    .error_widget.ace_warning, .error_widget_arrow.ace_warning{\
        border-color: #F1D817\
    }\
    .error_widget.ace_info, .error_widget_arrow.ace_info{\
        border-color: #5a5a5a\
    }\
    .error_widget.ace_ok, .error_widget_arrow.ace_ok{\
        border-color: #5aaa5a\
    }\
    .error_widget_arrow {\
        position: absolute;\
        border: solid 5px;\
        border-top-color: transparent!important;\
        border-right-color: transparent!important;\
        border-left-color: transparent!important;\
        top: -5px;\
    }\
","");});define("ace/ace",["require","exports","module","ace/lib/fixoldbrowsers","ace/lib/dom","ace/lib/event","ace/range","ace/editor","ace/edit_session","ace/undomanager","ace/virtual_renderer","ace/worker/worker_client","ace/keyboard/hash_handler","ace/placeholder","ace/multi_select","ace/mode/folding/fold_mode","ace/theme/textmate","ace/ext/error_marker","ace/config"],function(require,exports,module){"use strict";require("./lib/fixoldbrowsers");var dom=require("./lib/dom");var event=require("./lib/event");var Range=require("./range").Range;var Editor=require("./editor").Editor;var EditSession=require("./edit_session").EditSession;var UndoManager=require("./undomanager").UndoManager;var Renderer=require("./virtual_renderer").VirtualRenderer;require("./worker/worker_client");require("./keyboard/hash_handler");require("./placeholder");require("./multi_select");require("./mode/folding/fold_mode");require("./theme/textmate");require("./ext/error_marker");exports.config=require("./config");exports.require=require;if(typeof define==="function")
exports.define=define;exports.edit=function(el,options){if(typeof el=="string"){var _id=el;el=document.getElementById(_id);if(!el)
throw new Error("ace.edit can't find div #"+_id);}
if(el&&el.env&&el.env.editor instanceof Editor)
return el.env.editor;var value="";if(el&&/input|textarea/i.test(el.tagName)){var oldNode=el;value=oldNode.value;el=dom.createElement("pre");oldNode.parentNode.replaceChild(el,oldNode);}else if(el){value=el.textContent;el.innerHTML="";}
var doc=exports.createEditSession(value);var editor=new Editor(new Renderer(el),doc,options);var env={document:doc,editor:editor,onResize:editor.resize.bind(editor,null)};if(oldNode)env.textarea=oldNode;event.addListener(window,"resize",env.onResize);editor.on("destroy",function(){event.removeListener(window,"resize",env.onResize);env.editor.container.env=null;});editor.container.env=editor.env=env;return editor;};exports.createEditSession=function(text,mode){var doc=new EditSession(text,mode);doc.setUndoManager(new UndoManager());return doc;};exports.Range=Range;exports.EditSession=EditSession;exports.UndoManager=UndoManager;exports.VirtualRenderer=Renderer;exports.version="1.3.1";});(function(){window.require(["ace/ace"],function(a){if(a){a.config.init(true);a.define=window.define;}
if(!window.ace)
window.ace=a;for(var key in a)if(a.hasOwnProperty(key))
window.ace[key]=a[key];});})();;

/* /web/static/lib/ace/javascript_highlight_rules.js defined in bundle 'web.tests_assets' */
define("ace/mode/doc_comment_highlight_rules",["require","exports","module"],function(require,exports,module){"use strict";var oop=require("../lib/oop");var TextHighlightRules=require("./text_highlight_rules").TextHighlightRules;var DocCommentHighlightRules=function(){this.$rules={"start":[{token:"comment.doc.tag",regex:"@[\\w\\d_]+"},DocCommentHighlightRules.getTagRule(),{defaultToken:"comment.doc",caseInsensitive:true}]};};oop.inherits(DocCommentHighlightRules,TextHighlightRules);DocCommentHighlightRules.getTagRule=function(start){return{token:"comment.doc.tag.storage.type",regex:"\\b(?:TODO|FIXME|XXX|HACK)\\b"};};DocCommentHighlightRules.getStartRule=function(start){return{token:"comment.doc",regex:"\\/\\*(?=\\*)",next:start};};DocCommentHighlightRules.getEndRule=function(start){return{token:"comment.doc",regex:"\\*\\/",next:start};};exports.DocCommentHighlightRules=DocCommentHighlightRules;});;

/* /web/static/lib/ace/mode-python.js defined in bundle 'web.tests_assets' */
define("ace/mode/python_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/text_highlight_rules"],function(require,exports,module){"use strict";var oop=require("../lib/oop");var TextHighlightRules=require("./text_highlight_rules").TextHighlightRules;var PythonHighlightRules=function(){var keywords=("and|as|assert|break|class|continue|def|del|elif|else|except|exec|"+"finally|for|from|global|if|import|in|is|lambda|not|or|pass|print|"+"raise|return|try|while|with|yield|async|await");var builtinConstants=("True|False|None|NotImplemented|Ellipsis|__debug__");var builtinFunctions=("abs|divmod|input|open|staticmethod|all|enumerate|int|ord|str|any|"+"eval|isinstance|pow|sum|basestring|execfile|issubclass|print|super|"+"binfile|iter|property|tuple|bool|filter|len|range|type|bytearray|"+"float|list|raw_input|unichr|callable|format|locals|reduce|unicode|"+"chr|frozenset|long|reload|vars|classmethod|getattr|map|repr|xrange|"+"cmp|globals|max|reversed|zip|compile|hasattr|memoryview|round|"+"__import__|complex|hash|min|set|apply|delattr|help|next|setattr|"+"buffer|dict|hex|object|slice|coerce|dir|id|oct|sorted|intern");var keywordMapper=this.createKeywordMapper({"invalid.deprecated":"debugger","support.function":builtinFunctions,"constant.language":builtinConstants,"keyword":keywords},"identifier");var strPre="(?:r|u|ur|R|U|UR|Ur|uR)?";var decimalInteger="(?:(?:[1-9]\\d*)|(?:0))";var octInteger="(?:0[oO]?[0-7]+)";var hexInteger="(?:0[xX][\\dA-Fa-f]+)";var binInteger="(?:0[bB][01]+)";var integer="(?:"+decimalInteger+"|"+octInteger+"|"+hexInteger+"|"+binInteger+")";var exponent="(?:[eE][+-]?\\d+)";var fraction="(?:\\.\\d+)";var intPart="(?:\\d+)";var pointFloat="(?:(?:"+intPart+"?"+fraction+")|(?:"+intPart+"\\.))";var exponentFloat="(?:(?:"+pointFloat+"|"+intPart+")"+exponent+")";var floatNumber="(?:"+exponentFloat+"|"+pointFloat+")";var stringEscape="\\\\(x[0-9A-Fa-f]{2}|[0-7]{3}|[\\\\abfnrtv'\"]|U[0-9A-Fa-f]{8}|u[0-9A-Fa-f]{4})";this.$rules={"start":[{token:"comment",regex:"#.*$"},{token:"string",regex:strPre+'"{3}',next:"qqstring3"},{token:"string",regex:strPre+'"(?=.)',next:"qqstring"},{token:"string",regex:strPre+"'{3}",next:"qstring3"},{token:"string",regex:strPre+"'(?=.)",next:"qstring"},{token:"constant.numeric",regex:"(?:"+floatNumber+"|\\d+)[jJ]\\b"},{token:"constant.numeric",regex:floatNumber},{token:"constant.numeric",regex:integer+"[lL]\\b"},{token:"constant.numeric",regex:integer+"\\b"},{token:keywordMapper,regex:"[a-zA-Z_$][a-zA-Z0-9_$]*\\b"},{token:"keyword.operator",regex:"\\+|\\-|\\*|\\*\\*|\\/|\\/\\/|%|<<|>>|&|\\||\\^|~|<|>|<=|=>|==|!=|<>|="},{token:"paren.lparen",regex:"[\\[\\(\\{]"},{token:"paren.rparen",regex:"[\\]\\)\\}]"},{token:"text",regex:"\\s+"}],"qqstring3":[{token:"constant.language.escape",regex:stringEscape},{token:"string",regex:'"{3}',next:"start"},{defaultToken:"string"}],"qstring3":[{token:"constant.language.escape",regex:stringEscape},{token:"string",regex:"'{3}",next:"start"},{defaultToken:"string"}],"qqstring":[{token:"constant.language.escape",regex:stringEscape},{token:"string",regex:"\\\\$",next:"qqstring"},{token:"string",regex:'"|$',next:"start"},{defaultToken:"string"}],"qstring":[{token:"constant.language.escape",regex:stringEscape},{token:"string",regex:"\\\\$",next:"qstring"},{token:"string",regex:"'|$",next:"start"},{defaultToken:"string"}]};};oop.inherits(PythonHighlightRules,TextHighlightRules);exports.PythonHighlightRules=PythonHighlightRules;});define("ace/mode/folding/pythonic",["require","exports","module","ace/lib/oop","ace/mode/folding/fold_mode"],function(require,exports,module){"use strict";var oop=require("../../lib/oop");var BaseFoldMode=require("./fold_mode").FoldMode;var FoldMode=exports.FoldMode=function(markers){this.foldingStartMarker=new RegExp("([\\[{])(?:\\s*)$|("+markers+")(?:\\s*)(?:#.*)?$");};oop.inherits(FoldMode,BaseFoldMode);(function(){this.getFoldWidgetRange=function(session,foldStyle,row){var line=session.getLine(row);var match=line.match(this.foldingStartMarker);if(match){if(match[1])
return this.openingBracketBlock(session,match[1],row,match.index);if(match[2])
return this.indentationBlock(session,row,match.index+match[2].length);return this.indentationBlock(session,row);}};}).call(FoldMode.prototype);});define("ace/mode/python",["require","exports","module","ace/lib/oop","ace/mode/text","ace/mode/python_highlight_rules","ace/mode/folding/pythonic","ace/range"],function(require,exports,module){"use strict";var oop=require("../lib/oop");var TextMode=require("./text").Mode;var PythonHighlightRules=require("./python_highlight_rules").PythonHighlightRules;var PythonFoldMode=require("./folding/pythonic").FoldMode;var Range=require("../range").Range;var Mode=function(){this.HighlightRules=PythonHighlightRules;this.foldingRules=new PythonFoldMode("\\:");this.$behaviour=this.$defaultBehaviour;};oop.inherits(Mode,TextMode);(function(){this.lineCommentStart="#";this.getNextLineIndent=function(state,line,tab){var indent=this.$getIndent(line);var tokenizedLine=this.getTokenizer().getLineTokens(line,state);var tokens=tokenizedLine.tokens;if(tokens.length&&tokens[tokens.length-1].type=="comment"){return indent;}
if(state=="start"){var match=line.match(/^.*[\{\(\[:]\s*$/);if(match){indent+=tab;}}
return indent;};var outdents={"pass":1,"return":1,"raise":1,"break":1,"continue":1};this.checkOutdent=function(state,line,input){if(input!=="\r\n"&&input!=="\r"&&input!=="\n")
return false;var tokens=this.getTokenizer().getLineTokens(line.trim(),state).tokens;if(!tokens)
return false;do{var last=tokens.pop();}while(last&&(last.type=="comment"||(last.type=="text"&&last.value.match(/^\s+$/))));if(!last)
return false;return(last.type=="keyword"&&outdents[last.value]);};this.autoOutdent=function(state,doc,row){row+=1;var indent=this.$getIndent(doc.getLine(row));var tab=doc.getTabString();if(indent.slice(-tab.length)==tab)
doc.remove(new Range(row,indent.length-tab.length,row,indent.length));};this.$id="ace/mode/python";}).call(Mode.prototype);exports.Mode=Mode;});;

/* /web/static/lib/ace/mode-xml.js defined in bundle 'web.tests_assets' */
define("ace/mode/xml_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/text_highlight_rules"],function(require,exports,module){"use strict";var oop=require("../lib/oop");var TextHighlightRules=require("./text_highlight_rules").TextHighlightRules;var XmlHighlightRules=function(normalize){var tagRegex="[_:a-zA-Z\xc0-\uffff][-_:.a-zA-Z0-9\xc0-\uffff]*";this.$rules={start:[{token:"string.cdata.xml",regex:"<\\!\\[CDATA\\[",next:"cdata"},{token:["punctuation.instruction.xml","keyword.instruction.xml"],regex:"(<\\?)("+tagRegex+")",next:"processing_instruction"},{token:"comment.start.xml",regex:"<\\!--",next:"comment"},{token:["xml-pe.doctype.xml","xml-pe.doctype.xml"],regex:"(<\\!)(DOCTYPE)(?=[\\s])",next:"doctype",caseInsensitive:true},{include:"tag"},{token:"text.end-tag-open.xml",regex:"</"},{token:"text.tag-open.xml",regex:"<"},{include:"reference"},{defaultToken:"text.xml"}],processing_instruction:[{token:"entity.other.attribute-name.decl-attribute-name.xml",regex:tagRegex},{token:"keyword.operator.decl-attribute-equals.xml",regex:"="},{include:"whitespace"},{include:"string"},{token:"punctuation.xml-decl.xml",regex:"\\?>",next:"start"}],doctype:[{include:"whitespace"},{include:"string"},{token:"xml-pe.doctype.xml",regex:">",next:"start"},{token:"xml-pe.xml",regex:"[-_a-zA-Z0-9:]+"},{token:"punctuation.int-subset",regex:"\\[",push:"int_subset"}],int_subset:[{token:"text.xml",regex:"\\s+"},{token:"punctuation.int-subset.xml",regex:"]",next:"pop"},{token:["punctuation.markup-decl.xml","keyword.markup-decl.xml"],regex:"(<\\!)("+tagRegex+")",push:[{token:"text",regex:"\\s+"},{token:"punctuation.markup-decl.xml",regex:">",next:"pop"},{include:"string"}]}],cdata:[{token:"string.cdata.xml",regex:"\\]\\]>",next:"start"},{token:"text.xml",regex:"\\s+"},{token:"text.xml",regex:"(?:[^\\]]|\\](?!\\]>))+"}],comment:[{token:"comment.end.xml",regex:"-->",next:"start"},{defaultToken:"comment.xml"}],reference:[{token:"constant.language.escape.reference.xml",regex:"(?:&#[0-9]+;)|(?:&#x[0-9a-fA-F]+;)|(?:&[a-zA-Z0-9_:\\.-]+;)"}],attr_reference:[{token:"constant.language.escape.reference.attribute-value.xml",regex:"(?:&#[0-9]+;)|(?:&#x[0-9a-fA-F]+;)|(?:&[a-zA-Z0-9_:\\.-]+;)"}],tag:[{token:["meta.tag.punctuation.tag-open.xml","meta.tag.punctuation.end-tag-open.xml","meta.tag.tag-name.xml"],regex:"(?:(<)|(</))((?:"+tagRegex+":)?"+tagRegex+")",next:[{include:"attributes"},{token:"meta.tag.punctuation.tag-close.xml",regex:"/?>",next:"start"}]}],tag_whitespace:[{token:"text.tag-whitespace.xml",regex:"\\s+"}],whitespace:[{token:"text.whitespace.xml",regex:"\\s+"}],string:[{token:"string.xml",regex:"'",push:[{token:"string.xml",regex:"'",next:"pop"},{defaultToken:"string.xml"}]},{token:"string.xml",regex:'"',push:[{token:"string.xml",regex:'"',next:"pop"},{defaultToken:"string.xml"}]}],attributes:[{token:"entity.other.attribute-name.xml",regex:tagRegex},{token:"keyword.operator.attribute-equals.xml",regex:"="},{include:"tag_whitespace"},{include:"attribute_value"}],attribute_value:[{token:"string.attribute-value.xml",regex:"'",push:[{token:"string.attribute-value.xml",regex:"'",next:"pop"},{include:"attr_reference"},{defaultToken:"string.attribute-value.xml"}]},{token:"string.attribute-value.xml",regex:'"',push:[{token:"string.attribute-value.xml",regex:'"',next:"pop"},{include:"attr_reference"},{defaultToken:"string.attribute-value.xml"}]}]};if(this.constructor===XmlHighlightRules)
this.normalizeRules();};(function(){this.embedTagRules=function(HighlightRules,prefix,tag){this.$rules.tag.unshift({token:["meta.tag.punctuation.tag-open.xml","meta.tag."+tag+".tag-name.xml"],regex:"(<)("+tag+"(?=\\s|>|$))",next:[{include:"attributes"},{token:"meta.tag.punctuation.tag-close.xml",regex:"/?>",next:prefix+"start"}]});this.$rules[tag+"-end"]=[{include:"attributes"},{token:"meta.tag.punctuation.tag-close.xml",regex:"/?>",next:"start",onMatch:function(value,currentState,stack){stack.splice(0);return this.token;}}];this.embedRules(HighlightRules,prefix,[{token:["meta.tag.punctuation.end-tag-open.xml","meta.tag."+tag+".tag-name.xml"],regex:"(</)("+tag+"(?=\\s|>|$))",next:tag+"-end"},{token:"string.cdata.xml",regex:"<\\!\\[CDATA\\["},{token:"string.cdata.xml",regex:"\\]\\]>"}]);};}).call(TextHighlightRules.prototype);oop.inherits(XmlHighlightRules,TextHighlightRules);exports.XmlHighlightRules=XmlHighlightRules;});define("ace/mode/behaviour/xml",["require","exports","module","ace/lib/oop","ace/mode/behaviour","ace/token_iterator","ace/lib/lang"],function(require,exports,module){"use strict";var oop=require("../../lib/oop");var Behaviour=require("../behaviour").Behaviour;var TokenIterator=require("../../token_iterator").TokenIterator;var lang=require("../../lib/lang");function is(token,type){return token&&token.type.lastIndexOf(type+".xml")>-1;}
var XmlBehaviour=function(){this.add("string_dquotes","insertion",function(state,action,editor,session,text){if(text=='"'||text=="'"){var quote=text;var selected=session.doc.getTextRange(editor.getSelectionRange());if(selected!==""&&selected!=="'"&&selected!='"'&&editor.getWrapBehavioursEnabled()){return{text:quote+selected+quote,selection:false};}
var cursor=editor.getCursorPosition();var line=session.doc.getLine(cursor.row);var rightChar=line.substring(cursor.column,cursor.column+1);var iterator=new TokenIterator(session,cursor.row,cursor.column);var token=iterator.getCurrentToken();if(rightChar==quote&&(is(token,"attribute-value")||is(token,"string"))){return{text:"",selection:[1,1]};}
if(!token)
token=iterator.stepBackward();if(!token)
return;while(is(token,"tag-whitespace")||is(token,"whitespace")){token=iterator.stepBackward();}
var rightSpace=!rightChar||rightChar.match(/\s/);if(is(token,"attribute-equals")&&(rightSpace||rightChar=='>')||(is(token,"decl-attribute-equals")&&(rightSpace||rightChar=='?'))){return{text:quote+quote,selection:[1,1]};}}});this.add("string_dquotes","deletion",function(state,action,editor,session,range){var selected=session.doc.getTextRange(range);if(!range.isMultiLine()&&(selected=='"'||selected=="'")){var line=session.doc.getLine(range.start.row);var rightChar=line.substring(range.start.column+1,range.start.column+2);if(rightChar==selected){range.end.column++;return range;}}});this.add("autoclosing","insertion",function(state,action,editor,session,text){if(text=='>'){var position=editor.getSelectionRange().start;var iterator=new TokenIterator(session,position.row,position.column);var token=iterator.getCurrentToken()||iterator.stepBackward();if(!token||!(is(token,"tag-name")||is(token,"tag-whitespace")||is(token,"attribute-name")||is(token,"attribute-equals")||is(token,"attribute-value")))
return;if(is(token,"reference.attribute-value"))
return;if(is(token,"attribute-value")){var tokenEndColumn=iterator.getCurrentTokenColumn()+token.value.length;if(position.column<tokenEndColumn)
return;if(position.column==tokenEndColumn){var nextToken=iterator.stepForward();if(nextToken&&is(nextToken,"attribute-value"))
return;iterator.stepBackward();}}
if(/^\s*>/.test(session.getLine(position.row).slice(position.column)))
return;while(!is(token,"tag-name")){token=iterator.stepBackward();if(token.value=="<"){token=iterator.stepForward();break;}}
var tokenRow=iterator.getCurrentTokenRow();var tokenColumn=iterator.getCurrentTokenColumn();if(is(iterator.stepBackward(),"end-tag-open"))
return;var element=token.value;if(tokenRow==position.row)
element=element.substring(0,position.column-tokenColumn);if(this.voidElements.hasOwnProperty(element.toLowerCase()))
return;return{text:">"+"</"+element+">",selection:[1,1]};}});this.add("autoindent","insertion",function(state,action,editor,session,text){if(text=="\n"){var cursor=editor.getCursorPosition();var line=session.getLine(cursor.row);var iterator=new TokenIterator(session,cursor.row,cursor.column);var token=iterator.getCurrentToken();if(token&&token.type.indexOf("tag-close")!==-1){if(token.value=="/>")
return;while(token&&token.type.indexOf("tag-name")===-1){token=iterator.stepBackward();}
if(!token){return;}
var tag=token.value;var row=iterator.getCurrentTokenRow();token=iterator.stepBackward();if(!token||token.type.indexOf("end-tag")!==-1){return;}
if(this.voidElements&&!this.voidElements[tag]){var nextToken=session.getTokenAt(cursor.row,cursor.column+1);var line=session.getLine(row);var nextIndent=this.$getIndent(line);var indent=nextIndent+session.getTabString();if(nextToken&&nextToken.value==="</"){return{text:"\n"+indent+"\n"+nextIndent,selection:[1,indent.length,1,indent.length]};}else{return{text:"\n"+indent};}}}}});};oop.inherits(XmlBehaviour,Behaviour);exports.XmlBehaviour=XmlBehaviour;});define("ace/mode/folding/xml",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/range","ace/mode/folding/fold_mode","ace/token_iterator"],function(require,exports,module){"use strict";var oop=require("../../lib/oop");var lang=require("../../lib/lang");var Range=require("../../range").Range;var BaseFoldMode=require("./fold_mode").FoldMode;var TokenIterator=require("../../token_iterator").TokenIterator;var FoldMode=exports.FoldMode=function(voidElements,optionalEndTags){BaseFoldMode.call(this);this.voidElements=voidElements||{};this.optionalEndTags=oop.mixin({},this.voidElements);if(optionalEndTags)
oop.mixin(this.optionalEndTags,optionalEndTags);};oop.inherits(FoldMode,BaseFoldMode);var Tag=function(){this.tagName="";this.closing=false;this.selfClosing=false;this.start={row:0,column:0};this.end={row:0,column:0};};function is(token,type){return token.type.lastIndexOf(type+".xml")>-1;}
(function(){this.getFoldWidget=function(session,foldStyle,row){var tag=this._getFirstTagInLine(session,row);if(!tag)
return this.getCommentFoldWidget(session,row);if(tag.closing||(!tag.tagName&&tag.selfClosing))
return foldStyle=="markbeginend"?"end":"";if(!tag.tagName||tag.selfClosing||this.voidElements.hasOwnProperty(tag.tagName.toLowerCase()))
return"";if(this._findEndTagInLine(session,row,tag.tagName,tag.end.column))
return"";return"start";};this.getCommentFoldWidget=function(session,row){if(/comment/.test(session.getState(row))&&/<!-/.test(session.getLine(row)))
return"start";return"";};this._getFirstTagInLine=function(session,row){var tokens=session.getTokens(row);var tag=new Tag();for(var i=0;i<tokens.length;i++){var token=tokens[i];if(is(token,"tag-open")){tag.end.column=tag.start.column+token.value.length;tag.closing=is(token,"end-tag-open");token=tokens[++i];if(!token)
return null;tag.tagName=token.value;tag.end.column+=token.value.length;for(i++;i<tokens.length;i++){token=tokens[i];tag.end.column+=token.value.length;if(is(token,"tag-close")){tag.selfClosing=token.value=='/>';break;}}
return tag;}else if(is(token,"tag-close")){tag.selfClosing=token.value=='/>';return tag;}
tag.start.column+=token.value.length;}
return null;};this._findEndTagInLine=function(session,row,tagName,startColumn){var tokens=session.getTokens(row);var column=0;for(var i=0;i<tokens.length;i++){var token=tokens[i];column+=token.value.length;if(column<startColumn)
continue;if(is(token,"end-tag-open")){token=tokens[i+1];if(token&&token.value==tagName)
return true;}}
return false;};this._readTagForward=function(iterator){var token=iterator.getCurrentToken();if(!token)
return null;var tag=new Tag();do{if(is(token,"tag-open")){tag.closing=is(token,"end-tag-open");tag.start.row=iterator.getCurrentTokenRow();tag.start.column=iterator.getCurrentTokenColumn();}else if(is(token,"tag-name")){tag.tagName=token.value;}else if(is(token,"tag-close")){tag.selfClosing=token.value=="/>";tag.end.row=iterator.getCurrentTokenRow();tag.end.column=iterator.getCurrentTokenColumn()+token.value.length;iterator.stepForward();return tag;}}while(token=iterator.stepForward());return null;};this._readTagBackward=function(iterator){var token=iterator.getCurrentToken();if(!token)
return null;var tag=new Tag();do{if(is(token,"tag-open")){tag.closing=is(token,"end-tag-open");tag.start.row=iterator.getCurrentTokenRow();tag.start.column=iterator.getCurrentTokenColumn();iterator.stepBackward();return tag;}else if(is(token,"tag-name")){tag.tagName=token.value;}else if(is(token,"tag-close")){tag.selfClosing=token.value=="/>";tag.end.row=iterator.getCurrentTokenRow();tag.end.column=iterator.getCurrentTokenColumn()+token.value.length;}}while(token=iterator.stepBackward());return null;};this._pop=function(stack,tag){while(stack.length){var top=stack[stack.length-1];if(!tag||top.tagName==tag.tagName){return stack.pop();}
else if(this.optionalEndTags.hasOwnProperty(top.tagName)){stack.pop();continue;}else{return null;}}};this.getFoldWidgetRange=function(session,foldStyle,row){var firstTag=this._getFirstTagInLine(session,row);if(!firstTag){return this.getCommentFoldWidget(session,row)&&session.getCommentFoldRange(row,session.getLine(row).length);}
var isBackward=firstTag.closing||firstTag.selfClosing;var stack=[];var tag;if(!isBackward){var iterator=new TokenIterator(session,row,firstTag.start.column);var start={row:row,column:firstTag.start.column+firstTag.tagName.length+2};if(firstTag.start.row==firstTag.end.row)
start.column=firstTag.end.column;while(tag=this._readTagForward(iterator)){if(tag.selfClosing){if(!stack.length){tag.start.column+=tag.tagName.length+2;tag.end.column-=2;return Range.fromPoints(tag.start,tag.end);}else
continue;}
if(tag.closing){this._pop(stack,tag);if(stack.length==0)
return Range.fromPoints(start,tag.start);}
else{stack.push(tag);}}}
else{var iterator=new TokenIterator(session,row,firstTag.end.column);var end={row:row,column:firstTag.start.column};while(tag=this._readTagBackward(iterator)){if(tag.selfClosing){if(!stack.length){tag.start.column+=tag.tagName.length+2;tag.end.column-=2;return Range.fromPoints(tag.start,tag.end);}else
continue;}
if(!tag.closing){this._pop(stack,tag);if(stack.length==0){tag.start.column+=tag.tagName.length+2;if(tag.start.row==tag.end.row&&tag.start.column<tag.end.column)
tag.start.column=tag.end.column;return Range.fromPoints(tag.start,end);}}
else{stack.push(tag);}}}};}).call(FoldMode.prototype);});define("ace/mode/xml",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/mode/text","ace/mode/xml_highlight_rules","ace/mode/behaviour/xml","ace/mode/folding/xml","ace/worker/worker_client"],function(require,exports,module){"use strict";var oop=require("../lib/oop");var lang=require("../lib/lang");var TextMode=require("./text").Mode;var XmlHighlightRules=require("./xml_highlight_rules").XmlHighlightRules;var XmlBehaviour=require("./behaviour/xml").XmlBehaviour;var XmlFoldMode=require("./folding/xml").FoldMode;var WorkerClient=require("../worker/worker_client").WorkerClient;var Mode=function(){this.HighlightRules=XmlHighlightRules;this.$behaviour=new XmlBehaviour();this.foldingRules=new XmlFoldMode();};oop.inherits(Mode,TextMode);(function(){this.voidElements=lang.arrayToMap([]);this.blockComment={start:"<!--",end:"-->"};this.createWorker=function(session){var worker=new WorkerClient(["ace"],"ace/mode/xml_worker","Worker");worker.attachToDocument(session.getDocument());worker.on("error",function(e){session.setAnnotations(e.data);});worker.on("terminate",function(){session.clearAnnotations();});return worker;};this.$id="ace/mode/xml";}).call(Mode.prototype);exports.Mode=Mode;});;

/* /web/static/lib/ace/mode-js.js defined in bundle 'web.tests_assets' */
define("ace/mode/javascript_highlight_rules",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/mode/doc_comment_highlight_rules","ace/mode/text_highlight_rules"],function(require,exports,module){"use strict";var oop=require("../lib/oop");var DocCommentHighlightRules=require("./doc_comment_highlight_rules").DocCommentHighlightRules;var TextHighlightRules=require("./text_highlight_rules").TextHighlightRules;var identifierRe="[a-zA-Z\\$_\u00a1-\uffff][a-zA-Z\\d\\$_\u00a1-\uffff]*";var JavaScriptHighlightRules=function(options){var keywordMapper=this.createKeywordMapper({"variable.language":"Array|Boolean|Date|Function|Iterator|Number|Object|RegExp|String|Proxy|"+"Namespace|QName|XML|XMLList|"+"ArrayBuffer|Float32Array|Float64Array|Int16Array|Int32Array|Int8Array|"+"Uint16Array|Uint32Array|Uint8Array|Uint8ClampedArray|"+"Error|EvalError|InternalError|RangeError|ReferenceError|StopIteration|"+"SyntaxError|TypeError|URIError|"+"decodeURI|decodeURIComponent|encodeURI|encodeURIComponent|eval|isFinite|"+"isNaN|parseFloat|parseInt|"+"JSON|Math|"+"this|arguments|prototype|window|document","keyword":"const|yield|import|get|set|async|await|"+"break|case|catch|continue|default|delete|do|else|finally|for|function|"+"if|in|of|instanceof|new|return|switch|throw|try|typeof|let|var|while|with|debugger|"+"__parent__|__count__|escape|unescape|with|__proto__|"+"class|enum|extends|super|export|implements|private|public|interface|package|protected|static","storage.type":"const|let|var|function","constant.language":"null|Infinity|NaN|undefined","support.function":"alert","constant.language.boolean":"true|false"},"identifier");var kwBeforeRe="case|do|else|finally|in|instanceof|return|throw|try|typeof|yield|void";var escapedRe="\\\\(?:x[0-9a-fA-F]{2}|"+"u[0-9a-fA-F]{4}|"+"u{[0-9a-fA-F]{1,6}}|"+"[0-2][0-7]{0,2}|"+"3[0-7][0-7]?|"+"[4-7][0-7]?|"+".)";this.$rules={"no_regex":[DocCommentHighlightRules.getStartRule("doc-start"),comments("no_regex"),{token:"string",regex:"'(?=.)",next:"qstring"},{token:"string",regex:'"(?=.)',next:"qqstring"},{token:"constant.numeric",regex:/0(?:[xX][0-9a-fA-F]+|[oO][0-7]+|[bB][01]+)\b/},{token:"constant.numeric",regex:/(?:\d\d*(?:\.\d*)?|\.\d+)(?:[eE][+-]?\d+\b)?/},{token:["storage.type","punctuation.operator","support.function","punctuation.operator","entity.name.function","text","keyword.operator"],regex:"("+identifierRe+")(\\.)(prototype)(\\.)("+identifierRe+")(\\s*)(=)",next:"function_arguments"},{token:["storage.type","punctuation.operator","entity.name.function","text","keyword.operator","text","storage.type","text","paren.lparen"],regex:"("+identifierRe+")(\\.)("+identifierRe+")(\\s*)(=)(\\s*)(function)(\\s*)(\\()",next:"function_arguments"},{token:["entity.name.function","text","keyword.operator","text","storage.type","text","paren.lparen"],regex:"("+identifierRe+")(\\s*)(=)(\\s*)(function)(\\s*)(\\()",next:"function_arguments"},{token:["storage.type","punctuation.operator","entity.name.function","text","keyword.operator","text","storage.type","text","entity.name.function","text","paren.lparen"],regex:"("+identifierRe+")(\\.)("+identifierRe+")(\\s*)(=)(\\s*)(function)(\\s+)(\\w+)(\\s*)(\\()",next:"function_arguments"},{token:["storage.type","text","entity.name.function","text","paren.lparen"],regex:"(function)(\\s+)("+identifierRe+")(\\s*)(\\()",next:"function_arguments"},{token:["entity.name.function","text","punctuation.operator","text","storage.type","text","paren.lparen"],regex:"("+identifierRe+")(\\s*)(:)(\\s*)(function)(\\s*)(\\()",next:"function_arguments"},{token:["text","text","storage.type","text","paren.lparen"],regex:"(:)(\\s*)(function)(\\s*)(\\()",next:"function_arguments"},{token:"keyword",regex:"from(?=\\s*('|\"))"},{token:"keyword",regex:"(?:"+kwBeforeRe+")\\b",next:"start"},{token:["support.constant"],regex:/that\b/},{token:["storage.type","punctuation.operator","support.function.firebug"],regex:/(console)(\.)(warn|info|log|error|time|trace|timeEnd|assert)\b/},{token:keywordMapper,regex:identifierRe},{token:"punctuation.operator",regex:/[.](?![.])/,next:"property"},{token:"storage.type",regex:/=>/,next:"start"},{token:"keyword.operator",regex:/--|\+\+|\.{3}|===|==|=|!=|!==|<+=?|>+=?|!|&&|\|\||\?:|[!$%&*+\-~\/^]=?/,next:"start"},{token:"punctuation.operator",regex:/[?:,;.]/,next:"start"},{token:"paren.lparen",regex:/[\[({]/,next:"start"},{token:"paren.rparen",regex:/[\])}]/},{token:"comment",regex:/^#!.*$/}],property:[{token:"text",regex:"\\s+"},{token:["storage.type","punctuation.operator","entity.name.function","text","keyword.operator","text","storage.type","text","entity.name.function","text","paren.lparen"],regex:"("+identifierRe+")(\\.)("+identifierRe+")(\\s*)(=)(\\s*)(function)(?:(\\s+)(\\w+))?(\\s*)(\\()",next:"function_arguments"},{token:"punctuation.operator",regex:/[.](?![.])/},{token:"support.function",regex:/(s(?:h(?:ift|ow(?:Mod(?:elessDialog|alDialog)|Help))|croll(?:X|By(?:Pages|Lines)?|Y|To)?|t(?:op|rike)|i(?:n|zeToContent|debar|gnText)|ort|u(?:p|b(?:str(?:ing)?)?)|pli(?:ce|t)|e(?:nd|t(?:Re(?:sizable|questHeader)|M(?:i(?:nutes|lliseconds)|onth)|Seconds|Ho(?:tKeys|urs)|Year|Cursor|Time(?:out)?|Interval|ZOptions|Date|UTC(?:M(?:i(?:nutes|lliseconds)|onth)|Seconds|Hours|Date|FullYear)|FullYear|Active)|arch)|qrt|lice|avePreferences|mall)|h(?:ome|andleEvent)|navigate|c(?:har(?:CodeAt|At)|o(?:s|n(?:cat|textual|firm)|mpile)|eil|lear(?:Timeout|Interval)?|a(?:ptureEvents|ll)|reate(?:StyleSheet|Popup|EventObject))|t(?:o(?:GMTString|S(?:tring|ource)|U(?:TCString|pperCase)|Lo(?:caleString|werCase))|est|a(?:n|int(?:Enabled)?))|i(?:s(?:NaN|Finite)|ndexOf|talics)|d(?:isableExternalCapture|ump|etachEvent)|u(?:n(?:shift|taint|escape|watch)|pdateCommands)|j(?:oin|avaEnabled)|p(?:o(?:p|w)|ush|lugins.refresh|a(?:ddings|rse(?:Int|Float)?)|r(?:int|ompt|eference))|e(?:scape|nableExternalCapture|val|lementFromPoint|x(?:p|ec(?:Script|Command)?))|valueOf|UTC|queryCommand(?:State|Indeterm|Enabled|Value)|f(?:i(?:nd|le(?:ModifiedDate|Size|CreatedDate|UpdatedDate)|xed)|o(?:nt(?:size|color)|rward)|loor|romCharCode)|watch|l(?:ink|o(?:ad|g)|astIndexOf)|a(?:sin|nchor|cos|t(?:tachEvent|ob|an(?:2)?)|pply|lert|b(?:s|ort))|r(?:ou(?:nd|teEvents)|e(?:size(?:By|To)|calc|turnValue|place|verse|l(?:oad|ease(?:Capture|Events)))|andom)|g(?:o|et(?:ResponseHeader|M(?:i(?:nutes|lliseconds)|onth)|Se(?:conds|lection)|Hours|Year|Time(?:zoneOffset)?|Da(?:y|te)|UTC(?:M(?:i(?:nutes|lliseconds)|onth)|Seconds|Hours|Da(?:y|te)|FullYear)|FullYear|A(?:ttention|llResponseHeaders)))|m(?:in|ove(?:B(?:y|elow)|To(?:Absolute)?|Above)|ergeAttributes|a(?:tch|rgins|x))|b(?:toa|ig|o(?:ld|rderWidths)|link|ack))\b(?=\()/},{token:"support.function.dom",regex:/(s(?:ub(?:stringData|mit)|plitText|e(?:t(?:NamedItem|Attribute(?:Node)?)|lect))|has(?:ChildNodes|Feature)|namedItem|c(?:l(?:ick|o(?:se|neNode))|reate(?:C(?:omment|DATASection|aption)|T(?:Head|extNode|Foot)|DocumentFragment|ProcessingInstruction|E(?:ntityReference|lement)|Attribute))|tabIndex|i(?:nsert(?:Row|Before|Cell|Data)|tem)|open|delete(?:Row|C(?:ell|aption)|T(?:Head|Foot)|Data)|focus|write(?:ln)?|a(?:dd|ppend(?:Child|Data))|re(?:set|place(?:Child|Data)|move(?:NamedItem|Child|Attribute(?:Node)?)?)|get(?:NamedItem|Element(?:sBy(?:Name|TagName|ClassName)|ById)|Attribute(?:Node)?)|blur)\b(?=\()/},{token:"support.constant",regex:/(s(?:ystemLanguage|cr(?:ipts|ollbars|een(?:X|Y|Top|Left))|t(?:yle(?:Sheets)?|atus(?:Text|bar)?)|ibling(?:Below|Above)|ource|uffixes|e(?:curity(?:Policy)?|l(?:ection|f)))|h(?:istory|ost(?:name)?|as(?:h|Focus))|y|X(?:MLDocument|SLDocument)|n(?:ext|ame(?:space(?:s|URI)|Prop))|M(?:IN_VALUE|AX_VALUE)|c(?:haracterSet|o(?:n(?:structor|trollers)|okieEnabled|lorDepth|mp(?:onents|lete))|urrent|puClass|l(?:i(?:p(?:boardData)?|entInformation)|osed|asses)|alle(?:e|r)|rypto)|t(?:o(?:olbar|p)|ext(?:Transform|Indent|Decoration|Align)|ags)|SQRT(?:1_2|2)|i(?:n(?:ner(?:Height|Width)|put)|ds|gnoreCase)|zIndex|o(?:scpu|n(?:readystatechange|Line)|uter(?:Height|Width)|p(?:sProfile|ener)|ffscreenBuffering)|NEGATIVE_INFINITY|d(?:i(?:splay|alog(?:Height|Top|Width|Left|Arguments)|rectories)|e(?:scription|fault(?:Status|Ch(?:ecked|arset)|View)))|u(?:ser(?:Profile|Language|Agent)|n(?:iqueID|defined)|pdateInterval)|_content|p(?:ixelDepth|ort|ersonalbar|kcs11|l(?:ugins|atform)|a(?:thname|dding(?:Right|Bottom|Top|Left)|rent(?:Window|Layer)?|ge(?:X(?:Offset)?|Y(?:Offset)?))|r(?:o(?:to(?:col|type)|duct(?:Sub)?|mpter)|e(?:vious|fix)))|e(?:n(?:coding|abledPlugin)|x(?:ternal|pando)|mbeds)|v(?:isibility|endor(?:Sub)?|Linkcolor)|URLUnencoded|P(?:I|OSITIVE_INFINITY)|f(?:ilename|o(?:nt(?:Size|Family|Weight)|rmName)|rame(?:s|Element)|gColor)|E|whiteSpace|l(?:i(?:stStyleType|n(?:eHeight|kColor))|o(?:ca(?:tion(?:bar)?|lName)|wsrc)|e(?:ngth|ft(?:Context)?)|a(?:st(?:M(?:odified|atch)|Index|Paren)|yer(?:s|X)|nguage))|a(?:pp(?:MinorVersion|Name|Co(?:deName|re)|Version)|vail(?:Height|Top|Width|Left)|ll|r(?:ity|guments)|Linkcolor|bove)|r(?:ight(?:Context)?|e(?:sponse(?:XML|Text)|adyState))|global|x|m(?:imeTypes|ultiline|enubar|argin(?:Right|Bottom|Top|Left))|L(?:N(?:10|2)|OG(?:10E|2E))|b(?:o(?:ttom|rder(?:Width|RightWidth|BottomWidth|Style|Color|TopWidth|LeftWidth))|ufferDepth|elow|ackground(?:Color|Image)))\b/},{token:"identifier",regex:identifierRe},{regex:"",token:"empty",next:"no_regex"}],"start":[DocCommentHighlightRules.getStartRule("doc-start"),comments("start"),{token:"string.regexp",regex:"\\/",next:"regex"},{token:"text",regex:"\\s+|^$",next:"start"},{token:"empty",regex:"",next:"no_regex"}],"regex":[{token:"regexp.keyword.operator",regex:"\\\\(?:u[\\da-fA-F]{4}|x[\\da-fA-F]{2}|.)"},{token:"string.regexp",regex:"/[sxngimy]*",next:"no_regex"},{token:"invalid",regex:/\{\d+\b,?\d*\}[+*]|[+*$^?][+*]|[$^][?]|\?{3,}/},{token:"constant.language.escape",regex:/\(\?[:=!]|\)|\{\d+\b,?\d*\}|[+*]\?|[()$^+*?.]/},{token:"constant.language.delimiter",regex:/\|/},{token:"constant.language.escape",regex:/\[\^?/,next:"regex_character_class"},{token:"empty",regex:"$",next:"no_regex"},{defaultToken:"string.regexp"}],"regex_character_class":[{token:"regexp.charclass.keyword.operator",regex:"\\\\(?:u[\\da-fA-F]{4}|x[\\da-fA-F]{2}|.)"},{token:"constant.language.escape",regex:"]",next:"regex"},{token:"constant.language.escape",regex:"-"},{token:"empty",regex:"$",next:"no_regex"},{defaultToken:"string.regexp.charachterclass"}],"function_arguments":[{token:"variable.parameter",regex:identifierRe},{token:"punctuation.operator",regex:"[, ]+"},{token:"punctuation.operator",regex:"$"},{token:"empty",regex:"",next:"no_regex"}],"qqstring":[{token:"constant.language.escape",regex:escapedRe},{token:"string",regex:"\\\\$",consumeLineEnd:true},{token:"string",regex:'"|$',next:"no_regex"},{defaultToken:"string"}],"qstring":[{token:"constant.language.escape",regex:escapedRe},{token:"string",regex:"\\\\$",consumeLineEnd:true},{token:"string",regex:"'|$",next:"no_regex"},{defaultToken:"string"}]};if(!options||!options.noES6){this.$rules.no_regex.unshift({regex:"[{}]",onMatch:function(val,state,stack){this.next=val=="{"?this.nextState:"";if(val=="{"&&stack.length){stack.unshift("start",state);}
else if(val=="}"&&stack.length){stack.shift();this.next=stack.shift();if(this.next.indexOf("string")!=-1||this.next.indexOf("jsx")!=-1)
return"paren.quasi.end";}
return val=="{"?"paren.lparen":"paren.rparen";},nextState:"start"},{token:"string.quasi.start",regex:/`/,push:[{token:"constant.language.escape",regex:escapedRe},{token:"paren.quasi.start",regex:/\${/,push:"start"},{token:"string.quasi.end",regex:/`/,next:"pop"},{defaultToken:"string.quasi"}]});if(!options||options.jsx!=false)
JSX.call(this);}
this.embedRules(DocCommentHighlightRules,"doc-",[DocCommentHighlightRules.getEndRule("no_regex")]);this.normalizeRules();};oop.inherits(JavaScriptHighlightRules,TextHighlightRules,DocCommentHighlightRules);function JSX(){var tagRegex=identifierRe.replace("\\d","\\d\\-");var jsxTag={onMatch:function(val,state,stack){var offset=val.charAt(1)=="/"?2:1;if(offset==1){if(state!=this.nextState)
stack.unshift(this.next,this.nextState,0);else
stack.unshift(this.next);stack[2]++;}else if(offset==2){if(state==this.nextState){stack[1]--;if(!stack[1]||stack[1]<0){stack.shift();stack.shift();}}}
return[{type:"meta.tag.punctuation."+(offset==1?"":"end-")+"tag-open.xml",value:val.slice(0,offset)},{type:"meta.tag.tag-name.xml",value:val.substr(offset)}];},regex:"</?"+tagRegex+"",next:"jsxAttributes",nextState:"jsx"};this.$rules.start.unshift(jsxTag);var jsxJsRule={regex:"{",token:"paren.quasi.start",push:"start"};this.$rules.jsx=[jsxJsRule,jsxTag,{include:"reference"},{defaultToken:"string"}];this.$rules.jsxAttributes=[{token:"meta.tag.punctuation.tag-close.xml",regex:"/?>",onMatch:function(value,currentState,stack){if(currentState==stack[0])
stack.shift();if(value.length==2){if(stack[0]==this.nextState)
stack[1]--;if(!stack[1]||stack[1]<0){stack.splice(0,2);}}
this.next=stack[0]||"start";return[{type:this.token,value:value}];},nextState:"jsx"},jsxJsRule,comments("jsxAttributes"),{token:"entity.other.attribute-name.xml",regex:tagRegex},{token:"keyword.operator.attribute-equals.xml",regex:"="},{token:"text.tag-whitespace.xml",regex:"\\s+"},{token:"string.attribute-value.xml",regex:"'",stateName:"jsx_attr_q",push:[{token:"string.attribute-value.xml",regex:"'",next:"pop"},{include:"reference"},{defaultToken:"string.attribute-value.xml"}]},{token:"string.attribute-value.xml",regex:'"',stateName:"jsx_attr_qq",push:[{token:"string.attribute-value.xml",regex:'"',next:"pop"},{include:"reference"},{defaultToken:"string.attribute-value.xml"}]},jsxTag];this.$rules.reference=[{token:"constant.language.escape.reference.xml",regex:"(?:&#[0-9]+;)|(?:&#x[0-9a-fA-F]+;)|(?:&[a-zA-Z0-9_:\\.-]+;)"}];}
function comments(next){return[{token:"comment",regex:/\/\*/,next:[DocCommentHighlightRules.getTagRule(),{token:"comment",regex:"\\*\\/",next:next||"pop"},{defaultToken:"comment",caseInsensitive:true}]},{token:"comment",regex:"\\/\\/",next:[DocCommentHighlightRules.getTagRule(),{token:"comment",regex:"$|^",next:next||"pop"},{defaultToken:"comment",caseInsensitive:true}]}];}
exports.JavaScriptHighlightRules=JavaScriptHighlightRules;});define("ace/mode/js",["require","exports","module","ace/lib/oop","ace/mode/text","ace/mode/javascript_highlight_rules","ace/mode/matching_brace_outdent","ace/mode/behaviour/js","ace/mode/folding/cstyle"],function(require,exports,module){"use strict";var oop=require("../lib/oop");var TextMode=require("./text").Mode;var JavaScriptHighlightRules=require("./javascript_highlight_rules").JavaScriptHighlightRules;var MatchingBraceOutdent=require("./matching_brace_outdent").MatchingBraceOutdent;var WorkerClient=require("../worker/worker_client").WorkerClient;var CstyleBehaviour=require("./behaviour/cstyle").CstyleBehaviour;var CStyleFoldMode=require("./folding/cstyle").FoldMode;var Mode=function(){this.HighlightRules=JavaScriptHighlightRules;this.$outdent=new MatchingBraceOutdent();this.$behaviour=new CstyleBehaviour();this.foldingRules=new CStyleFoldMode();};oop.inherits(Mode,TextMode);(function(){this.lineCommentStart="//";this.blockComment={start:"/*",end:"*/"};this.$quotes={'"':'"',"'":"'","`":"`"};this.getNextLineIndent=function(state,line,tab){var indent=this.$getIndent(line);var tokenizedLine=this.getTokenizer().getLineTokens(line,state);var tokens=tokenizedLine.tokens;var endState=tokenizedLine.state;if(tokens.length&&tokens[tokens.length-1].type=="comment"){return indent;}
if(state=="start"||state=="no_regex"){var match=line.match(/^.*(?:\bcase\b.*:|[\{\(\[])\s*$/);if(match){indent+=tab;}}else if(state=="doc-start"){if(endState=="start"||endState=="no_regex"){return"";}
var match=line.match(/^\s*(\/?)\*/);if(match){if(match[1]){indent+=" ";}
indent+="* ";}}
return indent;};this.checkOutdent=function(state,line,input){return this.$outdent.checkOutdent(line,input);};this.autoOutdent=function(state,doc,row){this.$outdent.autoOutdent(doc,row);};this.createWorker=function(session){var worker=new WorkerClient(["ace"],"ace/mode/javascript_worker","JavaScriptWorker");worker.attachToDocument(session.getDocument());worker.on("annotate",function(results){session.setAnnotations(results.data);});worker.on("terminate",function(){session.clearAnnotations();});return worker;};this.$id="ace/mode/javascript";}).call(Mode.prototype);exports.Mode=Mode;});;

/* /web/static/lib/nearest/jquery.nearest.js defined in bundle 'web.tests_assets' */
;(function($,undefined){var rPerc=/^([\d.]+)%$/;function nearest(selector,options,thisObj){selector||(selector='div');var $container=$(options.container),containerOffset=$container.offset()||{left:0,top:0},containerDims=[containerOffset.left+$container.width(),containerOffset.top+$container.height()],percProps={x:0,y:1,w:0,h:1},prop,match;for(prop in percProps)if(percProps.hasOwnProperty(prop)){match=rPerc.exec(options[prop]);if(match){options[prop]=containerDims[percProps[prop]]*match[1]/100;}}
var $all=$(selector),cache=[],furthest=!!options.furthest,checkX=!!options.checkHoriz,checkY=!!options.checkVert,compDist=furthest?0:Infinity,point1x=parseFloat(options.x)||0,point1y=parseFloat(options.y)||0,point2x=parseFloat(point1x+options.w)||point1x,point2y=parseFloat(point1y+options.h)||point1y,tolerance=options.tolerance||0,hasEach2=!!$.fn.each2,min=Math.min,max=Math.max;if(!options.includeSelf&&thisObj){$all=$all.not(thisObj);}
if(tolerance<0){tolerance=0;}
$all[hasEach2?'each2':'each'](function(i,elem){var $this=hasEach2?elem:$(this),off=$this.offset(),x=off.left,y=off.top,w=$this.outerWidth(),h=$this.outerHeight(),x2=x+w,y2=y+h,maxX1=max(x,point1x),minX2=min(x2,point2x),maxY1=max(y,point1y),minY2=min(y2,point2y),intersectX=minX2>=maxX1,intersectY=minY2>=maxY1,distX,distY,distT,isValid;if((checkX&&checkY)||(!checkX&&!checkY&&intersectX&&intersectY)||(checkX&&intersectY)||(checkY&&intersectX)){distX=intersectX?0:maxX1-minX2;distY=intersectY?0:maxY1-minY2;distT=intersectX||intersectY?max(distX,distY):Math.sqrt(distX*distX+distY*distY);isValid=furthest?distT>=compDist-tolerance:distT<=compDist+tolerance;if(isValid){compDist=furthest?max(compDist,distT):min(compDist,distT);cache.push({node:this,dist:distT});}}});var len=cache.length,filtered=[],compMin,compMax,i,item;if(len){if(furthest){compMin=compDist-tolerance;compMax=compDist;}else{compMin=compDist;compMax=compDist+tolerance;}
for(i=0;i<len;i++){item=cache[i];if(item.dist>=compMin&&item.dist<=compMax){filtered.push(item.node);}}}
return filtered;}
$.each(['nearest','furthest','touching'],function(i,name){var defaults={x:0,y:0,w:0,h:0,tolerance:1,container:document,furthest:name=='furthest',includeSelf:false,checkHoriz:name!='touching',checkVert:name!='touching'};$[name]=function(point,selector,options){if(!point||point.x===undefined||point.y===undefined){return $([]);}
var opts=$.extend({},defaults,point,options||{});return $(nearest(selector,opts));};$.fn[name]=function(selector,options){var opts;if(selector&&$.isPlainObject(selector)){opts=$.extend({},defaults,selector,options||{});return this.pushStack(nearest(this,opts));}
var offset=this.offset(),dimensions={x:offset.left,y:offset.top,w:this.outerWidth(),h:this.outerHeight()};opts=$.extend({},defaults,dimensions,options||{});return this.pushStack(nearest(selector,opts,this));};});})(jQuery);;

/* /web/static/lib/daterangepicker/daterangepicker.js defined in bundle 'web.tests_assets' */
(function(root,factory){if(typeof define==='function'&&define.amd){define(['moment','jquery'],function(moment,jquery){if(!jquery.fn)jquery.fn={};if(typeof moment!=='function'&&moment.default)moment=moment.default
return factory(moment,jquery);});}else if(typeof module==='object'&&module.exports){var jQuery=(typeof window!='undefined')?window.jQuery:undefined;if(!jQuery){jQuery=require('jquery');if(!jQuery.fn)jQuery.fn={};}
var moment=(typeof window!='undefined'&&typeof window.moment!='undefined')?window.moment:require('moment');module.exports=factory(moment,jQuery);}else{root.daterangepicker=factory(root.moment,root.jQuery);}}(this,function(moment,$){var DateRangePicker=function(element,options,cb){this.parentEl='body';this.element=$(element);this.startDate=moment().startOf('day');this.endDate=moment().endOf('day');this.minDate=false;this.maxDate=false;this.maxSpan=false;this.autoApply=false;this.singleDatePicker=false;this.showDropdowns=false;this.minYear=moment().subtract(100,'year').format('YYYY');this.maxYear=moment().add(100,'year').format('YYYY');this.showWeekNumbers=false;this.showISOWeekNumbers=false;this.showCustomRangeLabel=true;this.timePicker=false;this.timePicker24Hour=false;this.timePickerIncrement=1;this.timePickerSeconds=false;this.linkedCalendars=true;this.autoUpdateInput=true;this.alwaysShowCalendars=false;this.ranges={};this.opens='right';if(this.element.hasClass('pull-right'))
this.opens='left';this.drops='down';if(this.element.hasClass('dropup'))
this.drops='up';this.buttonClasses='btn btn-sm';this.applyButtonClasses='btn-primary';this.cancelButtonClasses='btn-default';this.locale={direction:'ltr',format:moment.localeData().longDateFormat('L'),separator:' - ',applyLabel:'Apply',cancelLabel:'Cancel',weekLabel:'W',customRangeLabel:'Custom Range',daysOfWeek:moment.weekdaysMin(),monthNames:moment.monthsShort(),firstDay:moment.localeData().firstDayOfWeek()};this.callback=function(){};this.isShowing=false;this.leftCalendar={};this.rightCalendar={};if(typeof options!=='object'||options===null)
options={};options=$.extend(this.element.data(),options);if(typeof options.template!=='string'&&!(options.template instanceof $))
options.template='<div class="daterangepicker">'+'<div class="ranges"></div>'+'<div class="drp-calendar left">'+'<div class="calendar-table"></div>'+'<div class="calendar-time"></div>'+'</div>'+'<div class="drp-calendar right">'+'<div class="calendar-table"></div>'+'<div class="calendar-time"></div>'+'</div>'+'<div class="drp-buttons">'+'<span class="drp-selected"></span>'+'<button class="cancelBtn" type="button"></button>'+'<button class="applyBtn" disabled="disabled" type="button"></button> '+'</div>'+'</div>';this.parentEl=(options.parentEl&&$(options.parentEl).length)?$(options.parentEl):$(this.parentEl);this.container=$(options.template).appendTo(this.parentEl);if(typeof options.locale==='object'){if(typeof options.locale.direction==='string')
this.locale.direction=options.locale.direction;if(typeof options.locale.format==='string')
this.locale.format=options.locale.format;if(typeof options.locale.separator==='string')
this.locale.separator=options.locale.separator;if(typeof options.locale.daysOfWeek==='object')
this.locale.daysOfWeek=options.locale.daysOfWeek.slice();if(typeof options.locale.monthNames==='object')
this.locale.monthNames=options.locale.monthNames.slice();if(typeof options.locale.firstDay==='number')
this.locale.firstDay=options.locale.firstDay;if(typeof options.locale.applyLabel==='string')
this.locale.applyLabel=options.locale.applyLabel;if(typeof options.locale.cancelLabel==='string')
this.locale.cancelLabel=options.locale.cancelLabel;if(typeof options.locale.weekLabel==='string')
this.locale.weekLabel=options.locale.weekLabel;if(typeof options.locale.customRangeLabel==='string'){var elem=document.createElement('textarea');elem.innerHTML=options.locale.customRangeLabel;var rangeHtml=elem.value;this.locale.customRangeLabel=rangeHtml;}}
this.container.addClass(this.locale.direction);if(typeof options.startDate==='string')
this.startDate=moment(options.startDate,this.locale.format);if(typeof options.endDate==='string')
this.endDate=moment(options.endDate,this.locale.format);if(typeof options.minDate==='string')
this.minDate=moment(options.minDate,this.locale.format);if(typeof options.maxDate==='string')
this.maxDate=moment(options.maxDate,this.locale.format);if(typeof options.startDate==='object')
this.startDate=moment(options.startDate);if(typeof options.endDate==='object')
this.endDate=moment(options.endDate);if(typeof options.minDate==='object')
this.minDate=moment(options.minDate);if(typeof options.maxDate==='object')
this.maxDate=moment(options.maxDate);if(this.minDate&&this.startDate.isBefore(this.minDate))
this.startDate=this.minDate.clone();if(this.maxDate&&this.endDate.isAfter(this.maxDate))
this.endDate=this.maxDate.clone();if(typeof options.applyButtonClasses==='string')
this.applyButtonClasses=options.applyButtonClasses;if(typeof options.applyClass==='string')
this.applyButtonClasses=options.applyClass;if(typeof options.cancelButtonClasses==='string')
this.cancelButtonClasses=options.cancelButtonClasses;if(typeof options.cancelClass==='string')
this.cancelButtonClasses=options.cancelClass;if(typeof options.maxSpan==='object')
this.maxSpan=options.maxSpan;if(typeof options.dateLimit==='object')
this.maxSpan=options.dateLimit;if(typeof options.opens==='string')
this.opens=options.opens;if(typeof options.drops==='string')
this.drops=options.drops;if(typeof options.showWeekNumbers==='boolean')
this.showWeekNumbers=options.showWeekNumbers;if(typeof options.showISOWeekNumbers==='boolean')
this.showISOWeekNumbers=options.showISOWeekNumbers;if(typeof options.buttonClasses==='string')
this.buttonClasses=options.buttonClasses;if(typeof options.buttonClasses==='object')
this.buttonClasses=options.buttonClasses.join(' ');if(typeof options.showDropdowns==='boolean')
this.showDropdowns=options.showDropdowns;if(typeof options.minYear==='number')
this.minYear=options.minYear;if(typeof options.maxYear==='number')
this.maxYear=options.maxYear;if(typeof options.showCustomRangeLabel==='boolean')
this.showCustomRangeLabel=options.showCustomRangeLabel;if(typeof options.singleDatePicker==='boolean'){this.singleDatePicker=options.singleDatePicker;if(this.singleDatePicker)
this.endDate=this.startDate.clone();}
if(typeof options.timePicker==='boolean')
this.timePicker=options.timePicker;if(typeof options.timePickerSeconds==='boolean')
this.timePickerSeconds=options.timePickerSeconds;if(typeof options.timePickerIncrement==='number')
this.timePickerIncrement=options.timePickerIncrement;if(typeof options.timePicker24Hour==='boolean')
this.timePicker24Hour=options.timePicker24Hour;if(typeof options.autoApply==='boolean')
this.autoApply=options.autoApply;if(typeof options.autoUpdateInput==='boolean')
this.autoUpdateInput=options.autoUpdateInput;if(typeof options.linkedCalendars==='boolean')
this.linkedCalendars=options.linkedCalendars;if(typeof options.isInvalidDate==='function')
this.isInvalidDate=options.isInvalidDate;if(typeof options.isCustomDate==='function')
this.isCustomDate=options.isCustomDate;if(typeof options.alwaysShowCalendars==='boolean')
this.alwaysShowCalendars=options.alwaysShowCalendars;if(this.locale.firstDay!=0){var iterator=this.locale.firstDay;while(iterator>0){this.locale.daysOfWeek.push(this.locale.daysOfWeek.shift());iterator--;}}
var start,end,range;if(typeof options.startDate==='undefined'&&typeof options.endDate==='undefined'){if($(this.element).is(':text')){var val=$(this.element).val(),split=val.split(this.locale.separator);start=end=null;if(split.length==2){start=moment(split[0],this.locale.format);end=moment(split[1],this.locale.format);}else if(this.singleDatePicker&&val!==""){start=moment(val,this.locale.format);end=moment(val,this.locale.format);}
if(start!==null&&end!==null){this.setStartDate(start);this.setEndDate(end);}}}
if(typeof options.ranges==='object'){for(range in options.ranges){if(typeof options.ranges[range][0]==='string')
start=moment(options.ranges[range][0],this.locale.format);else
start=moment(options.ranges[range][0]);if(typeof options.ranges[range][1]==='string')
end=moment(options.ranges[range][1],this.locale.format);else
end=moment(options.ranges[range][1]);if(this.minDate&&start.isBefore(this.minDate))
start=this.minDate.clone();var maxDate=this.maxDate;if(this.maxSpan&&maxDate&&start.clone().add(this.maxSpan).isAfter(maxDate))
maxDate=start.clone().add(this.maxSpan);if(maxDate&&end.isAfter(maxDate))
end=maxDate.clone();if((this.minDate&&end.isBefore(this.minDate,this.timepicker?'minute':'day'))||(maxDate&&start.isAfter(maxDate,this.timepicker?'minute':'day')))
continue;var elem=document.createElement('textarea');elem.innerHTML=range;var rangeHtml=elem.value;this.ranges[rangeHtml]=[start,end];}
var list='<ul>';for(range in this.ranges){list+='<li data-range-key="'+range+'">'+range+'</li>';}
if(this.showCustomRangeLabel){list+='<li data-range-key="'+this.locale.customRangeLabel+'">'+this.locale.customRangeLabel+'</li>';}
list+='</ul>';this.container.find('.ranges').prepend(list);}
if(typeof cb==='function'){this.callback=cb;}
if(!this.timePicker){this.startDate=this.startDate.startOf('day');this.endDate=this.endDate.endOf('day');this.container.find('.calendar-time').hide();}
if(this.timePicker&&this.autoApply)
this.autoApply=false;if(this.autoApply){this.container.addClass('auto-apply');}
if(typeof options.ranges==='object')
this.container.addClass('show-ranges');if(this.singleDatePicker){this.container.addClass('single');this.container.find('.drp-calendar.left').addClass('single');this.container.find('.drp-calendar.left').show();this.container.find('.drp-calendar.right').hide();if(!this.timePicker){this.container.addClass('auto-apply');}}
if((typeof options.ranges==='undefined'&&!this.singleDatePicker)||this.alwaysShowCalendars){this.container.addClass('show-calendar');}
this.container.addClass('opens'+this.opens);this.container.find('.applyBtn, .cancelBtn').addClass(this.buttonClasses);if(this.applyButtonClasses.length)
this.container.find('.applyBtn').addClass(this.applyButtonClasses);if(this.cancelButtonClasses.length)
this.container.find('.cancelBtn').addClass(this.cancelButtonClasses);this.container.find('.applyBtn').html(this.locale.applyLabel);this.container.find('.cancelBtn').html(this.locale.cancelLabel);this.container.find('.drp-calendar').on('click.daterangepicker','.prev',$.proxy(this.clickPrev,this)).on('click.daterangepicker','.next',$.proxy(this.clickNext,this)).on('mousedown.daterangepicker','td.available',$.proxy(this.clickDate,this)).on('mouseenter.daterangepicker','td.available',$.proxy(this.hoverDate,this)).on('change.daterangepicker','select.yearselect',$.proxy(this.monthOrYearChanged,this)).on('change.daterangepicker','select.monthselect',$.proxy(this.monthOrYearChanged,this)).on('change.daterangepicker','select.hourselect,select.minuteselect,select.secondselect,select.ampmselect',$.proxy(this.timeChanged,this))
this.container.find('.ranges').on('click.daterangepicker','li',$.proxy(this.clickRange,this))
this.container.find('.drp-buttons').on('click.daterangepicker','button.applyBtn',$.proxy(this.clickApply,this)).on('click.daterangepicker','button.cancelBtn',$.proxy(this.clickCancel,this))
if(this.element.is('input')||this.element.is('button')){this.element.on({'click.daterangepicker':$.proxy(this.show,this),'keyup.daterangepicker':$.proxy(this.elementChanged,this),'keydown.daterangepicker':$.proxy(this.keydown,this)});}else{this.element.on('click.daterangepicker',$.proxy(this.toggle,this));this.element.on('keydown.daterangepicker',$.proxy(this.toggle,this));}
this.updateElement();};DateRangePicker.prototype={constructor:DateRangePicker,setStartDate:function(startDate){if(typeof startDate==='string')
this.startDate=moment(startDate,this.locale.format);if(typeof startDate==='object')
this.startDate=moment(startDate);if(!this.timePicker)
this.startDate=this.startDate.startOf('day');if(this.timePicker&&this.timePickerIncrement)
this.startDate.minute(Math.round(this.startDate.minute()/this.timePickerIncrement)*this.timePickerIncrement);if(this.minDate&&this.startDate.isBefore(this.minDate)){this.startDate=this.minDate.clone();if(this.timePicker&&this.timePickerIncrement)
this.startDate.minute(Math.round(this.startDate.minute()/this.timePickerIncrement)*this.timePickerIncrement);}
if(this.maxDate&&this.startDate.isAfter(this.maxDate)){this.startDate=this.maxDate.clone();if(this.timePicker&&this.timePickerIncrement)
this.startDate.minute(Math.floor(this.startDate.minute()/this.timePickerIncrement)*this.timePickerIncrement);}
if(!this.isShowing)
this.updateElement();this.updateMonthsInView();},setEndDate:function(endDate){if(typeof endDate==='string')
this.endDate=moment(endDate,this.locale.format);if(typeof endDate==='object')
this.endDate=moment(endDate);if(!this.timePicker)
this.endDate=this.endDate.endOf('day');if(this.timePicker&&this.timePickerIncrement)
this.endDate.minute(Math.round(this.endDate.minute()/this.timePickerIncrement)*this.timePickerIncrement);if(this.endDate.isBefore(this.startDate))
this.endDate=this.startDate.clone();if(this.maxDate&&this.endDate.isAfter(this.maxDate))
this.endDate=this.maxDate.clone();if(this.maxSpan&&this.startDate.clone().add(this.maxSpan).isBefore(this.endDate))
this.endDate=this.startDate.clone().add(this.maxSpan);this.previousRightTime=this.endDate.clone();this.container.find('.drp-selected').html(this.startDate.format(this.locale.format)+this.locale.separator+this.endDate.format(this.locale.format));if(!this.isShowing)
this.updateElement();this.updateMonthsInView();},isInvalidDate:function(){return false;},isCustomDate:function(){return false;},updateView:function(){if(this.timePicker){this.renderTimePicker('left');this.renderTimePicker('right');if(!this.endDate){this.container.find('.right .calendar-time select').attr('disabled','disabled').addClass('disabled');}else{this.container.find('.right .calendar-time select').removeAttr('disabled').removeClass('disabled');}}
if(this.endDate)
this.container.find('.drp-selected').html(this.startDate.format(this.locale.format)+this.locale.separator+this.endDate.format(this.locale.format));this.updateMonthsInView();this.updateCalendars();this.updateFormInputs();},updateMonthsInView:function(){if(this.endDate){if(!this.singleDatePicker&&this.leftCalendar.month&&this.rightCalendar.month&&(this.startDate.format('YYYY-MM')==this.leftCalendar.month.format('YYYY-MM')||this.startDate.format('YYYY-MM')==this.rightCalendar.month.format('YYYY-MM'))&&(this.endDate.format('YYYY-MM')==this.leftCalendar.month.format('YYYY-MM')||this.endDate.format('YYYY-MM')==this.rightCalendar.month.format('YYYY-MM'))){return;}
this.leftCalendar.month=this.startDate.clone().date(2);if(!this.linkedCalendars&&(this.endDate.month()!=this.startDate.month()||this.endDate.year()!=this.startDate.year())){this.rightCalendar.month=this.endDate.clone().date(2);}else{this.rightCalendar.month=this.startDate.clone().date(2).add(1,'month');}}else{if(this.leftCalendar.month.format('YYYY-MM')!=this.startDate.format('YYYY-MM')&&this.rightCalendar.month.format('YYYY-MM')!=this.startDate.format('YYYY-MM')){this.leftCalendar.month=this.startDate.clone().date(2);this.rightCalendar.month=this.startDate.clone().date(2).add(1,'month');}}
if(this.maxDate&&this.linkedCalendars&&!this.singleDatePicker&&this.rightCalendar.month>this.maxDate){this.rightCalendar.month=this.maxDate.clone().date(2);this.leftCalendar.month=this.maxDate.clone().date(2).subtract(1,'month');}},updateCalendars:function(){if(this.timePicker){var hour,minute,second;if(this.endDate){hour=parseInt(this.container.find('.left .hourselect').val(),10);minute=parseInt(this.container.find('.left .minuteselect').val(),10);if(isNaN(minute)){minute=parseInt(this.container.find('.left .minuteselect option:last').val(),10);}
second=this.timePickerSeconds?parseInt(this.container.find('.left .secondselect').val(),10):0;if(!this.timePicker24Hour){var ampm=this.container.find('.left .ampmselect').val();if(ampm==='PM'&&hour<12)
hour+=12;if(ampm==='AM'&&hour===12)
hour=0;}}else{hour=parseInt(this.container.find('.right .hourselect').val(),10);minute=parseInt(this.container.find('.right .minuteselect').val(),10);if(isNaN(minute)){minute=parseInt(this.container.find('.right .minuteselect option:last').val(),10);}
second=this.timePickerSeconds?parseInt(this.container.find('.right .secondselect').val(),10):0;if(!this.timePicker24Hour){var ampm=this.container.find('.right .ampmselect').val();if(ampm==='PM'&&hour<12)
hour+=12;if(ampm==='AM'&&hour===12)
hour=0;}}
this.leftCalendar.month.hour(hour).minute(minute).second(second);this.rightCalendar.month.hour(hour).minute(minute).second(second);}
this.renderCalendar('left');this.renderCalendar('right');this.container.find('.ranges li').removeClass('active');if(this.endDate==null)return;this.calculateChosenLabel();},renderCalendar:function(side){var calendar=side=='left'?this.leftCalendar:this.rightCalendar;var month=calendar.month.month();var year=calendar.month.year();var hour=calendar.month.hour();var minute=calendar.month.minute();var second=calendar.month.second();var daysInMonth=moment([year,month]).daysInMonth();var firstDay=moment([year,month,1]);var lastDay=moment([year,month,daysInMonth]);var lastMonth=moment(firstDay).subtract(1,'month').month();var lastYear=moment(firstDay).subtract(1,'month').year();var daysInLastMonth=moment([lastYear,lastMonth]).daysInMonth();var dayOfWeek=firstDay.day();var calendar=[];calendar.firstDay=firstDay;calendar.lastDay=lastDay;for(var i=0;i<6;i++){calendar[i]=[];}
var startDay=daysInLastMonth-dayOfWeek+this.locale.firstDay+1;if(startDay>daysInLastMonth)
startDay-=7;if(dayOfWeek==this.locale.firstDay)
startDay=daysInLastMonth-6;var curDate=moment([lastYear,lastMonth,startDay,12,minute,second]);var col,row;for(var i=0,col=0,row=0;i<42;i++,col++,curDate=moment(curDate).add(24,'hour')){if(i>0&&col%7===0){col=0;row++;}
calendar[row][col]=curDate.clone().hour(hour).minute(minute).second(second);curDate.hour(12);if(this.minDate&&calendar[row][col].format('YYYY-MM-DD')==this.minDate.format('YYYY-MM-DD')&&calendar[row][col].isBefore(this.minDate)&&side=='left'){calendar[row][col]=this.minDate.clone();}
if(this.maxDate&&calendar[row][col].format('YYYY-MM-DD')==this.maxDate.format('YYYY-MM-DD')&&calendar[row][col].isAfter(this.maxDate)&&side=='right'){calendar[row][col]=this.maxDate.clone();}}
if(side=='left'){this.leftCalendar.calendar=calendar;}else{this.rightCalendar.calendar=calendar;}
var minDate=side=='left'?this.minDate:this.startDate;var maxDate=this.maxDate;var selected=side=='left'?this.startDate:this.endDate;var arrow=this.locale.direction=='ltr'?{left:'chevron-left',right:'chevron-right'}:{left:'chevron-right',right:'chevron-left'};var html='<table class="table-condensed">';html+='<thead>';html+='<tr>';if(this.showWeekNumbers||this.showISOWeekNumbers)
html+='<th></th>';if((!minDate||minDate.isBefore(calendar.firstDay))&&(!this.linkedCalendars||side=='left')){html+='<th class="prev available"><span></span></th>';}else{html+='<th></th>';}
var dateHtml=this.locale.monthNames[calendar[1][1].month()]+calendar[1][1].format(" YYYY");if(this.showDropdowns){var currentMonth=calendar[1][1].month();var currentYear=calendar[1][1].year();var maxYear=(maxDate&&maxDate.year())||(this.maxYear);var minYear=(minDate&&minDate.year())||(this.minYear);var inMinYear=currentYear==minYear;var inMaxYear=currentYear==maxYear;var monthHtml='<select class="monthselect">';for(var m=0;m<12;m++){if((!inMinYear||(minDate&&m>=minDate.month()))&&(!inMaxYear||(maxDate&&m<=maxDate.month()))){monthHtml+="<option value='"+m+"'"+
(m===currentMonth?" selected='selected'":"")+">"+this.locale.monthNames[m]+"</option>";}else{monthHtml+="<option value='"+m+"'"+
(m===currentMonth?" selected='selected'":"")+" disabled='disabled'>"+this.locale.monthNames[m]+"</option>";}}
monthHtml+="</select>";var yearHtml='<select class="yearselect">';for(var y=minYear;y<=maxYear;y++){yearHtml+='<option value="'+y+'"'+
(y===currentYear?' selected="selected"':'')+'>'+y+'</option>';}
yearHtml+='</select>';dateHtml=monthHtml+yearHtml;}
html+='<th colspan="5" class="month">'+dateHtml+'</th>';if((!maxDate||maxDate.isAfter(calendar.lastDay))&&(!this.linkedCalendars||side=='right'||this.singleDatePicker)){html+='<th class="next available"><span></span></th>';}else{html+='<th></th>';}
html+='</tr>';html+='<tr>';if(this.showWeekNumbers||this.showISOWeekNumbers)
html+='<th class="week">'+this.locale.weekLabel+'</th>';$.each(this.locale.daysOfWeek,function(index,dayOfWeek){html+='<th>'+dayOfWeek+'</th>';});html+='</tr>';html+='</thead>';html+='<tbody>';if(this.endDate==null&&this.maxSpan){var maxLimit=this.startDate.clone().add(this.maxSpan).endOf('day');if(!maxDate||maxLimit.isBefore(maxDate)){maxDate=maxLimit;}}
for(var row=0;row<6;row++){html+='<tr>';if(this.showWeekNumbers)
html+='<td class="week">'+calendar[row][0].week()+'</td>';else if(this.showISOWeekNumbers)
html+='<td class="week">'+calendar[row][0].isoWeek()+'</td>';for(var col=0;col<7;col++){var classes=[];if(calendar[row][col].isSame(new Date(),"day"))
classes.push('today');if(calendar[row][col].isoWeekday()>5)
classes.push('weekend');if(calendar[row][col].month()!=calendar[1][1].month())
classes.push('off','ends');if(this.minDate&&calendar[row][col].isBefore(this.minDate,'day'))
classes.push('off','disabled');if(maxDate&&calendar[row][col].isAfter(maxDate,'day'))
classes.push('off','disabled');if(this.isInvalidDate(calendar[row][col]))
classes.push('off','disabled');if(calendar[row][col].format('YYYY-MM-DD')==this.startDate.format('YYYY-MM-DD'))
classes.push('active','start-date');if(this.endDate!=null&&calendar[row][col].format('YYYY-MM-DD')==this.endDate.format('YYYY-MM-DD'))
classes.push('active','end-date');if(this.endDate!=null&&calendar[row][col]>this.startDate&&calendar[row][col]<this.endDate)
classes.push('in-range');var isCustom=this.isCustomDate(calendar[row][col]);if(isCustom!==false){if(typeof isCustom==='string')
classes.push(isCustom);else
Array.prototype.push.apply(classes,isCustom);}
var cname='',disabled=false;for(var i=0;i<classes.length;i++){cname+=classes[i]+' ';if(classes[i]=='disabled')
disabled=true;}
if(!disabled)
cname+='available';html+='<td class="'+cname.replace(/^\s+|\s+$/g,'')+'" data-title="'+'r'+row+'c'+col+'">'+calendar[row][col].date()+'</td>';}
html+='</tr>';}
html+='</tbody>';html+='</table>';this.container.find('.drp-calendar.'+side+' .calendar-table').html(html);},renderTimePicker:function(side){if(side=='right'&&!this.endDate)return;var html,selected,minDate,maxDate=this.maxDate;if(this.maxSpan&&(!this.maxDate||this.startDate.clone().add(this.maxSpan).isBefore(this.maxDate)))
maxDate=this.startDate.clone().add(this.maxSpan);if(side=='left'){selected=this.startDate.clone();minDate=this.minDate;}else if(side=='right'){selected=this.endDate.clone();minDate=this.startDate;var timeSelector=this.container.find('.drp-calendar.right .calendar-time');if(timeSelector.html()!=''){selected.hour(!isNaN(selected.hour())?selected.hour():timeSelector.find('.hourselect option:selected').val());selected.minute(!isNaN(selected.minute())?selected.minute():timeSelector.find('.minuteselect option:selected').val());selected.second(!isNaN(selected.second())?selected.second():timeSelector.find('.secondselect option:selected').val());if(!this.timePicker24Hour){var ampm=timeSelector.find('.ampmselect option:selected').val();if(ampm==='PM'&&selected.hour()<12)
selected.hour(selected.hour()+12);if(ampm==='AM'&&selected.hour()===12)
selected.hour(0);}}
if(selected.isBefore(this.startDate))
selected=this.startDate.clone();if(maxDate&&selected.isAfter(maxDate))
selected=maxDate.clone();}
html='<select class="hourselect">';var start=this.timePicker24Hour?0:1;var end=this.timePicker24Hour?23:12;for(var i=start;i<=end;i++){var i_in_24=i;if(!this.timePicker24Hour)
i_in_24=selected.hour()>=12?(i==12?12:i+12):(i==12?0:i);var time=selected.clone().hour(i_in_24);var disabled=false;if(minDate&&time.minute(59).isBefore(minDate))
disabled=true;if(maxDate&&time.minute(0).isAfter(maxDate))
disabled=true;if(i_in_24==selected.hour()&&!disabled){html+='<option value="'+i+'" selected="selected">'+i+'</option>';}else if(disabled){html+='<option value="'+i+'" disabled="disabled" class="disabled">'+i+'</option>';}else{html+='<option value="'+i+'">'+i+'</option>';}}
html+='</select> ';html+=': <select class="minuteselect">';for(var i=0;i<60;i+=this.timePickerIncrement){var padded=i<10?'0'+i:i;var time=selected.clone().minute(i);var disabled=false;if(minDate&&time.second(59).isBefore(minDate))
disabled=true;if(maxDate&&time.second(0).isAfter(maxDate))
disabled=true;if(selected.minute()==i&&!disabled){html+='<option value="'+i+'" selected="selected">'+padded+'</option>';}else if(disabled){html+='<option value="'+i+'" disabled="disabled" class="disabled">'+padded+'</option>';}else{html+='<option value="'+i+'">'+padded+'</option>';}}
html+='</select> ';if(this.timePickerSeconds){html+=': <select class="secondselect">';for(var i=0;i<60;i++){var padded=i<10?'0'+i:i;var time=selected.clone().second(i);var disabled=false;if(minDate&&time.isBefore(minDate))
disabled=true;if(maxDate&&time.isAfter(maxDate))
disabled=true;if(selected.second()==i&&!disabled){html+='<option value="'+i+'" selected="selected">'+padded+'</option>';}else if(disabled){html+='<option value="'+i+'" disabled="disabled" class="disabled">'+padded+'</option>';}else{html+='<option value="'+i+'">'+padded+'</option>';}}
html+='</select> ';}
if(!this.timePicker24Hour){html+='<select class="ampmselect">';var am_html='';var pm_html='';if(minDate&&selected.clone().hour(12).minute(0).second(0).isBefore(minDate))
am_html=' disabled="disabled" class="disabled"';if(maxDate&&selected.clone().hour(0).minute(0).second(0).isAfter(maxDate))
pm_html=' disabled="disabled" class="disabled"';if(selected.hour()>=12){html+='<option value="AM"'+am_html+'>AM</option><option value="PM" selected="selected"'+pm_html+'>PM</option>';}else{html+='<option value="AM" selected="selected"'+am_html+'>AM</option><option value="PM"'+pm_html+'>PM</option>';}
html+='</select>';}
this.container.find('.drp-calendar.'+side+' .calendar-time').html(html);},updateFormInputs:function(){if(this.singleDatePicker||(this.endDate&&(this.startDate.isBefore(this.endDate)||this.startDate.isSame(this.endDate)))){this.container.find('button.applyBtn').removeAttr('disabled');}else{this.container.find('button.applyBtn').attr('disabled','disabled');}},move:function(){var parentOffset={top:0,left:0},containerTop;var parentRightEdge=$(window).width();if(!this.parentEl.is('body')){parentOffset={top:this.parentEl.offset().top-this.parentEl.scrollTop(),left:this.parentEl.offset().left-this.parentEl.scrollLeft()};parentRightEdge=this.parentEl[0].clientWidth+this.parentEl.offset().left;}
if(this.drops=='up')
containerTop=this.element.offset().top-this.container.outerHeight()-parentOffset.top;else
containerTop=this.element.offset().top+this.element.outerHeight()-parentOffset.top;this.container.css({top:0,left:0,right:'auto'});var containerWidth=this.container.outerWidth();this.container[this.drops=='up'?'addClass':'removeClass']('drop-up');if(this.opens=='left'){var containerRight=parentRightEdge-this.element.offset().left-this.element.outerWidth();if(containerWidth+containerRight>$(window).width()){this.container.css({top:containerTop,right:'auto',left:9});}else{this.container.css({top:containerTop,right:containerRight,left:'auto'});}}else if(this.opens=='center'){var containerLeft=this.element.offset().left-parentOffset.left+this.element.outerWidth()/2
-containerWidth/2;if(containerLeft<0){this.container.css({top:containerTop,right:'auto',left:9});}else if(containerLeft+containerWidth>$(window).width()){this.container.css({top:containerTop,left:'auto',right:0});}else{this.container.css({top:containerTop,left:containerLeft,right:'auto'});}}else{var containerLeft=this.element.offset().left-parentOffset.left;if(containerLeft+containerWidth>$(window).width()){this.container.css({top:containerTop,left:'auto',right:0});}else{this.container.css({top:containerTop,left:containerLeft,right:'auto'});}}},show:function(e){if(this.isShowing)return;this._outsideClickProxy=$.proxy(function(e){this.outsideClick(e);},this);$(document).on('mousedown.daterangepicker',this._outsideClickProxy).on('touchend.daterangepicker',this._outsideClickProxy).on('click.daterangepicker','[data-toggle=dropdown]',this._outsideClickProxy).on('focusin.daterangepicker',this._outsideClickProxy);$(window).on('resize.daterangepicker',$.proxy(function(e){this.move(e);},this));this.oldStartDate=this.startDate.clone();this.oldEndDate=this.endDate.clone();this.previousRightTime=this.endDate.clone();this.updateView();this.container.show();this.move();this.element.trigger('show.daterangepicker',this);this.isShowing=true;},hide:function(e){if(!this.isShowing)return;if(!this.endDate){this.startDate=this.oldStartDate.clone();this.endDate=this.oldEndDate.clone();}
if(!this.startDate.isSame(this.oldStartDate)||!this.endDate.isSame(this.oldEndDate))
this.callback(this.startDate.clone(),this.endDate.clone(),this.chosenLabel);this.updateElement();$(document).off('.daterangepicker');$(window).off('.daterangepicker');this.container.hide();this.element.trigger('hide.daterangepicker',this);this.isShowing=false;},toggle:function(e){if(this.isShowing){this.hide();}else{this.show();}},outsideClick:function(e){var target=$(e.target);if(e.type=="focusin"||target.closest(this.element).length||target.closest(this.container).length||target.closest('.calendar-table').length)return;this.hide();this.element.trigger('outsideClick.daterangepicker',this);},showCalendars:function(){this.container.addClass('show-calendar');this.move();this.element.trigger('showCalendar.daterangepicker',this);},hideCalendars:function(){this.container.removeClass('show-calendar');this.element.trigger('hideCalendar.daterangepicker',this);},clickRange:function(e){var label=e.target.getAttribute('data-range-key');this.chosenLabel=label;if(label==this.locale.customRangeLabel){this.showCalendars();}else{var dates=this.ranges[label];this.startDate=dates[0];this.endDate=dates[1];if(!this.timePicker){this.startDate.startOf('day');this.endDate.endOf('day');}
if(!this.alwaysShowCalendars)
this.hideCalendars();this.clickApply();}},clickPrev:function(e){var cal=$(e.target).parents('.drp-calendar');if(cal.hasClass('left')){this.leftCalendar.month.subtract(1,'month');if(this.linkedCalendars)
this.rightCalendar.month.subtract(1,'month');}else{this.rightCalendar.month.subtract(1,'month');}
this.updateCalendars();},clickNext:function(e){var cal=$(e.target).parents('.drp-calendar');if(cal.hasClass('left')){this.leftCalendar.month.add(1,'month');}else{this.rightCalendar.month.add(1,'month');if(this.linkedCalendars)
this.leftCalendar.month.add(1,'month');}
this.updateCalendars();},hoverDate:function(e){if(!$(e.target).hasClass('available'))return;var title=$(e.target).attr('data-title');var row=title.substr(1,1);var col=title.substr(3,1);var cal=$(e.target).parents('.drp-calendar');var date=cal.hasClass('left')?this.leftCalendar.calendar[row][col]:this.rightCalendar.calendar[row][col];var leftCalendar=this.leftCalendar;var rightCalendar=this.rightCalendar;var startDate=this.startDate;if(!this.endDate){this.container.find('.drp-calendar tbody td').each(function(index,el){if($(el).hasClass('week'))return;var title=$(el).attr('data-title');var row=title.substr(1,1);var col=title.substr(3,1);var cal=$(el).parents('.drp-calendar');var dt=cal.hasClass('left')?leftCalendar.calendar[row][col]:rightCalendar.calendar[row][col];if((dt.isAfter(startDate)&&dt.isBefore(date))||dt.isSame(date,'day')){$(el).addClass('in-range');}else{$(el).removeClass('in-range');}});}},clickDate:function(e){if(!$(e.target).hasClass('available'))return;var title=$(e.target).attr('data-title');var row=title.substr(1,1);var col=title.substr(3,1);var cal=$(e.target).parents('.drp-calendar');var date=cal.hasClass('left')?this.leftCalendar.calendar[row][col]:this.rightCalendar.calendar[row][col];if(this.endDate||date.isBefore(this.startDate,'day')){if(this.timePicker){var hour=parseInt(this.container.find('.left .hourselect').val(),10);if(!this.timePicker24Hour){var ampm=this.container.find('.left .ampmselect').val();if(ampm==='PM'&&hour<12)
hour+=12;if(ampm==='AM'&&hour===12)
hour=0;}
var minute=parseInt(this.container.find('.left .minuteselect').val(),10);if(isNaN(minute)){minute=parseInt(this.container.find('.left .minuteselect option:last').val(),10);}
var second=this.timePickerSeconds?parseInt(this.container.find('.left .secondselect').val(),10):0;date=date.clone().hour(hour).minute(minute).second(second);}
this.endDate=null;this.setStartDate(date.clone());}else if(!this.endDate&&date.isBefore(this.startDate)){this.setEndDate(this.startDate.clone());}else{if(this.timePicker){var hour=parseInt(this.container.find('.right .hourselect').val(),10);if(!this.timePicker24Hour){var ampm=this.container.find('.right .ampmselect').val();if(ampm==='PM'&&hour<12)
hour+=12;if(ampm==='AM'&&hour===12)
hour=0;}
var minute=parseInt(this.container.find('.right .minuteselect').val(),10);if(isNaN(minute)){minute=parseInt(this.container.find('.right .minuteselect option:last').val(),10);}
var second=this.timePickerSeconds?parseInt(this.container.find('.right .secondselect').val(),10):0;date=date.clone().hour(hour).minute(minute).second(second);}
this.setEndDate(date.clone());if(this.autoApply){this.calculateChosenLabel();this.clickApply();}}
if(this.singleDatePicker){this.setEndDate(this.startDate);if(!this.timePicker)
this.clickApply();}
this.updateView();e.stopPropagation();},calculateChosenLabel:function(){var customRange=true;var i=0;for(var range in this.ranges){if(this.timePicker){var format=this.timePickerSeconds?"YYYY-MM-DD HH:mm:ss":"YYYY-MM-DD HH:mm";if(this.startDate.format(format)==this.ranges[range][0].format(format)&&this.endDate.format(format)==this.ranges[range][1].format(format)){customRange=false;this.chosenLabel=this.container.find('.ranges li:eq('+i+')').addClass('active').attr('data-range-key');break;}}else{if(this.startDate.format('YYYY-MM-DD')==this.ranges[range][0].format('YYYY-MM-DD')&&this.endDate.format('YYYY-MM-DD')==this.ranges[range][1].format('YYYY-MM-DD')){customRange=false;this.chosenLabel=this.container.find('.ranges li:eq('+i+')').addClass('active').attr('data-range-key');break;}}
i++;}
if(customRange){if(this.showCustomRangeLabel){this.chosenLabel=this.container.find('.ranges li:last').addClass('active').attr('data-range-key');}else{this.chosenLabel=null;}
this.showCalendars();}},clickApply:function(e){this.hide();this.element.trigger('apply.daterangepicker',this);},clickCancel:function(e){this.startDate=this.oldStartDate;this.endDate=this.oldEndDate;this.hide();this.element.trigger('cancel.daterangepicker',this);},monthOrYearChanged:function(e){var isLeft=$(e.target).closest('.drp-calendar').hasClass('left'),leftOrRight=isLeft?'left':'right',cal=this.container.find('.drp-calendar.'+leftOrRight);var month=parseInt(cal.find('.monthselect').val(),10);var year=cal.find('.yearselect').val();if(!isLeft){if(year<this.startDate.year()||(year==this.startDate.year()&&month<this.startDate.month())){month=this.startDate.month();year=this.startDate.year();}}
if(this.minDate){if(year<this.minDate.year()||(year==this.minDate.year()&&month<this.minDate.month())){month=this.minDate.month();year=this.minDate.year();}}
if(this.maxDate){if(year>this.maxDate.year()||(year==this.maxDate.year()&&month>this.maxDate.month())){month=this.maxDate.month();year=this.maxDate.year();}}
if(isLeft){this.leftCalendar.month.month(month).year(year);if(this.linkedCalendars)
this.rightCalendar.month=this.leftCalendar.month.clone().add(1,'month');}else{this.rightCalendar.month.month(month).year(year);if(this.linkedCalendars)
this.leftCalendar.month=this.rightCalendar.month.clone().subtract(1,'month');}
this.updateCalendars();},timeChanged:function(e){var cal=$(e.target).closest('.drp-calendar'),isLeft=cal.hasClass('left');var hour=parseInt(cal.find('.hourselect').val(),10);var minute=parseInt(cal.find('.minuteselect').val(),10);if(isNaN(minute)){minute=parseInt(cal.find('.minuteselect option:last').val(),10);}
var second=this.timePickerSeconds?parseInt(cal.find('.secondselect').val(),10):0;if(!this.timePicker24Hour){var ampm=cal.find('.ampmselect').val();if(ampm==='PM'&&hour<12)
hour+=12;if(ampm==='AM'&&hour===12)
hour=0;}
if(isLeft){var start=this.startDate.clone();start.hour(hour);start.minute(minute);start.second(second);this.setStartDate(start);if(this.singleDatePicker){this.endDate=this.startDate.clone();}else if(this.endDate&&this.endDate.format('YYYY-MM-DD')==start.format('YYYY-MM-DD')&&this.endDate.isBefore(start)){this.setEndDate(start.clone());}}else if(this.endDate){var end=this.endDate.clone();end.hour(hour);end.minute(minute);end.second(second);this.setEndDate(end);}
this.updateCalendars();this.updateFormInputs();this.renderTimePicker('left');this.renderTimePicker('right');},elementChanged:function(){if(!this.element.is('input'))return;if(!this.element.val().length)return;var dateString=this.element.val().split(this.locale.separator),start=null,end=null;if(dateString.length===2){start=moment(dateString[0],this.locale.format);end=moment(dateString[1],this.locale.format);}
if(this.singleDatePicker||start===null||end===null){start=moment(this.element.val(),this.locale.format);end=start;}
if(!start.isValid()||!end.isValid())return;this.setStartDate(start);this.setEndDate(end);this.updateView();},keydown:function(e){if((e.keyCode===9)||(e.keyCode===13)){this.hide();}
if(e.keyCode===27){e.preventDefault();e.stopPropagation();this.hide();}},updateElement:function(){if(this.element.is('input')&&this.autoUpdateInput){var newValue=this.startDate.format(this.locale.format);if(!this.singleDatePicker){newValue+=this.locale.separator+this.endDate.format(this.locale.format);}
if(newValue!==this.element.val()){this.element.val(newValue).trigger('change');}}},remove:function(){this.container.remove();this.element.off('.daterangepicker');this.element.removeData();}};$.fn.daterangepicker=function(options,callback){var implementOptions=$.extend(true,{},$.fn.daterangepicker.defaultOptions,options);this.each(function(){var el=$(this);if(el.data('daterangepicker'))
el.data('daterangepicker').remove();el.data('daterangepicker',new DateRangePicker(el,implementOptions,callback));});return this;};return DateRangePicker;}));;

/* /web/static/lib/stacktracejs/stacktrace.js defined in bundle 'web.tests_assets' */
(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.StackTrace=f()}})(function(){var define,module,exports;return(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){(function(root,factory){'use strict';if(typeof define==='function'&&define.amd){define('error-stack-parser',['stackframe'],factory);}else if(typeof exports==='object'){module.exports=factory(require('stackframe'));}else{root.ErrorStackParser=factory(root.StackFrame);}}(this,function ErrorStackParser(StackFrame){'use strict';var FIREFOX_SAFARI_STACK_REGEXP=/(^|@)\S+:\d+/;var CHROME_IE_STACK_REGEXP=/^\s*at .*(\S+:\d+|\(native\))/m;var SAFARI_NATIVE_CODE_REGEXP=/^(eval@)?(\[native code])?$/;return{parse:function ErrorStackParser$$parse(error){if(typeof error.stacktrace!=='undefined'||typeof error['opera#sourceloc']!=='undefined'){return this.parseOpera(error);}else if(error.stack&&error.stack.match(CHROME_IE_STACK_REGEXP)){return this.parseV8OrIE(error);}else if(error.stack){return this.parseFFOrSafari(error);}else{throw new Error('Cannot parse given Error object');}},extractLocation:function ErrorStackParser$$extractLocation(urlLike){if(urlLike.indexOf(':')===-1){return[urlLike];}
var regExp=/(.+?)(?::(\d+))?(?::(\d+))?$/;var parts=regExp.exec(urlLike.replace(/[()]/g,''));return[parts[1],parts[2]||undefined,parts[3]||undefined];},parseV8OrIE:function ErrorStackParser$$parseV8OrIE(error){var filtered=error.stack.split('\n').filter(function(line){return!!line.match(CHROME_IE_STACK_REGEXP);},this);return filtered.map(function(line){if(line.indexOf('(eval ')>-1){line=line.replace(/eval code/g,'eval').replace(/(\(eval at [^()]*)|(\),.*$)/g,'');}
var sanitizedLine=line.replace(/^\s+/,'').replace(/\(eval code/g,'(');var location=sanitizedLine.match(/ (\((.+):(\d+):(\d+)\)$)/);sanitizedLine=location?sanitizedLine.replace(location[0],''):sanitizedLine;var tokens=sanitizedLine.split(/\s+/).slice(1);var locationParts=this.extractLocation(location?location[1]:tokens.pop());var functionName=tokens.join(' ')||undefined;var fileName=['eval','<anonymous>'].indexOf(locationParts[0])>-1?undefined:locationParts[0];return new StackFrame({functionName:functionName,fileName:fileName,lineNumber:locationParts[1],columnNumber:locationParts[2],source:line});},this);},parseFFOrSafari:function ErrorStackParser$$parseFFOrSafari(error){var filtered=error.stack.split('\n').filter(function(line){return!line.match(SAFARI_NATIVE_CODE_REGEXP);},this);return filtered.map(function(line){if(line.indexOf(' > eval')>-1){line=line.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,':$1');}
if(line.indexOf('@')===-1&&line.indexOf(':')===-1){return new StackFrame({functionName:line});}else{var functionNameRegex=/((.*".+"[^@]*)?[^@]*)(?:@)/;var matches=line.match(functionNameRegex);var functionName=matches&&matches[1]?matches[1]:undefined;var locationParts=this.extractLocation(line.replace(functionNameRegex,''));return new StackFrame({functionName:functionName,fileName:locationParts[0],lineNumber:locationParts[1],columnNumber:locationParts[2],source:line});}},this);},parseOpera:function ErrorStackParser$$parseOpera(e){if(!e.stacktrace||(e.message.indexOf('\n')>-1&&e.message.split('\n').length>e.stacktrace.split('\n').length)){return this.parseOpera9(e);}else if(!e.stack){return this.parseOpera10(e);}else{return this.parseOpera11(e);}},parseOpera9:function ErrorStackParser$$parseOpera9(e){var lineRE=/Line (\d+).*script (?:in )?(\S+)/i;var lines=e.message.split('\n');var result=[];for(var i=2,len=lines.length;i<len;i+=2){var match=lineRE.exec(lines[i]);if(match){result.push(new StackFrame({fileName:match[2],lineNumber:match[1],source:lines[i]}));}}
return result;},parseOpera10:function ErrorStackParser$$parseOpera10(e){var lineRE=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i;var lines=e.stacktrace.split('\n');var result=[];for(var i=0,len=lines.length;i<len;i+=2){var match=lineRE.exec(lines[i]);if(match){result.push(new StackFrame({functionName:match[3]||undefined,fileName:match[2],lineNumber:match[1],source:lines[i]}));}}
return result;},parseOpera11:function ErrorStackParser$$parseOpera11(error){var filtered=error.stack.split('\n').filter(function(line){return!!line.match(FIREFOX_SAFARI_STACK_REGEXP)&&!line.match(/^Error created at/);},this);return filtered.map(function(line){var tokens=line.split('@');var locationParts=this.extractLocation(tokens.pop());var functionCall=(tokens.shift()||'');var functionName=functionCall.replace(/<anonymous function(: (\w+))?>/,'$2').replace(/\([^)]*\)/g,'')||undefined;var argsRaw;if(functionCall.match(/\(([^)]*)\)/)){argsRaw=functionCall.replace(/^[^(]+\(([^)]*)\)$/,'$1');}
var args=(argsRaw===undefined||argsRaw==='[arguments not available]')?undefined:argsRaw.split(',');return new StackFrame({functionName:functionName,args:args,fileName:locationParts[0],lineNumber:locationParts[1],columnNumber:locationParts[2],source:line});},this);}};}));},{"stackframe":2}],2:[function(require,module,exports){(function(root,factory){'use strict';if(typeof define==='function'&&define.amd){define('stackframe',[],factory);}else if(typeof exports==='object'){module.exports=factory();}else{root.StackFrame=factory();}}(this,function(){'use strict';function _isNumber(n){return!isNaN(parseFloat(n))&&isFinite(n);}
function _capitalize(str){return str.charAt(0).toUpperCase()+str.substring(1);}
function _getter(p){return function(){return this[p];};}
var booleanProps=['isConstructor','isEval','isNative','isToplevel'];var numericProps=['columnNumber','lineNumber'];var stringProps=['fileName','functionName','source'];var arrayProps=['args'];var props=booleanProps.concat(numericProps,stringProps,arrayProps);function StackFrame(obj){if(!obj)return;for(var i=0;i<props.length;i++){if(obj[props[i]]!==undefined){this['set'+_capitalize(props[i])](obj[props[i]]);}}}
StackFrame.prototype={getArgs:function(){return this.args;},setArgs:function(v){if(Object.prototype.toString.call(v)!=='[object Array]'){throw new TypeError('Args must be an Array');}
this.args=v;},getEvalOrigin:function(){return this.evalOrigin;},setEvalOrigin:function(v){if(v instanceof StackFrame){this.evalOrigin=v;}else if(v instanceof Object){this.evalOrigin=new StackFrame(v);}else{throw new TypeError('Eval Origin must be an Object or StackFrame');}},toString:function(){var fileName=this.getFileName()||'';var lineNumber=this.getLineNumber()||'';var columnNumber=this.getColumnNumber()||'';var functionName=this.getFunctionName()||'';if(this.getIsEval()){if(fileName){return'[eval] ('+fileName+':'+lineNumber+':'+columnNumber+')';}
return'[eval]:'+lineNumber+':'+columnNumber;}
if(functionName){return functionName+' ('+fileName+':'+lineNumber+':'+columnNumber+')';}
return fileName+':'+lineNumber+':'+columnNumber;}};StackFrame.fromString=function StackFrame$$fromString(str){var argsStartIndex=str.indexOf('(');var argsEndIndex=str.lastIndexOf(')');var functionName=str.substring(0,argsStartIndex);var args=str.substring(argsStartIndex+1,argsEndIndex).split(',');var locationString=str.substring(argsEndIndex+1);if(locationString.indexOf('@')===0){var parts=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(locationString,'');var fileName=parts[1];var lineNumber=parts[2];var columnNumber=parts[3];}
return new StackFrame({functionName:functionName,args:args||undefined,fileName:fileName,lineNumber:lineNumber||undefined,columnNumber:columnNumber||undefined});};for(var i=0;i<booleanProps.length;i++){StackFrame.prototype['get'+_capitalize(booleanProps[i])]=_getter(booleanProps[i]);StackFrame.prototype['set'+_capitalize(booleanProps[i])]=(function(p){return function(v){this[p]=Boolean(v);};})(booleanProps[i]);}
for(var j=0;j<numericProps.length;j++){StackFrame.prototype['get'+_capitalize(numericProps[j])]=_getter(numericProps[j]);StackFrame.prototype['set'+_capitalize(numericProps[j])]=(function(p){return function(v){if(!_isNumber(v)){throw new TypeError(p+' must be a Number');}
this[p]=Number(v);};})(numericProps[j]);}
for(var k=0;k<stringProps.length;k++){StackFrame.prototype['get'+_capitalize(stringProps[k])]=_getter(stringProps[k]);StackFrame.prototype['set'+_capitalize(stringProps[k])]=(function(p){return function(v){this[p]=String(v);};})(stringProps[k]);}
return StackFrame;}));},{}],3:[function(require,module,exports){var util=require('./util');var has=Object.prototype.hasOwnProperty;function ArraySet(){this._array=[];this._set=Object.create(null);}
ArraySet.fromArray=function ArraySet_fromArray(aArray,aAllowDuplicates){var set=new ArraySet();for(var i=0,len=aArray.length;i<len;i++){set.add(aArray[i],aAllowDuplicates);}
return set;};ArraySet.prototype.size=function ArraySet_size(){return Object.getOwnPropertyNames(this._set).length;};ArraySet.prototype.add=function ArraySet_add(aStr,aAllowDuplicates){var sStr=util.toSetString(aStr);var isDuplicate=has.call(this._set,sStr);var idx=this._array.length;if(!isDuplicate||aAllowDuplicates){this._array.push(aStr);}
if(!isDuplicate){this._set[sStr]=idx;}};ArraySet.prototype.has=function ArraySet_has(aStr){var sStr=util.toSetString(aStr);return has.call(this._set,sStr);};ArraySet.prototype.indexOf=function ArraySet_indexOf(aStr){var sStr=util.toSetString(aStr);if(has.call(this._set,sStr)){return this._set[sStr];}
throw new Error('"'+aStr+'" is not in the set.');};ArraySet.prototype.at=function ArraySet_at(aIdx){if(aIdx>=0&&aIdx<this._array.length){return this._array[aIdx];}
throw new Error('No element indexed by '+aIdx);};ArraySet.prototype.toArray=function ArraySet_toArray(){return this._array.slice();};exports.ArraySet=ArraySet;},{"./util":9}],4:[function(require,module,exports){var base64=require('./base64');var VLQ_BASE_SHIFT=5;var VLQ_BASE=1<<VLQ_BASE_SHIFT;var VLQ_BASE_MASK=VLQ_BASE-1;var VLQ_CONTINUATION_BIT=VLQ_BASE;function toVLQSigned(aValue){return aValue<0?((-aValue)<<1)+1:(aValue<<1)+0;}
function fromVLQSigned(aValue){var isNegative=(aValue&1)===1;var shifted=aValue>>1;return isNegative?-shifted:shifted;}
exports.encode=function base64VLQ_encode(aValue){var encoded="";var digit;var vlq=toVLQSigned(aValue);do{digit=vlq&VLQ_BASE_MASK;vlq>>>=VLQ_BASE_SHIFT;if(vlq>0){digit|=VLQ_CONTINUATION_BIT;}
encoded+=base64.encode(digit);}while(vlq>0);return encoded;};exports.decode=function base64VLQ_decode(aStr,aIndex,aOutParam){var strLen=aStr.length;var result=0;var shift=0;var continuation,digit;do{if(aIndex>=strLen){throw new Error("Expected more digits in base 64 VLQ value.");}
digit=base64.decode(aStr.charCodeAt(aIndex++));if(digit===-1){throw new Error("Invalid base64 digit: "+aStr.charAt(aIndex-1));}
continuation=!!(digit&VLQ_CONTINUATION_BIT);digit&=VLQ_BASE_MASK;result=result+(digit<<shift);shift+=VLQ_BASE_SHIFT;}while(continuation);aOutParam.value=fromVLQSigned(result);aOutParam.rest=aIndex;};},{"./base64":5}],5:[function(require,module,exports){var intToCharMap='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'.split('');exports.encode=function(number){if(0<=number&&number<intToCharMap.length){return intToCharMap[number];}
throw new TypeError("Must be between 0 and 63: "+number);};exports.decode=function(charCode){var bigA=65;var bigZ=90;var littleA=97;var littleZ=122;var zero=48;var nine=57;var plus=43;var slash=47;var littleOffset=26;var numberOffset=52;if(bigA<=charCode&&charCode<=bigZ){return(charCode-bigA);}
if(littleA<=charCode&&charCode<=littleZ){return(charCode-littleA+littleOffset);}
if(zero<=charCode&&charCode<=nine){return(charCode-zero+numberOffset);}
if(charCode==plus){return 62;}
if(charCode==slash){return 63;}
return-1;};},{}],6:[function(require,module,exports){exports.GREATEST_LOWER_BOUND=1;exports.LEAST_UPPER_BOUND=2;function recursiveSearch(aLow,aHigh,aNeedle,aHaystack,aCompare,aBias){var mid=Math.floor((aHigh-aLow)/2)+aLow;var cmp=aCompare(aNeedle,aHaystack[mid],true);if(cmp===0){return mid;}
else if(cmp>0){if(aHigh-mid>1){return recursiveSearch(mid,aHigh,aNeedle,aHaystack,aCompare,aBias);}
if(aBias==exports.LEAST_UPPER_BOUND){return aHigh<aHaystack.length?aHigh:-1;}else{return mid;}}
else{if(mid-aLow>1){return recursiveSearch(aLow,mid,aNeedle,aHaystack,aCompare,aBias);}
if(aBias==exports.LEAST_UPPER_BOUND){return mid;}else{return aLow<0?-1:aLow;}}}
exports.search=function search(aNeedle,aHaystack,aCompare,aBias){if(aHaystack.length===0){return-1;}
var index=recursiveSearch(-1,aHaystack.length,aNeedle,aHaystack,aCompare,aBias||exports.GREATEST_LOWER_BOUND);if(index<0){return-1;}
while(index-1>=0){if(aCompare(aHaystack[index],aHaystack[index-1],true)!==0){break;}
--index;}
return index;};},{}],7:[function(require,module,exports){function swap(ary,x,y){var temp=ary[x];ary[x]=ary[y];ary[y]=temp;}
function randomIntInRange(low,high){return Math.round(low+(Math.random()*(high-low)));}
function doQuickSort(ary,comparator,p,r){if(p<r){var pivotIndex=randomIntInRange(p,r);var i=p-1;swap(ary,pivotIndex,r);var pivot=ary[r];for(var j=p;j<r;j++){if(comparator(ary[j],pivot)<=0){i+=1;swap(ary,i,j);}}
swap(ary,i+1,j);var q=i+1;doQuickSort(ary,comparator,p,q-1);doQuickSort(ary,comparator,q+1,r);}}
exports.quickSort=function(ary,comparator){doQuickSort(ary,comparator,0,ary.length-1);};},{}],8:[function(require,module,exports){var util=require('./util');var binarySearch=require('./binary-search');var ArraySet=require('./array-set').ArraySet;var base64VLQ=require('./base64-vlq');var quickSort=require('./quick-sort').quickSort;function SourceMapConsumer(aSourceMap){var sourceMap=aSourceMap;if(typeof aSourceMap==='string'){sourceMap=JSON.parse(aSourceMap.replace(/^\)\]\}'/,''));}
return sourceMap.sections!=null?new IndexedSourceMapConsumer(sourceMap):new BasicSourceMapConsumer(sourceMap);}
SourceMapConsumer.fromSourceMap=function(aSourceMap){return BasicSourceMapConsumer.fromSourceMap(aSourceMap);}
SourceMapConsumer.prototype._version=3;SourceMapConsumer.prototype.__generatedMappings=null;Object.defineProperty(SourceMapConsumer.prototype,'_generatedMappings',{get:function(){if(!this.__generatedMappings){this._parseMappings(this._mappings,this.sourceRoot);}
return this.__generatedMappings;}});SourceMapConsumer.prototype.__originalMappings=null;Object.defineProperty(SourceMapConsumer.prototype,'_originalMappings',{get:function(){if(!this.__originalMappings){this._parseMappings(this._mappings,this.sourceRoot);}
return this.__originalMappings;}});SourceMapConsumer.prototype._charIsMappingSeparator=function SourceMapConsumer_charIsMappingSeparator(aStr,index){var c=aStr.charAt(index);return c===";"||c===",";};SourceMapConsumer.prototype._parseMappings=function SourceMapConsumer_parseMappings(aStr,aSourceRoot){throw new Error("Subclasses must implement _parseMappings");};SourceMapConsumer.GENERATED_ORDER=1;SourceMapConsumer.ORIGINAL_ORDER=2;SourceMapConsumer.GREATEST_LOWER_BOUND=1;SourceMapConsumer.LEAST_UPPER_BOUND=2;SourceMapConsumer.prototype.eachMapping=function SourceMapConsumer_eachMapping(aCallback,aContext,aOrder){var context=aContext||null;var order=aOrder||SourceMapConsumer.GENERATED_ORDER;var mappings;switch(order){case SourceMapConsumer.GENERATED_ORDER:mappings=this._generatedMappings;break;case SourceMapConsumer.ORIGINAL_ORDER:mappings=this._originalMappings;break;default:throw new Error("Unknown order of iteration.");}
var sourceRoot=this.sourceRoot;mappings.map(function(mapping){var source=mapping.source===null?null:this._sources.at(mapping.source);if(source!=null&&sourceRoot!=null){source=util.join(sourceRoot,source);}
return{source:source,generatedLine:mapping.generatedLine,generatedColumn:mapping.generatedColumn,originalLine:mapping.originalLine,originalColumn:mapping.originalColumn,name:mapping.name===null?null:this._names.at(mapping.name)};},this).forEach(aCallback,context);};SourceMapConsumer.prototype.allGeneratedPositionsFor=function SourceMapConsumer_allGeneratedPositionsFor(aArgs){var line=util.getArg(aArgs,'line');var needle={source:util.getArg(aArgs,'source'),originalLine:line,originalColumn:util.getArg(aArgs,'column',0)};if(this.sourceRoot!=null){needle.source=util.relative(this.sourceRoot,needle.source);}
if(!this._sources.has(needle.source)){return[];}
needle.source=this._sources.indexOf(needle.source);var mappings=[];var index=this._findMapping(needle,this._originalMappings,"originalLine","originalColumn",util.compareByOriginalPositions,binarySearch.LEAST_UPPER_BOUND);if(index>=0){var mapping=this._originalMappings[index];if(aArgs.column===undefined){var originalLine=mapping.originalLine;while(mapping&&mapping.originalLine===originalLine){mappings.push({line:util.getArg(mapping,'generatedLine',null),column:util.getArg(mapping,'generatedColumn',null),lastColumn:util.getArg(mapping,'lastGeneratedColumn',null)});mapping=this._originalMappings[++index];}}else{var originalColumn=mapping.originalColumn;while(mapping&&mapping.originalLine===line&&mapping.originalColumn==originalColumn){mappings.push({line:util.getArg(mapping,'generatedLine',null),column:util.getArg(mapping,'generatedColumn',null),lastColumn:util.getArg(mapping,'lastGeneratedColumn',null)});mapping=this._originalMappings[++index];}}}
return mappings;};exports.SourceMapConsumer=SourceMapConsumer;function BasicSourceMapConsumer(aSourceMap){var sourceMap=aSourceMap;if(typeof aSourceMap==='string'){sourceMap=JSON.parse(aSourceMap.replace(/^\)\]\}'/,''));}
var version=util.getArg(sourceMap,'version');var sources=util.getArg(sourceMap,'sources');var names=util.getArg(sourceMap,'names',[]);var sourceRoot=util.getArg(sourceMap,'sourceRoot',null);var sourcesContent=util.getArg(sourceMap,'sourcesContent',null);var mappings=util.getArg(sourceMap,'mappings');var file=util.getArg(sourceMap,'file',null);if(version!=this._version){throw new Error('Unsupported version: '+version);}
sources=sources.map(String).map(util.normalize).map(function(source){return sourceRoot&&util.isAbsolute(sourceRoot)&&util.isAbsolute(source)?util.relative(sourceRoot,source):source;});this._names=ArraySet.fromArray(names.map(String),true);this._sources=ArraySet.fromArray(sources,true);this.sourceRoot=sourceRoot;this.sourcesContent=sourcesContent;this._mappings=mappings;this.file=file;}
BasicSourceMapConsumer.prototype=Object.create(SourceMapConsumer.prototype);BasicSourceMapConsumer.prototype.consumer=SourceMapConsumer;BasicSourceMapConsumer.fromSourceMap=function SourceMapConsumer_fromSourceMap(aSourceMap){var smc=Object.create(BasicSourceMapConsumer.prototype);var names=smc._names=ArraySet.fromArray(aSourceMap._names.toArray(),true);var sources=smc._sources=ArraySet.fromArray(aSourceMap._sources.toArray(),true);smc.sourceRoot=aSourceMap._sourceRoot;smc.sourcesContent=aSourceMap._generateSourcesContent(smc._sources.toArray(),smc.sourceRoot);smc.file=aSourceMap._file;var generatedMappings=aSourceMap._mappings.toArray().slice();var destGeneratedMappings=smc.__generatedMappings=[];var destOriginalMappings=smc.__originalMappings=[];for(var i=0,length=generatedMappings.length;i<length;i++){var srcMapping=generatedMappings[i];var destMapping=new Mapping;destMapping.generatedLine=srcMapping.generatedLine;destMapping.generatedColumn=srcMapping.generatedColumn;if(srcMapping.source){destMapping.source=sources.indexOf(srcMapping.source);destMapping.originalLine=srcMapping.originalLine;destMapping.originalColumn=srcMapping.originalColumn;if(srcMapping.name){destMapping.name=names.indexOf(srcMapping.name);}
destOriginalMappings.push(destMapping);}
destGeneratedMappings.push(destMapping);}
quickSort(smc.__originalMappings,util.compareByOriginalPositions);return smc;};BasicSourceMapConsumer.prototype._version=3;Object.defineProperty(BasicSourceMapConsumer.prototype,'sources',{get:function(){return this._sources.toArray().map(function(s){return this.sourceRoot!=null?util.join(this.sourceRoot,s):s;},this);}});function Mapping(){this.generatedLine=0;this.generatedColumn=0;this.source=null;this.originalLine=null;this.originalColumn=null;this.name=null;}
BasicSourceMapConsumer.prototype._parseMappings=function SourceMapConsumer_parseMappings(aStr,aSourceRoot){var generatedLine=1;var previousGeneratedColumn=0;var previousOriginalLine=0;var previousOriginalColumn=0;var previousSource=0;var previousName=0;var length=aStr.length;var index=0;var cachedSegments={};var temp={};var originalMappings=[];var generatedMappings=[];var mapping,str,segment,end,value;while(index<length){if(aStr.charAt(index)===';'){generatedLine++;index++;previousGeneratedColumn=0;}
else if(aStr.charAt(index)===','){index++;}
else{mapping=new Mapping();mapping.generatedLine=generatedLine;for(end=index;end<length;end++){if(this._charIsMappingSeparator(aStr,end)){break;}}
str=aStr.slice(index,end);segment=cachedSegments[str];if(segment){index+=str.length;}else{segment=[];while(index<end){base64VLQ.decode(aStr,index,temp);value=temp.value;index=temp.rest;segment.push(value);}
if(segment.length===2){throw new Error('Found a source, but no line and column');}
if(segment.length===3){throw new Error('Found a source and line, but no column');}
cachedSegments[str]=segment;}
mapping.generatedColumn=previousGeneratedColumn+segment[0];previousGeneratedColumn=mapping.generatedColumn;if(segment.length>1){mapping.source=previousSource+segment[1];previousSource+=segment[1];mapping.originalLine=previousOriginalLine+segment[2];previousOriginalLine=mapping.originalLine;mapping.originalLine+=1;mapping.originalColumn=previousOriginalColumn+segment[3];previousOriginalColumn=mapping.originalColumn;if(segment.length>4){mapping.name=previousName+segment[4];previousName+=segment[4];}}
generatedMappings.push(mapping);if(typeof mapping.originalLine==='number'){originalMappings.push(mapping);}}}
quickSort(generatedMappings,util.compareByGeneratedPositionsDeflated);this.__generatedMappings=generatedMappings;quickSort(originalMappings,util.compareByOriginalPositions);this.__originalMappings=originalMappings;};BasicSourceMapConsumer.prototype._findMapping=function SourceMapConsumer_findMapping(aNeedle,aMappings,aLineName,aColumnName,aComparator,aBias){if(aNeedle[aLineName]<=0){throw new TypeError('Line must be greater than or equal to 1, got '
+aNeedle[aLineName]);}
if(aNeedle[aColumnName]<0){throw new TypeError('Column must be greater than or equal to 0, got '
+aNeedle[aColumnName]);}
return binarySearch.search(aNeedle,aMappings,aComparator,aBias);};BasicSourceMapConsumer.prototype.computeColumnSpans=function SourceMapConsumer_computeColumnSpans(){for(var index=0;index<this._generatedMappings.length;++index){var mapping=this._generatedMappings[index];if(index+1<this._generatedMappings.length){var nextMapping=this._generatedMappings[index+1];if(mapping.generatedLine===nextMapping.generatedLine){mapping.lastGeneratedColumn=nextMapping.generatedColumn-1;continue;}}
mapping.lastGeneratedColumn=Infinity;}};BasicSourceMapConsumer.prototype.originalPositionFor=function SourceMapConsumer_originalPositionFor(aArgs){var needle={generatedLine:util.getArg(aArgs,'line'),generatedColumn:util.getArg(aArgs,'column')};var index=this._findMapping(needle,this._generatedMappings,"generatedLine","generatedColumn",util.compareByGeneratedPositionsDeflated,util.getArg(aArgs,'bias',SourceMapConsumer.GREATEST_LOWER_BOUND));if(index>=0){var mapping=this._generatedMappings[index];if(mapping.generatedLine===needle.generatedLine){var source=util.getArg(mapping,'source',null);if(source!==null){source=this._sources.at(source);if(this.sourceRoot!=null){source=util.join(this.sourceRoot,source);}}
var name=util.getArg(mapping,'name',null);if(name!==null){name=this._names.at(name);}
return{source:source,line:util.getArg(mapping,'originalLine',null),column:util.getArg(mapping,'originalColumn',null),name:name};}}
return{source:null,line:null,column:null,name:null};};BasicSourceMapConsumer.prototype.hasContentsOfAllSources=function BasicSourceMapConsumer_hasContentsOfAllSources(){if(!this.sourcesContent){return false;}
return this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(sc){return sc==null;});};BasicSourceMapConsumer.prototype.sourceContentFor=function SourceMapConsumer_sourceContentFor(aSource,nullOnMissing){if(!this.sourcesContent){return null;}
if(this.sourceRoot!=null){aSource=util.relative(this.sourceRoot,aSource);}
if(this._sources.has(aSource)){return this.sourcesContent[this._sources.indexOf(aSource)];}
var url;if(this.sourceRoot!=null&&(url=util.urlParse(this.sourceRoot))){var fileUriAbsPath=aSource.replace(/^file:\/\//,"");if(url.scheme=="file"&&this._sources.has(fileUriAbsPath)){return this.sourcesContent[this._sources.indexOf(fileUriAbsPath)]}
if((!url.path||url.path=="/")&&this._sources.has("/"+aSource)){return this.sourcesContent[this._sources.indexOf("/"+aSource)];}}
if(nullOnMissing){return null;}
else{throw new Error('"'+aSource+'" is not in the SourceMap.');}};BasicSourceMapConsumer.prototype.generatedPositionFor=function SourceMapConsumer_generatedPositionFor(aArgs){var source=util.getArg(aArgs,'source');if(this.sourceRoot!=null){source=util.relative(this.sourceRoot,source);}
if(!this._sources.has(source)){return{line:null,column:null,lastColumn:null};}
source=this._sources.indexOf(source);var needle={source:source,originalLine:util.getArg(aArgs,'line'),originalColumn:util.getArg(aArgs,'column')};var index=this._findMapping(needle,this._originalMappings,"originalLine","originalColumn",util.compareByOriginalPositions,util.getArg(aArgs,'bias',SourceMapConsumer.GREATEST_LOWER_BOUND));if(index>=0){var mapping=this._originalMappings[index];if(mapping.source===needle.source){return{line:util.getArg(mapping,'generatedLine',null),column:util.getArg(mapping,'generatedColumn',null),lastColumn:util.getArg(mapping,'lastGeneratedColumn',null)};}}
return{line:null,column:null,lastColumn:null};};exports.BasicSourceMapConsumer=BasicSourceMapConsumer;function IndexedSourceMapConsumer(aSourceMap){var sourceMap=aSourceMap;if(typeof aSourceMap==='string'){sourceMap=JSON.parse(aSourceMap.replace(/^\)\]\}'/,''));}
var version=util.getArg(sourceMap,'version');var sections=util.getArg(sourceMap,'sections');if(version!=this._version){throw new Error('Unsupported version: '+version);}
this._sources=new ArraySet();this._names=new ArraySet();var lastOffset={line:-1,column:0};this._sections=sections.map(function(s){if(s.url){throw new Error('Support for url field in sections not implemented.');}
var offset=util.getArg(s,'offset');var offsetLine=util.getArg(offset,'line');var offsetColumn=util.getArg(offset,'column');if(offsetLine<lastOffset.line||(offsetLine===lastOffset.line&&offsetColumn<lastOffset.column)){throw new Error('Section offsets must be ordered and non-overlapping.');}
lastOffset=offset;return{generatedOffset:{generatedLine:offsetLine+1,generatedColumn:offsetColumn+1},consumer:new SourceMapConsumer(util.getArg(s,'map'))}});}
IndexedSourceMapConsumer.prototype=Object.create(SourceMapConsumer.prototype);IndexedSourceMapConsumer.prototype.constructor=SourceMapConsumer;IndexedSourceMapConsumer.prototype._version=3;Object.defineProperty(IndexedSourceMapConsumer.prototype,'sources',{get:function(){var sources=[];for(var i=0;i<this._sections.length;i++){for(var j=0;j<this._sections[i].consumer.sources.length;j++){sources.push(this._sections[i].consumer.sources[j]);}}
return sources;}});IndexedSourceMapConsumer.prototype.originalPositionFor=function IndexedSourceMapConsumer_originalPositionFor(aArgs){var needle={generatedLine:util.getArg(aArgs,'line'),generatedColumn:util.getArg(aArgs,'column')};var sectionIndex=binarySearch.search(needle,this._sections,function(needle,section){var cmp=needle.generatedLine-section.generatedOffset.generatedLine;if(cmp){return cmp;}
return(needle.generatedColumn-
section.generatedOffset.generatedColumn);});var section=this._sections[sectionIndex];if(!section){return{source:null,line:null,column:null,name:null};}
return section.consumer.originalPositionFor({line:needle.generatedLine-
(section.generatedOffset.generatedLine-1),column:needle.generatedColumn-
(section.generatedOffset.generatedLine===needle.generatedLine?section.generatedOffset.generatedColumn-1:0),bias:aArgs.bias});};IndexedSourceMapConsumer.prototype.hasContentsOfAllSources=function IndexedSourceMapConsumer_hasContentsOfAllSources(){return this._sections.every(function(s){return s.consumer.hasContentsOfAllSources();});};IndexedSourceMapConsumer.prototype.sourceContentFor=function IndexedSourceMapConsumer_sourceContentFor(aSource,nullOnMissing){for(var i=0;i<this._sections.length;i++){var section=this._sections[i];var content=section.consumer.sourceContentFor(aSource,true);if(content){return content;}}
if(nullOnMissing){return null;}
else{throw new Error('"'+aSource+'" is not in the SourceMap.');}};IndexedSourceMapConsumer.prototype.generatedPositionFor=function IndexedSourceMapConsumer_generatedPositionFor(aArgs){for(var i=0;i<this._sections.length;i++){var section=this._sections[i];if(section.consumer.sources.indexOf(util.getArg(aArgs,'source'))===-1){continue;}
var generatedPosition=section.consumer.generatedPositionFor(aArgs);if(generatedPosition){var ret={line:generatedPosition.line+
(section.generatedOffset.generatedLine-1),column:generatedPosition.column+
(section.generatedOffset.generatedLine===generatedPosition.line?section.generatedOffset.generatedColumn-1:0)};return ret;}}
return{line:null,column:null};};IndexedSourceMapConsumer.prototype._parseMappings=function IndexedSourceMapConsumer_parseMappings(aStr,aSourceRoot){this.__generatedMappings=[];this.__originalMappings=[];for(var i=0;i<this._sections.length;i++){var section=this._sections[i];var sectionMappings=section.consumer._generatedMappings;for(var j=0;j<sectionMappings.length;j++){var mapping=sectionMappings[j];var source=section.consumer._sources.at(mapping.source);if(section.consumer.sourceRoot!==null){source=util.join(section.consumer.sourceRoot,source);}
this._sources.add(source);source=this._sources.indexOf(source);var name=section.consumer._names.at(mapping.name);this._names.add(name);name=this._names.indexOf(name);var adjustedMapping={source:source,generatedLine:mapping.generatedLine+
(section.generatedOffset.generatedLine-1),generatedColumn:mapping.generatedColumn+
(section.generatedOffset.generatedLine===mapping.generatedLine?section.generatedOffset.generatedColumn-1:0),originalLine:mapping.originalLine,originalColumn:mapping.originalColumn,name:name};this.__generatedMappings.push(adjustedMapping);if(typeof adjustedMapping.originalLine==='number'){this.__originalMappings.push(adjustedMapping);}}}
quickSort(this.__generatedMappings,util.compareByGeneratedPositionsDeflated);quickSort(this.__originalMappings,util.compareByOriginalPositions);};exports.IndexedSourceMapConsumer=IndexedSourceMapConsumer;},{"./array-set":3,"./base64-vlq":4,"./binary-search":6,"./quick-sort":7,"./util":9}],9:[function(require,module,exports){function getArg(aArgs,aName,aDefaultValue){if(aName in aArgs){return aArgs[aName];}else if(arguments.length===3){return aDefaultValue;}else{throw new Error('"'+aName+'" is a required argument.');}}
exports.getArg=getArg;var urlRegexp=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.]*)(?::(\d+))?(\S*)$/;var dataUrlRegexp=/^data:.+\,.+$/;function urlParse(aUrl){var match=aUrl.match(urlRegexp);if(!match){return null;}
return{scheme:match[1],auth:match[2],host:match[3],port:match[4],path:match[5]};}
exports.urlParse=urlParse;function urlGenerate(aParsedUrl){var url='';if(aParsedUrl.scheme){url+=aParsedUrl.scheme+':';}
url+='//';if(aParsedUrl.auth){url+=aParsedUrl.auth+'@';}
if(aParsedUrl.host){url+=aParsedUrl.host;}
if(aParsedUrl.port){url+=":"+aParsedUrl.port}
if(aParsedUrl.path){url+=aParsedUrl.path;}
return url;}
exports.urlGenerate=urlGenerate;function normalize(aPath){var path=aPath;var url=urlParse(aPath);if(url){if(!url.path){return aPath;}
path=url.path;}
var isAbsolute=exports.isAbsolute(path);var parts=path.split(/\/+/);for(var part,up=0,i=parts.length-1;i>=0;i--){part=parts[i];if(part==='.'){parts.splice(i,1);}else if(part==='..'){up++;}else if(up>0){if(part===''){parts.splice(i+1,up);up=0;}else{parts.splice(i,2);up--;}}}
path=parts.join('/');if(path===''){path=isAbsolute?'/':'.';}
if(url){url.path=path;return urlGenerate(url);}
return path;}
exports.normalize=normalize;function join(aRoot,aPath){if(aRoot===""){aRoot=".";}
if(aPath===""){aPath=".";}
var aPathUrl=urlParse(aPath);var aRootUrl=urlParse(aRoot);if(aRootUrl){aRoot=aRootUrl.path||'/';}
if(aPathUrl&&!aPathUrl.scheme){if(aRootUrl){aPathUrl.scheme=aRootUrl.scheme;}
return urlGenerate(aPathUrl);}
if(aPathUrl||aPath.match(dataUrlRegexp)){return aPath;}
if(aRootUrl&&!aRootUrl.host&&!aRootUrl.path){aRootUrl.host=aPath;return urlGenerate(aRootUrl);}
var joined=aPath.charAt(0)==='/'?aPath:normalize(aRoot.replace(/\/+$/,'')+'/'+aPath);if(aRootUrl){aRootUrl.path=joined;return urlGenerate(aRootUrl);}
return joined;}
exports.join=join;exports.isAbsolute=function(aPath){return aPath.charAt(0)==='/'||!!aPath.match(urlRegexp);};function relative(aRoot,aPath){if(aRoot===""){aRoot=".";}
aRoot=aRoot.replace(/\/$/,'');var level=0;while(aPath.indexOf(aRoot+'/')!==0){var index=aRoot.lastIndexOf("/");if(index<0){return aPath;}
aRoot=aRoot.slice(0,index);if(aRoot.match(/^([^\/]+:\/)?\/*$/)){return aPath;}
++level;}
return Array(level+1).join("../")+aPath.substr(aRoot.length+1);}
exports.relative=relative;var supportsNullProto=(function(){var obj=Object.create(null);return!('__proto__'in obj);}());function identity(s){return s;}
function toSetString(aStr){if(isProtoString(aStr)){return'$'+aStr;}
return aStr;}
exports.toSetString=supportsNullProto?identity:toSetString;function fromSetString(aStr){if(isProtoString(aStr)){return aStr.slice(1);}
return aStr;}
exports.fromSetString=supportsNullProto?identity:fromSetString;function isProtoString(s){if(!s){return false;}
var length=s.length;if(length<9){return false;}
if(s.charCodeAt(length-1)!==95||s.charCodeAt(length-2)!==95||s.charCodeAt(length-3)!==111||s.charCodeAt(length-4)!==116||s.charCodeAt(length-5)!==111||s.charCodeAt(length-6)!==114||s.charCodeAt(length-7)!==112||s.charCodeAt(length-8)!==95||s.charCodeAt(length-9)!==95){return false;}
for(var i=length-10;i>=0;i--){if(s.charCodeAt(i)!==36){return false;}}
return true;}
function compareByOriginalPositions(mappingA,mappingB,onlyCompareOriginal){var cmp=mappingA.source-mappingB.source;if(cmp!==0){return cmp;}
cmp=mappingA.originalLine-mappingB.originalLine;if(cmp!==0){return cmp;}
cmp=mappingA.originalColumn-mappingB.originalColumn;if(cmp!==0||onlyCompareOriginal){return cmp;}
cmp=mappingA.generatedColumn-mappingB.generatedColumn;if(cmp!==0){return cmp;}
cmp=mappingA.generatedLine-mappingB.generatedLine;if(cmp!==0){return cmp;}
return mappingA.name-mappingB.name;}
exports.compareByOriginalPositions=compareByOriginalPositions;function compareByGeneratedPositionsDeflated(mappingA,mappingB,onlyCompareGenerated){var cmp=mappingA.generatedLine-mappingB.generatedLine;if(cmp!==0){return cmp;}
cmp=mappingA.generatedColumn-mappingB.generatedColumn;if(cmp!==0||onlyCompareGenerated){return cmp;}
cmp=mappingA.source-mappingB.source;if(cmp!==0){return cmp;}
cmp=mappingA.originalLine-mappingB.originalLine;if(cmp!==0){return cmp;}
cmp=mappingA.originalColumn-mappingB.originalColumn;if(cmp!==0){return cmp;}
return mappingA.name-mappingB.name;}
exports.compareByGeneratedPositionsDeflated=compareByGeneratedPositionsDeflated;function strcmp(aStr1,aStr2){if(aStr1===aStr2){return 0;}
if(aStr1>aStr2){return 1;}
return-1;}
function compareByGeneratedPositionsInflated(mappingA,mappingB){var cmp=mappingA.generatedLine-mappingB.generatedLine;if(cmp!==0){return cmp;}
cmp=mappingA.generatedColumn-mappingB.generatedColumn;if(cmp!==0){return cmp;}
cmp=strcmp(mappingA.source,mappingB.source);if(cmp!==0){return cmp;}
cmp=mappingA.originalLine-mappingB.originalLine;if(cmp!==0){return cmp;}
cmp=mappingA.originalColumn-mappingB.originalColumn;if(cmp!==0){return cmp;}
return strcmp(mappingA.name,mappingB.name);}
exports.compareByGeneratedPositionsInflated=compareByGeneratedPositionsInflated;},{}],10:[function(require,module,exports){arguments[4][2][0].apply(exports,arguments)},{"dup":2}],11:[function(require,module,exports){(function(root,factory){'use strict';if(typeof define==='function'&&define.amd){define('stack-generator',['stackframe'],factory);}else if(typeof exports==='object'){module.exports=factory(require('stackframe'));}else{root.StackGenerator=factory(root.StackFrame);}}(this,function(StackFrame){return{backtrace:function StackGenerator$$backtrace(opts){var stack=[];var maxStackSize=10;if(typeof opts==='object'&&typeof opts.maxStackSize==='number'){maxStackSize=opts.maxStackSize;}
var curr=arguments.callee;while(curr&&stack.length<maxStackSize&&curr['arguments']){var args=new Array(curr['arguments'].length);for(var i=0;i<args.length;++i){args[i]=curr['arguments'][i];}
if(/function(?:\s+([\w$]+))+\s*\(/.test(curr.toString())){stack.push(new StackFrame({functionName:RegExp.$1||undefined,args:args}));}else{stack.push(new StackFrame({args:args}));}
try{curr=curr.caller;}catch(e){break;}}
return stack;}};}));},{"stackframe":10}],12:[function(require,module,exports){arguments[4][2][0].apply(exports,arguments)},{"dup":2}],13:[function(require,module,exports){(function(root,factory){'use strict';if(typeof define==='function'&&define.amd){define('stacktrace-gps',['source-map','stackframe'],factory);}else if(typeof exports==='object'){module.exports=factory(require('source-map/lib/source-map-consumer'),require('stackframe'));}else{root.StackTraceGPS=factory(root.SourceMap||root.sourceMap,root.StackFrame);}}(this,function(SourceMap,StackFrame){'use strict';function _xdr(url){return new Promise(function(resolve,reject){var req=new XMLHttpRequest();req.open('get',url);req.onerror=reject;req.onreadystatechange=function onreadystatechange(){if(req.readyState===4){if((req.status>=200&&req.status<300)||(url.substr(0,7)==='file://'&&req.responseText)){resolve(req.responseText);}else{reject(new Error('HTTP status: '+req.status+' retrieving '+url));}}};req.send();});}
function _atob(b64str){if(typeof window!=='undefined'&&window.atob){return window.atob(b64str);}else{throw new Error('You must supply a polyfill for window.atob in this environment');}}
function _parseJson(string){if(typeof JSON!=='undefined'&&JSON.parse){return JSON.parse(string);}else{throw new Error('You must supply a polyfill for JSON.parse in this environment');}}
function _findFunctionName(source,lineNumber){var syntaxes=[/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*function\b/,/function\s+([^('"`]*?)\s*\(([^)]*)\)/,/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*(?:eval|new Function)\b/,/\b(?!(?:if|for|switch|while|with|catch)\b)(?:(?:static)\s+)?(\S+)\s*\(.*?\)\s*\{/,/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*\(.*?\)\s*=>/];var lines=source.split('\n');var code='';var maxLines=Math.min(lineNumber,20);for(var i=0;i<maxLines;++i){var line=lines[lineNumber-i-1];var commentPos=line.indexOf('//');if(commentPos>=0){line=line.substr(0,commentPos);}
if(line){code=line+code;var len=syntaxes.length;for(var index=0;index<len;index++){var m=syntaxes[index].exec(code);if(m&&m[1]){return m[1];}}}}
return undefined;}
function _ensureSupportedEnvironment(){if(typeof Object.defineProperty!=='function'||typeof Object.create!=='function'){throw new Error('Unable to consume source maps in older browsers');}}
function _ensureStackFrameIsLegit(stackframe){if(typeof stackframe!=='object'){throw new TypeError('Given StackFrame is not an object');}else if(typeof stackframe.fileName!=='string'){throw new TypeError('Given file name is not a String');}else if(typeof stackframe.lineNumber!=='number'||stackframe.lineNumber%1!==0||stackframe.lineNumber<1){throw new TypeError('Given line number must be a positive integer');}else if(typeof stackframe.columnNumber!=='number'||stackframe.columnNumber%1!==0||stackframe.columnNumber<0){throw new TypeError('Given column number must be a non-negative integer');}
return true;}
function _findSourceMappingURL(source){var sourceMappingUrlRegExp=/\/\/[#@] ?sourceMappingURL=([^\s'"]+)\s*$/mg;var lastSourceMappingUrl;var matchSourceMappingUrl;while(matchSourceMappingUrl=sourceMappingUrlRegExp.exec(source)){lastSourceMappingUrl=matchSourceMappingUrl[1];}
if(lastSourceMappingUrl){return lastSourceMappingUrl;}else{throw new Error('sourceMappingURL not found');}}
function _extractLocationInfoFromSourceMapSource(stackframe,sourceMapConsumer,sourceCache){return new Promise(function(resolve,reject){var loc=sourceMapConsumer.originalPositionFor({line:stackframe.lineNumber,column:stackframe.columnNumber});if(loc.source){var mappedSource=sourceMapConsumer.sourceContentFor(loc.source);if(mappedSource){sourceCache[loc.source]=mappedSource;}
resolve(new StackFrame({functionName:loc.name||stackframe.functionName,args:stackframe.args,fileName:loc.source,lineNumber:loc.line,columnNumber:loc.column}));}else{reject(new Error('Could not get original source for given stackframe and source map'));}});}
return function StackTraceGPS(opts){if(!(this instanceof StackTraceGPS)){return new StackTraceGPS(opts);}
opts=opts||{};this.sourceCache=opts.sourceCache||{};this.sourceMapConsumerCache=opts.sourceMapConsumerCache||{};this.ajax=opts.ajax||_xdr;this._atob=opts.atob||_atob;this._get=function _get(location){return new Promise(function(resolve,reject){var isDataUrl=location.substr(0,5)==='data:';if(this.sourceCache[location]){resolve(this.sourceCache[location]);}else if(opts.offline&&!isDataUrl){reject(new Error('Cannot make network requests in offline mode'));}else{if(isDataUrl){var supportedEncodingRegexp=/^data:application\/json;([\w=:"-]+;)*base64,/;var match=location.match(supportedEncodingRegexp);if(match){var sourceMapStart=match[0].length;var encodedSource=location.substr(sourceMapStart);var source=this._atob(encodedSource);this.sourceCache[location]=source;resolve(source);}else{reject(new Error('The encoding of the inline sourcemap is not supported'));}}else{var xhrPromise=this.ajax(location,{method:'get'});this.sourceCache[location]=xhrPromise;xhrPromise.then(resolve,reject);}}}.bind(this));};this._getSourceMapConsumer=function _getSourceMapConsumer(sourceMappingURL,defaultSourceRoot){return new Promise(function(resolve){if(this.sourceMapConsumerCache[sourceMappingURL]){resolve(this.sourceMapConsumerCache[sourceMappingURL]);}else{var sourceMapConsumerPromise=new Promise(function(resolve,reject){return this._get(sourceMappingURL).then(function(sourceMapSource){if(typeof sourceMapSource==='string'){sourceMapSource=_parseJson(sourceMapSource.replace(/^\)\]\}'/,''));}
if(typeof sourceMapSource.sourceRoot==='undefined'){sourceMapSource.sourceRoot=defaultSourceRoot;}
resolve(new SourceMap.SourceMapConsumer(sourceMapSource));},reject);}.bind(this));this.sourceMapConsumerCache[sourceMappingURL]=sourceMapConsumerPromise;resolve(sourceMapConsumerPromise);}}.bind(this));};this.pinpoint=function StackTraceGPS$$pinpoint(stackframe){return new Promise(function(resolve,reject){this.getMappedLocation(stackframe).then(function(mappedStackFrame){function resolveMappedStackFrame(){resolve(mappedStackFrame);}
this.findFunctionName(mappedStackFrame).then(resolve,resolveMappedStackFrame)
['catch'](resolveMappedStackFrame);}.bind(this),reject);}.bind(this));};this.findFunctionName=function StackTraceGPS$$findFunctionName(stackframe){return new Promise(function(resolve,reject){_ensureStackFrameIsLegit(stackframe);this._get(stackframe.fileName).then(function getSourceCallback(source){var lineNumber=stackframe.lineNumber;var columnNumber=stackframe.columnNumber;var guessedFunctionName=_findFunctionName(source,lineNumber,columnNumber);if(guessedFunctionName){resolve(new StackFrame({functionName:guessedFunctionName,args:stackframe.args,fileName:stackframe.fileName,lineNumber:lineNumber,columnNumber:columnNumber}));}else{resolve(stackframe);}},reject)['catch'](reject);}.bind(this));};this.getMappedLocation=function StackTraceGPS$$getMappedLocation(stackframe){return new Promise(function(resolve,reject){_ensureSupportedEnvironment();_ensureStackFrameIsLegit(stackframe);var sourceCache=this.sourceCache;var fileName=stackframe.fileName;this._get(fileName).then(function(source){var sourceMappingURL=_findSourceMappingURL(source);var isDataUrl=sourceMappingURL.substr(0,5)==='data:';var defaultSourceRoot=fileName.substring(0,fileName.lastIndexOf('/')+1);if(sourceMappingURL[0]!=='/'&&!isDataUrl&&!(/^https?:\/\/|^\/\//i).test(sourceMappingURL)){sourceMappingURL=defaultSourceRoot+sourceMappingURL;}
return this._getSourceMapConsumer(sourceMappingURL,defaultSourceRoot).then(function(sourceMapConsumer){return _extractLocationInfoFromSourceMapSource(stackframe,sourceMapConsumer,sourceCache).then(resolve)['catch'](function(){resolve(stackframe);});});}.bind(this),reject)['catch'](reject);}.bind(this));};};}));},{"source-map/lib/source-map-consumer":8,"stackframe":12}],14:[function(require,module,exports){(function(root,factory){'use strict';if(typeof define==='function'&&define.amd){define('stacktrace',['error-stack-parser','stack-generator','stacktrace-gps'],factory);}else if(typeof exports==='object'){module.exports=factory(require('error-stack-parser'),require('stack-generator'),require('stacktrace-gps'));}else{root.StackTrace=factory(root.ErrorStackParser,root.StackGenerator,root.StackTraceGPS);}}(this,function StackTrace(ErrorStackParser,StackGenerator,StackTraceGPS){var _options={filter:function(stackframe){return(stackframe.functionName||'').indexOf('StackTrace$$')===-1&&(stackframe.functionName||'').indexOf('ErrorStackParser$$')===-1&&(stackframe.functionName||'').indexOf('StackTraceGPS$$')===-1&&(stackframe.functionName||'').indexOf('StackGenerator$$')===-1;},sourceCache:{}};var _generateError=function StackTrace$$GenerateError(){try{throw new Error();}catch(err){return err;}};function _merge(first,second){var target={};[first,second].forEach(function(obj){for(var prop in obj){if(Object.prototype.hasOwnProperty.call(obj,prop)){target[prop]=obj[prop];}}
return target;});return target;}
function _isShapedLikeParsableError(err){return err.stack||err['opera#sourceloc'];}
function _filtered(stackframes,filter){if(typeof filter==='function'){return stackframes.filter(filter);}
return stackframes;}
return{get:function StackTrace$$get(opts){var err=_generateError();return _isShapedLikeParsableError(err)?this.fromError(err,opts):this.generateArtificially(opts);},getSync:function StackTrace$$getSync(opts){opts=_merge(_options,opts);var err=_generateError();var stack=_isShapedLikeParsableError(err)?ErrorStackParser.parse(err):StackGenerator.backtrace(opts);return _filtered(stack,opts.filter);},fromError:function StackTrace$$fromError(error,opts){opts=_merge(_options,opts);var gps=new StackTraceGPS(opts);return new Promise(function(resolve){var stackframes=_filtered(ErrorStackParser.parse(error),opts.filter);resolve(Promise.all(stackframes.map(function(sf){return new Promise(function(resolve){function resolveOriginal(){resolve(sf);}
gps.pinpoint(sf).then(resolve,resolveOriginal)['catch'](resolveOriginal);});})));}.bind(this));},generateArtificially:function StackTrace$$generateArtificially(opts){opts=_merge(_options,opts);var stackFrames=StackGenerator.backtrace(opts);if(typeof opts.filter==='function'){stackFrames=stackFrames.filter(opts.filter);}
return Promise.resolve(stackFrames);},instrument:function StackTrace$$instrument(fn,callback,errback,thisArg){if(typeof fn!=='function'){throw new Error('Cannot instrument non-function object');}else if(typeof fn.__stacktraceOriginalFn==='function'){return fn;}
var instrumented=function StackTrace$$instrumented(){try{this.get().then(callback,errback)['catch'](errback);return fn.apply(thisArg||this,arguments);}catch(e){if(_isShapedLikeParsableError(e)){this.fromError(e).then(callback,errback)['catch'](errback);}
throw e;}}.bind(this);instrumented.__stacktraceOriginalFn=fn;return instrumented;},deinstrument:function StackTrace$$deinstrument(fn){if(typeof fn!=='function'){throw new Error('Cannot de-instrument non-function object');}else if(typeof fn.__stacktraceOriginalFn==='function'){return fn.__stacktraceOriginalFn;}else{return fn;}},report:function StackTrace$$report(stackframes,url,errorMsg,requestOptions){return new Promise(function(resolve,reject){var req=new XMLHttpRequest();req.onerror=reject;req.onreadystatechange=function onreadystatechange(){if(req.readyState===4){if(req.status>=200&&req.status<400){resolve(req.responseText);}else{reject(new Error('POST to '+url+' failed with status: '+req.status));}}};req.open('post',url);req.setRequestHeader('Content-Type','application/json');if(requestOptions&&typeof requestOptions.headers==='object'){var headers=requestOptions.headers;for(var header in headers){if(Object.prototype.hasOwnProperty.call(headers,header)){req.setRequestHeader(header,headers[header]);}}}
var reportPayload={stack:stackframes};if(errorMsg!==undefined&&errorMsg!==null){reportPayload.message=errorMsg;}
req.send(JSON.stringify(reportPayload));});}};}));},{"error-stack-parser":1,"stack-generator":11,"stacktrace-gps":13}]},{},[14])(14)});;

/* /web/static/tests/helpers/cleanup.js defined in bundle 'web.tests_assets' */
odoo.define('@web/../tests/helpers/cleanup',async function(require){'use strict';let __exports={};const cleanups=[];__exports.registerCleanup=registerCleanup;function registerCleanup(callback){cleanups.push(callback);}
QUnit.on("OdooAfterTestHook",(info)=>{if(QUnit.config.debug){return;}
let cleanup;while((cleanup=cleanups.pop())){try{cleanup(info);}catch(error){console.error(error);}}});const validElements=[{tagName:"DIV",attr:"id",value:"qunit",keep:true},{tagName:"DIV",attr:"id",value:"qunit-fixture",keep:true},{tagName:"SCRIPT",attr:"id",value:""},{tagName:"DIV",attr:"class",value:"o_notification_manager"},{tagName:"DIV",attr:"class",value:"tooltip fade bs-tooltip-auto"},{tagName:"DIV",attr:"class",value:"tooltip fade bs-tooltip-auto show"},{tagName:"DIV",attr:"class",value:"tooltip tooltip-field-info fade bs-tooltip-auto"},{tagName:"DIV",attr:"class",value:"tooltip tooltip-field-info fade bs-tooltip-auto show"},{tagName:"SPAN",attr:"class",value:"select2-hidden-accessible"},{tagName:"DIV",attr:"class",value:"ui-helper-hidden-accessible"},{tagName:"UL",attr:"class",value:"ui-menu ui-widget ui-widget-content ui-autocomplete ui-front",},{tagName:"UL",attr:"class",value:"ui-menu ui-widget ui-widget-content ui-autocomplete dropdown-menu ui-front",},];QUnit.on("OdooAfterTestHook",function(info){if(QUnit.config.debug){return;}
const failed=info.testReport.getStatus()==="failed";const toRemove=[];for(const bodyChild of document.body.children){const tolerated=validElements.find((e)=>e.tagName===bodyChild.tagName&&bodyChild.getAttribute(e.attr)===e.value);if(!failed&&!tolerated){QUnit.pushFailure(`Body still contains undesirable elements:\n${bodyChild.outerHTML}`);}
if(!tolerated||!tolerated.keep){toRemove.push(bodyChild);}}
const qunitFixture=document.getElementById("qunit-fixture");if(qunitFixture.children.length){toRemove.push(...qunitFixture.children);}
for(const el of toRemove){el.remove();}
document.body.classList.remove("modal-open");});return __exports;});;

/* /web/static/tests/helpers/legacy.js defined in bundle 'web.tests_assets' */
odoo.define("web.SessionOverrideForTests",(require)=>{const{session:sessionInfo}=require("@web/session");const initialSessionInfo=Object.assign({},sessionInfo);const Session=require("web.Session");const{patch}=require("@web/core/utils/patch");patch(Session.prototype,"web.SessionTestPatch",{async session_reload(){for(const key in sessionInfo)delete sessionInfo[key];for(const key in initialSessionInfo){sessionInfo[key]=initialSessionInfo[key];}
return await this._super(...arguments);},});});odoo.define("web.test_legacy",async(require)=>{require("web.SessionOverrideForTests");const legacyProm=new Promise(async(resolve)=>{const session=require("web.session");await session.is_bound;require("web.test_utils");resolve();});return{legacyProm};});;

/* /web/static/tests/helpers/legacy_env_utils.js defined in bundle 'web.tests_assets' */
odoo.define('@web/../tests/helpers/legacy_env_utils',async function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{uiService}=require("@web/core/ui/ui_service");const{patch,unpatch}=require("@web/core/utils/patch");const{makeLegacyDialogMappingService}=require("@web/legacy/utils");const{hotkeyService}=require("@web/core/hotkeys/hotkey_service");const core=require("web.core");const makeTestEnvironment=require("web.test_env");const{registerCleanup}=require("@web/../tests/helpers/cleanup");const{makeTestEnv}=require("@web/../tests/helpers/mock_env");const{patchWithCleanup}=require("@web/../tests/helpers/utils");const FavoriteMenu=require("web.FavoriteMenu");const CustomFavoriteItem=require("web.CustomFavoriteItem");const serviceRegistry=registry.category("services");__exports.makeLegacyDialogMappingTestEnv=makeLegacyDialogMappingTestEnv;async function makeLegacyDialogMappingTestEnv(){const coreBusListeners=[];patch(core.bus,"legacy.core.bus.listeners",{on(eventName,thisArg,callback){this._super(...arguments);coreBusListeners.push({eventName,callback});},});const legacyEnv=makeTestEnvironment({bus:core.bus});serviceRegistry.add("ui",uiService);serviceRegistry.add("hotkey",hotkeyService);serviceRegistry.add("legacy_dialog_mapping",makeLegacyDialogMappingService(legacyEnv));const env=await makeTestEnv();registerCleanup(()=>{for(const listener of coreBusListeners){core.bus.off(listener.eventName,listener.callback);}
unpatch(core.bus,"legacy.core.bus.listeners");});return{legacyEnv,env,};}
function clearLegacyRegistryWithCleanup(r){const patch={map:Object.create(null),listeners:[...r.listeners],_scoreMapping:Object.create(null),_sortedKeys:null,};patchWithCleanup(r,patch);}
__exports.prepareLegacyRegistriesWithCleanup=prepareLegacyRegistriesWithCleanup;function prepareLegacyRegistriesWithCleanup(){clearLegacyRegistryWithCleanup(FavoriteMenu.registry);FavoriteMenu.registry.add("favorite-generator-menu",CustomFavoriteItem,0);}
return __exports;});;

/* /web/static/tests/helpers/mock_env.js defined in bundle 'web.tests_assets' */
odoo.define('@web/../tests/helpers/mock_env',async function(require){'use strict';let __exports={};const{registry}=require("@web/core/registry");const{makeEnv,startServices}=require("@web/env");const FormController=require("web.FormController");const{SERVICES_METADATA}=require("@web/env");const{registerCleanup}=require("@web/../tests/helpers/cleanup");const{makeMockServer}=require("@web/../tests/helpers/mock_server");const{mocks}=require("@web/../tests/helpers/mock_services");const{patchWithCleanup}=require("@web/../tests/helpers/utils");__exports.clearRegistryWithCleanup=clearRegistryWithCleanup;function clearRegistryWithCleanup(registry){const patch={content:{},elements:null,entries:null,subRegistries:{},subscriptions:{UPDATE:[...registry.subscriptions.UPDATE]},};patchWithCleanup(registry,patch);}
function cloneRegistryWithCleanup(registry){const patch={content:{...registry.content},elements:null,entries:null,subRegistries:{},subscriptions:{UPDATE:[...registry.subscriptions.UPDATE]},};patchWithCleanup(registry,patch);}
__exports.clearServicesMetadataWithCleanup=clearServicesMetadataWithCleanup;function clearServicesMetadataWithCleanup(){const servicesMetadata=Object.assign({},SERVICES_METADATA);for(const key of Object.keys(SERVICES_METADATA)){delete SERVICES_METADATA[key];}
registerCleanup(()=>{for(const key of Object.keys(SERVICES_METADATA)){delete SERVICES_METADATA[key];}
Object.assign(SERVICES_METADATA,servicesMetadata);});}
__exports.prepareRegistriesWithCleanup=prepareRegistriesWithCleanup;function prepareRegistriesWithCleanup(){cloneRegistryWithCleanup(registry.category("actions"));cloneRegistryWithCleanup(registry.category("views"));cloneRegistryWithCleanup(registry.category("error_handlers"));cloneRegistryWithCleanup(registry.category("command_provider"));cloneRegistryWithCleanup(registry.category("view_widgets"));cloneRegistryWithCleanup(registry.category("fields"));cloneRegistryWithCleanup(registry.category("main_components"));clearRegistryWithCleanup(registry.category("command_categories"));clearRegistryWithCleanup(registry.category("debug"));clearRegistryWithCleanup(registry.category("error_dialogs"));clearRegistryWithCleanup(registry.category("favoriteMenu"));clearRegistryWithCleanup(registry.category("ir.actions.report handlers"));clearRegistryWithCleanup(registry.category("services"));clearServicesMetadataWithCleanup();clearRegistryWithCleanup(registry.category("systray"));clearRegistryWithCleanup(registry.category("user_menuitems"));clearRegistryWithCleanup(registry.category("__processed_archs__"));}
__exports.makeTestEnv=makeTestEnv;async function makeTestEnv(config={}){const serviceRegistry=registry.category("services");const servicesToProcess=serviceRegistry.getAll();while(servicesToProcess.length){const service=servicesToProcess.pop();if(service.dependencies){for(let depName of service.dependencies){if(depName in mocks&&!serviceRegistry.contains(depName)){const dep=mocks[depName]();serviceRegistry.add(depName,dep);servicesToProcess.push(dep);}}}}
if(config.serverData||config.mockRPC||config.activateMockServer){makeMockServer(config.serverData,config.mockRPC);}
const initialQuickEditDelay=FormController.prototype.multiClickTime;FormController.prototype.multiClickTime=0;registerCleanup(()=>{FormController.prototype.multiClickTime=initialQuickEditDelay;});const env=makeEnv();env.config=config.config||{};await startServices(env);env.qweb.addTemplates(window.__ODOO_TEMPLATES__);return env;}
return __exports;});;

/* /web/static/tests/helpers/mock_server.js defined in bundle 'web.tests_assets' */
odoo.define('@web/../tests/helpers/mock_server',async function(require){'use strict';let __exports={};const{browser}=require("@web/core/browser/browser");const{Domain}=require("@web/core/domain");const{evaluateExpr}=require("@web/core/py_js/py");const{registry}=require("@web/core/registry");const{makeFakeRPCService,makeMockFetch}=require("@web/../tests/helpers/mock_services");const{patchWithCleanup}=require("@web/../tests/helpers/utils");const{parseDateTime}=require("@web/core/l10n/dates");const{DateTime}=luxon;const serviceRegistry=registry.category("services");function traverseElementTree(tree,cb){if(cb(tree)){Array.from(tree.children).forEach((c)=>traverseElementTree(c,cb));}}
__exports._fieldsViewGet=_fieldsViewGet;function _fieldsViewGet(params){let processedNodes=params.processedNodes||[];const{arch,context,fields,modelName}=params;function isNodeProcessed(node){return processedNodes.findIndex((n)=>n.isSameNode(node))>-1;}
const modifiersNames=["invisible","readonly","required"];const onchanges=params.models[modelName].onchanges||{};const fieldNodes={};const groupbyNodes={};let doc;if(typeof arch==="string"){const domParser=new DOMParser();doc=domParser.parseFromString(arch,"text/xml").documentElement;}else{doc=arch;}
const inTreeView=doc.tagName==="tree";const isBaseModel=!context.base_model_name||modelName===context.base_model_name;const views=["kanban","tree","form","gantt","activity"];if(isBaseModel&&views.indexOf(doc.tagName)!==-1){for(const action of["create","delete","edit","write"]){if(!doc.getAttribute(action)&&action in context&&!context[action]){doc.setAttribute(action,"false");}}}
traverseElementTree(doc,(node)=>{if(node.nodeType===Node.TEXT_NODE){return false;}
const modifiers={};const isField=node.tagName==="field";const isGroupby=node.tagName==="groupby";if(isField){const fieldName=node.getAttribute("name");fieldNodes[fieldName]=node;const field=fields[fieldName];if(!field){throw new Error("Field "+fieldName+" does not exist");}
const defaultValues={};const stateExceptions={};modifiersNames.forEach((attr)=>{stateExceptions[attr]=[];defaultValues[attr]=!!field[attr];});Object.entries(defaultValues).forEach(([attr,defaultValue])=>{if(stateExceptions[attr].length){modifiers[attr]=[["state",defaultValue?"not in":"in",stateExceptions[attr]],];}else{modifiers[attr]=defaultValue;}});}else if(isGroupby&&!isNodeProcessed(node)){const groupbyName=node.getAttribute("name");fieldNodes[groupbyName]=node;groupbyNodes[groupbyName]=node;}
let attrs=node.getAttribute("attrs");if(attrs){attrs=evaluateExpr(attrs);Object.assign(modifiers,attrs);}
const states=node.getAttribute("states");if(states){if(!modifiers.invisible){modifiers.invisible=[];}
modifiers.invisible.push(["state","not in",states.split(",")]);}
const inListHeader=inTreeView&&node.closest("header");modifiersNames.forEach((attr)=>{const mod=node.getAttribute(attr);if(mod){console.info("MockServer: naive parse of modifier value in",QUnit.config.current.testName);const v=JSON.parse(mod);if(inTreeView&&!inListHeader&&attr==="invisible"){modifiers.column_invisible=v;}else if(v||!(attr in modifiers)||!Array.isArray(modifiers[attr])){modifiers[attr]=v;}}});modifiersNames.forEach((attr)=>{if(attr in modifiers&&(!!modifiers[attr]===false||(Array.isArray(modifiers[attr])&&!modifiers[attr].length))){delete modifiers[attr];}});if(Object.keys(modifiers).length){node.setAttribute("modifiers",JSON.stringify(modifiers));}
if(isGroupby&&!isNodeProcessed(node)){return false;}
return!isField;});let relModel,relFields;Object.entries(fieldNodes).forEach(([name,node])=>{const field=fields[name];if(field.type==="many2one"||field.type==="many2many"){const canCreate=node.getAttribute("can_create");node.setAttribute("can_create",canCreate||"true");const canWrite=node.getAttribute("can_write");node.setAttribute("can_write",canWrite||"true");}
if(field.type==="one2many"||field.type==="many2many"){field.views={};Array.from(node.children).forEach((children)=>{if(children.tagName){relModel=field.relation;relFields=Object.assign({},params.models[relModel].fields);field.views[children.tagName]=_fieldsViewGet({models:params.models,arch:children,modelName:relModel,fields:relFields,context:Object.assign({},context,{base_model_name:modelName}),processedNodes,});}});}
if(name in onchanges){node.setAttribute("on_change","1");}});Object.entries(groupbyNodes).forEach(([name,node])=>{const field=fields[name];if(field.type!=="many2one"){throw new Error("groupby can only target many2one");}
field.views={};relModel=field.relation;relFields=Object.assign({},params.models[relModel].fields);processedNodes.push(node);field.views.groupby=_fieldsViewGet({models:params.models,arch:node,modelName:relModel,fields:relFields,context,processedNodes,});while(node.firstChild){node.removeChild(node.firstChild);}});const xmlSerializer=new XMLSerializer();const processedArch=xmlSerializer.serializeToString(doc);const fieldsInView={};Object.entries(fields).forEach(([fname,field])=>{if(fname in fieldNodes){fieldsInView[fname]=field;}});return{arch:processedArch,fields:fieldsInView,model:modelName,type:doc.tagName==="tree"?"list":doc.tagName,};}
const MockServer=__exports.MockServer=class MockServer{constructor(data,options={}){this.models=data.models||{};this.actions=data.actions||{};this.menus=data.menus||null;this.archs=data.views||{};this.debug=options.debug||false;Object.entries(this.models).forEach(([modelName,model])=>{if(!("id"in model.fields)){model.fields.id={string:"ID",type:"integer"};}
if(!("display_name"in model.fields)){model.fields.display_name={string:"Display Name",type:"char"};}
if(!("__last_update"in model.fields)){model.fields.__last_update={string:"Last Modified on",type:"datetime"};}
if(!("name"in model.fields)){model.fields.name={string:"Name",type:"char",default:"name"};}
model.records=model.records||[];for(var i=0;i<model.records.length;i++){const values=model.records[i];const id=values.id===undefined?this.getUnusedID(modelName):values.id;model.records[i]={id};this.applyDefaults(model,values);this.writeRecord(modelName,values,id,{ensureIntegrity:false});}
model.onchanges=model.onchanges||{};model.methods=model.methods||{};});}
async performRPC(route,args){args=JSON.parse(JSON.stringify(args));if(this.debug){console.log("%c[rpc] request "+route,"color: blue; font-weight: bold;",args);args=JSON.parse(JSON.stringify(args));}
let result;result=await this._performRPC(route,args);const resultString=JSON.stringify(result||false);if(this.debug){console.log("%c[rpc] response"+route,"color: blue; font-weight: bold;",JSON.parse(resultString));}
return JSON.parse(resultString);}
fieldsViewGet(modelName,args,kwargs){if(!(modelName in this.models)){throw new Error(`Model ${modelName} was not defined in mock server data`);}
let[viewId,viewType]=args;if(!viewId){const contextKey=(viewType==="list"?"tree":viewType)+"_view_ref";if(contextKey in kwargs.context){viewId=kwargs.context[contextKey];}}
const key=[modelName,viewId,viewType].join(",");let arch=this.archs[key];if(!arch){const genericViewKey=Object.keys(this.archs).find((fullKey)=>{const[_model,,_viewType]=fullKey.split(",");return _model===modelName&&_viewType===viewType;});if(genericViewKey){arch=this.archs[genericViewKey];viewId=parseInt(genericViewKey.split(",")[1],10)||false;}}
if(!arch){throw new Error("No arch found for key "+key);}
const fields=Object.assign({},this.models[modelName].fields);for(const fieldName in fields){fields[fieldName].name=fieldName;}
const fvg=_fieldsViewGet({arch,modelName,fields,context:kwargs.context||{},models:this.models,});if(kwargs.options.toolbar){fvg.toolbar=this.models[modelName].toolbar||{};}
if(viewId!==undefined){fvg.view_id=viewId;fvg.name=key;}
return fvg;}
convertToOnChange(modelName,values){Object.entries(values).forEach(([fname,val])=>{const field=this.models[modelName].fields[fname];if(field.type==="many2one"&&typeof val==="number"){const m2oRecord=this.models[field.relation].records.find((r)=>r.id===val);values[fname]=[val,m2oRecord.display_name];}else if(field.type==="one2many"||field.type==="many2many"){const isCommandList=Array.isArray(val)&&Array.isArray(val[0]);if(!isCommandList){values[fname]=[[6,false,val]];}else{val.forEach((cmd)=>{if(cmd[0]===0||cmd[0]===1){cmd[2]=this.convertToOnChange(field.relation,cmd[2]);}});}}});return values;}
async _performRPC(route,args){const methodName=args.method||route;const mockFunction=registry.category("mock_server").get(`${args.model}/${methodName}`,null)||registry.category("mock_server").get(methodName,null);if(mockFunction){return mockFunction.call(this,route,args);}
switch(route){case"/web/webclient/load_menus":return this.mockLoadMenus();case"/web/action/load":return this.mockLoadAction(args);case"/web/dataset/search_read":return this.mockSearchReadController(args);}
if(route.indexOf("/web/image")>=0||[".png",".jpg"].includes(route.substr(route.length-4))){return;}
switch(args.method){case"render_public_asset":{return true;}
case"create":return this.mockCreate(args.model,args.args[0]);case"fields_get":return this.mockFieldsGet(args.model);case"load_views":return this.mockLoadViews(args.model,args.kwargs);case"name_create":return this.mockNameCreate(args.model,args.args[0]);case"name_get":return this.mockNameGet(args.model,args.args);case"name_search":return this.mockNameSearch(args.model,args.args,args.kwargs);case"onchange":return this.mockOnchange(args.model,args.args,args.kwargs);case"read":return this.mockRead(args.model,args.args);case"search":return this.mockSearch(args.model,args.args,args.kwargs);case"search_count":return this.mockSearchCount(args.model,args.args,args.kwargs);case"search_panel_select_range":return this.mockSearchPanelSelectRange(args.model,args.args,args.kwargs);case"search_panel_select_multi_range":return this.mockSearchPanelSelectMultiRange(args.model,args.args,args.kwargs);case"search_read":return this.mockSearchRead(args.model,args.args,args.kwargs);case"unlink":return this.mockUnlink(args.model,args.args);case"web_search_read":return this.mockWebSearchRead(args.model,args.args,args.kwargs);case"read_group":return this.mockReadGroup(args.model,args.kwargs);case"web_read_group":return this.mockWebReadGroup(args.model,args.kwargs);case"write":return this.mockWrite(args.model,args.args);}
const model=this.models[args.model];const method=model&&model.methods[args.method];if(method){return method(args.model,args.args,args.kwargs);}
throw new Error(`Unimplemented route: ${route}`);}
mockCreate(modelName,values){if("id"in values){throw new Error("Cannot create a record with a predefinite id");}
const model=this.models[modelName];const id=this.getUnusedID(modelName);const record={id};model.records.push(record);this.applyDefaults(model,values);this.writeRecord(modelName,values,id);return id;}
mockDefaultGet(modelName,args,kwargs={}){const fields=args[0];const model=this.models[modelName];const result={};for(const fieldName of fields){const key="default_"+fieldName;if(kwargs.context&&key in kwargs.context){result[fieldName]=kwargs.context[key];continue;}
const field=model.fields[fieldName];if("default"in field){result[fieldName]=field.default;continue;}}
for(const fieldName in result){const field=model.fields[fieldName];if(field.type==="many2one"){const recordExists=this.models[field.relation].records.some((r)=>r.id===result[fieldName]);if(!recordExists){delete result[fieldName];}}}
return result;}
mockFieldsGet(modelName){return this.models[modelName].fields;}
mockLoadAction(kwargs){const action=this.actions[kwargs.action_id];if(!action){console.warn(`No action found for ID ${kwargs.action_id} during test ${QUnit.config.current.testName}`);}
return action||false;}
mockLoadMenus(){let menus=this.menus;if(!menus){menus={root:{id:"root",children:[1],name:"root",appID:"root"},1:{id:1,children:[],name:"App0",appID:1},};}
return menus;}
mockLoadViews(modelName,kwargs){const fieldsViews={};kwargs.views.forEach(([viewId,viewType])=>{fieldsViews[viewType]=this.fieldsViewGet(modelName,[viewId,viewType],kwargs);});const result={fields:this.mockFieldsGet(modelName),fields_views:fieldsViews,};if(kwargs.options.load_filters){result.filters=this.models[modelName].filters||[];}
return result;}
mockNameCreate(modelName,name){const values={name:name,display_name:name,};const id=this.mockCreate(modelName,values);return[id,name];}
mockNameGet(model,args){var ids=args[0];if(!args.length){throw new Error("name_get: expected one argument");}else if(!ids){return[];}
if(!Array.isArray(ids)){ids=[ids];}
var records=this.models[model].records;var names=ids.map((id)=>id?[id,records.find((r)=>r.id===id).display_name]:[null,"False"]);return names;}
mockNameSearch(model,args,kwargs){const str=args&&typeof args[0]==="string"?args[0]:kwargs.name;const limit=kwargs.limit||100;const domain=(args&&args[1])||kwargs.args||[];let{records}=this.models[model];const result=[];for(const r of records){const isInDomain=this.evaluateDomain(domain,r);if(isInDomain&&(!str.length||r.display_name.includes(str))){result.push([r.id,r.display_name]);}}
return result.slice(0,limit);}
mockOnchange(modelName,args,kwargs){const currentData=args[1];const onChangeSpec=args[3];let fields=args[2]?(Array.isArray(args[2])?args[2]:[args[2]]):[];const onchanges=this.models[modelName].onchanges||{};const firstOnChange=!fields.length;const onchangeVals={};let defaultVals=undefined;let nullValues;if(firstOnChange){const fieldsFromView=Object.keys(onChangeSpec).reduce((acc,fname)=>{fname=fname.split(".",1)[0];if(!acc.includes(fname)){acc.push(fname);}
return acc;},[]);const defaultingFields=fieldsFromView.filter((fname)=>!(fname in currentData));defaultVals=this.mockDefaultGet(modelName,[defaultingFields],kwargs);fields=fieldsFromView;nullValues={};fields.filter((fName)=>!Object.keys(defaultVals).includes(fName)).forEach((fName)=>{nullValues[fName]=false;});}
Object.assign(currentData,defaultVals);fields.forEach((field)=>{if(field in onchanges){const changes=Object.assign({},nullValues,currentData);onchanges[field](changes);Object.entries(changes).forEach(([key,value])=>{if(currentData[key]!==value){onchangeVals[key]=value;}});}});return{value:this.convertToOnChange(modelName,Object.assign({},defaultVals,onchangeVals)),};}
mockRead(modelName,args){const model=this.models[modelName];let fields;if(args[1]&&args[1].length){fields=[...new Set(args[1].concat(["id"]))];}else{fields=Object.keys(model.fields);}
const ids=Array.isArray(args[0])?args[0]:[args[0]];const records=ids.reduce((records,id)=>{if(!id){throw new Error("mock read: falsy value given as id, would result in an access error in actual server !");}
const record=model.records.find((r)=>r.id===id);return record?records.concat(record):records;},[]);return records.map((record)=>{const result={id:record.id};for(const fieldName of fields){const field=model.fields[fieldName];if(!field){continue;}
if(["float","integer","monetary"].includes(field.type)){result[fieldName]=record[fieldName]||0;}else if(field.type==="many2one"){const CoModel=this.models[field.relation];const relRecord=CoModel.records.find((r)=>r.id===record[fieldName]);if(relRecord){result[fieldName]=[record[fieldName],relRecord.display_name];}else{result[fieldName]=false;}}else if(field.type==="one2many"||field.type==="many2many"){result[fieldName]=record[fieldName]||[];}else{result[fieldName]=record[fieldName]||false;}}
return result;});}
mockReadGroup(modelName,kwargs){if(!("lazy"in kwargs)){kwargs.lazy=true;}
const fields=this.models[modelName].fields;const records=this.getRecords(modelName,kwargs.domain);let groupBy=[];if(kwargs.groupby.length){groupBy=kwargs.lazy?[kwargs.groupby[0]]:kwargs.groupby;}
const groupByFieldNames=groupBy.map((groupByField)=>{return groupByField.split(":")[0];});let aggregatedFields=[];if(kwargs.fields.length===0){aggregatedFields=Object.keys(fields).filter((fieldName)=>!groupByFieldNames.includes(fieldName));}else{kwargs.fields.forEach((field)=>{var split=field.split(":");var fieldName=split[0];if(!fields[fieldName]){return;}
if(groupByFieldNames.includes(fieldName)){return;}
if(fields[fieldName]&&fields[fieldName].type==="many2one"&&split[1]!=="count_distinct"){return;}
aggregatedFields.push(fieldName);});}
function aggregateFields(group,records){let type;for(let i=0;i<aggregatedFields.length;i++){type=fields[aggregatedFields[i]].type;if(type==="float"||type==="integer"){group[aggregatedFields[i]]=null;for(let j=0;j<records.length;j++){const value=group[aggregatedFields[i]]||0;group[aggregatedFields[i]]=value+records[j][aggregatedFields[i]];}}
if(type==="many2one"){const ids=records.map((record)=>record[aggregatedFields[i]]);group[aggregatedFields[i]]=[...new Set(ids)].length||null;}}}
function formatValue(groupByField,val){if(val===false||val===undefined){return false;}
const[fieldName,aggregateFunction="month"]=groupByField.split(":");const{type}=fields[fieldName];if(type==="date"){const date=DateTime.fromSQL(val);if(aggregateFunction==="day"){return date.toFormat("yyyy-MM-dd");}else if(aggregateFunction==="week"){return`W${date.toFormat("WW kkkk")}`;}else if(aggregateFunction==="quarter"){return`Q${date.toFormat("q yyyy")}`;}else if(aggregateFunction==="year"){return date.toFormat("yyyy");}else{return date.toFormat("MMMM yyyy");}}else if(type==="datetime"){const date=DateTime.fromSQL(val);if(aggregateFunction==="hour"){return date.toFormat("HH:00 dd MMM");}else if(aggregateFunction==="day"){return date.toFormat("yyyy-MM-dd");}else if(aggregateFunction==="week"){return`W${date.toFormat("WW kkkk")}`;}else if(aggregateFunction==="quarter"){return`Q${date.toFormat("q yyyy")}`;}else if(aggregateFunction==="year"){return date.toFormat("yyyy");}else{return date.toFormat("MMMM yyyy");}}else if(Array.isArray(val)){if(val.length===0){return false;}
return type==="many2many"?val:val[0];}else{return val;}}
if(!groupBy.length){const group={__count:records.length};aggregateFields(group,records);return[group];}
const groups={};for(const r of records){let recordGroupValues=[];for(const gbField of groupBy){const[fieldName]=gbField.split(":");let value=formatValue(gbField,r[fieldName]);if(!Array.isArray(value)){value=[value];}
recordGroupValues=value.reduce((acc,val)=>{const newGroup={};newGroup[gbField]=val;if(recordGroupValues.length===0){acc.push(newGroup);}else{for(const groupValue of recordGroupValues){acc.push({...groupValue,...newGroup});}}
return acc;},[]);}
for(const groupValue of recordGroupValues){const valueKey=JSON.stringify(groupValue);groups[valueKey]=groups[valueKey]||[];groups[valueKey].push(r);}}
let readGroupResult=[];for(const[groupId,groupRecords]of Object.entries(groups)){const group={...JSON.parse(groupId),__domain:kwargs.domain||[],__range:{},};for(const gbField of groupBy){if(!(gbField in group)){group[gbField]=false;continue;}
const[fieldName,dateRange]=gbField.split(":");const value=Number.isInteger(group[gbField])?group[gbField]:group[gbField]||false;const{relation,type}=fields[fieldName];if(["many2one","many2many"].includes(type)&&!Array.isArray(value)){const relatedRecord=this.models[relation].records.find(({id})=>id===value);if(relatedRecord){group[gbField]=[value,relatedRecord.display_name];}else{group[gbField]=false;}}
if(["date","datetime"].includes(type)){if(value){let startDate,endDate;switch(dateRange){case"hour":{try{startDate=parseDateTime(value,{format:"HH dd MMM"});}catch{startDate=parseDateTime(value,{format:"HH:00 dd MMM"});}
endDate=startDate.plus({hours:1});break;}
case"day":{startDate=parseDateTime(value,{format:"yyyy-MM-dd"});endDate=startDate.plus({days:1});break;}
case"week":{startDate=parseDateTime(value,{format:"WW kkkk"});endDate=startDate.plus({weeks:1});break;}
case"quarter":{startDate=parseDateTime(value,{format:"q yyyy"});endDate=startDate.plus({quarters:1});break;}
case"year":{startDate=parseDateTime(value,{format:"y"});endDate=startDate.plus({years:1});break;}
case"month":default:{startDate=parseDateTime(value,{format:"MMMM yyyy"});endDate=startDate.plus({months:1});break;}}
const from=type==="date"?startDate.toFormat("yyyy-MM-dd"):startDate.toFormat("yyyy-MM-dd HH:mm:ss");const to=type==="date"?endDate.toFormat("yyyy-MM-dd"):endDate.toFormat("yyyy-MM-dd HH:mm:ss");group.__range[fieldName]={from,to};group.__domain=[[fieldName,">=",from],[fieldName,"<",to],].concat(group.__domain);}else{group.__range[fieldName]=false;group.__domain=[[fieldName,"=",value]].concat(group.__domain);}}else{group.__domain=[[fieldName,"=",value]].concat(group.__domain);}}
if(_.isEmpty(group.__range)){delete group.__range;}
const countKey=kwargs.lazy?groupBy[0].split(":")[0]+"_count":"__count";group[countKey]=groupRecords.length;aggregateFields(group,groupRecords);readGroupResult.push(group);}
if(kwargs.orderby){kwargs.orderby=kwargs.orderby.split(",")[0];const fieldName=kwargs.orderby.split(" ")[0];const order=kwargs.orderby.split(" ")[1];readGroupResult=this.sortByField(readGroupResult,modelName,fieldName,order);}
if(kwargs.limit){const offset=kwargs.offset||0;readGroupResult=readGroupResult.slice(offset,kwargs.limit+offset);}
return readGroupResult;}
mockWebReadGroup(modelName,kwargs){const groups=this.mockReadGroup(modelName,kwargs);if(kwargs.expand&&kwargs.groupby.length===1){groups.forEach((group)=>{group.__data=this.mockSearchReadController({domain:group.__domain,model:modelName,fields:kwargs.fields,limit:kwargs.expand_limit,sort:kwargs.expand_orderby,});});}
const allGroups=this.mockReadGroup(modelName,{domain:kwargs.domain,fields:["display_name"],groupby:kwargs.groupby,lazy:kwargs.lazy,});return{groups:groups,length:allGroups.length,};}
mockSearchPanelFieldImage(model,fieldName,kwargs){const enableCounters=kwargs.enable_counters;const onlyCounters=kwargs.only_counters;const extraDomain=kwargs.extra_domain||[];const normalizedExtra=new Domain(extraDomain).toList();const noExtra=JSON.stringify(normalizedExtra)==="[]";const modelDomain=kwargs.model_domain||[];const countDomain=new Domain([...modelDomain,...extraDomain]).toList();const limit=kwargs.limit;const setLimit=kwargs.set_limit;if(onlyCounters){return this.mockSearchPanelDomainImage(model,fieldName,countDomain,true);}
const modelDomainImage=this.mockSearchPanelDomainImage(model,fieldName,modelDomain,enableCounters&&noExtra,setLimit&&limit);if(enableCounters&&!noExtra){const countDomainImage=this.mockSearchPanelDomainImage(model,fieldName,countDomain,true);for(const[id,values]of modelDomainImage.entries()){const element=countDomainImage.get(id);values.__count=element?element.__count:0;}}
return modelDomainImage;}
mockSearchPanelDomainImage(model,fieldName,domain,setCount=false,limit=false){const field=this.models[model].fields[fieldName];let groupIdName;if(field.type==="many2one"){groupIdName=(value)=>value||[false,undefined];}else if(field.type==="selection"){const selection={};for(const[value,label]of this.models[model].fields[fieldName].selection){selection[value]=label;}
groupIdName=(value)=>[value,selection[value]];}
domain=new Domain([...domain,[fieldName,"!=",false]]).toList();const groups=this.mockReadGroup(model,{domain,fields:[fieldName],groupby:[fieldName],limit,});const domainImage=new Map();for(const group of groups){const[id,display_name]=groupIdName(group[fieldName]);const values={id,display_name};if(setCount){values.__count=group[fieldName+"_count"];}
domainImage.set(id,values);}
return domainImage;}
mockSearchPanelGlobalCounters(valuesRange,parentName){const localCounters=[...valuesRange.keys()].map((id)=>valuesRange.get(id).__count);for(let[id,values]of valuesRange.entries()){const count=localCounters[id];if(count){let parent_id=values[parentName];while(parent_id){values=valuesRange.get(parent_id);values.__count+=count;parent_id=values[parentName];}}}}
mockSearchPanelSanitizedParentHierarchy(records,parentName,ids){const getParentId=(record)=>record[parentName]&&record[parentName][0];const allowedRecords={};for(const record of records){allowedRecords[record.id]=record;}
const recordsToKeep={};for(const id of ids){const ancestorChain={};let recordId=id;let chainIsFullyIncluded=true;while(chainIsFullyIncluded&&recordId){const knownStatus=recordsToKeep[recordId];if(knownStatus!==undefined){chainIsFullyIncluded=knownStatus;break;}
const record=allowedRecords[recordId];if(record){ancestorChain[recordId]=record;recordId=getParentId(record);}else{chainIsFullyIncluded=false;}}
for(const id in ancestorChain){recordsToKeep[id]=chainIsFullyIncluded;}}
return records.filter((rec)=>recordsToKeep[rec.id]);}
mockSearchPanelSelectionRange(model,fieldName,kwargs){const enableCounters=kwargs.enable_counters;const expand=kwargs.expand;let domainImage;if(enableCounters||!expand){const newKwargs=Object.assign({},kwargs,{only_counters:expand,});domainImage=this.mockSearchPanelFieldImage(model,fieldName,newKwargs);}
if(!expand){return[...domainImage.values()];}
const selection=this.models[model].fields[fieldName].selection;const selectionRange=[];for(const[value,label]of selection){const values={id:value,display_name:label,};if(enableCounters){values.__count=domainImage.get(value)?domainImage.get(value).__count:0;}
selectionRange.push(values);}
return selectionRange;}
mockSearchPanelSelectRange(model,[fieldName],kwargs){const field=this.models[model].fields[fieldName];const supportedTypes=["many2one","selection"];if(!supportedTypes.includes(field.type)){throw new Error(`Only types ${supportedTypes} are supported for category (found type ${field.type})`);}
const modelDomain=kwargs.search_domain||[];const extraDomain=new Domain([...(kwargs.category_domain||[]),...(kwargs.filter_domain||[]),]).toList();if(field.type==="selection"){const newKwargs=Object.assign({},kwargs,{model_domain:modelDomain,extra_domain:extraDomain,});kwargs.model_domain=modelDomain;return{parent_field:false,values:this.mockSearchPanelSelectionRange(model,fieldName,newKwargs),};}
const fieldNames=["display_name"];let hierarchize="hierarchize"in kwargs?kwargs.hierarchize:true;let getParentId;let parentName=false;if(hierarchize&&this.models[field.relation].fields.parent_id){parentName="parent_id";fieldNames.push(parentName);getParentId=(record)=>record.parent_id&&record.parent_id[0];}else{hierarchize=false;}
let comodelDomain=kwargs.comodel_domain||[];const enableCounters=kwargs.enable_counters;const expand=kwargs.expand;const limit=kwargs.limit;let domainImage;if(enableCounters||!expand){const newKwargs=Object.assign({},kwargs,{model_domain:modelDomain,extra_domain:extraDomain,only_counters:expand,set_limit:limit&&!(expand||hierarchize||comodelDomain),});domainImage=this.mockSearchPanelFieldImage(model,fieldName,newKwargs);}
if(!expand&&!hierarchize&&!comodelDomain.length){if(limit&&domainImage.size===limit){return{error_msg:"Too many items to display."};}
return{parent_field:parentName,values:[...domainImage.values()],};}
let imageElementIds;if(!expand){imageElementIds=[...domainImage.keys()].map(Number);let condition;if(hierarchize){const records=this.models[field.relation].records;const ancestorIds=new Set();for(const id of imageElementIds){let recordId=id;let record;while(recordId){ancestorIds.add(recordId);record=records.find((rec)=>rec.id===recordId);recordId=record[parentName];}}
condition=["id","in",[...new Set(ancestorIds)]];}else{condition=["id","in",imageElementIds];}
comodelDomain=new Domain([...comodelDomain,condition]).toList();}
let comodelRecords=this.mockSearchRead(field.relation,[comodelDomain,fieldNames],{limit,});if(hierarchize){const ids=expand?comodelRecords.map((rec)=>rec.id):imageElementIds;comodelRecords=this.mockSearchPanelSanitizedParentHierarchy(comodelRecords,parentName,ids);}
if(limit&&comodelRecords.length===limit){return{error_msg:"Too many items to display."};}
const fieldRange=new Map();for(const record of comodelRecords){const values={id:record.id,display_name:record.display_name,};if(hierarchize){values[parentName]=getParentId(record);}
if(enableCounters){values.__count=domainImage.get(record.id)?domainImage.get(record.id).__count:0;}
fieldRange.set(record.id,values);}
if(hierarchize&&enableCounters){this.mockSearchPanelGlobalCounters(fieldRange,parentName);}
return{parent_field:parentName,values:[...fieldRange.values()],};}
mockSearchPanelSelectMultiRange(model,[fieldName],kwargs){const field=this.models[model].fields[fieldName];const supportedTypes=["many2one","many2many","selection"];if(!supportedTypes.includes(field.type)){throw new Error(`Only types ${supportedTypes} are supported for filter (found type ${field.type})`);}
let modelDomain=kwargs.search_domain||[];let extraDomain=new Domain([...(kwargs.category_domain||[]),...(kwargs.filter_domain||[]),]).toList();if(field.type==="selection"){const newKwargs=Object.assign({},kwargs,{model_domain:modelDomain,extra_domain:extraDomain,});return{values:this.mockSearchPanelSelectionRange(model,fieldName,newKwargs),};}
const fieldNames=["display_name"];const groupBy=kwargs.group_by;let groupIdName;if(groupBy){const groupByField=this.models[field.relation].fields[groupBy];fieldNames.push(groupBy);if(groupByField.type==="many2one"){groupIdName=(value)=>value||[false,"Not set"];}else if(groupByField.type==="selection"){const groupBySelection=Object.assign({},this.models[field.relation].fields[groupBy].selection);groupBySelection[false]="Not Set";groupIdName=(value)=>[value,groupBySelection[value]];}else{groupIdName=(value)=>(value?[value,value]:[false,"Not set"]);}}
let comodelDomain=kwargs.comodel_domain||[];const enableCounters=kwargs.enable_counters;const expand=kwargs.expand;const limit=kwargs.limit;if(field.type==="many2many"){const comodelRecords=this.mockSearchRead(field.relation,[comodelDomain,fieldNames],{limit,});if(expand&&limit&&comodelRecords.length===limit){return{error_msg:"Too many items to display."};}
const groupDomain=kwargs.group_domain;const fieldRange=[];for(const record of comodelRecords){const values={id:record.id,display_name:record.display_name,};let groupId;if(groupBy){const[gId,gName]=groupIdName(record[groupBy]);values.group_id=groupId=gId;values.group_name=gName;}
let count;let inImage;if(enableCounters||!expand){const searchDomain=new Domain([...modelDomain,[fieldName,"in",record.id],]).toList();let localExtraDomain=extraDomain;if(groupBy&&groupDomain){localExtraDomain=new Domain([...localExtraDomain,...(groupDomain[JSON.stringify(groupId)]||[]),]).toList();}
const searchCountDomain=new Domain([...searchDomain,...localExtraDomain,]).toList();if(enableCounters){count=this.mockSearchCount(model,[searchCountDomain]);}
if(!expand){if(enableCounters&&JSON.stringify(localExtraDomain)==="[]"){inImage=count;}else{inImage=this.mockSearch(model,[searchDomain],{limit:1}).length;}}}
if(expand||inImage){if(enableCounters){values.__count=count;}
fieldRange.push(values);}}
if(!expand&&limit&&fieldRange.length===limit){return{error_msg:"Too many items to display."};}
return{values:fieldRange};}
if(field.type==="many2one"){let domainImage;if(enableCounters||!expand){extraDomain=new Domain([...extraDomain,...(kwargs.group_domain||[])]).toList();modelDomain=new Domain([...modelDomain,...(kwargs.group_domain||[])]).toList();const newKwargs=Object.assign({},kwargs,{model_domain:modelDomain,extra_domain:extraDomain,only_counters:expand,set_limit:limit&&!(expand||groupBy||comodelDomain),});domainImage=this.mockSearchPanelFieldImage(model,fieldName,newKwargs);}
if(!expand&&!groupBy&&!comodelDomain.length){if(limit&&domainImage.size===limit){return{error_msg:"Too many items to display."};}
return{values:[...domainImage.values()]};}
if(!expand){const imageElementIds=[...domainImage.keys()].map(Number);comodelDomain=new Domain([...comodelDomain,["id","in",imageElementIds],]).toList();}
const comodelRecords=this.mockSearchRead(field.relation,[comodelDomain,fieldNames],{limit,});if(limit&&comodelRecords.length===limit){return{error_msg:"Too many items to display."};}
const fieldRange=[];for(const record of comodelRecords){const values={id:record.id,display_name:record.display_name,};if(groupBy){const[groupId,groupName]=groupIdName(record[groupBy]);values.group_id=groupId;values.group_name=groupName;}
if(enableCounters){values.__count=domainImage.get(record.id)?domainImage.get(record.id).__count:0;}
fieldRange.push(values);}
return{values:fieldRange};}}
mockSearch(modelName,args,kwargs){const result=this.mockSearchController({model:modelName,domain:kwargs.domain||args[0],fields:kwargs.fields||args[1],offset:kwargs.offset||args[2],limit:kwargs.limit||args[3],sort:kwargs.order||args[4],context:kwargs.context,});return result.records.map((r)=>r.id);}
mockSearchCount(model,args){return this.getRecords(model,args[0]).length;}
mockSearchRead(modelName,args,kwargs){const result=this.mockSearchReadController({model:modelName,domain:kwargs.domain||args[0],fields:kwargs.fields||args[1],offset:kwargs.offset||args[2],limit:kwargs.limit||args[3],sort:kwargs.order||args[4],context:kwargs.context,});return result.records;}
mockUnlink(modelName,[ids]){ids=Array.isArray(ids)?ids:[ids];this.models[modelName].records=this.models[modelName].records.filter((record)=>!ids.includes(record.id));for(const{fields,records}of Object.values(this.models)){for(const[fieldName,field]of Object.entries(fields)){if(field.relation===modelName){for(const record of records){if(Array.isArray(record[fieldName])){record[fieldName]=record[fieldName].filter((id)=>!ids.includes(id))}else if(ids.includes(record[fieldName])){record[fieldName]=false;}}}}}
return true;}
mockWebSearchRead(modelName,args,kwargs){const result=this.mockSearchReadController({model:modelName,domain:kwargs.domain||args[0],fields:kwargs.fields||args[1],offset:kwargs.offset||args[2],limit:kwargs.limit||args[3],sort:kwargs.order||args[4],context:kwargs.context,});return result;}
mockSearchController(params){const model=this.models[params.model];let fieldNames=params.fields;const offset=params.offset||0;if(!fieldNames||!fieldNames.length){fieldNames=Object.keys(model.fields);}
fieldNames=[...new Set(fieldNames.concat(["id"]))];const{context}=params;const active_test=context&&"active_test"in context?context.active_test:true;let records=this.getRecords(params.model,params.domain||[],Object.assign({},params.context,{active_test}));if(params.sort){params.sort=params.sort.split(",")[0];const fieldName=params.sort.split(" ")[0];const order=params.sort.split(" ")[1];records=this.sortByField(records,params.model,fieldName,order);}
const nbRecords=records.length;records=records.slice(offset,params.limit?offset+params.limit:nbRecords);return{fieldNames,length:nbRecords,records,};}
mockSearchReadController(params){const{fieldNames,length,records}=this.mockSearchController(params);return{length,records:this.mockRead(params.model,[records.map((r)=>r.id),fieldNames]),};}
mockWrite(modelName,args){args[0].forEach((id)=>this.writeRecord(modelName,args[1],id));return true;}
evaluateDomain(domain,record){return new Domain(domain).contains(record);}
getRecords(modelName,domain,{active_test=true}={}){if(!Array.isArray(domain)){throw new Error("MockServer._getRecords: given domain has to be an array.");}
const model=this.models[modelName];if(active_test&&"active"in model.fields){const activeInDomain=domain.some((subDomain)=>subDomain[0]==="active");if(!activeInDomain){domain=domain.concat([["active","=",true]]);}}
let records=model.records;if(domain.length){domain=domain.map((criterion)=>{if(criterion[1]==="child_of"){let oldLength=0;const childIDs=[criterion[2]];while(childIDs.length>oldLength){oldLength=childIDs.length;records.forEach((r)=>{if(childIDs.indexOf(r.parent_id)>=0){childIDs.push(r.id);}});}
criterion=[criterion[0],"in",childIDs];}
const field=model.fields[criterion[0]]||{};if(field.type==="many2many"&&criterion[1]==="="){if(criterion[2]===false){criterion=[criterion[0],"=",[]];}else{criterion=[criterion[0],"in",[criterion[2]]];}}
return criterion;});records=records.filter((record)=>this.evaluateDomain(domain,record));}
return records;}
sortByField(records,modelName,fieldName,order){const field=this.models[modelName].fields[fieldName];records.sort((r1,r2)=>{let v1=r1[fieldName];let v2=r2[fieldName];if(field.type==="many2one"){const coRecords=this.models[field.relation].records;if(this.models[field.relation].fields.sequence){v1=coRecords.find((r)=>r.id===v1[0]).sequence;v2=coRecords.find((r)=>r.id===v2[0]).sequence;}else{v1=v1[0];v2=v2[0];}}
if(v1<v2){return order==="ASC"?-1:1;}
if(v1>v2){return order==="ASC"?1:-1;}
return 0;});return records;}
writeRecord(modelName,values,id,{ensureIntegrity=true}={}){const model=this.models[modelName];const record=model.records.find((r)=>r.id===id);for(const fieldName in values){const field=model.fields[fieldName];let value=values[fieldName];if(!field){throw Error(`Mock: Can't write value "${JSON.stringify(
                        value
                    )}" on field "${fieldName}" on record "${model},${id}" (field is undefined)`);}
if(["one2many","many2many"].includes(field.type)){let ids=record[fieldName]?record[fieldName].slice():[];if(Array.isArray(value)){if(value.reduce((hasOnlyInt,val)=>hasOnlyInt&&Number.isInteger(val),true)){value=[[6,0,value]];}}else if(value===false){value=[[5]];}
for(const command of value||[]){if(command[0]===0){const newId=this.mockCreate(field.relation,command[2]);ids.push(newId);}else if(command[0]===1){this.mockWrite(field.relation,[[command[1]],command[2]]);}else if(command[0]===2||command[0]===3){ids.splice(ids.indexOf(command[1]),1);}else if(command[0]===4){if(!ids.includes(command[1])){ids.push(command[1]);}}else if(command[0]===5){ids=[];}else if(command[0]===6){ids=[...command[2]];}else{throw Error(`Command "${JSON.stringify(
                                value
                            )}" not supported by the MockServer on field "${fieldName}" on record "${model},${id}"`);}}
record[fieldName]=ids;}else if(field.type==="many2one"){if(value){const relRecord=this.models[field.relation].records.find((r)=>r.id===value);if(!relRecord&&ensureIntegrity){throw Error(`Wrong id "${JSON.stringify(
                                value
                            )}" for a many2one on field "${fieldName}" on record "${model},${id}"`);}
record[fieldName]=value;}else{record[fieldName]=false;}}else{record[fieldName]=value;}}}
getUnusedID(modelName){const model=this.models[modelName];return(model.records.reduce((max,record)=>{if(!Number.isInteger(record.id)){return max;}
return Math.max(record.id,max);},0)+1);}
applyDefaults(model,record){record.display_name=record.display_name||record.name;for(const fieldName in model.fields){if(fieldName==="id"){continue;}
if(!(fieldName in record)){if("default"in model.fields[fieldName]){const def=model.fields[fieldName].default;record[fieldName]=typeof def==="function"?def.call(this):def;}else if(["one2many","many2many"].includes(model.fields[fieldName].type)){record[fieldName]=[];}else{record[fieldName]=false;}}}}}
__exports.makeMockServer=makeMockServer;function makeMockServer(serverData,mockRPC){serverData=serverData||{};const mockServer=new MockServer(serverData,{debug:QUnit.config.debug,});const _mockRPC=async(route,args={})=>{let res;const performRPC=(route,args)=>mockServer.performRPC(route,args);if(mockRPC){res=await mockRPC(route,args,performRPC);}
if(res===undefined){res=await performRPC(route,args);}
return res;};const rpcService=makeFakeRPCService(_mockRPC);patchWithCleanup(browser,{fetch:makeMockFetch(_mockRPC),});serviceRegistry.add("rpc",rpcService,{force:true});}
return __exports;});;

/* /web/static/tests/helpers/mock_services.js defined in bundle 'web.tests_assets' */
odoo.define('@web/../tests/helpers/mock_services',async function(require){'use strict';let __exports={};const{browser}=require("@web/core/browser/browser");const{routerService}=require("@web/core/browser/router_service");const{localization}=require("@web/core/l10n/localization");const{translatedTerms}=require("@web/core/l10n/translation");const{rpcService}=require("@web/core/network/rpc_service");const{userService}=require("@web/core/user_service");const{effectService}=require("@web/core/effects/effect_service");const{objectToUrlEncodedString}=require("@web/core/utils/urls");const{registerCleanup}=require("@web/../tests/helpers/cleanup");const{patchWithCleanup}=require("@web/../tests/helpers/utils");const{companyService}=require("@web/webclient/company_service");const{uiService}=require("@web/core/ui/ui_service");const{Component}=owl;const defaultLocalization=__exports.defaultLocalization={dateFormat:"MM/dd/yyyy",timeFormat:"HH:mm:ss",dateTimeFormat:"MM/dd/yyyy HH:mm:ss",decimalPoint:".",direction:"ltr",grouping:[3,0],multiLang:false,thousandsSep:",",weekStart:7,};__exports.makeFakeLocalizationService=makeFakeLocalizationService;function makeFakeLocalizationService(config={}){patchWithCleanup(localization,Object.assign({},defaultLocalization,config));return{name:"localization",start:async(env)=>{const _t=(str)=>translatedTerms[str]||str;env._t=_t;env.qweb.translateFn=_t;},};}
function buildMockRPC(mockRPC){return async function(...args){if(this instanceof Component&&this.__owl__.status===5){return new Promise(()=>{});}
if(mockRPC){return mockRPC(...args);}};}
__exports.makeFakeRPCService=makeFakeRPCService;function makeFakeRPCService(mockRPC){return{name:"rpc",start(){return buildMockRPC(mockRPC);},specializeForComponent:rpcService.specializeForComponent,};}
__exports.makeMockXHR=makeMockXHR;function makeMockXHR(response,sendCb,def){let MockXHR=function(){return{_loadListener:null,url:"",addEventListener(type,listener){if(type==="load"){this._loadListener=listener;}else if(type==="error"){this._errorListener=listener;}},set onload(listener){this._loadListener=listener;},set onerror(listener){this._errorListener=listener;},open(method,url){this.url=url;},getResponseHeader(){},setRequestHeader(){},async send(data){let listener=this._loadListener;if(sendCb){if(typeof data==="string"){try{data=JSON.parse(data);}catch(e){}}
try{await sendCb.call(this,data);}catch(e){listener=this._errorListener;}}
if(def){await def;}
listener.call(this);},response:JSON.stringify(response||""),};};return MockXHR;}
__exports.makeMockFetch=makeMockFetch;function makeMockFetch(mockRPC){const _rpc=buildMockRPC(mockRPC);return async(input)=>{let route=typeof input==="string"?input:input.url;let params;if(route.includes("load_menus")){const routeArray=route.split("/");params={hash:routeArray.pop(),};route=routeArray.join("/");}
let res;let status;try{res=await _rpc(route,params);status=200;}catch(e){status=500;}
const blob=new Blob([JSON.stringify(res||{})],{type:"application/json"});return new Response(blob,{status});};}
__exports.makeFakeRouterService=makeFakeRouterService;function makeFakeRouterService(params={}){return{start({bus}){const router=routerService.start(...arguments);bus.on("test:hashchange",null,(hash)=>{browser.location.hash=objectToUrlEncodedString(hash);});registerCleanup(router.cancelPushes);patchWithCleanup(router,{async redirect(){await this._super(...arguments);if(params.onRedirect){params.onRedirect(...arguments);}},});return router;},};}
const fakeCommandService=__exports.fakeCommandService={start(){return{add(){return()=>{};},getCommands(){return[];},openPalette(){},};},};const fakeCookieService=__exports.fakeCookieService={start(){const cookie={};return{get current(){return cookie;},setCookie(key,value){if(value!==undefined){cookie[key]=value;}},deleteCookie(key){delete cookie[key];},};},};const fakeTitleService=__exports.fakeTitleService={start(){let current={};return{get current(){return JSON.stringify(current);},getParts(){return current;},setParts(parts){current=Object.assign({},current,parts);},};},};__exports.makeFakeNotificationService=makeFakeNotificationService;function makeFakeNotificationService(mock){return{start(){function add(){if(mock){return mock(...arguments);}}
return{add,};},};}
__exports.makeFakeDialogService=makeFakeDialogService;function makeFakeDialogService(addDialog){return{start(){return{add:addDialog||(()=>()=>{}),};},};}
__exports.makeFakeUserService=makeFakeUserService;function makeFakeUserService(hasGroup=()=>false){return{...userService,start(){const fakeUserService=userService.start(...arguments);fakeUserService.hasGroup=hasGroup;return fakeUserService;},};}
const mocks=__exports.mocks={company:()=>companyService,command:()=>fakeCommandService,cookie:()=>fakeCookieService,effect:()=>effectService,localization:makeFakeLocalizationService,notification:makeFakeNotificationService,router:makeFakeRouterService,rpc:makeFakeRPCService,title:()=>fakeTitleService,ui:()=>uiService,user:()=>userService,dialog:makeFakeDialogService,};return __exports;});;

/* /web/static/tests/helpers/utils.js defined in bundle 'web.tests_assets' */
odoo.define('@web/../tests/helpers/utils',async function(require){'use strict';let __exports={};const{browser}=require("@web/core/browser/browser");const{isMacOS}=require("@web/core/browser/feature_detection");const{patch,unpatch}=require("@web/core/utils/patch");const{registerCleanup}=require("@web/../tests/helpers/cleanup");const{download}=require("@web/core/network/download");__exports.patchDate=patchDate;function patchDate(year,month,day,hours,minutes,seconds){var RealDate=window.Date;var actualDate=new RealDate();var fakeDate=new RealDate(year,month,day,hours,minutes,seconds);var timeInterval=actualDate.getTime()-fakeDate.getTime();Date=(function(NativeDate){function Date(Y,M,D,h,m,s,ms){var length=arguments.length;if(arguments.length>0){var date=length==1&&String(Y)===Y?new NativeDate(Date.parse(Y)):length>=7?new NativeDate(Y,M,D,h,m,s,ms):length>=6?new NativeDate(Y,M,D,h,m,s):length>=5?new NativeDate(Y,M,D,h,m):length>=4?new NativeDate(Y,M,D,h):length>=3?new NativeDate(Y,M,D):length>=2?new NativeDate(Y,M):length>=1?new NativeDate(Y):new NativeDate();date.constructor=Date;return date;}else{var date=new NativeDate();var time=date.getTime();time-=timeInterval;date.setTime(time);return date;}}
for(var key in NativeDate){Date[key]=NativeDate[key];}
Date.now=function(){var date=new NativeDate();var time=date.getTime();time-=timeInterval;return time;};Date.UTC=NativeDate.UTC;Date.prototype=NativeDate.prototype;Date.prototype.constructor=Date;Date.parse=NativeDate.parse;return Date;})(Date);registerCleanup(()=>{window.Date=RealDate;});}
let nextId=1;__exports.patchWithCleanup=patchWithCleanup;function patchWithCleanup(obj,patchValue,options){const patchName=`__test_patch_${nextId++}__`;patch(obj,patchName,patchValue,options);registerCleanup(()=>{unpatch(obj,patchName);});}
__exports.getFixture=getFixture;function getFixture(){if(QUnit.config.debug){return document.body;}else{return document.querySelector("#qunit-fixture");}}
__exports.nextTick=nextTick;async function nextTick(){await new Promise((resolve)=>window.requestAnimationFrame(resolve));await new Promise((resolve)=>setTimeout(resolve));}
__exports.makeDeferred=makeDeferred;function makeDeferred(){let resolve;let reject;const prom=new Promise((res,rej)=>{resolve=res;reject=rej;});return Object.assign(prom,{resolve,reject});}
function findElement(el,selector){let target=el;if(selector){const els=el.querySelectorAll(selector);if(els.length===0){throw new Error(`No element found (selector: ${selector})`);}
if(els.length>1){throw new Error(`Found ${els.length} elements, instead of 1 (selector: ${selector})`);}
target=els[0];}
return target;}
const keyboardEventBubble=(args)=>Object.assign({},args,{bubbles:true,keyCode:args.which});const mouseEventMapping=(args)=>Object.assign({},args,{bubbles:true,cancelable:true,clientX:args?args.pageX:undefined,clientY:args?args.pageY:undefined,view:window,});const mouseEventNoBubble=(args)=>Object.assign({},args,{bubbles:false,cancelable:false,clientX:args?args.pageX:undefined,clientY:args?args.pageY:undefined,view:window,});const noBubble=(args)=>Object.assign({},args,{bubbles:false});const onlyBubble=(args)=>Object.assign({},args,{bubbles:true});const EVENT_TYPES={auxclick:{constructor:MouseEvent,processParameters:mouseEventMapping},click:{constructor:MouseEvent,processParameters:mouseEventMapping},contextmenu:{constructor:MouseEvent,processParameters:mouseEventMapping},dblclick:{constructor:MouseEvent,processParameters:mouseEventMapping},mousedown:{constructor:MouseEvent,processParameters:mouseEventMapping},mouseup:{constructor:MouseEvent,processParameters:mouseEventMapping},mousemove:{constructor:MouseEvent,processParameters:mouseEventMapping},mouseenter:{constructor:MouseEvent,processParameters:mouseEventNoBubble},mouseleave:{constructor:MouseEvent,processParameters:mouseEventNoBubble},mouseover:{constructor:MouseEvent,processParameters:mouseEventMapping},mouseout:{constructor:MouseEvent,processParameters:mouseEventMapping},focus:{constructor:FocusEvent,processParameters:noBubble},focusin:{constructor:FocusEvent,processParameters:onlyBubble},blur:{constructor:FocusEvent,processParameters:noBubble},cut:{constructor:ClipboardEvent,processParameters:onlyBubble},copy:{constructor:ClipboardEvent,processParameters:onlyBubble},paste:{constructor:ClipboardEvent,processParameters:onlyBubble},keydown:{constructor:KeyboardEvent,processParameters:keyboardEventBubble},keypress:{constructor:KeyboardEvent,processParameters:keyboardEventBubble},keyup:{constructor:KeyboardEvent,processParameters:keyboardEventBubble},drag:{constructor:DragEvent,processParameters:onlyBubble},dragend:{constructor:DragEvent,processParameters:onlyBubble},dragenter:{constructor:DragEvent,processParameters:onlyBubble},dragstart:{constructor:DragEvent,processParameters:onlyBubble},dragleave:{constructor:DragEvent,processParameters:onlyBubble},dragover:{constructor:DragEvent,processParameters:onlyBubble},drop:{constructor:DragEvent,processParameters:onlyBubble},input:{constructor:InputEvent,processParameters:onlyBubble},compositionstart:{constructor:CompositionEvent,processParameters:onlyBubble},compositionend:{constructor:CompositionEvent,processParameters:onlyBubble},};__exports.triggerEvent=triggerEvent;async function triggerEvent(el,selector,eventType,eventAttrs={}){let event;if(eventType in EVENT_TYPES){const{constructor,processParameters}=EVENT_TYPES[eventType];event=new constructor(eventType,processParameters(eventAttrs));}else{event=new Event(eventType,Object.assign({},eventAttrs,{bubbles:true}));}
const target=findElement(el,selector);target.dispatchEvent(event);await nextTick();}
__exports.triggerEvents=triggerEvents;async function triggerEvents(el,querySelector,events){for(let e=0;e<events.length;e++){await triggerEvent(el,querySelector,events[e]);}}
__exports.triggerScroll=triggerScroll;async function triggerScroll(target,coordinates={left:null,top:null},canPropagate=true){const isScrollable=(target.scrollHeight>target.clientHeight&&target.clientHeight>0)||(target.scrollWidth>target.clientWidth&&target.clientWidth>0);if(!isScrollable&&!canPropagate)return;if(isScrollable){const canScrollFrom={left:coordinates.left>target.scrollLeft?target.scrollLeft+target.clientWidth<target.scrollWidth:target.scrollLeft>0,top:coordinates.top>target.scrollTop?target.scrollTop+target.clientHeight<target.scrollHeight:target.scrollTop>0,};const scrollCoordinates={};Object.entries(coordinates).forEach(([key,value])=>{if(value!==null&&canScrollFrom[key]){scrollCoordinates[key]=value;delete coordinates[key];}});target.scrollTo(scrollCoordinates);target.dispatchEvent(new UIEvent("scroll"));if(!canPropagate||!Object.entries(coordinates).length)return;}
target.parentElement?triggerScroll(target.parentElement,coordinates):window.dispatchEvent(new UIEvent("scroll"));await nextTick();}
__exports.click=click;function click(el,selector){return triggerEvent(el,selector,"click",{bubbles:true,cancelable:true});}
__exports.mouseEnter=mouseEnter;async function mouseEnter(el,selector){return triggerEvent(el,selector,"mouseenter");}
__exports.triggerHotkey=triggerHotkey;function triggerHotkey(hotkey,addOverlayModParts=false,eventAttrs={}){eventAttrs.key=hotkey.split("+").pop();if(/shift/i.test(hotkey)){eventAttrs.shiftKey=true;}
if(/control/i.test(hotkey)){if(isMacOS()){eventAttrs.metaKey=true;}else{eventAttrs.ctrlKey=true;}}
if(/alt/i.test(hotkey)||addOverlayModParts){if(isMacOS()){eventAttrs.ctrlKey=true;}else{eventAttrs.altKey=true;}}
if(!("bubbles"in eventAttrs)){eventAttrs.bubbles=true;}
document.activeElement.dispatchEvent(new KeyboardEvent("keydown",eventAttrs));document.activeElement.dispatchEvent(new KeyboardEvent("keyup",eventAttrs));}
__exports.legacyExtraNextTick=legacyExtraNextTick;async function legacyExtraNextTick(){return nextTick();}
__exports.mockDownload=mockDownload;function mockDownload(cb){patchWithCleanup(download,{_download:cb});}
const hushConsole=__exports.hushConsole=Object.create(null);for(const propName of Object.keys(window.console)){hushConsole[propName]=()=>{};}
__exports.mockTimeout=mockTimeout;function mockTimeout(){const timeouts=new Map();let id=1;patchWithCleanup(browser,{setTimeout(fn){timeouts.set(id,fn);return id++;},clearTimeout(id){timeouts.delete(id);},});return function execRegisteredTimeouts(){for(const fn of timeouts.values()){fn();}
timeouts.clear();};}
__exports.mockAnimationFrame=mockAnimationFrame;function mockAnimationFrame(){const callbacks=new Map();let id=1;patchWithCleanup(browser,{requestAnimationFrame(fn){callbacks.set(id,fn);return id++;},cancelAnimationFrame(id){callbacks.delete(id);},});return function execRegisteredCallbacks(){for(const fn of callbacks.values()){fn();}
callbacks.clear();};}
return __exports;});;

/* /web/static/tests/search/helpers.js defined in bundle 'web.tests_assets' */
odoo.define('@web/../tests/search/helpers',async function(require){'use strict';let __exports={};const{hotkeyService}=require("@web/core/hotkeys/hotkey_service");const{notificationService}=require("@web/core/notifications/notification_service");const{ormService}=require("@web/core/orm_service");const{registry}=require("@web/core/registry");const{CustomFavoriteItem}=require("@web/search/favorite_menu/custom_favorite_item");const{WithSearch}=require("@web/search/with_search/with_search");const{viewService}=require("@web/views/view_service");const{actionService}=require("@web/webclient/actions/action_service");const{registerCleanup}=require("@web/../tests/helpers/cleanup");const{makeTestEnv}=require("@web/../tests/helpers/mock_env");const{click,getFixture,mouseEnter,triggerEvent}=require("@web/../tests/helpers/utils");const serviceRegistry=registry.category("services");const favoriteMenuRegistry=registry.category("favoriteMenu");const{Component,mount}=owl;const setupControlPanelServiceRegistry=__exports.setupControlPanelServiceRegistry=()=>{serviceRegistry.add("action",actionService);serviceRegistry.add("hotkey",hotkeyService);serviceRegistry.add("notification",notificationService);serviceRegistry.add("orm",ormService);serviceRegistry.add("view",viewService);};const setupControlPanelFavoriteMenuRegistry=__exports.setupControlPanelFavoriteMenuRegistry=()=>{favoriteMenuRegistry.add("custom-favorite-item",{Component:CustomFavoriteItem,groupNumber:3},{sequence:0});};const makeWithSearch=__exports.makeWithSearch=async(params)=>{const props={...params};const serverData=props.serverData||undefined;const mockRPC=props.mockRPC||undefined;const config=props.config||{};delete props.serverData;delete props.mockRPC;delete props.config;const env=await makeTestEnv({serverData,mockRPC,config});const target=getFixture();const withSearch=await mount(WithSearch,{env,props,target});registerCleanup(()=>withSearch.destroy());const component=Object.values(withSearch.__owl__.children)[0];return component;};const getNode=(target)=>{return target instanceof Component?target.el:target;};const findItem=(target,selector,finder=0)=>{const el=getNode(target);const elems=[...el.querySelectorAll(selector)];if(Number.isInteger(finder)){return elems[finder];}
return elems.find((el)=>el.innerText.trim().toLowerCase()===finder.toLowerCase());};const toggleMenu=__exports.toggleMenu=async(el,menuFinder)=>{const menu=findItem(el,`.dropdown button.dropdown-toggle`,menuFinder);await click(menu);};const toggleMenuItem=__exports.toggleMenuItem=async(el,itemFinder)=>{const item=findItem(el,`.o_menu_item`,itemFinder);if(item.classList.contains("dropdown-toggle")){await mouseEnter(item);}else{await click(item);}};const toggleMenuItemOption=__exports.toggleMenuItemOption=async(el,itemFinder,optionFinder)=>{const item=findItem(el,`.o_menu_item`,itemFinder);const option=findItem(item.parentNode,".o_item_option",optionFinder);if(option.classList.contains("dropdown-toggle")){await mouseEnter(option);}else{await click(option);}};const isItemSelected=__exports.isItemSelected=(el,itemFinder)=>{const item=findItem(el,`.o_menu_item`,itemFinder);return item.classList.contains("selected");};const isOptionSelected=__exports.isOptionSelected=(el,itemFinder,optionFinder)=>{const item=findItem(el,`.o_menu_item`,itemFinder);const option=findItem(item.parentNode,".o_item_option",optionFinder);return option.classList.contains("selected");};const getMenuItemTexts=__exports.getMenuItemTexts=(target)=>{const el=getNode(target);return[...el.querySelectorAll(`.dropdown ul .o_menu_item`)].map((e)=>e.innerText.trim());};const toggleFilterMenu=__exports.toggleFilterMenu=async(el)=>{await click(findItem(el,`.o_filter_menu button.dropdown-toggle`));};const toggleAddCustomFilter=__exports.toggleAddCustomFilter=async(el)=>{await mouseEnter(findItem(el,`.o_add_custom_filter_menu .dropdown-toggle`));};const editConditionField=__exports.editConditionField=async(el,index,fieldName)=>{const condition=findItem(el,`.o_filter_condition`,index);const select=findItem(condition,"select",0);select.value=fieldName;await triggerEvent(select,null,"change");};const editConditionOperator=__exports.editConditionOperator=async(el,index,operator)=>{const condition=findItem(el,`.o_filter_condition`,index);const select=findItem(condition,"select",1);select.value=operator;await triggerEvent(select,null,"change");};const editConditionValue=__exports.editConditionValue=async(el,index,value,valueIndex=0)=>{const condition=findItem(el,`.o_filter_condition`,index);const target=findItem(condition,".o_generator_menu_value input,.o_generator_menu_value select",valueIndex);target.value=value;await triggerEvent(target,null,"change");};const applyFilter=__exports.applyFilter=async(el)=>{await click(findItem(el,`.o_add_custom_filter_menu .dropdown-menu button.o_apply_filter`));};const addCondition=__exports.addCondition=async(el)=>{await click(findItem(el,`.o_add_custom_filter_menu .dropdown-menu button.o_add_condition`));};__exports.removeCondition=removeCondition;async function removeCondition(el,index){const condition=findItem(el,`.o_filter_condition`,index);await click(findItem(condition,".o_generator_menu_delete"));}
const toggleGroupByMenu=__exports.toggleGroupByMenu=async(el)=>{await click(findItem(el,`.o_group_by_menu .dropdown-toggle`));};const toggleAddCustomGroup=__exports.toggleAddCustomGroup=async(el)=>{await mouseEnter(findItem(el,`.o_add_custom_group_menu .dropdown-toggle`));};const selectGroup=__exports.selectGroup=async(el,fieldName)=>{const select=findItem(el,`.o_add_custom_group_menu .dropdown-menu select`);select.value=fieldName;await triggerEvent(select,null,"change");};const applyGroup=__exports.applyGroup=async(el)=>{await click(findItem(el,`.o_add_custom_group_menu .dropdown-menu .btn`));};const toggleFavoriteMenu=__exports.toggleFavoriteMenu=async(el)=>{await click(findItem(el,`.o_favorite_menu .dropdown-toggle`));};const deleteFavorite=__exports.deleteFavorite=async(el,favoriteFinder)=>{const favorite=findItem(el,`.o_favorite_menu .o_menu_item`,favoriteFinder);await click(findItem(favorite,"i.fa-trash-o"));};const toggleSaveFavorite=__exports.toggleSaveFavorite=async(el)=>{await mouseEnter(findItem(el,`.o_favorite_menu .o_add_favorite .dropdown-toggle`));};const editFavoriteName=__exports.editFavoriteName=async(el,name)=>{const input=findItem(el,`.o_favorite_menu .o_add_favorite .dropdown-menu input[type="text"]`);input.value=name;await triggerEvent(input,null,"input");};const saveFavorite=__exports.saveFavorite=async(el)=>{await click(findItem(el,`.o_favorite_menu .o_add_favorite .dropdown-menu button`));};const toggleComparisonMenu=__exports.toggleComparisonMenu=async(el)=>{await click(findItem(el,`.o_comparison_menu button.dropdown-toggle`));};const getFacetTexts=__exports.getFacetTexts=(target)=>{const el=getNode(target);return[...el.querySelectorAll(`div.o_searchview_facet`)].map((facet)=>facet.innerText.trim());};const removeFacet=__exports.removeFacet=async(el,facetFinder=0)=>{const facet=findItem(el,`div.o_searchview_facet`,facetFinder);await click(facet.querySelector("i.o_facet_remove"));};const editSearch=__exports.editSearch=async(el,value)=>{const input=findItem(el,`.o_searchview input`);input.value=value;await triggerEvent(input,null,"input");};const validateSearch=__exports.validateSearch=async(el)=>{const input=findItem(el,`.o_searchview input`);await triggerEvent(input,null,"keydown",{key:"Enter"});};const switchView=__exports.switchView=async(el,viewType)=>{await click(findItem(el,`button.o_switch_view.o_${viewType}`));};return __exports;});;

/* /web/static/tests/webclient/helpers.js defined in bundle 'web.tests_assets' */
odoo.define('@web/../tests/webclient/helpers',async function(require){'use strict';let __exports={};const{dialogService}=require("@web/core/dialog/dialog_service");const{notificationService}=require("@web/core/notifications/notification_service");const{ormService}=require("@web/core/orm_service");const{popoverService}=require("@web/core/popover/popover_service");const{registry}=require("@web/core/registry");const{legacyServiceProvider}=require("@web/legacy/legacy_service_provider");const{makeLegacyNotificationService,mapLegacyEnvToWowlEnv,makeLegacySessionService,}=require("@web/legacy/utils");const{makeLegacyActionManagerService}=require("@web/legacy/backend_utils");const{viewService}=require("@web/views/view_service");const{actionService}=require("@web/webclient/actions/action_service");const{effectService}=require("@web/core/effects/effect_service");const{hotkeyService}=require("@web/core/hotkeys/hotkey_service");const{menuService}=require("@web/webclient/menus/menu_service");const{WebClient}=require("@web/webclient/webclient");require("web.test_legacy");const AbstractService=require("web.AbstractService");const ActionMenus=require("web.ActionMenus");const basicFields=require("web.basic_fields");const Registry=require("web.Registry");const core=require("web.core");const makeTestEnvironment=require("web.test_env");const{registerCleanup}=require("@web/../tests/helpers/cleanup");const{makeTestEnv}=require("@web/../tests/helpers/mock_env");const{fakeTitleService,makeFakeLocalizationService,makeFakeRouterService,}=require("@web/../tests/helpers/mock_services");const{getFixture,legacyExtraNextTick,nextTick,patchWithCleanup}=require("@web/../tests/helpers/utils");const session=require("web.session");const{ComponentAdapter}=require("web.OwlCompatibility");const LegacyMockServer=require("web.MockServer");const Widget=require("web.Widget");const{userService}=require("@web/core/user_service");const{uiService}=require("@web/core/ui/ui_service");const{ClientActionAdapter,ViewAdapter}=require("@web/legacy/action_adapters");const{commandService}=require("@web/core/commands/command_service");const{CustomFavoriteItem}=require("@web/search/favorite_menu/custom_favorite_item");const{Component,mount,tags}=owl;const actionRegistry=registry.category("actions");const serviceRegistry=registry.category("services");const favoriteMenuRegistry=registry.category("favoriteMenu");__exports.setupWebClientRegistries=setupWebClientRegistries;function setupWebClientRegistries(){const favoriveMenuItems={"custom-favorite-item":{value:{Component:CustomFavoriteItem,groupNumber:3},options:{sequence:0},},};for(let[key,{value,options}]of Object.entries(favoriveMenuItems)){if(!favoriteMenuRegistry.contains(key)){favoriteMenuRegistry.add(key,value,options);}}
const services={action:()=>actionService,command:()=>commandService,dialog:()=>dialogService,effect:()=>effectService,hotkey:()=>hotkeyService,legacy_service_provider:()=>legacyServiceProvider,localization:()=>makeFakeLocalizationService(),menu:()=>menuService,notification:()=>notificationService,orm:()=>ormService,popover:()=>popoverService,router:()=>makeFakeRouterService(),title:()=>fakeTitleService,ui:()=>uiService,user:()=>userService,view:()=>viewService,};for(let serviceName in services){if(!serviceRegistry.contains(serviceName)){serviceRegistry.add(serviceName,services[serviceName]());}}}
__exports.addLegacyMockEnvironment=addLegacyMockEnvironment;function addLegacyMockEnvironment(env,legacyParams={}){const dataManager=Object.assign({load_action:(actionID,context)=>{return env.services.rpc("/web/action/load",{action_id:actionID,additional_context:context,});},load_views:async(params,options)=>{const result=await env.services.rpc(`/web/dataset/call_kw/${params.model}`,{args:[],kwargs:{context:params.context,options:options,views:params.views_descr,},method:"load_views",model:params.model,});const views=result.fields_views;for(const[,viewType]of params.views_descr){const fvg=views[viewType];fvg.viewFields=fvg.fields;fvg.fields=result.fields;}
if(params.favoriteFilters&&"search"in views){views.search.favoriteFilters=params.favoriteFilters;}
return views;},load_filters:(params)=>{if(QUnit.config.debug){console.log("[mock] load_filters",params);}
return Promise.resolve([]);},},legacyParams.dataManager);const actionMenusRegistry=ActionMenus.registry;ActionMenus.registry=new Registry();registerCleanup(()=>(ActionMenus.registry=actionMenusRegistry));let localSession;if(legacyParams&&legacyParams.getTZOffset){patchWithCleanup(session,{getTZOffset:legacyParams.getTZOffset,});localSession={getTZOffset:legacyParams.getTZOffset};}
const baseEnv={dataManager,bus:core.bus,session:localSession};const legacyEnv=makeTestEnvironment(Object.assign(baseEnv,legacyParams.env));if(legacyParams.serviceRegistry){const legacyServiceMap=core.serviceRegistry.map;core.serviceRegistry.map=legacyParams.serviceRegistry.map;delete legacyEnv.services.notification;AbstractService.prototype.deployServices(legacyEnv);registerCleanup(()=>{core.serviceRegistry.map=legacyServiceMap;});}
Component.env=legacyEnv;mapLegacyEnvToWowlEnv(legacyEnv,env);function patchLegacySession(){const userContext=Object.getOwnPropertyDescriptor(session,"user_context");registerCleanup(()=>{Object.defineProperty(session,"user_context",userContext);});}
patchLegacySession();serviceRegistry.add("legacy_session",makeLegacySessionService(legacyEnv,session));const legacyActionManagerService=makeLegacyActionManagerService(legacyEnv);serviceRegistry.add("legacy_action_manager",legacyActionManagerService);serviceRegistry.add("legacy_notification",makeLegacyNotificationService(legacyEnv));const debouncedField=basicFields.DebouncedField;const initialDebouncedVal=debouncedField.prototype.DEBOUNCE;debouncedField.prototype.DEBOUNCE=0;registerCleanup(()=>(debouncedField.prototype.DEBOUNCE=initialDebouncedVal));if(legacyParams.withLegacyMockServer){const adapter=new ComponentAdapter(null,{Component:owl.Component});adapter.env=legacyEnv;const W=Widget.extend({do_push_state(){}});const widget=new W(adapter);const legacyMockServer=new LegacyMockServer(legacyParams.models,{widget});const originalRPC=env.services.rpc;env.services.rpc=async(...args)=>{try{return await originalRPC(...args);}catch(e){if(e.message.includes("Unimplemented")){return legacyMockServer._performRpc(...args);}else{throw e;}}};}}
__exports.createWebClient=createWebClient;async function createWebClient(params){setupWebClientRegistries();const controllers=[];patchWithCleanup(ClientActionAdapter.prototype,{mounted(){this._super();controllers.push(this.widget);},});patchWithCleanup(ViewAdapter.prototype,{mounted(){this._super();controllers.push(this.widget);},});const legacyParams=params.legacyParams;params.serverData=params.serverData||{};const models=params.serverData.models;if(legacyParams&&legacyParams.withLegacyMockServer&&models){legacyParams.models=Object.assign({},models);Object.entries(legacyParams.models).forEach(([k,v])=>{if(!(v instanceof Object)||!("fields"in v)){delete models[k];}});}
const mockRPC=params.mockRPC||undefined;const env=await makeTestEnv({serverData:params.serverData,mockRPC,});addLegacyMockEnvironment(env,legacyParams);const WebClientClass=params.WebClientClass||WebClient;const target=params&&params.target?params.target:getFixture();const wc=await mount(WebClientClass,{env,target});registerCleanup(()=>{for(const controller of controllers){if(!controller.isDestroyed()){controller.destroy();}}
wc.destroy();});await nextTick();return wc;}
__exports.doAction=doAction;async function doAction(env,...args){if(env instanceof Component){env=env.env;}
try{await env.services.action.doAction(...args);}finally{await legacyExtraNextTick();}}
__exports.loadState=loadState;async function loadState(env,state){if(env instanceof Component){env=env.env;}
env.bus.trigger("test:hashchange",state);await nextTick();await nextTick();await legacyExtraNextTick();}
__exports.getActionManagerServerData=getActionManagerServerData;function getActionManagerServerData(){class TestClientAction extends Component{}
TestClientAction.template=tags.xml`
      <div class="test_client_action">
        ClientAction_<t t-esc="props.action.params?.description"/>
      </div>`;actionRegistry.add("__test__client__action__",TestClientAction);const menus={root:{id:"root",children:[0,1,2],name:"root",appID:"root"},0:{id:0,children:[],name:"UglyHack",appID:0,xmlid:"menu_0"},1:{id:1,children:[],name:"App1",appID:1,actionID:1001,xmlid:"menu_1"},2:{id:2,children:[],name:"App2",appID:2,actionID:1002,xmlid:"menu_2"},};const actionsArray=[{id:1,xml_id:"action_1",name:"Partners Action 1",res_model:"partner",type:"ir.actions.act_window",views:[[1,"kanban"]],},{id:2,xml_id:"action_2",type:"ir.actions.server",},{id:3,xml_id:"action_3",name:"Partners",res_model:"partner",type:"ir.actions.act_window",views:[[false,"list"],[1,"kanban"],[false,"form"],],},{id:4,xml_id:"action_4",name:"Partners Action 4",res_model:"partner",type:"ir.actions.act_window",views:[[1,"kanban"],[2,"list"],[false,"form"],],},{id:5,xml_id:"action_5",name:"Create a Partner",res_model:"partner",target:"new",type:"ir.actions.act_window",views:[[false,"form"]],},{id:6,xml_id:"action_6",name:"Partner",res_id:2,res_model:"partner",target:"inline",type:"ir.actions.act_window",views:[[false,"form"]],},{id:7,xml_id:"action_7",name:"Some Report",report_name:"some_report",report_type:"qweb-pdf",type:"ir.actions.report",},{id:8,xml_id:"action_8",name:"Favorite Ponies",res_model:"pony",type:"ir.actions.act_window",views:[[false,"list"],[false,"form"],],},{id:9,xml_id:"action_9",name:"A Client Action",tag:"ClientAction",type:"ir.actions.client",},{id:10,type:"ir.actions.act_window_close",},{id:11,xml_id:"action_11",name:"Another Report",report_name:"another_report",report_type:"qweb-pdf",type:"ir.actions.report",close_on_report_download:true,},{id:12,xml_id:"action_12",name:"Some HTML Report",report_name:"some_report",report_type:"qweb-html",type:"ir.actions.report",},{id:24,name:"Partner",res_id:2,res_model:"partner",type:"ir.actions.act_window",views:[[666,"form"]],},{id:25,name:"Create a Partner",res_model:"partner",target:"new",type:"ir.actions.act_window",views:[[3,"form"]],},{id:1001,tag:"__test__client__action__",target:"main",type:"ir.actions.client",params:{description:"Id 1"},},{id:1002,tag:"__test__client__action__",target:"main",type:"ir.actions.client",params:{description:"Id 2"},},{xmlId:"wowl.client_action",id:1099,tag:"__test__client__action__",target:"main",type:"ir.actions.client",params:{description:"xmlId"},},];const actions={};actionsArray.forEach((act)=>{actions[act.xmlId||act.id]=act;});const archs={"partner,1,kanban":'<kanban><templates><t t-name="kanban-box">'+'<div class="oe_kanban_global_click"><field name="foo"/></div>'+"</t></templates></kanban>","partner,false,list":'<tree><field name="foo"/></tree>',"partner,2,list":'<tree limit="3"><field name="foo"/></tree>',"pony,false,list":'<tree><field name="name"/></tree>',"partner,false,form":"<form>"+"<header>"+'<button name="object" string="Call method" type="object"/>'+'<button name="4" string="Execute action" type="action"/>'+"</header>"+"<group>"+'<field name="display_name"/>'+'<field name="foo"/>'+"</group>"+"</form>","partner,3,form":`
      <form>
      <footer>
      <button class="btn-primary" string="Save" special="save"/>
      </footer>
      </form>`,"partner,666,form":`<form>
      <header></header>
      <sheet>
      <div class="oe_button_box" name="button_box" modifiers="{}">
      <button class="oe_stat_button" type="action" name="1" icon="fa-star" context="{'default_partner': active_id}">
      <field string="Partners" name="o2m" widget="statinfo"/>
      </button>
      </div>
      <field name="display_name"/>
      </sheet>
      </form>`,"pony,false,form":"<form>"+'<field name="name"/>'+"</form>","partner,false,search":'<search><field name="foo" string="Foo"/></search>',"partner,4,search":"<search>"+'<filter name="bar" help="Bar" domain="[(\'bar\', \'=\', 1)]"/>'+"</search>","pony,false,search":"<search></search>",};const models={partner:{fields:{id:{string:"Id",type:"integer"},foo:{string:"Foo",type:"char"},bar:{string:"Bar",type:"many2one",relation:"partner"},o2m:{string:"One2Many",type:"one2many",relation:"partner",relation_field:"bar",},m2o:{string:"Many2one",type:"many2one",relation:"partner"},},records:[{id:1,display_name:"First record",foo:"yop",bar:2,o2m:[2,3],m2o:3},{id:2,display_name:"Second record",foo:"blip",bar:1,o2m:[1,4,5],m2o:3,},{id:3,display_name:"Third record",foo:"gnap",bar:1,o2m:[],m2o:1},{id:4,display_name:"Fourth record",foo:"plop",bar:2,o2m:[],m2o:1},{id:5,display_name:"Fifth record",foo:"zoup",bar:2,o2m:[],m2o:1},],},pony:{fields:{id:{string:"Id",type:"integer"},name:{string:"Name",type:"char"},},records:[{id:4,name:"Twilight Sparkle"},{id:6,name:"Applejack"},{id:9,name:"Fluttershy"},],},};return{models,views:archs,actions,menus,};}
return __exports;});;

/* /web/static/tests/qunit.js defined in bundle 'web.tests_assets' */
(function(){"use strict";const{Component}=owl;QUnit.config.autostart=false;QUnit.config.testTimeout=1*60*1000;QUnit.config.hidepassed=window.location.href.match(/[?&]testId=/)===null;function containsN(target,selector,n,msg){let $el;if(target._widgetRenderAndInsert){$el=target.$el;}else if(target instanceof Component){if(!target.el){throw new Error(`containsN assert with selector '${selector}' called on an unmounted component`);}
$el=$(target.el);}else{$el=target instanceof HTMLElement?$(target):target;}
msg=msg||`Selector '${selector}' should have exactly ${n} matches inside the target`;QUnit.assert.strictEqual($el.find(selector).length,n,msg);}
function containsNone(target,selector,msg){containsN(target,selector,0,msg);}
function containsOnce(target,selector,msg){containsN(target,selector,1,msg);}
function _checkClass(el,classNames,shouldHaveClass,msg){if(el){if(el._widgetRenderAndInsert){el=el.el;}else if(!(el instanceof HTMLElement)){el=el[0];}}
msg=msg||`target should ${shouldHaveClass ? "have" : "not have"} classnames ${classNames}`;const isFalse=classNames.split(" ").some((cls)=>{const hasClass=el.classList.contains(cls);return shouldHaveClass?!hasClass:hasClass;});QUnit.assert.ok(!isFalse,msg);}
function hasClass(el,classNames,msg){_checkClass(el,classNames,true,msg);}
function doesNotHaveClass(el,classNames,msg){_checkClass(el,classNames,false,msg);}
function hasAttrValue(target,attr,value,msg){let $el;if(target._widgetRenderAndInsert){$el=target.$el;}else if(target instanceof Component){if(!target.el){throw new Error(`hasAttrValue assert with attr '${attr}' called on an unmounted component`);}
$el=$(target.el);}else{$el=target instanceof HTMLElement?$(target):target;}
if($el.length!==1){const descr=`hasAttrValue (${attr}: ${value})`;QUnit.assert.ok(false,`Assertion '${descr}' targets ${$el.length} elements instead of 1`);}else{msg=msg||`attribute '${attr}' of target should be '${value}'`;QUnit.assert.strictEqual($el.attr(attr),value,msg);}}
function _checkVisible(el,shouldBeVisible,msg){if(el){if(el._widgetRenderAndInsert){el=el.el;}else if(!(el instanceof HTMLElement)){el=el[0];}}
msg=msg||`target should ${shouldBeVisible ? "" : "not"} be visible`;let isVisible=el&&el.offsetWidth&&el.offsetHeight;if(isVisible){const rect=el.getBoundingClientRect();isVisible=rect.width+rect.height;}
const condition=shouldBeVisible?isVisible:!isVisible;QUnit.assert.ok(condition,msg);}
function isVisible(el,msg){return _checkVisible(el,true,msg);}
function isNotVisible(el,msg){return _checkVisible(el,false,msg);}
QUnit.assert.containsN=containsN;QUnit.assert.containsNone=containsNone;QUnit.assert.containsOnce=containsOnce;QUnit.assert.doesNotHaveClass=doesNotHaveClass;QUnit.assert.hasClass=hasClass;QUnit.assert.hasAttrValue=hasAttrValue;QUnit.assert.isVisible=isVisible;QUnit.assert.isNotVisible=isNotVisible;const errorMessages=[];async function checkModules(){document.querySelector("#qunit-banner").classList.remove("qunit-pass");const modulesAlert=document.createElement("div");modulesAlert.classList.add("alert");modulesAlert.classList.add("alert-info");modulesAlert.textContent="Waiting for modules check...";document.getElementById("qunit").appendChild(modulesAlert);await odoo.__DEBUG__.didLogInfo;const info=odoo.__DEBUG__.jsModules;if(info.missing.length||info.failed.length||info.unloaded.length){document.querySelector("#qunit-banner").classList.add("qunit-fail");modulesAlert.classList.toggle("alert-danger");modulesAlert.classList.toggle("alert-info");let error="Some modules couldn't be started:<ul>";if(info.failed.length){const failedList=info.failed.map((mod)=>"<li>"+_.escape(mod)+"</li>");error+=`<li> Failed modules: <ul>${failedList.join("")}</ul> </li>`;}
if(info.missing.length){const missingList=info.missing.map((mod)=>"<li>"+_.escape(mod)+"</li>");error+=`<li> Missing dependencies: <ul>${missingList.join("")}</ul> </li>`;}
if(info.unloaded.length){const unloadedList=info.unloaded.map((mod)=>"<li>"+_.escape(mod)+"</li>");error+=`
                    <li> Non loaded modules due to missing dependencies:
                        <ul>${unloadedList.join("")}</ul>
                    </li>`;if(info.cycle){error+=`<li> Cycle: ${info.cycle} </li>`;}}
error+="</ul>";modulesAlert.innerHTML=error;errorMessages.unshift(error);return false;}else{modulesAlert.classList.toggle("alert-success");modulesAlert.classList.toggle("alert-info");modulesAlert.textContent="All modules have been correctly loaded.";document.querySelector("#qunit-banner").classList.add("qunit-pass");return true;}}
QUnit.done(async(result)=>{const allModulesLoaded=await checkModules();if(result.failed){errorMessages.push(`${result.failed} / ${result.total} tests failed.`);}
if(!result.failed&&allModulesLoaded){console.log("test successful");}else{console.error(errorMessages.join("\n"));}});QUnit.moduleDone((result)=>{if(!result.failed){console.log('"'+result.name+'"',"passed",result.total,"tests.");}else{console.log('"'+result.name+'"',"failed",result.failed,"tests out of",result.total,".");}});QUnit.log((result)=>{if(result.result){return;}
let info=`QUnit test failed: ${result.module} > ${result.name}`;info+=` [message: "${result.message}"`;if(result.actual!==null){info+=`, actual: "${result.actual}"`;}
if(result.expected!==null){info+=`, expected: "${result.expected}"`;}
info+="]";errorMessages.push(info);});QUnit.debug=(name,cb)=>{QUnit.config.debug=true;QUnit.only(name,cb);};const qunitUnhandledReject=QUnit.onUnhandledRejection;QUnit.onUnhandledRejection=(reason)=>{if(reason instanceof Error){qunitUnhandledReject(reason);}};const windowUnhandledReject=window.onunhandledrejection;window.onunhandledrejection=(ev)=>{if(!(ev.reason instanceof Error)){ev.stopImmediatePropagation();ev.preventDefault();}else if(windowUnhandledReject){windowUnhandledReject.call(window,ev);}};QUnit.config.urlConfig.push({id:"failfast",label:"Fail Fast",tooltip:"Stop the test suite immediately after the first failed test.",});QUnit.begin(function(){if(odoo.__DEBUG__.services["@web/core/errors/error_utils"]){const errorUtils=odoo.__DEBUG__.services["@web/core/errors/error_utils"];const{annotateTraceback}=errorUtils;QUnit.annotateTraceback=annotateTraceback;}
const config=QUnit.config;if(config.failfast){QUnit.testDone(function(details){if(details.failed>0){config.queue.length=0;}});}});const oldError=QUnit.onError;QUnit.onError=err=>{if(err.message==='ResizeObserver loop limit exceeded'){return true;}
return oldError(err);}
let sortButtonAppended=false;function addSortButton(){sortButtonAppended=true;var $sort=$("<label> sort by time (desc)</label>").css({float:"right"});$("h2#qunit-userAgent").append($sort);$sort.click(function(){var $ol=$("ol#qunit-tests");var $results=$ol.children("li").get();$results.sort(function(a,b){var timeA=Number($(a).find("span.runtime").first().text().split(" ")[0]);var timeB=Number($(b).find("span.runtime").first().text().split(" ")[0]);if(timeA<timeB){return 1;}else if(timeA>timeB){return-1;}else{return 0;}});$.each($results,function(idx,$itm){$ol.append($itm);});});}
QUnit.done(()=>{if(!sortButtonAppended){addSortButton();}});QUnit.begin(()=>{const el=document.createElement("style");el.innerText="details:not([open]) > :not(summary) { display: none; }";document.head.appendChild(el);});})();;

/* /web/static/tests/main.js defined in bundle 'web.tests_assets' */
odoo.define('@web/../tests/main',async function(require){'use strict';let __exports={};const{setupTests}=require("@web/../tests/setup");(async()=>{await setupTests();QUnit.start();})();return __exports;});;

/* /web/static/tests/mock_server_tests.js defined in bundle 'web.tests_assets' */
odoo.define('@web/../tests/mock_server_tests',async function(require){'use strict';let __exports={};const{MockServer}=require("@web/../tests/helpers/mock_server");QUnit.module("Mock Server",{beforeEach(){this.data={models:{"res.partner":{fields:{name:{string:"Name",type:"string",},email:{string:"Email",type:"string",},active:{string:"Active",type:"bool",default:true,},},records:[{id:1,name:"Jean-Michel",email:"jean.michel@example.com"},{id:2,name:"Raoul",email:"raoul@example.com",active:false},],},bar:{fields:{foo:{string:"Foo",type:"integer",searchable:true,group_operator:"sum",},date:{string:"Date",type:"date",store:true,sortable:true},datetime:{string:"DateTime",type:"datetime",store:true,sortable:true,},partners:{string:"Buddies",type:"many2many",relation:"res.partner"},},records:[{id:1,foo:12,date:"2016-12-14",datetime:"2016-12-14 12:34:56",partners:[1,2],},{id:2,foo:1,date:"2016-10-26",datetime:"2016-10-26 12:34:56",partners:[1],},{id:3,foo:17,date:"2016-12-15",datetime:"2016-12-15 12:34:56",partners:[2],},{id:4,foo:2,date:"2016-04-11",datetime:"2016-04-11 12:34:56"},{id:5,foo:0,date:"2016-12-15",datetime:"2016-12-15 12:34:56"},{id:6,foo:42,date:"2019-12-30",datetime:"2019-12-30 12:34:56"},],},},};},});QUnit.test("performRPC: search with active_test=false",async function(assert){assert.expect(1);const server=new MockServer(this.data,{});const result=await server.performRPC("",{model:"res.partner",method:"search",args:[[]],kwargs:{context:{active_test:false},},});assert.deepEqual(result,[1,2]);});QUnit.test("performRPC: search with active_test=true",async function(assert){assert.expect(1);const server=new MockServer(this.data,{});const result=await server.performRPC("",{model:"res.partner",method:"search",args:[[]],kwargs:{context:{active_test:true},},});assert.deepEqual(result,[1]);});QUnit.test("performRPC: search_read with active_test=false",async function(assert){assert.expect(1);const server=new MockServer(this.data,{});const result=await server.performRPC("",{model:"res.partner",method:"search_read",args:[[]],kwargs:{fields:["name"],context:{active_test:false},},});assert.deepEqual(result,[{id:1,name:"Jean-Michel"},{id:2,name:"Raoul"},]);});QUnit.test("performRPC: search_read with active_test=true",async function(assert){assert.expect(1);const server=new MockServer(this.data,{});const result=await server.performRPC("",{model:"res.partner",method:"search_read",args:[[]],kwargs:{fields:["name"],context:{active_test:true},},});assert.deepEqual(result,[{id:1,name:"Jean-Michel"}]);});QUnit.test("performRPC: read_group, group by date",async function(assert){assert.expect(10);const server=new MockServer(this.data,{});let result=await server.performRPC("",{model:"bar",method:"read_group",args:[[]],kwargs:{fields:["foo"],domain:[],groupby:["date"],},});assert.deepEqual(result.map((x)=>x.date),["December 2016","October 2016","April 2016","December 2019"]);assert.deepEqual(result.map((x)=>x.date_count),[3,1,1,1]);result=await server.performRPC("",{model:"bar",method:"read_group",args:[[]],kwargs:{fields:["foo"],domain:[],groupby:["date:day"],},});assert.deepEqual(result.map((x)=>x["date:day"]),["2016-12-14","2016-10-26","2016-12-15","2016-04-11","2019-12-30"]);assert.deepEqual(result.map((x)=>x.date_count),[1,1,2,1,1]);result=await server.performRPC("",{model:"bar",method:"read_group",args:[[]],kwargs:{fields:["foo"],domain:[],groupby:["date:week"],},});assert.deepEqual(result.map((x)=>x["date:week"]),["W50 2016","W43 2016","W15 2016","W01 2020"]);assert.deepEqual(result.map((x)=>x.date_count),[3,1,1,1]);result=await server.performRPC("",{model:"bar",method:"read_group",args:[[]],kwargs:{fields:["foo"],domain:[],groupby:["date:quarter"],},});assert.deepEqual(result.map((x)=>x["date:quarter"]),["Q4 2016","Q2 2016","Q4 2019"]);assert.deepEqual(result.map((x)=>x.date_count),[4,1,1]);result=await server.performRPC("",{model:"bar",method:"read_group",args:[[]],kwargs:{fields:["foo"],domain:[],groupby:["date:year"],},});assert.deepEqual(result.map((x)=>x["date:year"]),["2016","2019"]);assert.deepEqual(result.map((x)=>x.date_count),[5,1]);});QUnit.test("performRPC: read_group, group by datetime",async function(assert){const server=new MockServer(this.data,{});let result=await server.performRPC("",{model:"bar",method:"read_group",args:[[]],kwargs:{fields:["foo"],domain:[],groupby:["datetime"],},});assert.deepEqual(result.map((x)=>x.datetime),["December 2016","October 2016","April 2016","December 2019"]);assert.deepEqual(result.map((x)=>x.datetime_count),[3,1,1,1]);result=await server.performRPC("",{model:"bar",method:"read_group",args:[[]],kwargs:{fields:["foo"],domain:[],groupby:["datetime:hour"],},});assert.deepEqual(result.map((x)=>x["datetime:hour"]),["12:00 14 Dec","12:00 26 Oct","12:00 15 Dec","12:00 11 Apr","12:00 30 Dec"]);assert.deepEqual(result.map((x)=>x.datetime_count),[1,1,2,1,1]);result=await server.performRPC("",{model:"bar",method:"read_group",args:[[]],kwargs:{fields:["foo"],domain:[],groupby:["datetime:day"],},});assert.deepEqual(result.map((x)=>x["datetime:day"]),["2016-12-14","2016-10-26","2016-12-15","2016-04-11","2019-12-30"]);assert.deepEqual(result.map((x)=>x.datetime_count),[1,1,2,1,1]);result=await server.performRPC("",{model:"bar",method:"read_group",args:[[]],kwargs:{fields:["foo"],domain:[],groupby:["datetime:week"],},});assert.deepEqual(result.map((x)=>x["datetime:week"]),["W50 2016","W43 2016","W15 2016","W01 2020"]);assert.deepEqual(result.map((x)=>x.datetime_count),[3,1,1,1]);result=await server.performRPC("",{model:"bar",method:"read_group",args:[[]],kwargs:{fields:["foo"],domain:[],groupby:["datetime:quarter"],},});assert.deepEqual(result.map((x)=>x["datetime:quarter"]),["Q4 2016","Q2 2016","Q4 2019"]);assert.deepEqual(result.map((x)=>x.datetime_count),[4,1,1]);result=await server.performRPC("",{model:"bar",method:"read_group",args:[[]],kwargs:{fields:["foo"],domain:[],groupby:["datetime:year"],},});assert.deepEqual(result.map((x)=>x["datetime:year"]),["2016","2019"]);assert.deepEqual(result.map((x)=>x.datetime_count),[5,1]);});QUnit.test("performRPC: read_group, group by m2m",async function(assert){const server=new MockServer(this.data,{});const result=await server.performRPC("",{model:"bar",method:"read_group",args:[[]],kwargs:{fields:["partners"],domain:[],groupby:["partners"],},});assert.deepEqual(result,[{__domain:[["partners","=",1]],partners:[1,"Jean-Michel"],partners_count:2,},{__domain:[["partners","=",2]],partners:[2,"Raoul"],partners_count:2,},{__domain:[["partners","=",false]],partners:false,partners_count:3,},]);});QUnit.test("performRPC: read_group, group by integer",async function(assert){const server=new MockServer(this.data,{});const result=await server.performRPC("",{model:"bar",method:"read_group",args:[[]],kwargs:{fields:["foo"],domain:[],groupby:["foo"],},});assert.deepEqual(result,[{__domain:[["foo","=",12]],foo:12,foo_count:1,},{__domain:[["foo","=",1]],foo:1,foo_count:1,},{__domain:[["foo","=",17]],foo:17,foo_count:1,},{__domain:[["foo","=",2]],foo:2,foo_count:1,},{__domain:[["foo","=",0]],foo:0,foo_count:1,},{__domain:[["foo","=",42]],foo:42,foo_count:1,},]);});return __exports;});;

/* /web/static/tests/setup.js defined in bundle 'web.tests_assets' */
odoo.define('@web/../tests/setup',async function(require){'use strict';let __exports={};const LegacyBus=require("web.Bus");const session=require("web.session");const{_t,qweb}=require("web.core");const{browser,makeRAMLocalStorage}=require("@web/core/browser/browser");const{patchWithCleanup}=require("@web/../tests/helpers/utils");const{legacyProm}=require("web.test_legacy");const{registerCleanup}=require("@web/../tests/helpers/cleanup");const{prepareRegistriesWithCleanup}=require("@web/../tests/helpers/mock_env");const{session:sessionInfo}=require("@web/session");const{prepareLegacyRegistriesWithCleanup}=require("@web/../tests/helpers/legacy_env_utils");const{whenReady,loadFile}=owl.utils;owl.config.enableTransitions=false;owl.QWeb.dev=true;function stringifyObjectValues(obj,properties){let res="";for(const dotted of properties){const keys=dotted.split(".");let val=obj;for(const k of keys){val=val[k];}
res+=JSON.stringify(val);}
return res;}
function checkGlobalObjectsIntegrity(){const objects=[[session,["user_context","currencies"]],[_t,["database.multi_lang","database.parameters"]],];const initials=objects.map((obj)=>stringifyObjectValues(obj[0],obj[1]));registerCleanup((infos)=>{const finals=objects.map((obj)=>stringifyObjectValues(obj[0],obj[1]));for(const index in initials){if(initials[index]!==finals[index]){const[global,keys]=objects[index];throw new Error(`The keys "${keys}" of some global objects (usually session or _t) may have been polluted by the test "${infos.testName}" in module "${infos.moduleName}"`);}}});}
function forceLocaleAndTimezoneWithCleanup(){const originalLocale=luxon.Settings.defaultLocale;luxon.Settings.defaultLocale="en";const originalZoneName=luxon.Settings.defaultZoneName;luxon.Settings.defaultZoneName="Europe/Brussels";registerCleanup(()=>{luxon.Settings.defaultLocale=originalLocale;luxon.Settings.defaultZoneName=originalZoneName;});}
function makeMockLocation(hasListeners=()=>true){const locationLink=Object.assign(document.createElement("a"),{href:window.location.origin+window.location.pathname,assign(url){this.href=url;},reload(){},});return new Proxy(locationLink,{get(target,p){return target[p];},set(target,p,value){if(p==="hash"){const oldURL=new URL(locationLink.href).toString();target[p]=value;const newURL=new URL(locationLink.href).toString();if(!hasListeners()){return true;}
window.setTimeout(()=>{window.dispatchEvent(new HashChangeEvent("hashchange",{oldURL,newURL}));});return true;}
target[p]=value;return true;},});}
function patchBrowserWithCleanup(){const originalAddEventListener=browser.addEventListener;const originalRemoveEventListener=browser.removeEventListener;let hasHashChangeListeners=false;const mockLocation=makeMockLocation(()=>hasHashChangeListeners);patchWithCleanup(browser,{addEventListener(evName){if(evName==="hashchange"){hasHashChangeListeners=true;}
originalAddEventListener(...arguments);registerCleanup(()=>{originalRemoveEventListener(...arguments);});},navigator:{userAgent:browser.navigator.userAgent.replace(/\([^)]*\)/,"(X11; Linux x86_64)"),},location:mockLocation,history:{pushState(state,title,url){mockLocation.assign(url);},replaceState(state,title,url){mockLocation.assign(url);},},localStorage:makeRAMLocalStorage(),sessionStorage:makeRAMLocalStorage(),},{pure:true});}
function patchLegacyBus(){patchWithCleanup(LegacyBus.prototype,{on(){this._super(...arguments);registerCleanup(()=>{this.off(...arguments);});},});}
function patchOdoo(){patchWithCleanup(odoo,{debug:"",});}
function patchSessionInfo(){patchWithCleanup(sessionInfo,{cache_hashes:{load_menus:"161803",translations:"314159",},currencies:{1:{name:"USD",digits:[69,2],position:"before",symbol:"$"},2:{name:"EUR",digits:[69,2],position:"after",symbol:"€"},},user_context:{lang:"en",uid:7,tz:"taht",},qweb:"owl",uid:7,name:"Mitchell",username:"The wise",is_admin:true,is_system:true,partner_id:7,user_companies:{allowed_companies:{1:{id:1,name:"Hermit"}},current_company:1,},db:"test",server_version:"1.0",server_version_info:["1.0"],});}
function removeUnwantedAttrsFromTemplates(templates,attrs){function replaceAttr(attrName,prefix,element){const attrKey=`${prefix}${attrName}`;const attrValue=element.getAttribute(attrKey);element.removeAttribute(attrKey);element.setAttribute(`${prefix}data-${attrName}`,attrValue);}
const attrPrefixes=['','t-att-','t-attf-'];for(const attrName of attrs){for(const prefix of attrPrefixes){for(const element of templates.querySelectorAll(`*[${prefix}${attrName}]`)){replaceAttr(attrName,prefix,element);}}}}
__exports.setupTests=setupTests;async function setupTests(){QUnit.testStart(()=>{checkGlobalObjectsIntegrity();prepareRegistriesWithCleanup();prepareLegacyRegistriesWithCleanup();forceLocaleAndTimezoneWithCleanup();patchBrowserWithCleanup();patchLegacyBus();patchOdoo();patchSessionInfo();});const templatesUrl=`/web/webclient/qweb/${new Date().getTime()}?bundle=web.assets_qweb`;let templates=await loadFile(templatesUrl);const doc=new DOMParser().parseFromString(templates,"text/xml");removeUnwantedAttrsFromTemplates(doc,['alt','src']);for(const template of Object.values(qweb.templates)){removeUnwantedAttrsFromTemplates(template,["alt","src"]);}
const owlTemplates=[];for(let child of doc.querySelectorAll("templates > [owl]")){child.removeAttribute("owl");owlTemplates.push(child.outerHTML);}
templates=`<templates> ${owlTemplates.join("\n")} </templates>`;window.__ODOO_TEMPLATES__=templates;session.owlTemplates=templates;await Promise.all([whenReady(),legacyProm]);}
return __exports;});;

/* /web/static/src/legacy/frontend/keyboard_navigation_mixin.js defined in bundle 'web.tests_assets' */
odoo.define('web.KeyboardNavigationMixin',function(require){"use strict";var BrowserDetection=require('web.BrowserDetection');const core=require('web.core');var knownUnusableAccessKeys=[' ','A','B','C','H','J','K','L','N','P','S','Q','E','F','D','0','1','2','3','4','5','6','7','8','9'];var KeyboardNavigationMixin={events:{'keydown':'_onKeyDown','keyup':'_onKeyUp',},init:function(options){this.options=Object.assign({autoAccessKeys:true,skipRenderOverlay:false,},options);this._areAccessKeyVisible=false;this.BrowserDetection=new BrowserDetection();},start:function(){const temp=this._hideAccessKeyOverlay.bind(this);this._hideAccessKeyOverlay=()=>temp();window.addEventListener('blur',this._hideAccessKeyOverlay);core.bus.on('click',null,this._hideAccessKeyOverlay);},destroy:function(){window.removeEventListener('blur',this._hideAccessKeyOverlay);core.bus.off('click',null,this._hideAccessKeyOverlay);},_addAccessKeyOverlays:function(){if(this.options.skipRenderOverlay){return;}
var accesskeyElements=$(document).find('[accesskey]').filter(':visible');_.each(accesskeyElements,function(elem){var overlay=$(_.str.sprintf("<div class='o_web_accesskey_overlay'>%s</div>",$(elem).attr('accesskey').toUpperCase()));var $overlayParent;if(elem.tagName.toUpperCase()==="INPUT"){$overlayParent=$(elem).parent();}else{$overlayParent=$(elem);}
if($overlayParent.css('position')!=='absolute'){$overlayParent.css('position','relative');}
overlay.appendTo($overlayParent);});},_getAllUsedAccessKeys:function(){var usedAccessKeys=knownUnusableAccessKeys.slice();this.$el.find('[accesskey]').each(function(_,elem){usedAccessKeys.push(elem.accessKey.toUpperCase());});return usedAccessKeys;},_hideAccessKeyOverlay:function(){this._areAccessKeyVisible=false;var overlays=this.$el.find('.o_web_accesskey_overlay');if(overlays.length){return overlays.remove();}},_setAccessKeyOnTopNavigation:function(){this.$el.find('.o_menu_sections>li>a').each(function(number,item){item.accessKey=number+1;});},_onKeyDown:function(keyDownEvent){if($('body.o_ui_blocked').length&&(keyDownEvent.altKey||keyDownEvent.key==='Alt')&&!keyDownEvent.ctrlKey){if(keyDownEvent.preventDefault)keyDownEvent.preventDefault();else keyDownEvent.returnValue=false;if(keyDownEvent.stopPropagation)keyDownEvent.stopPropagation();if(keyDownEvent.cancelBubble)keyDownEvent.cancelBubble=true;return false;}
if(!this._areAccessKeyVisible&&(keyDownEvent.altKey||keyDownEvent.key==='Alt')&&!keyDownEvent.ctrlKey){this._areAccessKeyVisible=true;this._setAccessKeyOnTopNavigation();var usedAccessKey=this._getAllUsedAccessKeys();if(this.options.autoAccessKeys){var buttonsWithoutAccessKey=this.$el.find('button.btn:visible').not('[accesskey]').not('[disabled]').not('[tabindex="-1"]');_.each(buttonsWithoutAccessKey,function(elem){var buttonString=[elem.innerText,elem.title,"ABCDEFGHIJKLMNOPQRSTUVWXYZ"].join('');for(var letterIndex=0;letterIndex<buttonString.length;letterIndex++){var candidateAccessKey=buttonString[letterIndex].toUpperCase();if(candidateAccessKey>='A'&&candidateAccessKey<='Z'&&!_.includes(usedAccessKey,candidateAccessKey)){elem.accessKey=candidateAccessKey;usedAccessKey.push(candidateAccessKey);break;}}});}
var elementsWithoutAriaKeyshortcut=this.$el.find('[accesskey]').not('[aria-keyshortcuts]');_.each(elementsWithoutAriaKeyshortcut,function(elem){elem.setAttribute('aria-keyshortcuts','Alt+Shift+'+elem.accessKey);});this._addAccessKeyOverlays();}
if(this.BrowserDetection.isOsMac())
return;if(keyDownEvent.altKey&&!keyDownEvent.ctrlKey&&keyDownEvent.key.length===1){var elementWithAccessKey=[];if(keyDownEvent.keyCode>=65&&keyDownEvent.keyCode<=90||keyDownEvent.keyCode>=97&&keyDownEvent.keyCode<=122){elementWithAccessKey=document.querySelectorAll('[accesskey="'+String.fromCharCode(keyDownEvent.keyCode).toLowerCase()+'"], [accesskey="'+String.fromCharCode(keyDownEvent.keyCode).toUpperCase()+'"]');if(elementWithAccessKey.length){if(this.BrowserDetection.isOsMac()||!this.BrowserDetection.isBrowserChrome()){elementWithAccessKey[0].focus();elementWithAccessKey[0].click();if(keyDownEvent.preventDefault)keyDownEvent.preventDefault();else keyDownEvent.returnValue=false;if(keyDownEvent.stopPropagation)keyDownEvent.stopPropagation();if(keyDownEvent.cancelBubble)keyDownEvent.cancelBubble=true;return false;}}}
else{var numberKey;if(keyDownEvent.originalEvent.code&&keyDownEvent.originalEvent.code.indexOf('Digit')===0){numberKey=keyDownEvent.originalEvent.code[keyDownEvent.originalEvent.code.length-1];}else if(keyDownEvent.originalEvent.key&&keyDownEvent.originalEvent.key.length===1&&keyDownEvent.originalEvent.key>='0'&&keyDownEvent.originalEvent.key<='9'){numberKey=keyDownEvent.originalEvent.key;}else if(keyDownEvent.keyCode>=48&&keyDownEvent.keyCode<=57){numberKey=keyDownEvent.keyCode-48;}
if(numberKey>='0'&&numberKey<='9'){elementWithAccessKey=document.querySelectorAll('[accesskey="'+numberKey+'"]');if(elementWithAccessKey.length){elementWithAccessKey[0].click();if(keyDownEvent.preventDefault)keyDownEvent.preventDefault();else keyDownEvent.returnValue=false;if(keyDownEvent.stopPropagation)keyDownEvent.stopPropagation();if(keyDownEvent.cancelBubble)keyDownEvent.cancelBubble=true;return false;}}}}},_onKeyUp:function(keyUpEvent){if((keyUpEvent.altKey||keyUpEvent.key==='Alt')&&!keyUpEvent.ctrlKey){if(this.options.skipRenderOverlay){return;}
this._hideAccessKeyOverlay();if(keyUpEvent.preventDefault)keyUpEvent.preventDefault();else keyUpEvent.returnValue=false;if(keyUpEvent.stopPropagation)keyUpEvent.stopPropagation();if(keyUpEvent.cancelBubble)keyUpEvent.cancelBubble=true;return false;}},};return KeyboardNavigationMixin;});;

/* /web/static/src/legacy/js/views/graph/graph_controller.js defined in bundle 'web.tests_assets' */
odoo.define('web.GraphController',function(require){"use strict";const AbstractController=require('web.AbstractController');const{ComponentWrapper}=require('web.OwlCompatibility');const DropdownMenu=require('web.DropdownMenu');const{DEFAULT_INTERVAL,INTERVAL_OPTIONS}=require('web.searchUtils');const{qweb}=require('web.core');const{_t}=require('web.core');class CarretDropdownMenu extends DropdownMenu{get displayCaret(){return true;}}
var GraphController=AbstractController.extend({custom_events:_.extend({},AbstractController.prototype.custom_events,{item_selected:'_onItemSelected',open_view:'_onOpenView',}),init:function(parent,model,renderer,params){this._super.apply(this,arguments);this.measures=params.measures;this.isEmbedded=params.isEmbedded;this.withButtons=params.withButtons;this.views=params.views;this.title=params.title;this.groupableFields=params.groupableFields;this.buttonDropdownPromises=[];},destroy:function(){if(this.$buttons){this.$buttons.find('button').off().tooltip('dispose');}
this._super.apply(this,arguments);},getOwnedQueryParams:function(){var state=this.model.get();return{context:{graph_measure:state.measure,graph_mode:state.mode,graph_groupbys:state.groupBy,}};},reload:async function(){const promises=[this._super(...arguments)];if(this.withButtons){const state=this.model.get();this.measures.forEach(m=>m.isActive=m.fieldName===state.measure);promises.push(this.measureMenu.update({items:this.measures}));}
return Promise.all(promises);},renderButtons:function($node){this.$buttons=$(qweb.render('GraphView.buttons'));this.$buttons.find('button').tooltip();this.$buttons.click(ev=>this._onButtonClick(ev));if(this.withButtons){const state=this.model.get();const fragment=document.createDocumentFragment();this.measures.forEach(m=>m.isActive=m.fieldName===state.measure);this.measureMenu=new ComponentWrapper(this,CarretDropdownMenu,{title:_t("Measures"),items:this.measures,});this.buttonDropdownPromises=[this.measureMenu.mount(fragment)];if(this.isEmbedded){this.groupByMenu=new ComponentWrapper(this,CarretDropdownMenu,{title:_t("Group By"),icon:'fa fa-bars',items:this._getGroupBys(state.groupBy),});this.buttonDropdownPromises.push(this.groupByMenu.mount(fragment));}
if($node){this.$buttons.appendTo($node);}}},updateButtons:function(){if(!this.$buttons){return;}
var state=this.model.get();this.$buttons.find('.o_graph_button').removeClass('active');this.$buttons.find('.o_graph_button[data-mode="'+state.mode+'"]').addClass('active');this.$buttons.find('.o_graph_button[data-mode="stack"]').data('stacked',state.stacked).toggleClass('active',state.stacked).toggleClass('o_hidden',state.mode!=='bar');this.$buttons.find('.o_graph_button[data-order]').toggleClass('o_hidden',state.mode==='pie'||!!Object.keys(state.timeRanges).length).filter('.o_graph_button[data-order="'+state.orderBy+'"]').toggleClass('active',!!state.orderBy);if(this.withButtons){return this._attachDropdownComponents();}},async _attachDropdownComponents(){await Promise.all(this.buttonDropdownPromises);if(this.isDestroyed()){return;}
const actionsContainer=this.$buttons[0];actionsContainer.appendChild(this.measureMenu.el);this.measureMenu.el.classList.add('o_graph_measures_list');if(this.isEmbedded){actionsContainer.appendChild(this.groupByMenu.el);this.groupByMenu.el.classList.add('o_group_by_menu');}
const buttons=actionsContainer.querySelectorAll('.dropdown-toggle');for(const button of buttons){button.classList.remove('btn-secondary');if(this.isEmbedded){button.classList.add('btn-outline-secondary');}else{button.classList.add('btn-primary');button.tabIndex=0;}}},_getGroupBys(activeGroupBys){const normalizedGroupBys=this._normalizeActiveGroupBys(activeGroupBys);const groupBys=Object.keys(this.groupableFields).map(fieldName=>{const field=this.groupableFields[fieldName];const groupByActivity=normalizedGroupBys.filter(gb=>gb.fieldName===fieldName);const groupBy={id:fieldName,isActive:Boolean(groupByActivity.length),description:field.string,itemType:'groupBy',};if(['date','datetime'].includes(field.type)){groupBy.hasOptions=true;const activeOptionIds=groupByActivity.map(gb=>gb.interval);groupBy.options=Object.values(INTERVAL_OPTIONS).map(o=>{return Object.assign({},o,{isActive:activeOptionIds.includes(o.id)});});}
return groupBy;}).sort((gb1,gb2)=>{return gb1.description.localeCompare(gb2.description);});return groupBys;},_normalizeActiveGroupBys(activeGroupBys){return activeGroupBys.map(groupBy=>{const fieldName=groupBy.split(':')[0];const field=this.groupableFields[fieldName];const normalizedGroupBy={fieldName};if(['date','datetime'].includes(field.type)){normalizedGroupBy.interval=groupBy.split(':')[1]||DEFAULT_INTERVAL;}
return normalizedGroupBy;});},_onButtonClick:function(ev){var $target=$(ev.target);if($target.hasClass('o_graph_button')){if(_.contains(['bar','line','pie'],$target.data('mode'))){this.update({mode:$target.data('mode')});}else if($target.data('mode')==='stack'){this.update({stacked:!$target.data('stacked')});}else if(['asc','desc'].includes($target.data('order'))){const order=$target.data('order');const state=this.model.get();this.update({orderBy:state.orderBy===order?false:order});}}},_onItemSelected(ev){const item=ev.data.item;if(this.isEmbedded&&item.itemType==='groupBy'){const fieldName=item.id;const optionId=ev.data.option&&ev.data.option.id;const activeGroupBys=this.model.get().groupBy;if(optionId){const normalizedGroupBys=this._normalizeActiveGroupBys(activeGroupBys);const index=normalizedGroupBys.findIndex(ngb=>ngb.fieldName===fieldName&&ngb.interval===optionId);if(index===-1){activeGroupBys.push(fieldName+':'+optionId);}else{activeGroupBys.splice(index,1);}}else{const groupByFieldNames=activeGroupBys.map(gb=>gb.split(':')[0]);const indexOfGroupby=groupByFieldNames.indexOf(fieldName);if(indexOfGroupby===-1){activeGroupBys.push(fieldName);}else{activeGroupBys.splice(indexOfGroupby,1);}}
this.update({groupBy:activeGroupBys});this.groupByMenu.update({items:this._getGroupBys(activeGroupBys),});}else if(item.itemType==='measure'){this.update({measure:item.fieldName});this.measures.forEach(m=>m.isActive=m.fieldName===item.fieldName);this.measureMenu.update({items:this.measures});}},_onOpenView(ev){ev.stopPropagation();const state=this.model.get();const context=Object.assign({},state.context);Object.keys(context).forEach(x=>{if(x==='group_by'||x.startsWith('search_default_')){delete context[x];}});this.do_action({context:context,domain:ev.data.domain,name:this.title,res_model:this.modelName,target:'current',type:'ir.actions.act_window',view_mode:'list',views:this.views,});},});return GraphController;});;

/* /web/static/src/legacy/js/views/graph/graph_model.js defined in bundle 'web.tests_assets' */
odoo.define('web.GraphModel',function(require){"use strict";var core=require('web.core');const{DEFAULT_INTERVAL,rankInterval}=require('web.searchUtils');var _t=core._t;var AbstractModel=require('web.AbstractModel');return AbstractModel.extend({init:function(){this._super.apply(this,arguments);this.chart=null;},__get:function(){return Object.assign({isSample:this.isSampleModel},this.chart);},__load:function(params){var groupBys=params.context.graph_groupbys||params.groupBys;this.initialGroupBys=groupBys;this.fields=params.fields;this.modelName=params.modelName;this.chart=Object.assign({context:params.context,dataPoints:[],domain:params.domain,groupBy:params.groupedBy.length?params.groupedBy:groupBys,measure:params.context.graph_measure||params.measure,mode:params.context.graph_mode||params.mode,origins:[],stacked:params.stacked,timeRanges:params.timeRanges,orderBy:params.orderBy});if(this.chart.measure==="__count"){this.chart.measure="__count__";}
this._computeDerivedParams();return this._loadGraph();},__reload:function(handle,params){if('context'in params){this.chart.context=params.context;this.chart.groupBy=params.context.graph_groupbys||this.chart.groupBy;this.chart.measure=params.context.graph_measure||this.chart.measure;this.chart.mode=params.context.graph_mode||this.chart.mode;}
if('domain'in params){this.chart.domain=params.domain;}
if('groupBy'in params){this.chart.groupBy=params.groupBy.length?params.groupBy:this.initialGroupBys;}
if('measure'in params){this.chart.measure=params.measure;}
if('timeRanges'in params){this.chart.timeRanges=params.timeRanges;}
if(this.chart.measure==="__count"){this.chart.measure="__count__";}
this._computeDerivedParams();if('mode'in params){this.chart.mode=params.mode;return Promise.resolve();}
if('stacked'in params){this.chart.stacked=params.stacked;return Promise.resolve();}
if('orderBy'in params){this.chart.orderBy=params.orderBy;return Promise.resolve();}
return this._loadGraph();},_computeDerivedParams:function(){this.chart.processedGroupBy=this._processGroupBy(this.chart.groupBy);const{range,rangeDescription,comparisonRange,comparisonRangeDescription,fieldName}=this.chart.timeRanges;if(range){this.chart.domains=[this.chart.domain.concat(range),this.chart.domain.concat(comparisonRange),];this.chart.origins=[rangeDescription,comparisonRangeDescription];const groupBys=this.chart.processedGroupBy.map(function(gb){return gb.split(":")[0];});this.chart.comparisonFieldIndex=groupBys.indexOf(fieldName);}else{this.chart.domains=[this.chart.domain];this.chart.origins=[""];this.chart.comparisonFieldIndex=-1;}},_isEmpty(){return this.chart.dataPoints.length===0;},_loadGraph:function(){var self=this;this.chart.dataPoints=[];var groupBy=this.chart.processedGroupBy;var fields=_.map(groupBy,function(groupBy){return groupBy.split(':')[0];});const loadId=this.loadId?++this.loadId:1;this.loadId=loadId;if(this.chart.measure!=='__count__'){if(this.fields[this.chart.measure].type==='many2one'){fields=fields.concat(this.chart.measure+":count_distinct");}
else{fields=fields.concat(this.chart.measure);}}
var context=_.extend({fill_temporal:true},this.chart.context);var proms=[];this.chart.domains.forEach(function(domain,originIndex){proms.push(self._rpc({model:self.modelName,method:'read_group',context:context,domain:domain,fields:fields,groupBy:groupBy,lazy:false,}).then(self._processData.bind(self,originIndex,loadId)));});return Promise.all(proms);},_processData:function(originIndex,loadId,rawData){if(loadId<this.loadId){return;}
var self=this;var isCount=this.chart.measure==='__count__';var labels;function getLabels(dataPt){return self.chart.processedGroupBy.map(function(field){return self._sanitizeValue(dataPt[field],field.split(":")[0]);});}
rawData.forEach(function(dataPt){labels=getLabels(dataPt);var count=dataPt.__count||dataPt[self.chart.processedGroupBy[0]+'_count']||0;var value=isCount?count:dataPt[self.chart.measure];if(value instanceof Array){value=1;}
self.chart.dataPoints.push({resId:dataPt[self.chart.groupBy[0]]instanceof Array?dataPt[self.chart.groupBy[0]][0]:-1,count:count,domain:dataPt.__domain,value:value,labels:labels,originIndex:originIndex,});});},_processGroupBy:function(groupBy){const groupBysMap=new Map();for(const gb of groupBy){let[fieldName,interval]=gb.split(':');const field=this.fields[fieldName];if(['date','datetime'].includes(field.type)){interval=interval||DEFAULT_INTERVAL;}
if(groupBysMap.has(fieldName)){const registeredInterval=groupBysMap.get(fieldName);if(rankInterval(registeredInterval)<rankInterval(interval)){groupBysMap.set(fieldName,interval);}}else{groupBysMap.set(fieldName,interval);}}
return[...groupBysMap].map(([fieldName,interval])=>{if(interval){return`${fieldName}:${interval}`;}
return fieldName;});},_sanitizeValue:function(value,fieldName){if(value===false&&this.fields[fieldName].type!=='boolean'){return _t("Undefined");}
if(value instanceof Array){return value[1];}
if(fieldName&&(this.fields[fieldName].type==='selection')){var selected=_.where(this.fields[fieldName].selection,{0:value})[0];return selected?selected[1]:value;}
return value;},});});;

/* /web/static/src/legacy/js/views/graph/graph_renderer.js defined in bundle 'web.tests_assets' */
odoo.define("web/static/src/js/views/graph/graph_renderer",function(require){"use strict";const AbstractRenderer=require("web.AbstractRendererOwl");const{DateClasses}=require("web.dataComparisonUtils");const fieldUtils=require("web.field_utils");const{sortBy}=require("web.utils");const{COLORS,DEFAULT_BG,FORMAT_OPTIONS,MAX_LEGEND_LENGTH,getColor,getMaxWidth,hexToRGBA,shortenLabel,}=require("web/static/src/js/views/graph/graph_utils");const{useRef}=owl.hooks;class GraphRenderer extends AbstractRenderer{constructor(){super(...arguments);this.noDataLabel=[this.env._t("No data")];this.fakeDataLabel=[""];this.sampleDataTargets=[".o_graph_canvas_container"];this._processProps(this.props);this.canvasRef=useRef("canvas");this.containerRef=useRef("container");}
async willUpdateProps(nextProps){await super.willUpdateProps(...arguments);this._processProps(nextProps);}
mounted(){super.mounted();this._renderChart();}
patched(){super.patched();this._renderChart();}
get measureDescription(){const measure=this.props.measures.find(m=>m.fieldName===this.props.measure);return measure?measure.description:this.props.fields[this.props.measure].string;}
_adjustTooltipHeight(maxTooltipHeight){const sizeOneLine=this.tooltip.querySelector("tbody tr").clientHeight;const tbodySize=this.tooltip.querySelector("tbody").clientHeight;const toKeep=Math.max(0,Math.floor((maxTooltipHeight-(this.tooltip.clientHeight-tbodySize))/sizeOneLine)-1);const lines=this.tooltip.querySelectorAll("tbody tr");const toRemove=lines.length-toKeep;if(toRemove>0){for(let index=toKeep;index<lines.length;++index){lines[index].remove();}
const tr=document.createElement("tr");const td=document.createElement("td");tr.classList.add("o_show_more");td.innerHTML=this.env._t("...");tr.appendChild(td);this.tooltip.querySelector("tbody").appendChild(tr);}}
_createBarChartConfig(){const data=this._prepareData(this.processedDataPoints);for(let index=0;index<data.datasets.length;++index){const dataset=data.datasets[index];if(this.props.stacked){dataset.stack=this.props.origins[dataset.originIndex];}
dataset.backgroundColor=getColor(index);}
const options=this._prepareOptions(data.datasets.length);return{data,options,type:"bar"};}
_createConfig(){if(this.noContentHelperData){return{};}
if(this.props.comparisonFieldIndex===0){this.dateClasses=this._getDateClasses(this.processedDataPoints);}
switch(this.props.mode){case"bar":return this._createBarChartConfig();case"line":return this._createLineChartConfig();case"pie":return this._createPieChartConfig();}}
_createLineChartConfig(){const data=this._prepareData(this.processedDataPoints);for(let index=0;index<data.datasets.length;++index){const dataset=data.datasets[index];if(this.props.processedGroupBy.length<=1&&this.props.origins.length>1){if(dataset.originIndex===0){dataset.fill="origin";dataset.backgroundColor=hexToRGBA(COLORS[0],0.4);dataset.borderColor=hexToRGBA(COLORS[0],1);}else if(dataset.originIndex===1){dataset.borderColor=hexToRGBA(COLORS[1],1);}else{dataset.borderColor=getColor(index);}}else{dataset.borderColor=getColor(index);}
if(data.labels.length===1){dataset.data.unshift(undefined);}
dataset.pointBackgroundColor=dataset.borderColor;dataset.pointBorderColor="rgba(0,0,0,0.2)";}
if(data.datasets.length===1&&data.datasets[0].originIndex===0){const dataset=data.datasets[0];dataset.fill="origin";dataset.backgroundColor=hexToRGBA(COLORS[0],0.4);}
data.labels=data.labels.length>1?data.labels:[this.fakeDataLabel,...data.labels,this.fakeDataLabel];const options=this._prepareOptions(data.datasets.length);return{data,options,type:"line"};}
_createPieChartConfig(){let data={};const allZero=this.processedDataPoints.every(datapt=>datapt.value===0);if(allZero){data.labels=[this.noDataLabel];data.datasets=this.props.origins.map(origin=>{return{label:origin,data:[1],backgroundColor:[DEFAULT_BG],};});}else{data=this._prepareData(this.processedDataPoints);const colors=data.labels.map((_,index)=>getColor(index));for(const dataset of data.datasets){dataset.backgroundColor=colors;dataset.borderColor="rgba(255,255,255,0.6)";}
const representedOriginIndexes=data.datasets.map(dataset=>dataset.originIndex);let addNoDataToLegend=false;const fakeData=new Array(data.labels.length).concat([1]);for(let index=0;index<this.props.origins.length;++index){const origin=this.props.origins[index];if(!representedOriginIndexes.includes(index)){data.datasets.splice(index,0,{label:origin,data:fakeData,backgroundColor:[...colors,DEFAULT_BG],});addNoDataToLegend=true;}}
if(addNoDataToLegend){data.labels.push(this.noDataLabel);}}
const options=this._prepareOptions(data.datasets.length);return{data,options,type:"pie"};}
_customTooltip(tooltipModel){this.el.style.cursor="";this._removeTooltips();if(tooltipModel.opacity===0||tooltipModel.dataPoints.length===0){return;}
if(this._isRedirectionEnabled()){this.el.style.cursor="pointer";}
const chartAreaTop=this.chart.chartArea.top;const rendererTop=this.el.getBoundingClientRect().top;const innerHTML=this.env.qweb.renderToString("web.GraphRenderer.CustomTooltip",{maxWidth:getMaxWidth(this.chart.chartArea),measure:this.measureDescription,mode:this.props.mode,tooltipItems:this._getTooltipItems(tooltipModel),});const template=Object.assign(document.createElement("template"),{innerHTML});this.tooltip=template.content.firstChild;this.containerRef.el.prepend(this.tooltip);let top;const tooltipHeight=this.tooltip.clientHeight;const minTopAllowed=Math.floor(chartAreaTop);const maxTopAllowed=Math.floor(window.innerHeight-(rendererTop+tooltipHeight))-2;const y=Math.floor(tooltipModel.y);if(minTopAllowed<=maxTopAllowed){if(y<=maxTopAllowed){if(y>=minTopAllowed){top=y;}else{top=minTopAllowed;}}else{top=maxTopAllowed;}}else{top=minTopAllowed;const maxTooltipHeight=window.innerHeight-(rendererTop+chartAreaTop)-2;this._adjustTooltipHeight(maxTooltipHeight);}
this._fixTooltipLeftPosition(this.tooltip,tooltipModel.x);this.tooltip.style.top=Math.floor(top)+"px";}
_filterDataPoints(props){let dataPoints=[];if(props.mode==="line"){let counts=0;for(const dataPoint of props.dataPoints){if(dataPoint.labels[0]!==this.env._t("Undefined")){dataPoints.push(dataPoint);}
counts+=dataPoint.count;}
if(counts===0){dataPoints=[];}}else{dataPoints=props.dataPoints.filter(dataPoint=>dataPoint.count>0);}
return dataPoints;}
_fixTooltipLeftPosition(tooltip,x){let left;const tooltipWidth=tooltip.clientWidth;const minLeftAllowed=Math.floor(this.chart.chartArea.left+2);const maxLeftAllowed=Math.floor(this.chart.chartArea.right-tooltipWidth-2);x=Math.floor(x);if(x<=maxLeftAllowed){if(x>=minLeftAllowed){left=x;}else{left=minLeftAllowed;}}else{left=maxLeftAllowed;}
tooltip.style.left=left+"px";}
_formatValue(value){const formatter=fieldUtils.format.float;const measure=this.props.fields[this.props.measure];const formatedValue=formatter(value,measure,FORMAT_OPTIONS);return formatedValue;}
_getDatasetDataLength(originIndex,defaultLength){if(this.props.mode!=="pie"&&this.props.comparisonFieldIndex===0){return this.dateClasses.dateSets[originIndex].length;}
return defaultLength;}
_getDatasetLabel({labels,originIndex}){if(this.props.mode==="pie"){return this.props.origins[originIndex];}
let datasetLabel=labels.slice(1).join("/");if(this.props.origins.length>1){datasetLabel=this.props.origins[originIndex]+(datasetLabel?("/"+datasetLabel):"");}
return datasetLabel||this.measureDescription;}
_getDateClasses(dataPoints){const dateSets=this.props.origins.map(()=>[]);for(const{labels,originIndex}of dataPoints){dateSets[originIndex].push(labels[this.props.comparisonFieldIndex]);}
return new DateClasses(dateSets.map(dateSet=>[...new Set(dateSet)]));}
_getElementOptions(){const elementOptions={};if(this.props.mode==="bar"){elementOptions.rectangle={borderWidth:1};}else if(this.props.mode==="line"){elementOptions.line={tension:0,fill:false,};}
return elementOptions;}
_getLabel({labels,originIndex}){const index=this.props.comparisonFieldIndex;if(this.props.mode!=="pie"){if(index===0){return[this.dateClasses.dateClass(originIndex,labels[index])];}else{return labels.slice(0,1);}}else if(index===0){return[this.dateClasses.dateClass(originIndex,labels[index]),...labels.slice(index+1)];}else{return labels;}}
_getLegendOptions(datasetsCount){const legendOptions={display:datasetsCount<=MAX_LEGEND_LENGTH,position:"top",onHover:this._onlegendHover.bind(this),onLeave:this._onLegendLeave.bind(this),};if(this.props.mode==="line"){legendOptions.onClick=this._onLegendClick.bind(this);}
if(this.props.mode!=="pie"){let referenceColor;if(this.props.mode==="bar"){referenceColor="backgroundColor";}else{referenceColor="borderColor";}
legendOptions.labels={generateLabels:chart=>{const{data}=chart;const labels=data.datasets.map((dataset,index)=>{return{text:shortenLabel(dataset.label),fullText:dataset.label,fillStyle:dataset[referenceColor],hidden:!chart.isDatasetVisible(index),lineCap:dataset.borderCapStyle,lineDash:dataset.borderDash,lineDashOffset:dataset.borderDashOffset,lineJoin:dataset.borderJoinStyle,lineWidth:dataset.borderWidth,strokeStyle:dataset[referenceColor],pointStyle:dataset.pointStyle,datasetIndex:index,};});return labels;},};}else{const{comparisonFieldIndex}=this.props;legendOptions.labels={generateLabels:chart=>{const{data}=chart;const metaData=data.datasets.map((_,index)=>chart.getDatasetMeta(index).data);const labels=data.labels.map((label,index)=>{const hidden=metaData.some(data=>data[index]&&data[index].hidden);const fullText=this._relabelling(label,comparisonFieldIndex);const text=shortenLabel(fullText);const fillStyle=label===this.noDataLabel?DEFAULT_BG:getColor(index);return{text,fullText,fillStyle,hidden,index};});return labels;},};}
return legendOptions;}
_getNoContentHelper(){if(this.props.mode==="pie"){const dataPoints=this.processedDataPoints;const someNegative=dataPoints.some(dataPt=>dataPt.value<0);const somePositive=dataPoints.some(dataPt=>dataPt.value>0);if(someNegative&&somePositive){return{title:this.env._t("Invalid data"),description:[this.env._t("Pie chart cannot mix positive and negative numbers. "),this.env._t("Try to change your domain to only display positive results")].join("")};}}
return null;}
_getScaleOptions(){if(this.props.mode==="pie"){return{};}
const{comparisonFieldIndex}=this.props;const xAxes=[{type:"category",scaleLabel:{display:this.props.processedGroupBy.length&&!this.props.isEmbedded,labelString:this.props.processedGroupBy.length?this.props.fields[this.props.processedGroupBy[0].split(":")[0]].string:"",},ticks:{callback:label=>shortenLabel(this._relabelling(label,comparisonFieldIndex))},}];const yAxes=[{type:"linear",scaleLabel:{display:!this.props.isEmbedded,labelString:this.measureDescription,},ticks:{callback:value=>this._formatValue(value),suggestedMax:0,suggestedMin:0,},}];return{xAxes,yAxes};}
_getTooltipItemContent(item,data){const{comparisonFieldIndex}=this.props;const dataset=data.datasets[item.datasetIndex];const id=item.index;let label=data.labels[item.index];let value;let boxColor;let percentage;if(this.props.mode==="pie"){if(label===this.noDataLabel){value=this._formatValue(0);}else{value=this._formatValue(dataset.data[item.index]);const totalData=dataset.data.reduce((a,b)=>a+b,0);percentage=totalData&&((dataset.data[item.index]*100)/totalData).toFixed(2);}
label=this._relabelling(label,comparisonFieldIndex,dataset.originIndex);if(this.props.origins.length>1){label=`${dataset.label}/${label}`;}
boxColor=dataset.backgroundColor[item.index];}else{label=this._relabelling(label,comparisonFieldIndex,dataset.originIndex);if(this.props.processedGroupBy.length>1||this.props.origins.length>1){label=`${label}/${dataset.label}`;}
value=this._formatValue(item.yLabel);boxColor=this.props.mode==="bar"?dataset.backgroundColor:dataset.borderColor;}
return{id,label,value,boxColor,percentage};}
_getTooltipItems(tooltipModel){const{data}=this.chart.config;const sortedDataPoints=sortBy(tooltipModel.dataPoints,"yLabel","desc");return sortedDataPoints.map(item=>this._getTooltipItemContent(item,data));}
_getTooltipOptions(){const tooltipOptions={enabled:false,custom:this._customTooltip.bind(this),};if(this.props.mode==="line"){tooltipOptions.mode="index";tooltipOptions.intersect=false;}
return tooltipOptions;}
_isRedirectionEnabled(){return!this.props.disableLinking&&this.props.mode!=="line";}
_prepareData(dataPoints){const labelMap={};const labels=[];for(const dataPt of dataPoints){const label=this._getLabel(dataPt);const labelKey=`${dataPt.resId}:${JSON.stringify(label)}`;const index=labelMap[labelKey];if(index===undefined){labelMap[labelKey]=dataPt.labelIndex=labels.length;labels.push(label);}else{dataPt.labelIndex=index;}}
const datasetsTmp={};for(const dp of dataPoints){const datasetLabel=this._getDatasetLabel(dp);if(!(datasetLabel in datasetsTmp)){const dataLength=this._getDatasetDataLength(dp.originIndex,labels.length);datasetsTmp[datasetLabel]={data:new Array(dataLength).fill(0),domain:new Array(dataLength).fill([]),label:datasetLabel,originIndex:dp.originIndex,};}
const labelIndex=dp.labelIndex;datasetsTmp[datasetLabel].data[labelIndex]=dp.value;datasetsTmp[datasetLabel].domain[labelIndex]=dp.domain;}
const datasets=sortBy(Object.values(datasetsTmp),"originIndex");return{datasets,labels};}
_prepareOptions(datasetsCount){const options={maintainAspectRatio:false,scales:this._getScaleOptions(),legend:this._getLegendOptions(datasetsCount),tooltips:this._getTooltipOptions(),elements:this._getElementOptions(),};if(this._isRedirectionEnabled()){options.onClick=ev=>this._onGraphClicked(ev);}
return options;}
_processProps(props){const filteredDataPoints=this._filterDataPoints(props);this.processedDataPoints=this._sortDataPoints(filteredDataPoints,props);this.noContentHelperData=this._getNoContentHelper(props.mode);}
_relabelling(label,index,originIndex){if(label===this.noDataLabel||label===this.fakeDataLabel){return label[0];}
if(this.props.mode!=="pie"&&index===0){return this.dateClasses.representative(label,originIndex)||"";}else if(this.props.mode==="pie"&&index===0){const labelCopy=label.slice();let newLabel;if(originIndex===undefined){newLabel=this.dateClasses.dateClassMembers(label[index]);}else{newLabel=this.dateClasses.representative(label[index],originIndex);}
labelCopy.splice(index,1,newLabel);return labelCopy.join("/");}
return label.join("/")||this.env._t("Total");}
_removeTooltips(){if(this.tooltip){this.tooltip.remove();this.tooltip=null;}
if(this.legendTooltip){this.legendTooltip.remove();this.legendTooltip=null;}}
_renderChart(){if(this.noContentHelperData){return;}
if(this.chart){this.chart.destroy();}
const config=this._createConfig();const canvasContext=this.canvasRef.el.getContext("2d");this.chart=new Chart(canvasContext,config);Chart.animationService.advance();}
_sortDataPoints(dataPoints,props){if(props.domains.length===1&&props.orderBy&&props.mode!=="pie"&&props.processedGroupBy.length){const[groupByFieldName]=props.processedGroupBy[0].split(":");const{type}=props.fields[groupByFieldName];const groupedDataPoints={};for(const dataPt of dataPoints){const key=type==="many2one"?dataPt.resId:dataPt.labels[0];if(!groupedDataPoints[key]){groupedDataPoints[key]=[];}
groupedDataPoints[key].push(dataPt);}
const groupTotal=group=>group.reduce((sum,{value})=>sum+value,0);dataPoints=sortBy(Object.values(groupedDataPoints),groupTotal,props.orderBy).flat();}
return dataPoints;}
_onGraphClicked(ev){const[activeElement]=this.chart.getElementAtEvent(ev);if(!activeElement){return;}
const{_datasetIndex,_index}=activeElement;const{domain}=this.chart.data.datasets[_datasetIndex];if(domain){this.trigger("open_view",{domain:domain[_index]});}}
_onLegendClick(ev,legendItem){this._removeTooltips();const index=legendItem.datasetIndex;const meta=this.chart.getDatasetMeta(index);meta.hidden=meta.hidden===null?!this.chart.data.datasets[index].hidden:null;this.chart.update();}
_onlegendHover(ev,legendItem){this.canvasRef.el.style.cursor="pointer";if(legendItem.text===legendItem.fullText||this.legendTooltip){return;}
const rendererTop=this.el.getBoundingClientRect().top;this.legendTooltip=Object.assign(document.createElement("div"),{className:"o_tooltip_legend",innerText:legendItem.fullText,});this.legendTooltip.style.top=(ev.clientY-rendererTop)+"px";this.legendTooltip.style.maxWidth=getMaxWidth(this.chart.chartArea);this.containerRef.el.appendChild(this.legendTooltip);this._fixTooltipLeftPosition(this.legendTooltip,ev.clientX);}
_onLegendLeave(){this.canvasRef.el.style.cursor="";if(this.legendTooltip){this.legendTooltip.remove();this.legendTooltip=null;}}}
GraphRenderer.template="web.Legacy.GraphRenderer";GraphRenderer.props={arch:{type:Object,shape:{children:{type:Array,element:Object},attrs:Object,tag:{validate:t=>t==="graph"},},},comparisonFieldIndex:Number,context:Object,dataPoints:{type:Array,element:Object},disableLinking:Boolean,domain:[Array,String],domains:{type:Array,element:[Array,String]},fields:Object,groupBy:{type:Array,element:String},isEmbedded:Boolean,isSample:{type:Boolean,optional:1},measure:String,measures:{type:Array,element:Object},mode:{validate:m=>["bar","line","pie"].includes(m)},origins:{type:Array,element:String},processedGroupBy:{type:Array,element:String},stacked:Boolean,timeRanges:Object,noContentHelp:{type:String,optional:1},orderBy:{type:[String,Boolean],optional:1},title:{type:String,optional:1},withSearchPanel:{type:Boolean,optional:1},};return GraphRenderer;});;

/* /web/static/src/legacy/js/views/graph/graph_utils.js defined in bundle 'web.tests_assets' */
odoo.define('web/static/src/js/views/graph/graph_utils',function(require){"use strict";const{device}=require("web.config");const COLORS=["#1f77b4","#ff7f0e","#aec7e8","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5",];const DEFAULT_BG="#d3d3d3";const FORMAT_OPTIONS={humanReadable:value=>Math.abs(value)>=1000,minDigits:1,decimals:2,formatterCallback:str=>str,};const MAX_LEGEND_LENGTH=4*Math.max(1,device.size_class);const RGB_REGEX=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;function getColor(index){return COLORS[index%COLORS.length];}
function getMaxWidth({left,right}){return Math.floor((right-left)/1.618)+"px";}
function hexToRGBA(hex,opacity){const rgb=RGB_REGEX.exec(hex).slice(1,4).map(n=>parseInt(n,16)).join(",");return`rgba(${rgb},${opacity})`;}
function shortenLabel(label){const groups=label.split("/");let shortLabel=groups.slice(0,3).join("/");if(shortLabel.length>30){shortLabel=`${shortLabel.slice(0, 30)}...`;}else if(groups.length>3){shortLabel=`${shortLabel}/...`;}
return shortLabel;}
return{COLORS,DEFAULT_BG,FORMAT_OPTIONS,MAX_LEGEND_LENGTH,RGB_REGEX,getColor,getMaxWidth,hexToRGBA,shortenLabel,};});;

/* /web/static/src/legacy/js/views/graph/graph_view.js defined in bundle 'web.tests_assets' */
odoo.define('web.GraphView',function(require){"use strict";var AbstractView=require('web.AbstractView');var core=require('web.core');var GraphModel=require('web.GraphModel');var Controller=require('web.GraphController');const GraphRenderer=require("web/static/src/js/views/graph/graph_renderer");const RendererWrapper=require("web.RendererWrapper");const viewRegistry=require("web.view_registry");var _t=core._t;var _lt=core._lt;var searchUtils=require('web.searchUtils');var GROUPABLE_TYPES=searchUtils.GROUPABLE_TYPES;var GraphView=AbstractView.extend({display_name:_lt('Graph'),icon:'fa-bar-chart',jsLibs:['/web/static/lib/Chart/Chart.js',],config:_.extend({},AbstractView.prototype.config,{Model:GraphModel,Controller:Controller,Renderer:GraphRenderer,}),viewType:'graph',searchMenuTypes:['filter','groupBy','comparison','favorite'],init:function(viewInfo,params){this._super.apply(this,arguments);const additionalMeasures=params.additionalMeasures||[];let measure;const measures={};const measureStrings={};let groupBys=[];const groupableFields={};this.fields.__count__={string:_t("Count"),type:'integer'};this.arch.children.forEach(field=>{let fieldName=field.attrs.name;if(fieldName==="id"){return;}
const interval=field.attrs.interval;if(interval){fieldName=fieldName+':'+interval;}
if(field.attrs.type==='measure'){const{string}=this.fields[fieldName];measure=fieldName;measures[fieldName]={description:string,fieldName,groupNumber:0,isActive:false,itemType:'measure',};}else{groupBys.push(fieldName);}
if(field.attrs.string){measureStrings[fieldName]=field.attrs.string;}});for(const name in this.fields){const field=this.fields[name];if(name!=='id'&&(field.type!=="many2many"&&field.sortable||field.store)===true){if(['integer','float','monetary'].includes(field.type)||additionalMeasures.includes(name)){measures[name]={description:field.string,fieldName:name,groupNumber:0,isActive:false,itemType:'measure',};}
if(GROUPABLE_TYPES.includes(field.type)){groupableFields[name]=field;}}}
for(const name in measureStrings){if(measures[name]){measures[name].description=measureStrings[name];}}
this.arch.children.forEach(field=>{let fieldName=field.attrs.name;if(field.attrs.invisible&&py.eval(field.attrs.invisible)){groupBys=groupBys.filter(groupBy=>groupBy!==fieldName);if(fieldName in groupableFields){delete groupableFields[fieldName];}
if(!additionalMeasures.includes(fieldName)){delete measures[fieldName];}}});const sortedMeasures=Object.values(measures).sort((a,b)=>{const descA=a.description.toLowerCase();const descB=b.description.toLowerCase();return descA>descB?1:descA<descB?-1:0;});const countMeasure={description:_t("Count"),fieldName:'__count__',groupNumber:1,isActive:false,itemType:'measure',};this.controllerParams.withButtons=params.withButtons!==false;this.controllerParams.measures=[...sortedMeasures,countMeasure];this.controllerParams.groupableFields=groupableFields;this.controllerParams.title=params.title||this.arch.attrs.string||_t("Untitled");function _findView(views,viewType){const view=views.find(view=>{return view.type===viewType;});return[view?view.viewID:false,viewType];}
this.controllerParams.views=[_findView(params.actionViews,'list'),_findView(params.actionViews,'form'),];this.rendererParams.fields=this.fields;this.rendererParams.measures=this.controllerParams.measures;this.rendererParams.title=this.arch.attrs.title;this.rendererParams.disableLinking=!!JSON.parse(this.arch.attrs.disable_linking||'0');this.loadParams.mode=this.arch.attrs.type||'bar';this.loadParams.orderBy=this.arch.attrs.order;this.loadParams.measure=measure||'__count__';this.loadParams.groupBys=groupBys;this.loadParams.fields=this.fields;this.loadParams.comparisonDomain=params.comparisonDomain;this.loadParams.stacked=this.arch.attrs.stacked!=="False";},getRenderer(parent,props){props=Object.assign(props||{},this.rendererParams);return new RendererWrapper(null,this.config.Renderer,props);},});viewRegistry.add("graph",GraphView);return GraphView;});;

/* /web/static/src/legacy/js/views/pivot/pivot_controller.js defined in bundle 'web.tests_assets' */
odoo.define('@web/legacy/js/views/pivot/pivot_controller',async function(require){'use strict';let __exports={};const AbstractController=require("@web/legacy/js/views/abstract_controller")[Symbol.for("default")];const core=require('web.core');const framework=require('web.framework');const session=require('web.session');const _t=core._t;const QWeb=core.qweb;const PivotController=AbstractController.extend({custom_events:Object.assign({},AbstractController.prototype.custom_events,{closed_header_click:'_onClosedHeaderClicked',open_view:'_onOpenView',opened_header_click:'_onOpenedHeaderClicked',sort_rows:'_onSortRows',groupby_menu_selection:'_onGroupByMenuSelection',}),init:function(parent,model,renderer,params){this._super(...arguments);this.disableLinking=params.disableLinking;this.measures=params.measures;this.title=params.title;this.views=params.views;this.groupSelected=null;},destroy:function(){if(this.$buttons){this.$buttons.find('button').off();}
return this._super(...arguments);},getOwnedQueryParams:function(){const state=this.model.get({raw:true});return{context:{pivot_measures:state.measures,pivot_column_groupby:state.colGroupBys,pivot_row_groupby:state.rowGroupBys,}};},renderButtons:function($node){const context=this._getRenderButtonContext();this.$buttons=$(QWeb.render('PivotView.buttons',context));this.$buttons.click(this._onButtonClick.bind(this));this.$buttons.find('button').tooltip();if($node){this.$buttons.appendTo($node);}},updateButtons:function(){if(!this.$buttons){return;}
const state=this.model.get({raw:true});Object.entries(this.measures).forEach(elt=>{const name=elt[0];const isSelected=state.measures.includes(name);this.$buttons.find('.dropdown-item[data-field="'+name+'"]').toggleClass('selected',isSelected);});const noDataDisplayed=!state.hasData||!state.measures.length;this.$buttons.find('.o_pivot_flip_button').prop('disabled',noDataDisplayed);this.$buttons.find('.o_pivot_expand_button').prop('disabled',noDataDisplayed);this.$buttons.find('.o_pivot_download').prop('disabled',noDataDisplayed);},_downloadTable:function(){if(this.model.getTableWidth()>16384){this.call('crash_manager','show_message',_t("For Excel compatibility, data cannot be exported if there are more than 16384 columns.\n\nTip: try to flip axis, filter further or reduce the number of measures."));framework.unblockUI();return;}
const table=this.model.exportData();table.title=this.title;table.model=this.modelName;session.get_file({url:'/web/pivot/export_xlsx',data:{data:JSON.stringify(table)},complete:framework.unblockUI,error:(error)=>this.call('crash_manager','rpc_error',error),});},_onButtonClick:async function(ev){const $target=$(ev.target);if($target.hasClass('o_pivot_flip_button')){this.model.flip();this.update({},{reload:false});}
if($target.hasClass('o_pivot_expand_button')){await this.model.expandAll();this.update({},{reload:false});}
if(ev.target.closest('.o_pivot_measures_list')){ev.preventDefault();ev.stopPropagation();const field=ev.target.dataset.field;if(field){this.update({measure:field});}}
if($target.hasClass('o_pivot_download')){this._downloadTable();}
await this._addIncludedButtons(ev);},_addIncludedButtons:async function(ev){},_getRenderButtonContext:function(){return{measures:Object.entries(this.measures).filter(x=>x[0]!=='__count').sort((a,b)=>a[1].string.toLowerCase()>b[1].string.toLowerCase()?1:-1),};},_onCloseGroup:function(ev){this.model.closeGroup(ev.data.groupId,ev.data.type);this.update({},{reload:false});},_onOpenedHeaderClicked:function(ev){this.model.closeGroup(ev.data.cell.groupId,ev.data.type);this.update({},{reload:false});},_onClosedHeaderClicked:async function(ev){const cell=ev.data.cell;const groupId=cell.groupId;const type=ev.data.type;const group={rowValues:groupId[0],colValues:groupId[1],type:type};const state=this.model.get({raw:true});const groupValues=type==='row'?groupId[0]:groupId[1];const groupBys=type==='row'?state.rowGroupBys:state.colGroupBys;this.selectedGroup=group;if(groupValues.length<groupBys.length){const groupBy=groupBys[groupValues.length];await this.model.expandGroup(this.selectedGroup,groupBy);this.update({},{reload:false});}},_onGroupByMenuSelection:async function(ev){ev.stopPropagation();const{fieldName,interval}=ev.data;let groupBy=fieldName;if(interval){groupBy=`${groupBy}:${interval}`;}
this.model.addGroupBy(groupBy,this.selectedGroup.type);await this.model.expandGroup(this.selectedGroup,groupBy);this.update({},{reload:false});},_onOpenView:function(ev){ev.stopPropagation();const cell=ev.data;if(cell.value===undefined||this.disableLinking){return;}
const context=Object.assign({},this.model.data.context);Object.keys(context).forEach(x=>{if(x==='group_by'||x.startsWith('search_default_')){delete context[x];}});const group={rowValues:cell.groupId[0],colValues:cell.groupId[1],originIndex:cell.originIndexes[0]};const domain=this.model._getGroupDomain(group);this.do_action({type:'ir.actions.act_window',name:this.title,res_model:this.modelName,views:this.views,view_mode:'list',target:'current',context:context,domain:domain,});},_onSortRows:function(ev){this.model.sortRows({groupId:ev.data.groupId,measure:ev.data.measure,order:(ev.data.order||'desc')==='asc'?'desc':'asc',originIndexes:ev.data.originIndexes,});this.update({},{reload:false});},});__exports[Symbol.for("default")]=PivotController;return __exports;});odoo.define(`web.PivotController`,async function(require){return require('@web/legacy/js/views/pivot/pivot_controller')[Symbol.for("default")];});;

/* /web/static/src/legacy/js/views/pivot/pivot_model.js defined in bundle 'web.tests_assets' */
odoo.define('@web/legacy/js/views/pivot/pivot_model',async function(require){'use strict';let __exports={};const AbstractModel=require("@web/legacy/js/views/abstract_model")[Symbol.for("default")];const concurrency=require('web.concurrency');const core=require('web.core');const dataComparisonUtils=require('web.dataComparisonUtils');const Domain=require('web.Domain');const mathUtils=require('@web/core/utils/arrays');const session=require('web.session');var _t=core._t;var cartesian=mathUtils.cartesian;var computeVariation=dataComparisonUtils.computeVariation;var sections=mathUtils.sections;var PivotModel=AbstractModel.extend({init:function(){this._super.apply(this,arguments);this.numbering={};this.data=null;this._loadDataDropPrevious=new concurrency.DropPrevious();},addGroupBy:function(groupBy,type){if(type==='row'){this.data.expandedRowGroupBys.push(groupBy);}else{this.data.expandedColGroupBys.push(groupBy);}},closeGroup:function(groupId,type){var groupBys;var expandedGroupBys;let keyPart;var group;var tree;if(type==='row'){groupBys=this.data.rowGroupBys;expandedGroupBys=this.data.expandedRowGroupBys;tree=this.rowGroupTree;group=this._findGroup(this.rowGroupTree,groupId[0]);keyPart=0;}else{groupBys=this.data.colGroupBys;expandedGroupBys=this.data.expandedColGroupBys;tree=this.colGroupTree;group=this._findGroup(this.colGroupTree,groupId[1]);keyPart=1;}
const groupIdPart=groupId[keyPart];const range=groupIdPart.map((_,index)=>index);function keep(key){const idPart=JSON.parse(key)[keyPart];return range.some(index=>groupIdPart[index]!==idPart[index])||idPart.length===groupIdPart.length;}
function omitKeys(object){const newObject={};for(const key in object){if(keep(key)){newObject[key]=object[key];}}
return newObject;}
this.measurements=omitKeys(this.measurements);this.counts=omitKeys(this.counts);this.groupDomains=omitKeys(this.groupDomains);group.directSubTrees.clear();delete group.sortedKeys;var newGroupBysLength=this._getTreeHeight(tree)-1;if(newGroupBysLength<=groupBys.length){expandedGroupBys.splice(0);groupBys.splice(newGroupBysLength);}else{expandedGroupBys.splice(newGroupBysLength-groupBys.length);}},expandAll:function(){return this._loadData();},expandGroup:async function(group,groupBy){var leftDivisors;var rightDivisors;if(group.type==='row'){leftDivisors=[[groupBy]];rightDivisors=sections(this._getGroupBys().colGroupBys);}else{leftDivisors=sections(this._getGroupBys().rowGroupBys);rightDivisors=[[groupBy]];}
var divisors=cartesian(leftDivisors,rightDivisors);delete group.type;return this._subdivideGroup(group,divisors);},exportData:function(){var measureCount=this.data.measures.length;var originCount=this.data.origins.length;var table=this._getTable();var headers=table.headers;var colGroupHeaderRows;var measureRow=[];var originRow=[];function processHeader(header){var inTotalColumn=header.groupId[1].length===0;return{title:header.title,width:header.width,height:header.height,is_bold:!!header.measure&&inTotalColumn};}
if(originCount>1){colGroupHeaderRows=headers.slice(0,headers.length-2);measureRow=headers[headers.length-2].map(processHeader);originRow=headers[headers.length-1].map(processHeader);}else{colGroupHeaderRows=headers.slice(0,headers.length-1);measureRow=headers[headers.length-1].map(processHeader);}
colGroupHeaderRows[0].splice(0,1);colGroupHeaderRows=colGroupHeaderRows.map(function(headerRow){return headerRow.map(processHeader);});var tableRows=table.rows.map(function(row){return{title:row.title,indent:row.indent,values:row.subGroupMeasurements.map(function(measurement){var value=measurement.value;if(value===undefined){value="";}else if(measurement.originIndexes.length>1){value=value*100;}
return{is_bold:measurement.isBold,value:value,};}),};});return{col_group_headers:colGroupHeaderRows,measure_headers:measureRow,origin_headers:originRow,rows:tableRows,measure_count:measureCount,origin_count:originCount,};},flip:function(){var temp=this.rowGroupTree;this.rowGroupTree=this.colGroupTree;this.colGroupTree=temp;temp=this.data.rowGroupBys;this.data.groupedBy=this.data.colGroupBys;this.data.rowGroupBys=this.data.colGroupBys;this.data.colGroupBys=temp;temp=this.data.expandedColGroupBys;this.data.expandedColGroupBys=this.data.expandedRowGroupBys;this.data.expandedRowGroupBys=temp;function twistKey(key){return JSON.stringify(JSON.parse(key).reverse());}
function twist(object){var newObject={};Object.keys(object).forEach(function(key){var value=object[key];newObject[twistKey(key)]=value;});return newObject;}
this.measurements=twist(this.measurements);this.counts=twist(this.counts);this.groupDomains=twist(this.groupDomains);},__get:function(options){options=options||{};var raw=options.raw||false;var groupBys=this._getGroupBys();var state={colGroupBys:groupBys.colGroupBys,context:this.data.context,domain:this.data.domain,fields:this.fields,hasData:this._hasData(),isSample:this.isSampleModel,measures:this.data.measures,origins:this.data.origins,rowGroupBys:groupBys.rowGroupBys,modelName:this.modelName};if(!raw&&state.hasData){state.table=this._getTable();state.tree=this.rowGroupTree;}
return state;},getTableWidth:function(){var leafCounts=this._getLeafCounts(this.colGroupTree);return leafCounts[JSON.stringify(this.colGroupTree.root.values)]+2;},__load:function(params){this.initialDomain=params.domain;this.initialRowGroupBys=params.context.pivot_row_groupby||params.rowGroupBys;this.defaultGroupedBy=params.groupedBy;this.fields=params.fields;this.modelName=params.modelName;const measures=this._processMeasures(params.context.pivot_measures)||params.measures.map(m=>m);this.data={expandedRowGroupBys:[],expandedColGroupBys:[],domain:this.initialDomain,context:_.extend({},session.user_context,params.context),groupedBy:params.context.pivot_row_groupby||params.groupedBy,colGroupBys:params.context.pivot_column_groupby||params.colGroupBys,measures,timeRanges:params.timeRanges,};this._computeDerivedParams();this.data.groupedBy=this.data.groupedBy.slice();this.data.rowGroupBys=!_.isEmpty(this.data.groupedBy)?this.data.groupedBy:this.initialRowGroupBys.slice();var defaultOrder=params.default_order&&params.default_order.split(' ');if(defaultOrder){this.data.sortedColumn={groupId:[[],[]],measure:defaultOrder[0],order:defaultOrder[1]?defaultOrder[1]:'asc',};}
return this._loadData();},__reload:function(handle,params){var self=this;var oldColGroupBys=this.data.colGroupBys;var oldRowGroupBys=this.data.rowGroupBys;if('context'in params){this.data.context=params.context;this.data.colGroupBys=params.context.pivot_column_groupby||this.data.colGroupBys;this.data.groupedBy=params.context.pivot_row_groupby||this.data.groupedBy;this.data.measures=this._processMeasures(params.context.pivot_measures)||this.data.measures;this.defaultGroupedBy=this.data.groupedBy.length?this.data.groupedBy:this.defaultGroupedBy;}
if('domain'in params){this.data.domain=params.domain;this.initialDomain=params.domain;}else{this.data.domain=this.initialDomain;}
if('groupBy'in params){this.data.groupedBy=params.groupBy.length?params.groupBy:this.defaultGroupedBy;}
if('timeRanges'in params){this.data.timeRanges=params.timeRanges;}
this._computeDerivedParams();this.data.groupedBy=this.data.groupedBy.slice();this.data.rowGroupBys=!_.isEmpty(this.data.groupedBy)?this.data.groupedBy:this.initialRowGroupBys.slice();if(!_.isEqual(oldRowGroupBys,self.data.rowGroupBys)){this.data.expandedRowGroupBys=[];}
if(!_.isEqual(oldColGroupBys,self.data.colGroupBys)){this.data.expandedColGroupBys=[];}
if('measure'in params){return this._toggleMeasure(params.measure);}
if(!this._hasData()){return this._loadData();}
var oldRowGroupTree=this.rowGroupTree;var oldColGroupTree=this.colGroupTree;return this._loadData().then(function(){if(_.isEqual(oldRowGroupBys,self.data.rowGroupBys)){self._pruneTree(self.rowGroupTree,oldRowGroupTree);}
if(_.isEqual(oldColGroupBys,self.data.colGroupBys)){self._pruneTree(self.colGroupTree,oldColGroupTree);}});},sortRows:function(sortedColumn){var self=this;var colGroupValues=sortedColumn.groupId[1];sortedColumn.originIndexes=sortedColumn.originIndexes||[0];this.data.sortedColumn=sortedColumn;var sortFunction=function(tree){return function(subTreeKey){var subTree=tree.directSubTrees.get(subTreeKey);var groupIntersectionId=[subTree.root.values,colGroupValues];var value=self._getCellValue(groupIntersectionId,sortedColumn.measure,sortedColumn.originIndexes)||0;return sortedColumn.order==='asc'?value:-value;};};this._sortTree(sortFunction,this.rowGroupTree);},_addGroup:function(groupTree,labels,values){var tree=groupTree;values.slice(0,values.length-1).forEach(function(value){tree=tree.directSubTrees.get(value);});const value=values[values.length-1];if(tree.directSubTrees.has(value)){return;}
tree.directSubTrees.set(value,{root:{labels:labels,values:values,},directSubTrees:new Map(),});},_computeRowGroupBys:function(){return!_.isEmpty(this.data.groupedBy)?this.data.groupedBy:this.initialRowGroupBys;},_findGroup:function(groupTree,values){var tree=groupTree;values.slice(0,values.length).forEach(function(value){tree=tree.directSubTrees.get(value);});return tree;},_getCellValue:function(groupId,measure,originIndexes){var self=this;var key=JSON.stringify(groupId);if(!self.measurements[key]){return;}
var values=originIndexes.map(function(originIndex){return self.measurements[key][originIndex][measure];});if(originIndexes.length>1){return computeVariation(values[1],values[0]);}else{return values[0];}},_getGroupBys:function(){return{colGroupBys:this.data.colGroupBys.concat(this.data.expandedColGroupBys),rowGroupBys:this.data.rowGroupBys.concat(this.data.expandedRowGroupBys),};},_getGroupDomain:function(group){var key=JSON.stringify([group.rowValues,group.colValues]);return this.groupDomains[key][group.originIndex];},_getGroupLabels:function(group,groupBys){var self=this;return groupBys.map(function(groupBy){return self._sanitizeLabel(group[groupBy],groupBy);});},_getGroupSubdivision:function(group,rowGroupBy,colGroupBy){var groupDomain=this._getGroupDomain(group);var measureSpecs=this._getMeasureSpecs();var groupBy=rowGroupBy.concat(colGroupBy);return this._rpc({model:this.modelName,method:'read_group',context:this.data.context,domain:groupDomain,fields:measureSpecs,groupBy:groupBy,lazy:false,}).then(function(subGroups){return{group:group,subGroups:subGroups,rowGroupBy:rowGroupBy,colGroupBy:colGroupBy};});},_getGroupValues:function(group,groupBys){var self=this;return groupBys.map(function(groupBy){return self._sanitizeValue(group[groupBy]);});},_getLeafCounts:function(tree){var self=this;var leafCounts={};var leafCount;if(!tree.directSubTrees.size){leafCount=1;}else{leafCount=[...tree.directSubTrees.values()].reduce(function(acc,subTree){var subLeafCounts=self._getLeafCounts(subTree);_.extend(leafCounts,subLeafCounts);return acc+leafCounts[JSON.stringify(subTree.root.values)];},0);}
leafCounts[JSON.stringify(tree.root.values)]=leafCount;return leafCounts;},_getMeasurements:function(group){var self=this;return this.data.measures.reduce(function(measurements,fieldName){var measurement=group[fieldName];if(measurement instanceof Array){measurement=1;}
if(self.fields[fieldName].type==='boolean'&&measurement instanceof Boolean){measurement=measurement?1:0;}
if(self.data.origins.length>1&&!measurement){measurement=0;}
measurements[fieldName]=measurement;return measurements;},{});},_getMeasuresRow:function(columns){var self=this;var sortedColumn=this.data.sortedColumn||{};var measureRow=[];columns.forEach(function(column){self.data.measures.forEach(function(measure){var measureCell={groupId:column.groupId,height:1,measure:measure,title:self.fields[measure].string,width:2*self.data.origins.length-1,};if(sortedColumn.measure===measure&&_.isEqual(sortedColumn.groupId,column.groupId)){measureCell.order=sortedColumn.order;}
measureRow.push(measureCell);});});return measureRow;},_getMeasureSpecs:function(){var self=this;return this.data.measures.reduce(function(acc,measure){if(measure==='__count'){acc.push(measure);return acc;}
var type=self.fields[measure].type;var groupOperator=self.fields[measure].group_operator;if(type==='many2one'){groupOperator='count_distinct';}
if(groupOperator===undefined){throw new Error("No aggregate function has been provided for the measure '"+measure+"'");}
acc.push(measure+':'+groupOperator);return acc;},[]);},_getNumberedLabel:function(label,fieldName){var id=label[0];var name=label[1];this.numbering[fieldName]=this.numbering[fieldName]||{};this.numbering[fieldName][name]=this.numbering[fieldName][name]||{};var numbers=this.numbering[fieldName][name];numbers[id]=numbers[id]||_.size(numbers)+1;return name+(numbers[id]>1?"  ("+numbers[id]+")":"");},_getOriginsRow:function(columns){var self=this;var sortedColumn=this.data.sortedColumn||{};var originRow=[];columns.forEach(function(column){var groupId=column.groupId;var measure=column.measure;var isSorted=sortedColumn.measure===measure&&_.isEqual(sortedColumn.groupId,groupId);var isSortedByOrigin=isSorted&&!sortedColumn.originIndexes[1];var isSortedByVariation=isSorted&&sortedColumn.originIndexes[1];self.data.origins.forEach(function(origin,originIndex){var originCell={groupId:groupId,height:1,measure:measure,originIndexes:[originIndex],title:origin,width:1,};if(isSortedByOrigin&&sortedColumn.originIndexes[0]===originIndex){originCell.order=sortedColumn.order;}
originRow.push(originCell);if(originIndex>0){var variationCell={groupId:groupId,height:1,measure:measure,originIndexes:[originIndex-1,originIndex],title:_t('Variation'),width:1,};if(isSortedByVariation&&sortedColumn.originIndexes[1]===originIndex){variationCell.order=sortedColumn.order;}
originRow.push(variationCell);}});});return originRow;},_getTable:function(){var headers=this._getTableHeaders();return{headers:headers,rows:this._getTableRows(this.rowGroupTree,headers[headers.length-1]),};},_getTableHeaders:function(){var colGroupBys=this._getGroupBys().colGroupBys;var height=colGroupBys.length+1;var measureCount=this.data.measures.length;var originCount=this.data.origins.length;var leafCounts=this._getLeafCounts(this.colGroupTree);var headers=[];var measureColumns=[];var colGroupRows=(new Array(height)).fill(0).map(function(){return[];});colGroupRows[0].push({height:height+1+(originCount>1?1:0),title:"",width:1,});function generateTreeHeaders(tree,fields){var group=tree.root;var rowIndex=group.values.length;var row=colGroupRows[rowIndex];var groupId=[[],group.values];var isLeaf=!tree.directSubTrees.size;var leafCount=leafCounts[JSON.stringify(tree.root.values)];var cell={groupId:groupId,height:isLeaf?(colGroupBys.length+1-rowIndex):1,isLeaf:isLeaf,isFolded:isLeaf&&colGroupBys.length>group.values.length,label:rowIndex===0?undefined:fields[colGroupBys[rowIndex-1].split(':')[0]].string,title:group.labels[group.labels.length-1]||_t('Total'),width:leafCount*measureCount*(2*originCount-1),};row.push(cell);if(isLeaf){measureColumns.push(cell);}
[...tree.directSubTrees.values()].forEach(function(subTree){generateTreeHeaders(subTree,fields);});}
generateTreeHeaders(this.colGroupTree,this.fields);if(leafCounts[JSON.stringify(this.colGroupTree.root.values)]>1){var groupId=[[],[]];var totalTopRightCell={groupId:groupId,height:height,title:"",width:measureCount*(2*originCount-1),};colGroupRows[0].push(totalTopRightCell);measureColumns.push(totalTopRightCell);}
headers=headers.concat(colGroupRows);var measuresRow=this._getMeasuresRow(measureColumns);headers.push(measuresRow);if(originCount>1){headers.push(this._getOriginsRow(measuresRow));}
return headers;},_getTableRows:function(tree,columns){var self=this;var rows=[];var group=tree.root;var rowGroupId=[group.values,[]];var title=group.labels[group.labels.length-1]||_t('Total');var indent=group.labels.length;var isLeaf=!tree.directSubTrees.size;var rowGroupBys=this._getGroupBys().rowGroupBys;var subGroupMeasurements=columns.map(function(column){var colGroupId=column.groupId;var groupIntersectionId=[rowGroupId[0],colGroupId[1]];var measure=column.measure;var originIndexes=column.originIndexes||[0];var value=self._getCellValue(groupIntersectionId,measure,originIndexes);var measurement={groupId:groupIntersectionId,originIndexes:originIndexes,measure:measure,value:value,isBold:!groupIntersectionId[0].length||!groupIntersectionId[1].length,};return measurement;});rows.push({title:title,label:indent===0?undefined:this.fields[rowGroupBys[indent-1].split(':')[0]].string,groupId:rowGroupId,indent:indent,isLeaf:isLeaf,isFolded:isLeaf&&rowGroupBys.length>group.values.length,subGroupMeasurements:subGroupMeasurements});var subTreeKeys=tree.sortedKeys||[...tree.directSubTrees.keys()];subTreeKeys.forEach(function(subTreeKey){var subTree=tree.directSubTrees.get(subTreeKey);rows=rows.concat(self._getTableRows(subTree,columns));});return rows;},_getTreeHeight:function(tree){var subTreeHeights=[...tree.directSubTrees.values()].map(this._getTreeHeight.bind(this));return Math.max(0,Math.max.apply(null,subTreeHeights))+1;},_hasData:function(){return(this.counts[JSON.stringify([[],[]])]||[]).some(function(count){return count>0;});},_isEmpty(){return!this._hasData();},_loadData:function(){var self=this;this.rowGroupTree={root:{labels:[],values:[]},directSubTrees:new Map()};this.colGroupTree={root:{labels:[],values:[]},directSubTrees:new Map()};this.measurements={};this.counts={};var key=JSON.stringify([[],[]]);this.groupDomains={};this.groupDomains[key]=this.data.domains.slice(0);var group={rowValues:[],colValues:[]};var groupBys=this._getGroupBys();var leftDivisors=sections(groupBys.rowGroupBys);var rightDivisors=sections(groupBys.colGroupBys);var divisors=cartesian(leftDivisors,rightDivisors);return this._subdivideGroup(group,divisors.slice(0,1)).then(function(){return self._subdivideGroup(group,divisors.slice(1));});},_prepareData:function(group,groupSubdivisions){var self=this;var groupRowValues=group.rowValues;var groupRowLabels=[];var rowSubTree=this.rowGroupTree;var root;if(groupRowValues.length){rowSubTree=this._findGroup(this.rowGroupTree,groupRowValues);root=rowSubTree.root;groupRowLabels=root.labels;}
var groupColValues=group.colValues;var groupColLabels=[];if(groupColValues.length){root=this._findGroup(this.colGroupTree,groupColValues).root;groupColLabels=root.labels;}
groupSubdivisions.forEach(function(groupSubdivision){groupSubdivision.subGroups.forEach(function(subGroup){var rowValues=groupRowValues.concat(self._getGroupValues(subGroup,groupSubdivision.rowGroupBy));var rowLabels=groupRowLabels.concat(self._getGroupLabels(subGroup,groupSubdivision.rowGroupBy));var colValues=groupColValues.concat(self._getGroupValues(subGroup,groupSubdivision.colGroupBy));var colLabels=groupColLabels.concat(self._getGroupLabels(subGroup,groupSubdivision.colGroupBy));if(!colValues.length&&rowValues.length){self._addGroup(self.rowGroupTree,rowLabels,rowValues);}
if(colValues.length&&!rowValues.length){self._addGroup(self.colGroupTree,colLabels,colValues);}
var key=JSON.stringify([rowValues,colValues]);var originIndex=groupSubdivision.group.originIndex;if(!(key in self.measurements)){self.measurements[key]=self.data.origins.map(function(){return self._getMeasurements({});});}
self.measurements[key][originIndex]=self._getMeasurements(subGroup);if(!(key in self.counts)){self.counts[key]=self.data.origins.map(function(){return 0;});}
self.counts[key][originIndex]=subGroup.__count;if(!(key in self.groupDomains)){self.groupDomains[key]=self.data.origins.map(function(){return Domain.FALSE_DOMAIN;});}
if(subGroup.__domain){self.groupDomains[key][originIndex]=subGroup.__domain;}});});if(this.data.sortedColumn){this.sortRows(this.data.sortedColumn,rowSubTree);}},_processMeasures:function(measures){if(measures){return _.map(measures,function(measure){return measure==='__count__'?'__count':measure;});}},_computeDerivedParams:function(){const{range,rangeDescription,comparisonRange,comparisonRangeDescription}=this.data.timeRanges;if(range){this.data.domains=[this.data.domain.concat(comparisonRange),this.data.domain.concat(range)];this.data.origins=[comparisonRangeDescription,rangeDescription];}else{this.data.domains=[this.data.domain];this.data.origins=[""];}},_pruneTree:function(tree,oldTree){if(!oldTree.directSubTrees.size){tree.directSubTrees.clear();delete tree.sortedKeys;return;}
var self=this;[...tree.directSubTrees.keys()].forEach(function(subTreeKey){var subTree=tree.directSubTrees.get(subTreeKey);if(!oldTree.directSubTrees.has(subTreeKey)){subTree.directSubTrees.clear();delete subTreeKey.sortedKeys;}else{var oldSubTree=oldTree.directSubTrees.get(subTreeKey);self._pruneTree(subTree,oldSubTree);}});},_toggleMeasure:function(fieldName){var index=this.data.measures.indexOf(fieldName);if(index!==-1){this.data.measures.splice(index,1);return Promise.resolve();}else{this.data.measures.push(fieldName);}
return this._loadData();},_sanitizeLabel:function(value,groupBy){var fieldName=groupBy.split(':')[0];if(value===false){return _t("Undefined");}
if(value instanceof Array){return this._getNumberedLabel(value,fieldName);}
if(fieldName&&this.fields[fieldName]&&(this.fields[fieldName].type==='selection')){var selected=_.where(this.fields[fieldName].selection,{0:value})[0];return selected?selected[1]:value;}
return value;},_sanitizeValue:function(value){if(value instanceof Array){return value[0];}
return value;},_subdivideGroup:function(group,divisors){var self=this;var key=JSON.stringify([group.rowValues,group.colValues]);var proms=this.data.origins.reduce(function(acc,origin,originIndex){if(!self.counts[key]||self.counts[key][originIndex]>0){var subGroup={rowValues:group.rowValues,colValues:group.colValues,originIndex:originIndex};divisors.forEach(function(divisor){acc.push(self._getGroupSubdivision(subGroup,divisor[0],divisor[1]));});}
return acc;},[]);return this._loadDataDropPrevious.add(Promise.all(proms)).then(function(groupSubdivisions){if(groupSubdivisions.length){self._prepareData(group,groupSubdivisions);}});},_sortTree:function(sortFunction,tree){var self=this;tree.sortedKeys=_.sortBy([...tree.directSubTrees.keys()],sortFunction(tree));[...tree.directSubTrees.values()].forEach(function(subTree){self._sortTree(sortFunction,subTree);});},});__exports[Symbol.for("default")]=PivotModel;return __exports;});odoo.define(`web.PivotModel`,async function(require){return require('@web/legacy/js/views/pivot/pivot_model')[Symbol.for("default")];});;

/* /web/static/src/legacy/js/views/pivot/pivot_renderer.js defined in bundle 'web.tests_assets' */
odoo.define('@web/legacy/js/views/pivot/pivot_renderer',async function(require){'use strict';let __exports={};const{useEffect}=require("@web/core/utils/hooks");const OwlAbstractRenderer=require("@web/legacy/js/views/abstract_renderer_owl")[Symbol.for("default")];const field_utils=require('web.field_utils');const{DEFAULT_INTERVAL,INTERVAL_OPTIONS,getIntervalOptions}=require('web.searchUtils');const{Component,hooks}=owl;const{useExternalListener,useState}=hooks;class PivotCustomGroupByItem extends Component{constructor(){super(...arguments);this.canBeOpened=true;this.state=useState({fieldName:this.props.fields[0].name});}
onApply(){const{fieldName}=this.state;const{type}=this.props.fields.find(f=>f.name===fieldName);let interval=null;if(['date','datetime'].includes(type)){interval=DEFAULT_INTERVAL;}
this.trigger('groupby-menu-selection',{fieldName,interval,custom:true});this.state.open=false;}}
PivotCustomGroupByItem.template="web.CustomGroupByItem";PivotCustomGroupByItem.props={fields:Array};const PivotGroupByMenu=__exports.PivotGroupByMenu=class PivotGroupByMenu extends Component{constructor(){super(...arguments);this.intervalOptions=INTERVAL_OPTIONS;this.openedSubMenus={};}
get items(){let items=this.props.fields;if(this.props.hasSearchArchGroupBys){items=this.props.searchModel.get('filters',f=>f.type==='groupBy');let groupNumber=1+Math.max(...items.map(g=>g.groupNumber),0);for(const[_,customGroupBy]of this.props.customGroupBys){customGroupBy.groupNumber=groupNumber++;items.push(customGroupBy);}}
return items.map((item)=>({...item,id:item.id||item.name,fieldName:item.fieldName||item.name,description:item.description||item.string,isActive:false,options:item.options||["date","datetime"].includes(item.type)?getIntervalOptions():undefined,}));}
_onClickMenuGroupBy(fieldName,interval){this.trigger('groupby-menu-selection',{fieldName,interval});}
_toggleMenu(id){this.openedSubMenus[id]=!this.openedSubMenus[id];this.render();}}
PivotGroupByMenu.template="web.legacy.PivotGroupByMenu";PivotGroupByMenu.components={PivotCustomGroupByItem};PivotGroupByMenu.props={customGroupBys:Map,fields:Object,hasSearchArchGroupBys:Boolean,searchModel:true,};class PivotRenderer extends OwlAbstractRenderer{constructor(){super(...arguments);this.sampleDataTargets=['table'];this.state=useState({activeNodeHeader:{groupId:false,isXAxis:false,click:false},});const searchArchGroupBys=this.props.searchModel.get('filters',f=>f.type==='groupBy'&&!f.custom);this.hasSearchArchGroupBys=Boolean(searchArchGroupBys&&searchArchGroupBys.length);this.customGroupBys=new Map();useEffect(()=>this._updateTooltip());useExternalListener(window,'click',this._resetState);}
_getFormattedValue(cell){const type=this.props.widgets[cell.measure]||(this.props.fields[cell.measure].type==='many2one'?'integer':this.props.fields[cell.measure].type);const formatter=field_utils.format[type];return formatter(cell.value,this.props.fields[cell.measure]);}
_getFormattedVariation(cell){const value=cell.value;return isNaN(value)?'-':field_utils.format.percentage(value,this.props.fields[cell.measure]);}
_getPadding(cell){return 5+cell.indent*30;}
_resetState(){if(this.isHeaderClicked){this.isHeaderClicked=false;return;}
this.state.activeNodeHeader={groupId:false,isXAxis:false,click:false};}
_updateTooltip(){$(this.el).find('.o_pivot_header_cell_opened, .o_pivot_header_cell_closed').tooltip();}
_onGroupByMenuSelection(ev){if(this.hasSearchArchGroupBys){const{custom,fieldName}=ev.detail;if(custom&&!this.customGroupBys.has(fieldName)){const field=this.props.groupableFields.find(g=>g.fieldName===fieldName)
this.customGroupBys.set(fieldName,field);}}}
_onHeaderClick(cell,type){const groupValues=cell.groupId[type==='col'?1:0];const groupByLength=type==='col'?this.props.colGroupBys.length:this.props.rowGroupBys.length;if(cell.isLeaf&&groupValues.length>=groupByLength){this.isHeaderClicked=true;this.state.activeNodeHeader={groupId:cell.groupId,isXAxis:type==='col',click:'leftClick'};}
this.trigger(cell.isLeaf?'closed_header_click':'opened_header_click',{cell,type});}
_onMouseEnter(ev){var index=[...ev.currentTarget.parentNode.children].indexOf(ev.currentTarget);if(ev.currentTarget.tagName==='TH'){index+=1;}
this.el.querySelectorAll('td:nth-child('+(index+1)+')').forEach(elt=>elt.classList.add('o_cell_hover'));}
_onMouseLeave(){this.el.querySelectorAll('.o_cell_hover').forEach(elt=>elt.classList.remove('o_cell_hover'));}}
PivotRenderer.template='web.legacy.PivotRenderer';PivotRenderer.components={PivotGroupByMenu};__exports[Symbol.for("default")]=PivotRenderer;return __exports;});odoo.define(`web.PivotRenderer`,async function(require){return require('@web/legacy/js/views/pivot/pivot_renderer')[Symbol.for("default")];});;

/* /web/static/src/legacy/js/views/pivot/pivot_view.js defined in bundle 'web.tests_assets' */
odoo.define('@web/legacy/js/views/pivot/pivot_view',async function(require){'use strict';let __exports={};const AbstractView=require("@web/legacy/js/views/abstract_view")[Symbol.for("default")];const config=require('web.config');const core=require('web.core');const PivotModel=require('web.PivotModel');const PivotController=require('web.PivotController');const PivotRenderer=require("@web/legacy/js/views/pivot/pivot_renderer")[Symbol.for("default")];const RendererWrapper=require('web.RendererWrapper');const{sortBy}=require('web.utils');const viewRegistry=require("web.view_registry");const _t=core._t;const _lt=core._lt;const searchUtils=require('web.searchUtils');const GROUPABLE_TYPES=searchUtils.GROUPABLE_TYPES;const PivotView=AbstractView.extend({display_name:_lt('Pivot'),icon:'fa-table',config:Object.assign({},AbstractView.prototype.config,{Model:PivotModel,Controller:PivotController,Renderer:PivotRenderer,}),viewType:'pivot',searchMenuTypes:['filter','groupBy','comparison','favorite'],init:function(viewInfo,params){this._super.apply(this,arguments);const activeMeasures=[];const colGroupBys=[];const rowGroupBys=[];const measures={};const groupableFields={};const widgets={};const additionalMeasures=params.additionalMeasures||[];this.fields.__count={string:_t("Count"),type:"integer"};Object.keys(this.fields).forEach(name=>{const field=this.fields[name];if(name!=='id'&&field.store===true){if(['integer','float','monetary'].includes(field.type)||additionalMeasures.includes(name)){measures[name]=field;}
if(GROUPABLE_TYPES.includes(field.type)){groupableFields[name]=Object.assign({description:field.string,fieldName:name,fieldType:field.type,name,},field);}}});measures.__count={string:_t("Count"),type:"integer"};this.arch.children.forEach(field=>{let name=field.attrs.name;if(field.attrs.invisible&&py.eval(field.attrs.invisible)){if(name in groupableFields){delete groupableFields[name];}
if(!additionalMeasures.includes(name)){delete measures[name];return;}}
if(field.attrs.interval){name+=':'+field.attrs.interval;}
if(field.attrs.widget){widgets[name]=field.attrs.widget;}
if(field.attrs.type==='measure'&&!(name in measures)){measures[name]=this.fields[name];}
if(field.attrs.string&&name in measures){measures[name].string=field.attrs.string;}
if(field.attrs.type==='measure'||'operator'in field.attrs){activeMeasures.push(name);measures[name]=this.fields[name];}
if(field.attrs.type==='col'){colGroupBys.push(name);}
if(field.attrs.type==='row'){rowGroupBys.push(name);}});if((!activeMeasures.length)||this.arch.attrs.display_quantity){activeMeasures.splice(0,0,'__count');}
this.loadParams.measures=activeMeasures;this.loadParams.colGroupBys=config.device.isMobile?[]:colGroupBys;this.loadParams.rowGroupBys=rowGroupBys;this.loadParams.fields=this.fields;this.loadParams.default_order=params.default_order||this.arch.attrs.default_order;const disableLinking=!!(this.arch.attrs.disable_linking&&JSON.stringify(this.arch.attrs.disable_linking));this.rendererParams.widgets=widgets;this.rendererParams.disableLinking=disableLinking;const{searchModel}=this.controllerParams;this.rendererParams.searchModel=searchModel;this.rendererParams.groupableFields=sortBy(Object.values(groupableFields),(f)=>f.description);this.controllerParams.disableLinking=disableLinking;this.controllerParams.title=params.title||this.arch.attrs.string||_t("Untitled");this.controllerParams.measures=measures;this.controllerParams.views=[_findView(params.actionViews,'list'),_findView(params.actionViews,'form'),];function _findView(views,viewType){const view=views.find(view=>{return view.type===viewType;});return[view?view.viewID:false,viewType];}},getRenderer(parent,state){state=Object.assign(state||{},this.rendererParams);return new RendererWrapper(parent,this.config.Renderer,state);},});viewRegistry.add("pivot",PivotView);__exports[Symbol.for("default")]=PivotView;return __exports;});odoo.define(`web.PivotView`,async function(require){return require('@web/legacy/js/views/pivot/pivot_view')[Symbol.for("default")];});;

/* /crm/static/src/js/forecast_graph_legacy.js defined in bundle 'web.tests_assets' */
odoo.define('@crm/js/forecast_graph_legacy',async function(require){'use strict';let __exports={};const GraphView=require('web.GraphView');const viewRegistry=require('web.view_registry');const ForecastGraphView=GraphView.extend({_createSearchModel(params,extraExtensions={}){Object.assign(extraExtensions,{Forecast:{}});return this._super(params,extraExtensions);},});viewRegistry.add('forecast_graph',ForecastGraphView);return __exports;});;

/* /web_enterprise/static/src/legacy/js/views/pivot_renderer.js defined in bundle 'web.tests_assets' */
odoo.define('@web_enterprise/legacy/js/views/pivot_renderer',async function(require){'use strict';let __exports={};const config=require("web.config");const PivotRenderer=require("@web/legacy/js/views/pivot/pivot_renderer")[Symbol.for("default")];const{PivotGroupByMenu}=require("@web/legacy/js/views/pivot/pivot_renderer");const{patch}=require("web.utils");if(config.device.isMobile){patch(PivotRenderer.prototype,"pivot_mobile",{_updateTooltip(){},_getPadding(cell){return 5+cell.indent*5;},});patch(PivotGroupByMenu.prototype,"pivot_mobile",{_onClickMenuGroupBy(fieldName,interval,ev){if(!ev.currentTarget.classList.contains("o_pivot_field_selection")){this._super(...arguments);}else{ev.stopPropagation();}},});}
return __exports;});;

/* /web_cohort/static/src/legacy/js/cohort_controller.js defined in bundle 'web.tests_assets' */
odoo.define('web_cohort.CohortController',function(require){'use strict';const AbstractController=require('web.AbstractController');const config=require('web.config');const core=require('web.core');const framework=require('web.framework');const session=require('web.session');const qweb=core.qweb;const _t=core._t;var CohortController=AbstractController.extend({custom_events:Object.assign({},AbstractController.prototype.custom_events,{row_clicked:'_onRowClicked',}),init:function(parent,model,renderer,params){this._super.apply(this,arguments);this.title=params.title;this.measures=params.measures;this.intervals=params.intervals;this.dateStartString=params.dateStartString;this.dateStopString=params.dateStopString;this.timeline=params.timeline;this.views=params.views;},getOwnedQueryParams:function(){var state=this.model.get();return{context:{cohort_measure:state.measure,cohort_interval:state.interval,}};},renderButtons:function($node){this.$buttons=$(qweb.render('CohortView.buttons',{measures:_.sortBy(_.pairs(this.measures),function(x){return x[1].toLowerCase();}),intervals:this.intervals,isMobile:config.device.isMobile}));this.$measureList=this.$buttons.find('.o_cohort_measures_list');this.$buttons.on('click','button',this._onButtonClick.bind(this));if($node){this.$buttons.appendTo($node);}},updateButtons:function(){if(!this.$buttons){return;}
var data=this.model.get();var noData=!data.report.rows.length&&(!data.comparisonReport||!data.comparisonReport.rows.length);this.$buttons.find('.o_cohort_download_button').toggleClass('d-none',noData);if(config.device.isMobile){var $activeInterval=this.$buttons.find('.o_cohort_interval_button[data-interval="'+data.interval+'"]');this.$buttons.find('.dropdown_cohort_content').text($activeInterval.text());}
this.$buttons.find('.o_cohort_interval_button').removeClass('active');this.$buttons.find('.o_cohort_interval_button[data-interval="'+data.interval+'"]').addClass('active');_.each(this.$measureList.find('.dropdown-item'),function(el){var $el=$(el);$el.toggleClass('selected',$el.data('field')===data.measure);});},_downloadExcel:function(){var data=this.model.get();data=_.extend(data,{title:this.title,model:this.modelName,interval_string:this.intervals[data.interval].toString(),measure_string:this.measures[data.measure]||_t('Count'),date_start_string:this.dateStartString,date_stop_string:this.dateStopString,timeline:this.timeline,});framework.blockUI();session.get_file({url:'/web/cohort/export',data:{data:JSON.stringify(data)},complete:framework.unblockUI,error:(error)=>this.call('crash_manager','rpc_error',error),});},_setInterval:function(interval){this.update({interval:interval});},_setMeasure:function(measure){this.update({measure:measure});},_update:function(){this.updateButtons();return this._super.apply(this,arguments);},_onButtonClick:function(ev){var $btn=$(ev.currentTarget);if($btn.hasClass('o_cohort_interval_button')){this._setInterval($btn.data('interval'));}else if($btn.hasClass('o_cohort_download_button')){this._downloadExcel();}else if($btn.closest('.o_cohort_measures_list').length){ev.preventDefault();ev.stopPropagation();this._setMeasure($btn.data('field'));}},_onRowClicked:function(event){this.do_action({type:'ir.actions.act_window',name:this.title,res_model:this.modelName,views:this.views,domain:event.data.domain,});},});return CohortController;});;

/* /web_cohort/static/src/legacy/js/cohort_model.js defined in bundle 'web.tests_assets' */
odoo.define('web_cohort.CohortModel',function(require){'use strict';var AbstractModel=require('web.AbstractModel');const{processMeasure}=require("@web/views/helpers/utils");var CohortModel=AbstractModel.extend({__get:function(){const{rangeDescription,comparisonRangeDescription}=this.timeRanges;return Object.assign({},this.data,{hasContent:!this._isEmpty(),isSample:this.isSampleModel,rangeDescription,comparisonRangeDescription});},__load:function(params){this.modelName=params.modelName;this.dateStart=params.dateStart;this.dateStop=params.dateStop;this.measure=processMeasure(params.measure);this.interval=params.interval;this.domain=params.domain;this.mode=params.mode;this.timeline=params.timeline;this.data={measure:this.measure,interval:this.interval,};this.context=params.context;this.timeRanges=params.timeRanges;return this._fetchData();},__reload:function(handle,params){if('measure'in params){this.data.measure=processMeasure(params.measure);}
if('interval'in params){this.data.interval=params.interval;}
if('domain'in params){this.domain=params.domain;}
if('timeRanges'in params){this.timeRanges=params.timeRanges;}
return this._fetchData();},_fetchData:function(){const domains=this._getDomains();const proms=domains.map(domain=>{return this._rpc({model:this.modelName,method:'get_cohort_data',kwargs:{date_start:this.dateStart,date_stop:this.dateStop,measure:this.data.measure,interval:this.data.interval,domain:domain,mode:this.mode,timeline:this.timeline,context:this.context}});});return Promise.all(proms).then(([report,comparisonReport])=>{this.data.report=report;this.data.comparisonReport=comparisonReport;});},_getDomains:function(){const{range,comparisonRange}=this.timeRanges;if(!range){return[this.domain];}
return[this.domain.concat(range),this.domain.concat(comparisonRange),];},_isEmpty(){let rowCount=this.data.report.rows.length;if(this.data.comparisonReport){rowCount+=this.data.comparisonReport.rows.length;}
return rowCount===0;},});return CohortModel;});;

/* /web_cohort/static/src/legacy/js/cohort_renderer.js defined in bundle 'web.tests_assets' */
odoo.define('web_cohort.CohortRenderer',function(require){'use strict';const OwlAbstractRenderer=require('web.AbstractRendererOwl');const field_utils=require('web.field_utils');class CohortRenderer extends OwlAbstractRenderer{constructor(){super(...arguments);this.sampleDataTargets=['table'];}
_range(value){return _.range(value);}
_formatFloat(value){return field_utils.format.float(value,null,{digits:[42,1],});}
_formatPercentage(value){return field_utils.format.percentage(value,null,{digits:[42,1],});}
getCellTitle(period,measure,count){return`${this.env._t("Period")}: ${period}\n${measure}: ${count}`;}
_onClickRow(ev){if(!ev.target.classList.contains('o_cohort_value')){return;}
const rowData=ev.currentTarget.dataset;const rowIndex=rowData.rowIndex;const colIndex=ev.target.dataset.colIndex;const row=(rowData.type==='data')?this.props.report.rows[rowIndex]:this.props.comparisonReport.rows[rowIndex];const rowDomain=row?row.domain:[];const cellContent=row?row.columns[colIndex]:false;const cellDomain=cellContent?cellContent.domain:[];const fullDomain=rowDomain.concat(cellDomain);if(cellDomain.length){fullDomain.unshift('&');}
if(fullDomain.length){this.trigger('row_clicked',{domain:fullDomain});}}}
CohortRenderer.template='web_cohort.Legacy.CohortRenderer';return CohortRenderer;});;

/* /web_cohort/static/src/legacy/js/cohort_view.js defined in bundle 'web.tests_assets' */
odoo.define('web_cohort.CohortView',function(require){'use strict';var AbstractView=require('web.AbstractView');var core=require('web.core');var CohortController=require('web_cohort.CohortController');var CohortModel=require('web_cohort.CohortModel');var CohortRenderer=require('web_cohort.CohortRenderer');const RendererWrapper=require('web.RendererWrapper');const legacyViewRegistry=require("web.view_registry");var _t=core._t;var _lt=core._lt;var intervals={day:_lt('Day'),week:_lt('Week'),month:_lt('Month'),year:_lt('Year'),};var CohortView=AbstractView.extend({display_name:_lt('Cohort'),icon:'fa-signal',config:_.extend({},AbstractView.prototype.config,{Model:CohortModel,Controller:CohortController,Renderer:CohortRenderer,}),viewType:'cohort',searchMenuTypes:['filter','comparison','favorite'],init:function(viewInfo,params){this._super.apply(this,arguments);var fields=this.fields;var attrs=this.arch.attrs;const additionalMeasures=params.additionalMeasures||[];if(!attrs.date_start){throw new Error(_lt('Cohort view has not defined "date_start" attribute.'));}
if(!attrs.date_stop){throw new Error(_lt('Cohort view has not defined "date_stop" attribute.'));}
var measures={};_.each(fields,function(field,name){if(name!=='id'&&field.store===true&&_.contains(['integer','float','monetary'],field.type)){measures[name]=field.string;}});this.arch.children.forEach(field=>{let fieldName=field.attrs.name;if(!additionalMeasures.includes(fieldName)&&field.attrs.invisible&&py.eval(field.attrs.invisible)){delete measures[fieldName];return;}
if(fieldName in measures&&field.attrs.string){measures[fieldName]=field.attrs.string;}});measures.__count=_t('Count');this.rendererParams.measures=measures;this.rendererParams.intervals=intervals;this.controllerParams.measures=_.omit(measures,'__count');this.controllerParams.intervals=intervals;this.controllerParams.title=params.title||attrs.string||_t('Untitled');this.controllerParams.views=[_findViewID('list'),_findViewID('form'),];function _findViewID(viewType){var action=params.action;if(action===undefined){return[false,viewType];}
var contextID=viewType==='list'?action.context.list_view_id:action.context.form_view_id;if(contextID){return[contextID,viewType];}else{const result=action._views?action._views.find((v)=>v[1]===viewType):undefined;return result||[false,viewType];}}},_updateMVCParams:function(){this._super.apply(this,arguments);var context=this.loadParams.context;var attrs=this.arch.attrs;this.loadParams.dateStart=context.cohort_date_start||attrs.date_start;this.loadParams.dateStop=context.cohort_date_stop||attrs.date_stop;this.loadParams.mode=context.cohort_mode||attrs.mode||'retention';this.loadParams.timeline=context.cohort_timeline||attrs.timeline||'forward';this.loadParams.measure=context.cohort_measure||attrs.measure||'__count';this.loadParams.interval=context.cohort_interval||attrs.interval||'day';this.rendererParams.mode=this.loadParams.mode;this.rendererParams.timeline=this.loadParams.timeline;this.rendererParams.dateStartString=this.fields[this.loadParams.dateStart].string;this.rendererParams.dateStopString=this.fields[this.loadParams.dateStop].string;this.controllerParams.dateStartString=this.rendererParams.dateStartString;this.controllerParams.dateStopString=this.rendererParams.dateStopString;this.controllerParams.timeline=this.rendererParams.timeline;},getRenderer(parent,state){state=Object.assign({},state,this.rendererParams);return new RendererWrapper(null,this.config.Renderer,state);},});legacyViewRegistry.add("cohort",CohortView);return CohortView;});;

/* /web_cohort/static/src/legacy/js/sample_server.js defined in bundle 'web.tests_assets' */
odoo.define('web_cohort/static/src/js/sample_server.js',function(require){"use strict";const SampleServer=require('web.SampleServer');function _mockGetCohortData(params){const{model}=params;const{date_start,interval,measure,mode,timeline}=params.kwargs;const columns_avg={};const rows=[];let initialChurnValue=0;const groups=this._mockReadGroup({model,fields:[date_start],groupBy:[date_start+':'+interval]});const totalCount=groups.length;let totalValue=0;for(const group of groups){const format=SampleServer.FORMATS[interval];const displayFormat=SampleServer.DISPLAY_FORMATS[interval];const date=moment(group[date_start+':'+interval],format);const now=moment();let colStartDate=date.clone();if(timeline==='backward'){colStartDate=colStartDate.subtract(15,interval);}
let value=measure==='__count'?this._getRandomInt(SampleServer.MAX_INTEGER):this._generateFieldValue(model,measure);value=value||25;totalValue+=value;let initialValue=value;let max=value;const columns=[];for(let column=0;column<=15;column++){if(!columns_avg[column]){columns_avg[column]={percentage:0,count:0};}
if(colStartDate.clone().add(column,interval)>now){columns.push({value:'-',churn_value:'-',percentage:''});continue;}
let colValue=0;if(max>0){colValue=Math.min(Math.round(Math.random()*max),max);max-=colValue;}
if(timeline==='backward'&&column===0){initialValue=Math.min(Math.round(Math.random()*value),value);initialChurnValue=value-initialValue;}
const previousValue=column===0?initialValue:columns[column-1].value;const remainingValue=previousValue-colValue;const previousChurnValue=column===0?initialChurnValue:columns[column-1].churn_value;const churn_value=colValue+previousChurnValue;let percentage=value?parseFloat(remainingValue/value):0;if(mode==='churn'){percentage=1-percentage;}
percentage=Number((100*percentage).toFixed(1));columns_avg[column].percentage+=percentage;columns_avg[column].count+=1;columns.push({value:remainingValue,churn_value,percentage,period:column,});}
const keepRow=columns.some(c=>c.percentage!=='');if(keepRow){rows.push({date:date.format(displayFormat),value,columns});}}
const avg_value=totalCount?(totalValue/totalCount):0;const avg={avg_value,columns_avg};return{rows,avg};}
SampleServer.mockRegistry.add('get_cohort_data',_mockGetCohortData);});;

/* /web_dashboard/static/src/legacy/js/dashboard_controller.js defined in bundle 'web.tests_assets' */
odoo.define('web_dashboard.DashboardController',function(require){"use strict";var AbstractController=require('web.AbstractController');var BasicController=require('web.BasicController');var core=require('web.core');var Domain=require('web.Domain');var _t=core._t;var DashboardController=AbstractController.extend({custom_events:_.extend({},BasicController.prototype.custom_events,{open_view:'_onOpenView',}),init:function(parent,model,renderer,params){this._super.apply(this,arguments);this.actionDomain=params.actionDomain;this.currentFilterIDs=[];},getOwnedQueryParams:function(){return{context:this.renderer.getsubControllersContext()};},_onOpenView:function(ev){ev.stopPropagation();var data=ev.data;var action={domain:this.actionDomain,context:data.context,name:_.str.sprintf(_t('%s Analysis'),_.str.capitalize(data.viewType)),res_model:this.modelName,type:'ir.actions.act_window',views:[[false,data.viewType]],useSampleModel:false,};if(!_.isEmpty(ev.data.additionalMeasures)){action.flags={additionalMeasures:ev.data.additionalMeasures};}
this.do_action(action);},_onReload:async function(ev){ev.stopPropagation();const dashboardDomain={};if(ev.data.domain&&ev.data.domain.length){dashboardDomain.domain=Domain.prototype.arrayToString(ev.data.domain);dashboardDomain.label=ev.data.domainLabel;}
this.searchModel.dispatch("updateDashboardDomain",dashboardDomain);},});return DashboardController;});;

/* /web_dashboard/static/src/legacy/js/dashboard_model.js defined in bundle 'web.tests_assets' */
odoo.define('web_dashboard.DashboardModel',function(require){"use strict";var BasicModel=require('web.BasicModel');var dataComparisonUtils=require('web.dataComparisonUtils');var Domain=require('web.Domain');var pyUtils=require('web.py_utils');var computeVariation=dataComparisonUtils.computeVariation;var DashboardModel=BasicModel.extend({__get:function(){var record=this._super.apply(this,arguments);record.timeRanges=this.dataPoint.timeRanges;record.timeRange=this.dataPoint.timeRange;record.comparisonTimeRange=this.dataPoint.comparisonTimeRange;record.compare=this.dataPoint.compare;record.comparisonData=this.dataPoint.comparisonData;record.variationData=this.dataPoint.variationData;record.isSample=this.isSampleModel;return record;},__load:function(params){params.type='record';this.dataPoint=this._makeDataPoint(params);return this._load(this.dataPoint);},__reload:function(id,options){options=options||{};if(options.domain!==undefined){this.dataPoint.domain=options.domain;}
if('timeRanges'in options){this._processTimeRanges(this.dataPoint,options.timeRanges);}
return this._load(this.dataPoint);},_evaluateFormulas:function(dataPoint){_.each(dataPoint.formulas,function(formula,formulaID){try{dataPoint.data[formulaID]=pyUtils.py_eval(formula.value,{record:dataPoint.data});if(!isFinite(dataPoint.data[formulaID])){dataPoint.data[formulaID]=NaN;}}catch(e){dataPoint.data[formulaID]=NaN;}
if(dataPoint.compare){try{dataPoint.comparisonData[formulaID]=pyUtils.py_eval(formula.value,{record:dataPoint.comparisonData});if(!isFinite(dataPoint.comparisonData[formulaID])){dataPoint.comparisonData[formulaID]=NaN;}}catch(e){dataPoint.comparisonData[formulaID]=NaN;}}});},_getReadGroupDomain:function(aggregateDomain,range){return Domain.prototype.normalizeArray(this.dataPoint.domain).concat(range).concat(Domain.prototype.normalizeArray(new Domain(aggregateDomain).toArray()));},_isEmpty(){return this.dataPoint.count===0;},_load:function(dataPoint){var self=this;let count=0;const domainMapping={};if(this.useSampleModel){domainMapping['[]']=[];}
var fieldsInfo=dataPoint.fieldsInfo.dashboard;_.each(dataPoint.aggregates,function(aggregateName){var domain=fieldsInfo[aggregateName].domain;if(domain in domainMapping){domainMapping[domain].push(aggregateName);}else{domainMapping[domain]=[aggregateName];}});var defs=[];_.each(domainMapping,function(aggregateNames,domain){var fields=_.map(aggregateNames,function(aggregateName){var fieldName=fieldsInfo[aggregateName].field;var groupOperator=fieldsInfo[aggregateName].group_operator;return aggregateName+':'+groupOperator+'('+fieldName+')';});defs.push(self._readGroup({domain:self._getReadGroupDomain(domain,self.dataPoint.timeRange),fields:fields,}).then(function(result){count=count+(domain==='[]'?result.__count:0);_.extend(self.dataPoint.data,_.pick(result,aggregateNames));}));if(dataPoint.compare){defs.push(self._readGroup({domain:self._getReadGroupDomain(domain,self.dataPoint.comparisonTimeRange),fields:fields,}).then(function(result){count=count+(domain==='[]'?result.__count:0);_.extend(self.dataPoint.comparisonData,_.pick(result,aggregateNames));}));}});return Promise.all(defs).then(function(){self.dataPoint.count=count;self._evaluateFormulas(dataPoint);if(dataPoint.compare){var value,comparisonValue;for(var statisticName in dataPoint.data){value=dataPoint.data[statisticName];comparisonValue=dataPoint.comparisonData[statisticName];dataPoint.variationData[statisticName]=computeVariation(value,comparisonValue);}}else{dataPoint.comparisonData={};dataPoint.variationData={};}
return dataPoint.id;});},_makeDataPoint:function(params){var dataPoint=this._super.apply(this,arguments);dataPoint.aggregates=params.aggregates;dataPoint.count=0;dataPoint.formulas=params.formulas;dataPoint.comparisonData={};dataPoint.variationData={};this._processTimeRanges(dataPoint,params.timeRanges);return dataPoint;},_readGroup:function(args){var readGroupArgs=_.extend({context:this.dataPoint.getContext(),groupBy:[],lazy:true,method:'read_group',model:this.dataPoint.model,orderBy:[],},args);return this._rpc(readGroupArgs).then(function(result){result=result[0];return _.mapObject(result,function(value){return value||0;});});},_processTimeRanges:function(dataPoint,timeRanges){const{range,comparisonRange}=timeRanges;dataPoint.timeRanges=timeRanges;dataPoint.timeRange=range||[];dataPoint.comparisonTimeRange=comparisonRange||[];dataPoint.compare=Boolean(dataPoint.comparisonTimeRange.length);},});return DashboardModel;});;

/* /web_dashboard/static/src/legacy/js/dashboard_model_extension.js defined in bundle 'web.tests_assets' */
odoo.define("web_dashboard/static/src/js/dashboard_model_extension.js",function(require){"use strict";const ActionModel=require("web.ActionModel");const DASHBOARD_FACET_ID="dashboard";class DashboardModelExtension extends ActionModel.Extension{prepareState(){this.state.domain=null;this.state.facets=null;}
get(property){switch(property){case"domain":return this.getDomain();case"facets":return this.getFacets();}}
deactivateGroup(groupId){if(groupId===DASHBOARD_FACET_ID){this.state.domain=null;this.state.facets=null;}}
getDomain(){return this.state.domain;}
getFacets(){return this.state.facets;}
updateDashboardDomain({domain,label}){this.state.domain=domain||null;if(domain){const facet={groupId:DASHBOARD_FACET_ID,type:"filter",values:[label],};this.state.facets=[facet];}else{this.state.facets=null;}}}
ActionModel.registry.add("Dashboard",DashboardModelExtension,50);});;

/* /web_dashboard/static/src/legacy/js/dashboard_renderer.js defined in bundle 'web.tests_assets' */
odoo.define('web_dashboard.DashboardRenderer',function(require){"use strict";var config=require('web.config');var core=require('web.core');var dataComparisonUtils=require('web.dataComparisonUtils');var Domain=require('web.Domain');var fieldUtils=require('web.field_utils');var FormRenderer=require('web.FormRenderer');var pyUtils=require('web.py_utils');var viewRegistry=require('web.view_registry');var renderComparison=dataComparisonUtils.renderComparison;var renderVariation=dataComparisonUtils.renderVariation;var QWeb=core.qweb;var DashboardRenderer=FormRenderer.extend({className:"o_legacy_dashboard_view",sampleDataTargets:['.o_subview','.o_group'],events:{'click .o_aggregate.o_clickable':'_onAggregateClicked',},OUTER_GROUP_COL:6,init:function(parent,state,params){this._super.apply(this,arguments);this.mode='readonly';this.subFieldsViews=params.subFieldsViews;this.subViewRefs=params.subViewRefs;this.additionalMeasures=params.additionalMeasures;this.subControllers={};this.subControllersContext=_.pick(state.context||{},'pivot','graph','cohort');this.subcontrollersNextMeasures={pivot:{},graph:{},cohort:{}};var session=this.getSession();var currency_id=session.company_currency_id;if(session.companies_currency_id&&session.user_context.allowed_company_ids){currency_id=session.companies_currency_id[session.user_context.allowed_company_ids[0]];}
this.formatOptions={currency_id:currency_id,humanReadable:function(value){return Math.abs(value)>=1000;},minDigits:1,decimals:2,formatterCallback:function(str){return str;}};},on_attach_callback:function(){this._super.apply(this,arguments);this.isInDOM=true;_.invoke(this.subControllers,'on_attach_callback');},on_detach_callback:function(){this._super.apply(this,arguments);this.isInDOM=false;},getsubControllersContext:function(){return _.mapObject(this.subControllers,function(controller){return controller.getOwnedQueryParams().context;});},updateState:function(state,params){var viewType;for(viewType in this.subControllers){this.subControllersContext[viewType]=this.subControllers[viewType].getOwnedQueryParams().context;}
var subControllersContext=_.pick(params.context||{},'pivot','graph','cohort');_.extend(this.subControllersContext,subControllersContext);for(viewType in this.subControllers){_.extend(this.subControllersContext[viewType],this.subcontrollersNextMeasures[viewType]);this.subcontrollersNextMeasures[viewType]={};}
return this._super.apply(this,arguments);},_addStatisticTooltip:function($el,node){$el.tooltip({delay:{show:1000,hide:0},title:function(){return QWeb.render('web_dashboard.LegacyStatisticTooltip',{debug:config.isDebug(),node:node,});}});},_renderLabel:function(node){var text=node.attrs.name;if('string'in node.attrs){text=node.attrs.string;}
var $result=$('<label>',{text:text});return $result;},_renderStatistic:function(node){var self=this;var $label=this._renderLabel(node);var $el=$('<div>').attr('name',node.attrs.name).append($label);var $value;var statisticName=node.attrs.name;var variation;var formatter;var statistic=self.state.fieldsInfo.dashboard[statisticName];var valueLabel=statistic.value_label?(' '+statistic.value_label):'';if(!node.attrs.widget||(node.attrs.widget in fieldUtils.format)){var fieldValue=self.state.data[statisticName];fieldValue=_.contains(['date','datetime'],statistic.type)?(fieldValue===0?NaN:moment(fieldValue)):fieldValue;var formatType=node.attrs.widget||statistic.type;formatter=fieldUtils.format[formatType];if(this.state.compare){var comparisonValue=this.state.comparisonData[statisticName];comparisonValue=_.contains(['date','datetime'],statistic.type)?(comparisonValue===0?NaN:moment(comparisonValue)):comparisonValue;variation=this.state.variationData[statisticName];renderComparison($el,fieldValue,comparisonValue,variation,formatter,statistic,this.formatOptions);$('.o_comparison',$el).append(valueLabel);}else{fieldValue=isNaN(fieldValue)?'-':formatter(fieldValue,statistic,this.formatOptions);$value=$('<div>',{class:'o_value'}).html(fieldValue+valueLabel);$el.append($value);}}else{if(this.state.compare){var $originalValue=this._renderFieldWidget(node,this.state);var fakeState=_.clone(this.state);fakeState.data=fakeState.comparisonData;var $comparisonValue=this._renderFieldWidget(node,fakeState);variation=this.state.variationData[statisticName];fakeState.data[statisticName]=variation;$el.append(renderVariation(variation,statistic)).append($('<div>',{class:'o_comparison'}).append($originalValue,$('<span>').html(" vs "),$comparisonValue));}else{$value=this._renderFieldWidget(node,this.state).addClass('o_value');$el.append($value);}}
if(variation){if(variation>0){$el.addClass('border-success');}else if(variation<0){$el.addClass('border-danger');}}
this._registerModifiers(node,this.state,$el);if(config.isDebug()||node.attrs.help){this._addStatisticTooltip($el,node);}
return $el;},_renderSubViewButtons:async function($el,controller){var $buttons=$('<div>',{class:'o_'+controller.viewType+'_buttons o_dashboard_subview_buttons'});controller.renderButtons($buttons);var $buttonGroup=$('<div class="btn-group">');$buttonGroup.append($buttons.find('[aria-label="Main actions"]'));$buttonGroup.append($buttons.find('.dropdown:has(.o_group_by_menu)'));$buttonGroup.prependTo($buttons);$('<button>').addClass("btn btn-outline-secondary fa fa-arrows-alt float-right o_button_switch").attr({title:'Full Screen View',viewType:controller.viewType}).tooltip().on('click',this._onViewSwitcherClicked.bind(this)).appendTo($buttons);$buttons.find('.btn-primary,.btn-secondary').removeClass('btn-primary btn-secondary').addClass("btn-outline-secondary");$buttons.find('[class*=interval_button]').addClass('text-muted text-capitalize');$buttons.find('.fa.fa-bars').removeClass('fa fa-bars');$buttons.prependTo($el);return controller.updateButtons();},_renderTagAggregate:function(node){var $aggregate=this._renderStatistic(node).addClass('o_aggregate');var isClickable=node.attrs.clickable===undefined||pyUtils.py_eval(node.attrs.clickable);$aggregate.toggleClass('o_clickable',isClickable);var $result=$('<div>').addClass('o_aggregate_col').append($aggregate);this._registerModifiers(node,this.state,$result);return $result;},_renderTagFormula:function(node){return this._renderStatistic(node).addClass('o_formula');},_renderTagGroup:function(node){var $group=this._renderOuterGroup(node);if(node.children.length&&node.children[0].tag==='widget'){$group.addClass('o_has_widget');}
return $group;},_renderTagView:function(node){var self=this;var viewType=node.attrs.type;var controllerContext=this.subControllersContext[viewType];var searchQuery={context:_.extend({},this.state.context,controllerContext),domain:this.state.domain,groupBy:[],timeRanges:this.state.timeRanges,};var subViewParams={modelName:this.state.model,withControlPanel:false,withSearchPanel:false,hasSwitchButton:true,isEmbedded:true,additionalMeasures:this.additionalMeasures,searchQuery:searchQuery,useSampleModel:Boolean(this.state.isSample),};var SubView=viewRegistry.get(viewType);var subView=new SubView(this.subFieldsViews[viewType],subViewParams);var $div=$('<div>',{class:'o_subview',type:viewType});var def=subView.getController(this).then(function(controller){return controller.appendTo($div).then(function(){return self._renderSubViewButtons($div,controller).then(()=>{self.subControllers[viewType]=controller;});});});this.defs.push(def);return $div;},_renderView:function(){var self=this;var oldControllers=_.values(this.subControllers);var r=this._super.apply(this,arguments);return r.then(function(){_.invoke(oldControllers,'destroy');if(self.isInDOM){_.invoke(self.subControllers,'on_attach_callback');}
if(self.state.isSample){self._renderNoContentHelper();}});},_updateView:function($newContent){this.$el.html($newContent);},_onAggregateClicked:function(ev){var aggregate=ev.currentTarget.getAttribute('name');var aggregateInfo=this.state.fieldsInfo.dashboard[aggregate];var measure=aggregateInfo.measure!==undefined?aggregateInfo.measure:aggregateInfo.field;if(this.subControllers.pivot){this.subcontrollersNextMeasures.pivot.pivot_measures=[measure];}
if(this.subControllers.graph){this.subcontrollersNextMeasures.graph.graph_measure=measure;}
if(this.subControllers.cohort){this.subcontrollersNextMeasures.cohort.cohort_measure=measure;}
var domain=new Domain(aggregateInfo.domain);var label=aggregateInfo.domain_label||aggregateInfo.string||aggregateInfo.name;this.trigger_up('reload',{domain:domain.toArray(),domainLabel:label,});},_onViewSwitcherClicked:function(ev){ev.stopPropagation();var viewType=$(ev.currentTarget).attr('viewType');var controller=this.subControllers[viewType];const controllerContext=controller.getOwnedQueryParams().context;this.trigger_up('open_view',{context:Object.assign({},this.state.context,controllerContext,this.subViewRefs),viewType:viewType,additionalMeasures:this.additionalMeasures,});},});return DashboardRenderer;});;

/* /web_dashboard/static/src/legacy/js/dashboard_view.js defined in bundle 'web.tests_assets' */
odoo.define('web_dashboard.DashboardView',function(require){"use strict";var BasicView=require('web.BasicView');var core=require('web.core');var viewRegistry=require('web.view_registry');var DashboardController=require('web_dashboard.DashboardController');var DashboardModel=require('web_dashboard.DashboardModel');var DashboardRenderer=require('web_dashboard.DashboardRenderer');var _lt=core._lt;var DashboardView=BasicView.extend({config:_.extend({},BasicView.prototype.config,{Model:DashboardModel,Controller:DashboardController,Renderer:DashboardRenderer,}),display_name:_lt('Dashboard'),searchMenuTypes:['filter','comparison','favorite'],icon:'fa-tachometer',viewType:'dashboard',init:function(viewInfo,params){this._super.apply(this,arguments);this.modelName=params.modelName;this.controllerParams.actionDomain=(params.action&&params.action.domain)||[];this.rendererParams.subFieldsViews={};var fields=this.fieldsInfo.dashboard;const additionalMeasures=[];for(const f of Object.values(fields)){if(f.realType==="many2one"&&!f.invisible){additionalMeasures.push(f.field);}}
this.rendererParams.additionalMeasures=additionalMeasures;this.subViewRefs={};_.each(this.fieldsView.subViews,subView=>{if(subView[0]){this.subViewRefs[subView[1]+'_view_ref']=subView[0];}});this.rendererParams.subViewRefs=this.subViewRefs;this.fieldsView.subViews=_.map(this.fieldsView.subViews,function(subView){return[false,subView[1]];});this.loadParams.aggregates=this.fieldsView.aggregates;this.loadParams.formulas=this.fieldsView.formulas;},_createSearchModel(params,extraExtensions={}){Object.assign(extraExtensions,{Dashboard:{}});return this._super(params,extraExtensions);},_loadData:function(model){var self=this;var subViewsDef;if(this.fieldsView.subViews.length){const context=Object.assign({},this.subViewRefs,this.loadParams.context);subViewsDef=model.loadViews(this.modelName,context,this.fieldsView.subViews).then(function(fieldsViews){for(var viewType in fieldsViews){self.rendererParams.subFieldsViews[viewType]=fieldsViews[viewType];}});}
var superDef=this._super.apply(this,arguments);return Promise.all([superDef,subViewsDef]).then(function(results){return results[0];});},_processAggregateNode:function(node,fv){var aggregateID=node.attrs.name;var field=fv.viewFields[node.attrs.field];var aggregate=_.defaults({},node.attrs,{domain:'[]',group_operator:field.group_operator,});aggregate.Widget=this._getFieldWidgetClass('dashboard',field,aggregate);if(field.type==='many2one'){field.type='integer';field.realType='many2one';aggregate.realType='many2one';aggregate.group_operator='count_distinct';}
aggregate.type=field.type;fv.fieldsInfo.dashboard[aggregateID]=aggregate;fv.viewFields[node.attrs.name]=_.extend({},field,{name:node.attrs.name,});fv.aggregates.push(aggregateID);return false;},_processArch:function(arch,fv){fv.aggregates=[];fv.formulas={};fv.subViews=[];fv.viewFields=$.extend(true,{},fv.viewFields);this._super.apply(this,arguments);},_processFormulaNode:function(node,fv){var formulaID=node.attrs.name||_.uniqueId('formula_');node.attrs.name=formulaID;var formula=_.extend({},node.attrs,{type:'float'});var fakeField={name:formulaID,type:'float'};formula.Widget=this._getFieldWidgetClass('dashboard',fakeField,formula);fv.fieldsInfo.dashboard[formulaID]=formula;fv.viewFields[formulaID]=fakeField;fv.formulas[formulaID]=_.pick(node.attrs,'string','value');return false;},_processNode:function(node,fv){var res=this._super.apply(this,arguments);if(node.tag==='aggregate'){res=this._processAggregateNode(node,fv);}
if(node.tag==='formula'){res=this._processFormulaNode(node,fv);}
if(node.tag==='view'){fv.subViews.push([node.attrs.ref,node.attrs.type]);res=false;}
return res;},});viewRegistry.add('dashboard',DashboardView);return DashboardView;});;

/* /mail/static/src/env/test_env.js defined in bundle 'web.tests_assets' */
odoo.define('@mail/env/test_env',async function(require){'use strict';let __exports={};const{nextTick}=require('@mail/utils/utils');__exports.addMessagingToEnv=addMessagingToEnv;function addMessagingToEnv(providedEnv={}){const env={...providedEnv};Object.assign(env,{browser:Object.assign({innerHeight:1080,innerWidth:1920,Notification:Object.assign({permission:'denied',async requestPermission(){return this.permission;},},(env.browser&&env.browser.Notification)||{}),},env.browser),});return env;}
__exports.addTimeControlToEnv=addTimeControlToEnv;function addTimeControlToEnv(providedEnv={}){const env={...providedEnv};if(!env.browser){env.browser={};}
let timedOutIds=[];const timeouts=new Map();Object.assign(env.browser,{clearTimeout:id=>{timeouts.delete(id);timedOutIds=timedOutIds.filter(i=>i!==id);},setTimeout:(func,duration)=>{const timeoutId=_.uniqueId('timeout_');const timeout={id:timeoutId,isTimedOut:false,func,duration,};timeouts.set(timeoutId,timeout);if(duration===0){timedOutIds.push(timeoutId);timeout.isTimedOut=true;}
return timeoutId;},});if(!env.testUtils){env.testUtils={};}
Object.assign(env.testUtils,{advanceTime:async duration=>{await nextTick();for(const id of timeouts.keys()){const timeout=timeouts.get(id);if(timeout.isTimedOut){continue;}
timeout.duration=Math.max(timeout.duration-duration,0);if(timeout.duration===0){timedOutIds.push(id);}}
while(timedOutIds.length>0){const id=timedOutIds.shift();const timeout=timeouts.get(id);timeouts.delete(id);timeout.func();await nextTick();}
await nextTick();},});return env;}
return __exports;});;

/* /mail/static/src/utils/test_utils.js defined in bundle 'web.tests_assets' */
odoo.define('@mail/utils/test_utils',async function(require){'use strict';let __exports={};const BusService=require('bus.BusService');const{addMessagingToEnv,addTimeControlToEnv,}=require('@mail/env/test_env');const{insertAndReplace,replace}=require('@mail/model/model_field_command');const{ChatWindowService}=require('@mail/services/chat_window_service/chat_window_service');const{MessagingService}=require('@mail/services/messaging/messaging');const{makeDeferred}=require('@mail/utils/deferred/deferred');const{DialogService}=require('@mail/services/dialog_service/dialog_service');const{getMessagingComponent}=require('@mail/utils/messaging_component');const{nextTick}=require('@mail/utils/utils');const{DiscussWidget}=require('@mail/widgets/discuss/discuss');const{MockModels}=require('@mail/../tests/helpers/mock_models');const AbstractStorageService=require('web.AbstractStorageService');const RamStorage=require('web.RamStorage');const{createView,makeTestPromise,mock,}=require('web.test_utils');const Widget=require('web.Widget');const{createWebClient,getActionManagerServerData}=require("@web/../tests/webclient/helpers");const LegacyRegistry=require("web.Registry");const{addMockEnvironment,patch:legacyPatch,unpatch:legacyUnpatch,}=mock;const{Component}=owl;const{EventBus}=owl.core;function _createFakeDataTransfer(files){return{dropEffect:'all',effectAllowed:'all',files,items:[],types:['Files'],};}
function _useChatWindow(callbacks){const{mount:prevMount,destroy:prevDestroy,}=callbacks;return Object.assign({},callbacks,{mount:prevMount.concat(async()=>{await Component.env.services['chat_window']._onWebClientReady();}),destroy:prevDestroy.concat(()=>{Component.env.services['chat_window'].destroy();}),});}
function _useDialog(callbacks){const{mount:prevMount,destroy:prevDestroy,}=callbacks;return Object.assign({},callbacks,{mount:prevMount.concat(async()=>{await Component.env.services['dialog']._onWebClientReady();}),destroy:prevDestroy.concat(()=>{Component.env.services['dialog'].destroy();}),});}
function _useDiscuss(callbacks){const{init:prevInit,mount:prevMount,return:prevReturn,}=callbacks;let discussWidget;const state={autoOpenDiscuss:false,discussData:{},};return Object.assign({},callbacks,{init:prevInit.concat(params=>{const{autoOpenDiscuss=state.autoOpenDiscuss,discuss:discussData=state.discussData}=params;Object.assign(state,{autoOpenDiscuss,discussData});delete params.autoOpenDiscuss;delete params.discuss;}),mount:prevMount.concat(async params=>{const{selector,widget}=params;DiscussWidget.prototype._pushStateActionManager=()=>{};discussWidget=new DiscussWidget(widget,state.discussData);await discussWidget.appendTo($(selector));if(state.autoOpenDiscuss){await discussWidget.on_attach_callback();}}),return:prevReturn.concat(result=>{Object.assign(result,{discussWidget});}),});}
function nextAnimationFrame(){const requestAnimationFrame=owl.Component.scheduler.requestAnimationFrame;return new Promise(function(resolve){setTimeout(()=>requestAnimationFrame(()=>resolve()));});}
const afterNextRender=(function(){const stop=owl.Component.scheduler.stop;const stopPromises=[];owl.Component.scheduler.stop=function(){const wasRunning=this.isRunning;stop.call(this);if(wasRunning){while(stopPromises.length){stopPromises.pop().resolve();}}};async function afterNextRender(func,timeoutDelay=5000){const startError=new Error("Timeout: the render didn't start.");const stopError=new Error("Timeout: the render didn't stop.");let timeoutNoRender;const timeoutProm=new Promise((resolve,reject)=>{timeoutNoRender=setTimeout(()=>{let error=startError;if(owl.Component.scheduler.isRunning){error=stopError;}
console.error(error);reject(error);},timeoutDelay);});const prom=makeTestPromise();stopPromises.push(prom);const funcRes=func();await Promise.race([prom,timeoutProm]);clearTimeout(timeoutNoRender);await funcRes;await nextAnimationFrame();if(owl.Component.scheduler.isRunning){await afterNextRender(()=>{},timeoutDelay);}}
return afterNextRender;})();function beforeEach(self){const data=MockModels.generateData();data.partnerRootId=2;data['res.partner'].records.push({active:false,display_name:"OdooBot",id:data.partnerRootId,});data.currentPartnerId=3;data.currentUserId=2;data['res.partner'].records.push({display_name:"Your Company, Mitchell Admin",id:data.currentPartnerId,name:"Mitchell Admin",user_ids:[data.currentUserId],});data['res.users'].records.push({display_name:"Your Company, Mitchell Admin",id:data.currentUserId,name:"Mitchell Admin",partner_id:data.currentPartnerId,});data.publicPartnerId=4;data['res.partner'].records.push({active:false,display_name:"Public user",id:data.publicPartnerId,});data.publicUserId=3;data['res.users'].records.push({active:false,display_name:"Public user",id:data.publicUserId,name:"Public user",partner_id:data.publicPartnerId,});const originals={'_.debounce':_.debounce,'_.throttle':_.throttle,};(function patch(){_.debounce=_.identity;_.throttle=_.identity;})();function unpatch(){_.debounce=originals['_.debounce'];_.throttle=originals['_.throttle'];}
Object.assign(self,{components:[],data,unpatch,widget:undefined});Object.defineProperty(self,'messaging',{get(){if(!this.env||!this.env.services.messaging){return undefined;}
return this.env.services.messaging.modelManager.messaging;},});}
function afterEach(self){while(self.components.length>0){const component=self.components.pop();component.destroy();}
if(self.widget){self.widget.destroy();self.widget=undefined;}
if(self.messaging){self.messaging.delete();}
self.env=undefined;self.unpatch();}
function getAfterEvent({messagingBus}){return async function afterEvent({eventName,func,message,predicate,timeoutDelay=5000}){let timeoutNoEvent;const timeoutProm=new Promise((resolve,reject)=>{timeoutNoEvent=setTimeout(()=>{let error=message?new Error(message):new Error(`Timeout: the event ${eventName} was not triggered.`);console.error(error);reject(error);},timeoutDelay);});const eventProm=new Promise(resolve=>{messagingBus.on(eventName,null,data=>{if(!predicate||predicate(data)){resolve();}});});const funcRes=func();await Promise.race([eventProm,timeoutProm]);clearTimeout(timeoutNoEvent);await funcRes;};}
async function createRootMessagingComponent(self,componentName,{props={},target}){const Component=getMessagingComponent(componentName);Component.env=self.env;const component=new Component(null,props);delete Component.env;self.components.push(component);await afterNextRender(()=>component.mount(target));return component;}
function getCreateComposerComponent({components,env,modelManager,widget}){return async function createComposerComponent(composer,props){const composerView=modelManager.messaging.models['mail.composer_view'].create({qunitTest:insertAndReplace({composer:replace(composer),}),});await createRootMessagingComponent({components,env},"Composer",{props:{composerViewLocalId:composerView.localId,...props},target:widget.el,});};}
function getCreateComposerSuggestionComponent({components,env,modelManager,widget}){return async function createComposerSuggestionComponent(composer,props){const composerView=modelManager.messaging.models['mail.composer_view'].create({qunitTest:insertAndReplace({composer:replace(composer),}),});await createRootMessagingComponent({components,env},"ComposerSuggestion",{props:{...props,composerViewLocalId:composerView.localId},target:widget.el,});};}
function getCreateMessageComponent({components,env,modelManager,widget}){return async function createMessageComponent(message){const messageView=modelManager.messaging.models['mail.message_view'].create({message:replace(message),qunitTest:insertAndReplace(),});await createRootMessagingComponent({components,env},"Message",{props:{messageViewLocalId:messageView.localId},target:widget.el,});};}
function getCreateMessagingMenuComponent({components,env,widget}){return async function createMessagingMenuComponent(){await createRootMessagingComponent({components,env},'MessagingMenu',{props:{},target:widget.el,});};}
function getCreateThreadViewComponent({afterEvent,components,env,widget}){return async function createThreadViewComponent(threadView,otherProps={},{isFixedSize=false,waitUntilMessagesLoaded=true}={}){let target;if(isFixedSize){const div=document.createElement('div');Object.assign(div.style,{display:'flex','flex-flow':'column',height:'300px',});widget.el.append(div);target=div;}else{target=widget.el;}
async function func(){return createRootMessagingComponent({components,env},"ThreadView",{props:{threadViewLocalId:threadView.localId,...otherProps},target});}
if(waitUntilMessagesLoaded){await afterNextRender(()=>afterEvent({eventName:'o-thread-view-hint-processed',func,message:"should wait until thread loaded messages after creating thread view component",predicate:({hint,threadViewer})=>{return(hint.type==='messages-loaded'&&threadViewer.threadView===threadView);},}));}else{await func();}};}
async function start(param0={}){let callbacks={init:[],mount:[],destroy:[],return:[],};const{env:providedEnv,hasWebClient=false,hasChatWindow=false,hasDialog=false,hasDiscuss=false,hasTimeControl=false,hasView=false,loadingBaseDelayDuration=0,messagingBeforeCreationDeferred=Promise.resolve(),waitUntilEvent,waitUntilMessagingCondition='initialized',}=param0;if(!['none','created','initialized'].includes(waitUntilMessagingCondition)){throw Error(`Unknown parameter value ${waitUntilMessagingCondition} for 'waitUntilMessaging'.`);}
delete param0.env;delete param0.hasWebClient;delete param0.hasChatWindow;delete param0.hasDiscuss;delete param0.hasTimeControl;delete param0.hasView;if(hasChatWindow){callbacks=_useChatWindow(callbacks);}
if(hasDialog){callbacks=_useDialog(callbacks);}
if(hasDiscuss){callbacks=_useDiscuss(callbacks);}
const messagingBus=new EventBus();const{init:initCallbacks,mount:mountCallbacks,destroy:destroyCallbacks,return:returnCallbacks,}=callbacks;const{debug=false}=param0;initCallbacks.forEach(callback=>callback(param0));const testSetupDoneDeferred=makeDeferred();let env=Object.assign(providedEnv||{});env.session=Object.assign({is_bound:Promise.resolve(),url:s=>s,},env.session);env.isDebug=env.isDebug||(()=>true);env=addMessagingToEnv(env);if(hasTimeControl){env=addTimeControlToEnv(env);}
const services=Object.assign({},{bus_service:BusService.extend({_beep(){},_poll(){},_registerWindowUnload(){},isOdooFocused(){return true;},updateOption(){},}),chat_window:ChatWindowService.extend({_getParentNode(){return document.querySelector(debug?'body':'#qunit-fixture');},_listenHomeMenu:()=>{},}),dialog:DialogService.extend({_getParentNode(){return document.querySelector(debug?'body':'#qunit-fixture');},_listenHomeMenu:()=>{},}),local_storage:AbstractStorageService.extend({storage:new RamStorage()}),messaging:MessagingService.extend({messagingValues:{autofetchPartnerImStatus:false,disableAnimation:true,isQUnitTest:true,loadingBaseDelayDuration,messagingBus,},init(...args){this._super(...args);this.modelManager.isDebug=true;},async start(){const _super=this._super.bind(this);await testSetupDoneDeferred;await messagingBeforeCreationDeferred;_super();},}),},param0.services);const kwargs=Object.assign({},param0,{archs:Object.assign({},{'mail.message,false,search':'<search/>'},param0.archs),debug:param0.debug||false,services:Object.assign({},services,param0.services),},{env});let widget;let mockServer;let testEnv;const selector=debug?'body':'#qunit-fixture';if(hasView){widget=await createView(kwargs);legacyPatch(widget,{destroy(){destroyCallbacks.forEach(callback=>callback({widget}));this._super(...arguments);legacyUnpatch(widget);}});}else if(hasWebClient){let serverData;if(!kwargs.serverData){serverData=getActionManagerServerData();}else{serverData=kwargs.serverData;delete kwargs.serverData;}
if(kwargs.actions){const actions={};kwargs.actions.forEach((act)=>{actions[act.xml_id||act.id]=act;});Object.assign(serverData.actions,actions);delete kwargs.actions;}
Object.assign(serverData.views,kwargs.archs);delete kwargs.archs;Object.assign(serverData.models,kwargs.data);delete kwargs.data;const mockRPC=kwargs.mockRPC;delete kwargs.mockRPC;if(kwargs.services){const serviceRegistry=kwargs.serviceRegistry=new LegacyRegistry();for(const sname in kwargs.services){serviceRegistry.add(sname,kwargs.services[sname]);}
delete kwargs.services;}
const legacyParams=kwargs;legacyParams.withLegacyMockServer=true;legacyParams.env=env;widget=await createWebClient({serverData,mockRPC,legacyParams});legacyPatch(widget,{destroy(){destroyCallbacks.forEach(callback=>callback({widget}));this._super(...arguments);legacyUnpatch(widget);}});}else{const Parent=Widget.extend({do_push_state(){}});const parent=new Parent();mockServer=await addMockEnvironment(parent,kwargs);widget=new Widget(parent);await widget.appendTo($(selector));Object.assign(widget,{destroy(){delete widget.destroy;destroyCallbacks.forEach(callback=>callback({widget}));parent.destroy();},});}
testEnv=Component.env;const afterEvent=getAfterEvent({messagingBus});let waitUntilEventPromise;if(waitUntilEvent){waitUntilEventPromise=afterEvent({func:()=>testSetupDoneDeferred.resolve(),...waitUntilEvent,});}else{testSetupDoneDeferred.resolve();waitUntilEventPromise=Promise.resolve();}
const components=[];const result={afterEvent,components,env:testEnv,mockServer,widget,};const{modelManager}=testEnv.services.messaging;if(waitUntilMessagingCondition==='created'){await modelManager.messagingCreatedPromise;}
if(waitUntilMessagingCondition==='initialized'){await modelManager.messagingCreatedPromise;await modelManager.messagingInitializedPromise;}
if(mountCallbacks.length>0){await afterNextRender(async()=>{await Promise.all(mountCallbacks.map(callback=>callback({selector,widget})));});}
returnCallbacks.forEach(callback=>callback(result));await waitUntilEventPromise;return{...result,createComposerComponent:getCreateComposerComponent({components,env:testEnv,modelManager,widget}),createComposerSuggestionComponent:getCreateComposerSuggestionComponent({components,env:testEnv,modelManager,widget}),createMessageComponent:getCreateMessageComponent({components,env:testEnv,modelManager,widget}),createMessagingMenuComponent:getCreateMessagingMenuComponent({components,env:testEnv,widget}),createThreadViewComponent:getCreateThreadViewComponent({afterEvent,components,env:testEnv,widget}),};}
function dragenterFiles(el,files){const ev=new Event('dragenter',{bubbles:true});Object.defineProperty(ev,'dataTransfer',{value:_createFakeDataTransfer(files),});el.dispatchEvent(ev);}
function dropFiles(el,files){const ev=new Event('drop',{bubbles:true});Object.defineProperty(ev,'dataTransfer',{value:_createFakeDataTransfer(files),});el.dispatchEvent(ev);}
function pasteFiles(el,files){const ev=new Event('paste',{bubbles:true});Object.defineProperty(ev,'clipboardData',{value:_createFakeDataTransfer(files),});el.dispatchEvent(ev);}
function isScrolledToBottom(el){return Math.abs(el.scrollHeight-el.clientHeight-el.scrollTop)<=1;}
Object.assign(__exports,{afterEach,afterNextRender,beforeEach,createRootMessagingComponent,dragenterFiles,dropFiles,isScrolledToBottom,nextAnimationFrame,nextTick,pasteFiles,start,});return __exports;});;

/* /mail/static/tests/helpers/mock_models.js defined in bundle 'web.tests_assets' */
odoo.define('@mail/../tests/helpers/mock_models',async function(require){'use strict';let __exports={};const{datetime_to_str}=require('web.time');const MockModels=__exports.MockModels=class MockModels{static generateData(){return{'ir.attachment':{fields:{checksum:{string:'cheksum',type:'char'},create_date:{type:'date'},create_uid:{string:"Created By",type:"many2one",relation:'res.users'},datas:{string:"File Content (base64)",type:'binary'},mimetype:{string:"mimetype",type:'char'},name:{string:"attachment name",type:'char',required:true},res_id:{string:"res id",type:'integer'},res_model:{type:'char',string:"res model"},type:{type:'selection',selection:[['url',"URL"],['binary',"BINARY"]]},url:{string:'url',type:'char'},},records:[],},'mail.activity':{fields:{activity_category:{string:"Category",type:'selection',selection:[['default','Other'],['upload_file','Upload File']]},activity_type_id:{string:"Activity type",type:"many2one",relation:"mail.activity.type"},can_write:{string:"Can write",type:"boolean"},chaining_type:{string:'Chaining Type',type:'selection',selection:[['suggest','Suggest Next Activity'],['trigger','Trigger Next Activity']],default:'suggest'},create_uid:{string:"Created By",type:"many2one",relation:'res.users'},display_name:{string:"Display name",type:"char"},date_deadline:{string:"Due Date",type:"date",default(){return moment().format('YYYY-MM-DD');}},icon:{type:'char'},note:{string:"Note",type:"html"},res_id:{type:'integer'},res_model:{type:'char'},state:{string:'State',type:'selection',selection:[['overdue','Overdue'],['today','Today'],['planned','Planned']]},user_id:{string:"Assigned to",type:"many2one",relation:'res.users'},},records:[],},'mail.activity.type':{fields:{chaining_type:{string:'Chaining Type',type:'selection',selection:[['suggest','Suggest Next Activity'],['trigger','Trigger Next Activity']],default:'suggest'},category:{string:'Category',type:'selection',selection:[['default','Other'],['upload_file','Upload File']]},decoration_type:{string:"Decoration Type",type:"selection",selection:[['warning','Alert'],['danger','Error']]},icon:{string:'icon',type:"char"},name:{string:"Name",type:"char"},},records:[{icon:'fa-envelope',id:1,name:"Email"},],},'mail.channel':{fields:{avatarCacheKey:{string:"Avatar Cache Key",type:"datetime",default(){moment.utc().format("YYYYMMDDHHmmss");}},channel_type:{string:"Channel Type",type:"selection",default:'channel'},custom_channel_name:{string:"Custom channel name",type:'char'},fetched_message_id:{string:"Last Fetched",type:'many2one',relation:'mail.message'},group_based_subscription:{string:"Group based subscription",type:"boolean",default:false},id:{string:"Id",type:'integer'},is_minimized:{string:"isMinimized",type:"boolean",default:false},is_pinned:{string:"isPinned",type:"boolean",default:true},last_interest_dt:{string:"Last Interest",type:"datetime",default(){return datetime_to_str(new Date());}},members:{string:"Members",type:'many2many',relation:'res.partner',default(){return[this.currentPartnerId];}},message_unread_counter:{string:"# unread messages",type:'integer'},name:{string:"Name",type:"char",required:true},public:{string:"Public",type:"boolean",default:'groups'},seen_message_id:{string:"Last Seen",type:'many2one',relation:'mail.message'},state:{string:"FoldState",type:"char",default:'open'},uuid:{string:"UUID",type:"char",required:true,default(){return _.uniqueId('mail.channel_uuid-');}},},records:[],},'mail.followers':{fields:{email:{type:'char'},id:{type:'integer'},is_active:{type:'boolean'},is_editable:{type:'boolean'},name:{type:'char'},partner_id:{type:'integer'},res_id:{type:'many2one_reference'},res_model:{type:'char'},subtype_ids:{type:'many2many',relation:'mail.message.subtype'}},records:[],},'mail.message':{fields:{attachment_ids:{string:"Attachments",type:'many2many',relation:'ir.attachment',default:[]},author_id:{string:"Author",type:'many2one',relation:'res.partner',default(){return this.currentPartnerId;}},body:{string:"Contents",type:'html',default:"<p></p>"},date:{string:"Date",type:'datetime',default(){return moment.utc().format("YYYY-MM-DD HH:mm:ss");}},email_from:{string:"From",type:'char'},history_partner_ids:{string:"Partners with History",type:'many2many',relation:'res.partner'},id:{string:"Id",type:'integer'},is_discussion:{string:"Discussion",type:'boolean'},is_note:{string:"Note",type:'boolean'},is_notification:{string:"Notification",type:'boolean'},message_type:{string:"Type",type:'selection',default:'email'},model:{string:"Related Document model",type:'char'},needaction:{string:"Need Action",type:'boolean'},needaction_partner_ids:{string:"Partners with Need Action",type:'many2many',relation:'res.partner'},notification_ids:{string:"Notifications",type:'one2many',relation:'mail.notification'},partner_ids:{string:"Recipients",type:'many2many',relation:'res.partner'},record_name:{string:"Name",type:'char'},res_id:{string:"Related Document ID",type:'integer'},res_model_name:{string:"Res Model Name",type:'char'},starred_partner_ids:{string:"Favorited By",type:'many2many',relation:'res.partner'},subject:{string:"Subject",type:'char'},subtype_id:{string:"Subtype id",type:'many2one',relation:'mail.message.subtype'},tracking_value_ids:{relation:'mail.tracking.value',string:"Tracking values",type:'one2many'},},records:[],},'mail.message.subtype':{fields:{default:{type:'boolean',default:true},description:{type:'text'},hidden:{type:'boolean'},internal:{type:'boolean'},name:{type:'char'},parent_id:{type:'many2one',relation:'mail.message.subtype'},relation_field:{type:'char'},res_model:{type:'char'},sequence:{type:'integer',default:1},subtype_xmlid:{type:'char'},},records:[{name:"Discussions",sequence:0,subtype_xmlid:'mail.mt_comment'},{default:false,internal:true,name:"Note",sequence:100,subtype_xmlid:'mail.mt_note'},{default:false,internal:true,name:"Activities",sequence:90,subtype_xmlid:'mail.mt_activities'},],},'mail.notification':{fields:{failure_type:{string:"Failure Type",type:'selection',selection:[["SMTP","Connection failed (outgoing mail server problem)"],["RECIPIENT","Invalid email address"],["BOUNCE","Email address rejected by destination"],["UNKNOWN","Unknown error"]]},is_read:{string:"Is Read",type:'boolean',default:false},mail_message_id:{string:"Message",type:'many2one',relation:'mail.message'},notification_status:{string:"Notification Status",type:'selection',selection:[['ready','Ready to Send'],['sent','Sent'],['bounce','Bounced'],['exception','Exception'],['canceled','Canceled']],default:'ready'},notification_type:{string:"Notification Type",type:'selection',selection:[['email','Handle by Emails'],['inbox','Handle in Odoo']],default:'email'},res_partner_id:{string:"Needaction Recipient",type:'many2one',relation:'res.partner'},},records:[],},'mail.shortcode':{fields:{source:{type:'char'},substitution:{type:'char'},},records:[],},'mail.tracking.value':{fields:{changed_field:{string:'Changed field',type:'char'},field_type:{string:'Field type',type:'char'},new_value:{string:'New value',type:'char'},old_value:{string:'Old value',type:'char'},},records:[],},'res.users.settings':{fields:{is_discuss_sidebar_category_channel_open:{string:"Is Discuss Sidebar Category Channel Open?",type:'boolean',default:true},is_discuss_sidebar_category_chat_open:{string:"Is Discuss Sidebar Category Chat Open?",type:'boolean',default:true},user_id:{string:"User Id",type:'many2one',relation:'res.users'},},records:[],},'res.country':{fields:{code:{string:"Code",type:'char'},name:{string:"Name",type:'char'},},records:[],},'res.partner':{fields:{active:{string:"Active",type:'boolean',default:true},activity_ids:{string:"Activities",type:'one2many',relation:'mail.activity'},contact_address_complete:{string:"Address",type:'char'},country_id:{string:"Country",type:'many2one',relation:'res.country'},description:{string:'description',type:'text'},display_name:{string:"Displayed name",type:"char"},email:{type:'char'},avatar_128:{string:"Image 128",type:'image'},im_status:{string:"IM Status",type:'char'},message_follower_ids:{relation:'mail.followers',string:"Followers",type:"one2many"},message_attachment_count:{string:'Attachment count',type:'integer'},message_ids:{string:"Messages",type:'one2many',relation:'mail.message'},name:{string:"Name",type:'char'},partner_latitude:{string:"Latitude",type:'float'},partner_longitude:{string:"Longitude",type:'float'},partner_share:{string:"Share Partner",type:'boolean',default:false},user_ids:{string:"Users",type:"one2many",relation:'res.users',default:[]},},records:[],},'res.users':{fields:{active:{string:"Active",type:'boolean',default:true},display_name:{string:"Display name",type:"char"},im_status:{string:"IM Status",type:'char'},name:{string:"Name",type:'char'},partner_id:{string:"Related partners",type:'many2one',relation:'res.partner'},share:{string:"Shared users",type:'boolean',default:false},},records:[],},'res.fake':{fields:{activity_ids:{string:"Activities",type:'one2many',relation:'mail.activity'},email_cc:{type:'char'},partner_ids:{string:"Related partners",type:'one2many',relation:'res.partner'},},records:[],},};}}
return __exports;});;

/* /mail/static/tests/helpers/mock_server.js defined in bundle 'web.tests_assets' */
odoo.define('@mail/../tests/helpers/mock_server',async function(require){'use strict';let __exports={};const{nextAnimationFrame}=require('@mail/utils/test_utils');const MockServer=require('web.MockServer');const{datetime_to_str}=require('web.time');MockServer.include({init(data,options){if(data&&data.currentPartnerId){this.currentPartnerId=data.currentPartnerId;delete data.currentPartnerId;}
if(data&&data.currentUserId){this.currentUserId=data.currentUserId;delete data.currentUserId;}
if(data&&data.partnerRootId){this.partnerRootId=data.partnerRootId;delete data.partnerRootId;}
if(data&&data.publicPartnerId){this.publicPartnerId=data.publicPartnerId;delete data.publicPartnerId;}
if(data&&data.publicUserId){this.publicUserId=data.publicUserId;delete data.publicUserId;}
this._widget=options.widget;this._super(...arguments);},async _performFetch(resource,init){if(resource==='/mail/attachment/upload'){const ufile=init.body.get('ufile');const is_pending=init.body.get('is_pending')==='true';const model=is_pending?'mail.compose.message':init.body.get('thread_model');const id=is_pending?0:parseInt(init.body.get('thread_id'));const attachmentId=this._mockCreate('ir.attachment',{mimetype:ufile.type,name:ufile.name,res_id:id,res_model:model,});const attachment=this._getRecords('ir.attachment',[['id','=',attachmentId]])[0];return new window.Response(JSON.stringify({'filename':attachment.name,'id':attachment.id,'mimetype':attachment.mimetype,'size':attachment.file_size}));}
return this._super(...arguments);},async _performRpc(route,args){if(route==='/mail/message/post'){const finalData={};for(const allowedField of['attachment_ids','body','message_type','partner_ids','subtype_xmlid','parent_id']){if(args.post_data[allowedField]!==undefined){finalData[allowedField]=args.post_data[allowedField];}}
if(args.thread_model==='mail.channel'){return this._mockMailChannelMessagePost(args.thread_id,finalData,args.context);}
return this._mockMailThreadMessagePost(args.thread_model,[args.thread_id],finalData,args.context);}
if(route==='/mail/attachment/delete'){const{attachment_id}=args;return this._mockRouteMailAttachmentRemove(attachment_id);}
if(route==='/mail/chat_post'){const uuid=args.uuid;const message_content=args.message_content;const context=args.context;return this._mockRouteMailChatPost(uuid,message_content,context);}
if(route==='/mail/get_suggested_recipients'){const model=args.model;const res_ids=args.res_ids;return this._mockRouteMailGetSuggestedRecipient(model,res_ids);}
if(route==='/mail/init_messaging'){return this._mockRouteMailInitMessaging();}
if(route==='/mail/load_message_failures'){return this._mockRouteMailLoadMessageFailures();}
if(route==='/mail/history/messages'){const{min_id,max_id,limit}=args;return this._mockRouteMailMessageHistory(min_id,max_id,limit);}
if(route==='/mail/inbox/messages'){const{min_id,max_id,limit}=args;return this._mockRouteMailMessageInbox(min_id,max_id,limit);}
if(route==='/mail/starred/messages'){const{min_id,max_id,limit}=args;return this._mockRouteMailMessageStarredMessages(min_id,max_id,limit);}
if(route==='/mail/read_followers'){return this._mockRouteMailReadFollowers(args);}
if(route==='/mail/read_subscription_data'){const follower_id=args.follower_id;return this._mockRouteMailReadSubscriptionData(follower_id);}
if(route==='/mail/thread/data'){return this._mockRouteMailThreadData(args.thread_model,args.thread_id,args.request_list);}
if(route==='/mail/thread/messages'){const{min_id,max_id,limit,thread_model,thread_id}=args;return this._mockRouteMailThreadFetchMessages(thread_model,thread_id,max_id,min_id,limit);}
if(route==='/mail/channel/messages'){const{channel_id,min_id,max_id,limit}=args;return this._mockRouteMailChannelMessages(channel_id,max_id,min_id,limit);}
if(new RegExp('/mail/channel/\\d+/partner/\\d+/avatar_128').test(route)){return;}
if(args.model==='mail.activity'&&args.method==='activity_format'){let res=this._mockRead(args.model,args.args,args.kwargs);res=res.map(function(record){if(record.mail_template_ids){record.mail_template_ids=record.mail_template_ids.map(function(template_id){return{id:template_id,name:"template"+template_id};});}
return record;});return res;}
if(args.model==='mail.activity'&&args.method==='get_activity_data'){const res_model=args.args[0]||args.kwargs.res_model;const domain=args.args[1]||args.kwargs.domain;return this._mockMailActivityGetActivityData(res_model,domain);}
if(args.model==='mail.channel'&&args.method==='action_unfollow'){const ids=args.args[0];return this._mockMailChannelActionUnfollow(ids);}
if(args.model==='mail.channel'&&args.method==='channel_fetched'){const ids=args.args[0];return this._mockMailChannelChannelFetched(ids);}
if(args.model==='mail.channel'&&args.method==='channel_fetch_listeners'){return[];}
if(args.model==='mail.channel'&&args.method==='channel_fetch_preview'){const ids=args.args[0];return this._mockMailChannelChannelFetchPreview(ids);}
if(args.model==='mail.channel'&&args.method==='channel_fold'){const uuid=args.args[0]||args.kwargs.uuid;const state=args.args[1]||args.kwargs.state;return this._mockMailChannelChannelFold(uuid,state);}
if(args.model==='mail.channel'&&args.method==='channel_get'){const partners_to=args.args[0]||args.kwargs.partners_to;const pin=args.args[1]!==undefined?args.args[1]:args.kwargs.pin!==undefined?args.kwargs.pin:undefined;return this._mockMailChannelChannelGet(partners_to,pin);}
if(args.model==='mail.channel'&&args.method==='channel_info'){const ids=args.args[0];return this._mockMailChannelChannelInfo(ids);}
if(args.model==='mail.channel'&&args.method==='add_members'){const ids=args.args[0];const partner_ids=args.args[1]||args.kwargs.partner_ids;return this._mockMailChannelAddMembers(ids,partner_ids);}
if(args.model==='mail.channel'&&args.method==='channel_pin'){const uuid=args.args[0]||args.kwargs.uuid;const pinned=args.args[1]||args.kwargs.pinned;return this._mockMailChannelChannelPin(uuid,pinned);}
if(args.model==='mail.channel'&&args.method==='channel_rename'){const ids=args.args[0];const name=args.args[1]||args.kwargs.name;return this._mockMailChannelChannelRename(ids,name);}
if(route==='/mail/channel/set_last_seen_message'){const id=args.channel_id;const last_message_id=args.last_message_id;return this._mockMailChannel_ChannelSeen([id],last_message_id);}
if(args.model==='mail.channel'&&args.method==='channel_set_custom_name'){const ids=args.args[0];const name=args.args[1]||args.kwargs.name;return this._mockMailChannelChannelSetCustomName(ids,name);}
if(args.model==='mail.channel'&&args.method==='create_group'){const partners_to=args.args[0]||args.kwargs.partners_to;return this._mockMailChannelCreateGroup(partners_to);}
if(args.model==='mail.channel'&&args.method==='execute_command_leave'){return this._mockMailChannelExecuteCommandLeave(args);}
if(args.model==='mail.channel'&&args.method==='execute_command_who'){return this._mockMailChannelExecuteCommandWho(args);}
if(args.model==='mail.channel'&&args.method==='notify_typing'){const ids=args.args[0];const is_typing=args.args[1]||args.kwargs.is_typing;const context=args.kwargs.context;return this._mockMailChannelNotifyTyping(ids,is_typing,context);}
if(args.model==='mail.channel'&&args.method==='write'&&'image_128'in args.args[1]){const ids=args.args[0];return this._mockMailChannelWriteImage128(ids[0]);}
if(args.model==='mail.message'&&args.method==='mark_all_as_read'){const domain=args.args[0]||args.kwargs.domain;return this._mockMailMessageMarkAllAsRead(domain);}
if(args.model==='mail.message'&&args.method==='message_format'){const ids=args.args[0];return this._mockMailMessageMessageFormat(ids);}
if(args.model==='mail.message'&&args.method==='set_message_done'){const ids=args.args[0];return this._mockMailMessageSetMessageDone(ids);}
if(args.model==='mail.message'&&args.method==='toggle_message_starred'){const ids=args.args[0];return this._mockMailMessageToggleMessageStarred(ids);}
if(args.model==='mail.message'&&args.method==='unstar_all'){return this._mockMailMessageUnstarAll();}
if(args.model==='res.users.settings'&&args.method==='_find_or_create_for_user'){const user_id=args.args[0][0];return this._mockResUsersSettings_FindOrCreateForUser(user_id);}
if(args.model==='res.users.settings'&&args.method==='set_res_users_settings'){const id=args.args[0][0];const newSettings=args.kwargs.new_settings;return this._mockResUsersSettingsSetResUsersSettings(id,newSettings);}
if(args.method==='get_mention_suggestions'){if(args.model==='mail.channel'){return this._mockMailChannelGetMentionSuggestions(args);}
if(args.model==='res.partner'){return this._mockResPartnerGetMentionSuggestions(args);}}
if(args.model==='res.partner'&&args.method==='im_search'){const name=args.args[0]||args.kwargs.search;const limit=args.args[1]||args.kwargs.limit;return this._mockResPartnerImSearch(name,limit);}
if(args.model==='res.partner'&&args.method==='search_for_channel_invite'){const search_term=args.args[0]||args.kwargs.search_term;const channel_id=args.args[1]||args.kwargs.channel_id;const limit=args.args[2]||args.kwargs.limit;return this._mockResPartnerSearchForChannelInvite(search_term,channel_id,limit);}
if(args.method==='message_subscribe'){const ids=args.args[0];const partner_ids=args.args[1]||args.kwargs.partner_ids;const subtype_ids=args.args[2]||args.kwargs.subtype_ids;return this._mockMailThreadMessageSubscribe(args.model,ids,partner_ids,subtype_ids);}
if(args.method==='message_unsubscribe'){const ids=args.args[0];const partner_ids=args.args[1]||args.kwargs.partner_ids;return this._mockMailThreadMessageUnsubscribe(args.model,ids,partner_ids);}
if(args.method==='message_post'){const id=args.args[0];const kwargs=args.kwargs;const context=kwargs.context;delete kwargs.context;return this._mockMailThreadMessagePost(args.model,[id],kwargs,context);}
return this._super(route,args);},async _mockRouteMailAttachmentRemove(attachment_id){return this._mockUnlink('ir.attachment',[[attachment_id]]);},async _mockRouteMailChannelMessages(channel_id,max_id=false,min_id=false,limit=30){const domain=[['res_id','=',channel_id],['model','=','mail.channel'],['message_type','!=','user_notification'],];return this._mockMailMessage_MessageFetch(domain,max_id,min_id,limit);},async _mockRouteMailChatPost(uuid,message_content,context={}){const mailChannel=this._getRecords('mail.channel',[['uuid','=',uuid]])[0];if(!mailChannel){return false;}
let user_id;if('mockedUserId'in context){user_id=context.mockedUserId;}else{user_id=this.currentUserId;}
let author_id;let email_from;if(user_id){const author=this._getRecords('res.users',[['id','=',user_id]])[0];author_id=author.partner_id;email_from=`${author.display_name} <${author.email}>`;}else{author_id=false;email_from=mailChannel.anonymous_name||"catchall@example.com";}
const body=message_content;return this._mockMailChannelMessagePost(mailChannel.id,{author_id,email_from,body,message_type:'comment',subtype_xmlid:'mail.mt_comment',},context);},_mockRouteMailGetSuggestedRecipient(model,res_ids){if(model==='res.fake'){return this._mockResFake_MessageGetSuggestedRecipients(model,res_ids);}
return this._mockMailThread_MessageGetSuggestedRecipients(model,res_ids);},_mockRouteMailInitMessaging(){return this._mockResUsers_InitMessaging([this.currentUserId]);},_mockRouteMailLoadMessageFailures(){return this._mockResPartner_MessageFetchFailed(this.currentPartnerId);},_mockRouteMailMessageHistory(min_id=false,max_id=false,limit=30){const domain=[['needaction','=',false]];return this._mockMailMessage_MessageFetch(domain,max_id,min_id,limit);},_mockRouteMailMessageInbox(min_id=false,max_id=false,limit=30){const domain=[['needaction','=',true]];return this._mockMailMessage_MessageFetch(domain,max_id,min_id,limit);},_mockRouteMailMessageStarredMessages(min_id=false,max_id=false,limit=30){const domain=[['starred_partner_ids','in',[this.currentPartnerId]]];return this._mockMailMessage_MessageFetch(domain,max_id,min_id,limit);},async _mockRouteMailReadFollowers(args){const res_id=args.res_id;const res_model=args.res_model;const followers=this._getRecords('mail.followers',[['res_id','=',res_id],['res_model','=',res_model]]);const currentPartnerFollower=followers.find(follower=>follower.id===this.currentPartnerId);const subtypes=currentPartnerFollower?this._mockRouteMailReadSubscriptionData(currentPartnerFollower.id):false;return{followers,subtypes};},async _mockRouteMailReadSubscriptionData(follower_id){const follower=this._getRecords('mail.followers',[['id','=',follower_id]])[0];const subtypes=this._getRecords('mail.message.subtype',['&',['hidden','=',false],'|',['res_model','=',follower.res_model],['res_model','=',false],]);const subtypes_list=subtypes.map(subtype=>{const parent=this._getRecords('mail.message.subtype',[['id','=',subtype.parent_id],])[0];return{'default':subtype.default,'followed':follower.subtype_ids.includes(subtype.id),'id':subtype.id,'internal':subtype.internal,'name':subtype.name,'parent_model':parent?parent.res_model:false,'res_model':subtype.res_model,'sequence':subtype.sequence,};});return subtypes_list;},async _mockRouteMailThreadData(thread_model,thread_id,request_list){const res={};const thread=this._mockSearchRead(thread_model,[[['id','=',thread_id]]],{})[0];if(request_list.includes('attachments')){const attachments=this._mockSearchRead('ir.attachment',[[['res_id','=',thread.id],['res_model','=',thread_model]],],{});res['attachments']=this._mockIrAttachment_attachmentFormat(attachments.map(attachment=>attachment.id),true);}
return res;},async _mockRouteMailThreadFetchMessages(res_model,res_id,max_id=false,min_id=false,limit=30){const domain=[['res_id','=',res_id],['model','=',res_model],['message_type','!=','user_notification'],];return this._mockMailMessage_MessageFetch(domain,max_id,min_id,limit);},_mockIrAttachment_attachmentFormat(ids,commands=false){const attachments=this._mockRead('ir.attachment',[ids]);return attachments.map(attachment=>{const res={'checksum':attachment.checksum,'filename':attachment.name,'id':attachment.id,'mimetype':attachment.mimetype,'name':attachment.name,};if(commands){res['originThread']=[['insert',{'id':attachment.res_id,'model':attachment.res_model,}]];}else{Object.assign(res,{'res_id':attachment.res_id,'res_model':attachment.res_model,});}
return res;});},_mockMailActivityGetActivityData(res_model,domain){const self=this;const records=this._getRecords(res_model,domain);const activityTypes=this._getRecords('mail.activity.type',[]);const activityIds=_.pluck(records,'activity_ids').flat();const groupedActivities={};const resIdToDeadline={};const groups=self._mockReadGroup('mail.activity',{domain:[['id','in',activityIds]],fields:['res_id','activity_type_id','ids:array_agg(id)','date_deadline:min(date_deadline)'],groupby:['res_id','activity_type_id'],lazy:false,});groups.forEach(function(group){const activites=self._getRecords('mail.activity',group.__domain);group.activity_type_id=group.activity_type_id[0];let minDate;activites.forEach(function(activity){if(!minDate||moment(activity.date_deadline)<moment(minDate)){minDate=activity.date_deadline;}});group.date_deadline=minDate;resIdToDeadline[group.res_id]=minDate;let state;if(group.date_deadline===moment().format("YYYY-MM-DD")){state='today';}else if(moment(group.date_deadline)>moment()){state='planned';}else{state='overdue';}
if(!groupedActivities[group.res_id]){groupedActivities[group.res_id]={};}
groupedActivities[group.res_id][group.activity_type_id]={count:group.__count,state:state,o_closest_deadline:group.date_deadline,ids:_.pluck(activites,'id'),};});return{activity_types:activityTypes.map(function(type){let mailTemplates=[];if(type.mail_template_ids){mailTemplates=type.mail_template_ids.map(function(id){const template=_.findWhere(self.data['mail.template'].records,{id:id});return{id:id,name:template.name,};});}
return[type.id,type.display_name,mailTemplates];}),activity_res_ids:_.sortBy(_.pluck(records,'id'),function(id){return moment(resIdToDeadline[id]);}),grouped_activities:groupedActivities,};},_mockMailChannelActionUnfollow(ids){const channel=this._getRecords('mail.channel',[['id','in',ids]])[0];if(!channel.members.includes(this.currentPartnerId)){return true;}
this._mockWrite('mail.channel',[[channel.id],{is_pinned:false,members:[[3,this.currentPartnerId]],},]);this._widget.call('bus_service','trigger','notification',[{type:'mail.channel/leave',payload:{id:channel.id,},}]);return true;},_mockMailChannelAddMembers(ids,partner_ids){const id=ids[0];const channel=this._getRecords('mail.channel',[['id','=',id]])[0];if(!channel.is_pinned){this._mockWrite('mail.channel',[[channel.id],{is_pinned:true},]);const body=`<div class="o_mail_notification">joined <a href="#" class="o_channel_redirect" data-oe-id="${channel.id}">#${channel.name}</a></div>`;const message_type="notification";const subtype_xmlid="mail.mt_comment";this._mockMailChannelMessagePost([channel.id],{body,message_type,subtype_xmlid},);}
this._widget.call('bus_service','trigger','notification',[{type:'mail.channel/joined',payload:{'channel':this._mockMailChannelChannelInfo([channel.id])[0],'invited_by_user_id':this.currentUserId,},}]);},_mockMailChannel_broadcast(ids,partner_ids){const notifications=this._mockMailChannel_channelChannelNotifications(ids,partner_ids);this._widget.call('bus_service','trigger','notification',notifications);},_mockMailChannel_channelChannelNotifications(ids,partner_ids){const notifications=[];for(const partner_id of partner_ids){const user=this._getRecords('res.users',[['partner_id','in',partner_id]])[0];if(!user){continue;}
const channelInfos=this._mockMailChannelChannelInfo(ids);for(const channelInfo of channelInfos){notifications.push({type:'mail.channel/legacy_insert',payload:{id:channelInfo.id,state:channelInfo.is_minimized?'open':'closed',},});}}
return notifications;},_mockMailChannelChannelFetched(ids){const channels=this._getRecords('mail.channel',[['id','in',ids]]);for(const channel of channels){const channelMessages=this._getRecords('mail.message',[['model','=','mail.channel'],['res_id','=',channel.id],]);const lastMessage=channelMessages.reduce((lastMessage,message)=>{if(message.id>lastMessage.id){return message;}
return lastMessage;},channelMessages[0]);if(!lastMessage){continue;}
this._mockWrite('mail.channel',[[channel.id],{fetched_message_id:lastMessage.id},]);this._widget.call('bus_service','trigger','notification',[{type:'mail.channel.partner/fetched',payload:{channel_id:channel.id,id:`${channel.id}/${this.currentPartnerId}`,last_message_id:lastMessage.id,partner_id:this.currentPartnerId,},}]);}},_mockMailChannelChannelFetchPreview(ids){const channels=this._getRecords('mail.channel',[['id','in',ids]]);return channels.map(channel=>{const channelMessages=this._getRecords('mail.message',[['model','=','mail.channel'],['res_id','=',channel.id],]);const lastMessage=channelMessages.reduce((lastMessage,message)=>{if(message.id>lastMessage.id){return message;}
return lastMessage;},channelMessages[0]);return{id:channel.id,last_message:lastMessage?this._mockMailMessageMessageFormat([lastMessage.id])[0]:false,};});},_mockMailChannelChannelFold(uuid,state){const channel=this._getRecords('mail.channel',[['uuid','=',uuid]])[0];this._mockWrite('mail.channel',[[channel.id],{is_minimized:state!=='closed',state,}]);const channelInfo=this._mockMailChannelChannelInfo([channel.id])[0];this._widget.call('bus_service','trigger','notification',[{type:'mail.channel/insert',payload:{id:channelInfo.id,serverFoldState:channelInfo.is_minimized?'open':'closed',},}]);},_mockMailChannelChannelGet(partners_to=[],pin=true){if(partners_to.length===0){return false;}
if(!partners_to.includes(this.currentPartnerId)){partners_to.push(this.currentPartnerId);}
const partners=this._getRecords('res.partner',[['id','in',partners_to]]);const id=this._mockCreate('mail.channel',{channel_type:'chat',is_minimized:true,is_pinned:true,last_interest_dt:datetime_to_str(new Date()),members:[[6,0,partners_to]],name:partners.map(partner=>partner.name).join(", "),public:'private',state:'open',});return this._mockMailChannelChannelInfo([id])[0];},_mockMailChannelChannelInfo(ids){const channels=this._getRecords('mail.channel',[['id','in',ids]]);const all_partners=[...new Set(channels.reduce((all_partners,channel)=>{return[...all_partners,...channel.members];},[]))];const direct_partners=[...new Set(channels.reduce((all_partners,channel)=>{if(channel.channel_type==='chat'){return[...all_partners,...channel.members];}
return all_partners;},[]))];const partnerInfos=this._mockMailChannelPartnerInfo(all_partners,direct_partners);return channels.map(channel=>{const members=channel.members.map(partnerId=>partnerInfos[partnerId]);const messages=this._getRecords('mail.message',[['model','=','mail.channel'],['res_id','=',channel.id],]);const lastMessageId=messages.reduce((lastMessageId,message)=>{if(!lastMessageId||message.id>lastMessageId){return message.id;}
return lastMessageId;},undefined);const messageNeedactionCounter=this._getRecords('mail.notification',[['res_partner_id','=',this.currentPartnerId],['is_read','=',false],['mail_message_id','in',messages.map(message=>message.id)],]).length;const res=Object.assign({},channel,{last_message_id:lastMessageId,members,message_needaction_counter:messageNeedactionCounter,});if(channel.channel_type==='channel'){delete res.members;}else{res['seen_partners_info']=[{partner_id:this.currentPartnerId,seen_message_id:channel.seen_message_id,fetched_message_id:channel.fetched_message_id,}];}
return res;});},async _mockMailChannelChannelPin(uuid,pinned=false){const channel=this._getRecords('mail.channel',[['uuid','=',uuid]])[0];this._mockWrite('mail.channel',[[channel.id],{is_pinned:false},]);if(!pinned){this._widget.call('bus_service','trigger','notification',[{type:'mail.channel/unpin',payload:{id:channel.id},}]);}else{this._widget.call('bus_service','trigger','notification',[{type:'mail.channel/legacy_insert',payload:this._mockMailChannelChannelInfo([channel.id])[0],}]);}},async _mockMailChannel_ChannelSeen(ids,last_message_id){const channel_id=ids[0];if(!channel_id){throw new Error('Should only be one channel in channel_seen mock params');}
const channel=this._getRecords('mail.channel',[['id','=',channel_id]])[0];const messagesBeforeGivenLastMessage=this._getRecords('mail.message',[['id','<=',last_message_id],['model','=','mail.channel'],['res_id','=',channel.id],]);if(!messagesBeforeGivenLastMessage||messagesBeforeGivenLastMessage.length===0){return;}
if(!channel){return;}
if(channel.seen_message_id&&channel.seen_message_id>=last_message_id){return;}
this._mockMailChannel_SetLastSeenMessage([channel.id],last_message_id);this._widget.call('bus_service','trigger','notification',[{type:'mail.channel.partner/seen',payload:{channel_id:channel.id,last_message_id,partner_id:this.currentPartnerId,},}]);},_mockMailChannelChannelRename(ids,name){const channel=this._getRecords('mail.channel',[['id','in',ids]])[0];this._mockWrite('mail.channel',[[channel.id],{name},]);this._widget.call('bus_service','trigger','notification',[{type:'mail.channel/insert',payload:{id:channel.id,name,},}]);},_mockMailChannelChannelSetCustomName(ids,name){const channel=this._getRecords('mail.channel',[['id','in',ids]])[0];this._mockWrite('mail.channel',[[channel.id],{custom_channel_name:name},]);this._widget.call('bus_service','trigger','notification',[{type:'mail.channel/insert',payload:{id:channel.id,custom_channel_name:name,},}]);},async _mockMailChannelCreateGroup(partners_to){const partners=this._getRecords('res.partner',[['id','in',partners_to]]);const id=this._mockCreate('mail.channel',{channel_type:'group',is_pinned:true,members:[[6,0,partners.map(partner=>partner.id)]],name:'',public:'private',state:'open',});this._mockMailChannel_broadcast(id,partners.map(partner=>partner.id));return this._mockMailChannelChannelInfo([id])[0];},_mockMailChannelExecuteCommandLeave(args){const channel=this._getRecords('mail.channel',[['id','in',args.args[0]]])[0];if(channel.channel_type==='channel'){this._mockMailChannelActionUnfollow([channel.id]);}else{this._mockMailChannelChannelPin(channel.uuid,false);}},_mockMailChannelExecuteCommandWho(args){const ids=args.args[0];const channels=this._getRecords('mail.channel',[['id','in',ids]]);for(const channel of channels){const members=channel.members.map(memberId=>this._getRecords('res.partner',[['id','=',memberId]])[0].name);let message="You are alone in this channel.";if(members.length>0){message=`Users in this channel: ${members.join(', ')} and you`;}
this._widget.call('bus_service','trigger','notification',[{type:'mail.channel/transient_message',payload:{'body':`<span class="o_mail_notification">${message}</span>`,'model':'mail.channel','res_id':channel.id,}}]);}},_mockMailChannelGetMentionSuggestions(args){const search=args.kwargs.search||'';const limit=args.kwargs.limit||8;const mentionSuggestionsFilter=function(channels,search,limit){const matchingChannels=channels.filter(channel=>{if(!search){return true;}
if(channel.name&&channel.name.includes(search)){return true;}
return false;}).map(channel=>{return{id:channel.id,name:channel.name,public:channel.public,};});matchingChannels.length=Math.min(matchingChannels.length,limit);return matchingChannels;};const mentionSuggestions=mentionSuggestionsFilter(this.data['mail.channel'].records,search,limit);return mentionSuggestions;},_mockMailChannelWriteImage128(id){this._mockWrite('mail.channel',[[id],{avatarCacheKey:moment.utc().format("YYYYMMDDHHmmss"),},]);const avatarCacheKey=this._getRecords('mail.channel',[['id','=',id]])[0].avatarCacheKey;this._widget.call('bus_service','trigger','notification',[{type:'mail.channel/insert',payload:{id,avatarCacheKey:avatarCacheKey,},}]);},_mockMailChannelMessagePost(id,kwargs,context){const message_type=kwargs.message_type||'notification';const channel=this._getRecords('mail.channel',[['id','=',id]])[0];if(channel.channel_type!=='channel'){this._mockWrite('mail.channel',[[channel.id],{last_interest_dt:datetime_to_str(new Date()),is_pinned:true,},]);}
const messageData=this._mockMailThreadMessagePost('mail.channel',[id],Object.assign(kwargs,{message_type,}),context,);if(kwargs.author_id===this.currentPartnerId){this._mockMailChannel_SetLastSeenMessage([channel.id],messageData.id);}else{this._mockWrite('mail.channel',[[channel.id],{message_unread_counter:(channel.message_unread_counter||0)+1},]);}
return messageData;},_mockMailChannelNotifyTyping(ids,is_typing,context={}){const channels=this._getRecords('mail.channel',[['id','in',ids]]);let partner_id;if('mockedPartnerId'in context){partner_id=context.mockedPartnerId;}else{partner_id=this.currentPartnerId;}
const partner=this._getRecords('res.partner',[['id','=',partner_id]]);const notifications=[];for(const channel of channels){const data={type:'mail.channel.partner/typing_status',payload:{channel_id:channel.id,is_typing:is_typing,partner_id:partner_id,partner_name:partner.name,},};notifications.push([data]);}
this._widget.call('bus_service','trigger','notification',notifications);},_mockMailChannelPartnerInfo(all_partners,direct_partners){const partners=this._getRecords('res.partner',[['id','in',all_partners]],{active_test:false},);const partnerInfos={};for(const partner of partners){const partnerInfo={email:partner.email,id:partner.id,name:partner.name,};if(direct_partners.includes(partner.id)){partnerInfo.im_status=partner.im_status;}
partnerInfos[partner.id]=partnerInfo;}
return partnerInfos;},_mockMailChannel_SetLastSeenMessage(ids,message_id){this._mockWrite('mail.channel',[ids,{fetched_message_id:message_id,seen_message_id:message_id,}]);},_mockMailMessageMarkAllAsRead(domain){const notifDomain=[['res_partner_id','=',this.currentPartnerId],['is_read','=',false],];if(domain){const messages=this._getRecords('mail.message',domain);const ids=messages.map(messages=>messages.id);this._mockMailMessageSetMessageDone(ids);return ids;}
const notifications=this._getRecords('mail.notification',notifDomain);this._mockWrite('mail.notification',[notifications.map(notification=>notification.id),{is_read:true},]);const messageIds=[];for(const notification of notifications){if(!messageIds.includes(notification.mail_message_id)){messageIds.push(notification.mail_message_id);}}
const messages=this._getRecords('mail.message',[['id','in',messageIds]]);for(const message of messages){this._mockWrite('mail.message',[[message.id],{needaction:false,needaction_partner_ids:message.needaction_partner_ids.filter(partnerId=>partnerId!==this.currentPartnerId),},]);}
this._widget.call('bus_service','trigger','notification',[{type:'mail.message/mark_as_read',payload:{message_ids:messageIds,needaction_inbox_counter:this._mockResPartner_GetNeedactionCount(this.currentPartnerId),},}]);return messageIds;},async _mockMailMessage_MessageFetch(domain,max_id,min_id,limit=30){await nextAnimationFrame();if(max_id){domain.push(['id','<',max_id]);}
if(min_id){domain.push(['id','>',min_id]);}
let messages=this._getRecords('mail.message',domain);messages.sort(function(m1,m2){return m1.id<m2.id?1:-1;});messages.length=Math.min(messages.length,limit);return this._mockMailMessageMessageFormat(messages.map(message=>message.id));},_mockMailMessageMessageFormat(ids){const messages=this._getRecords('mail.message',[['id','in',ids]]);messages.sort(function(m1,m2){return m1.id<m2.id?1:-1;});return messages.map(message=>{const thread=message.model&&this._getRecords(message.model,[['id','=',message.res_id],])[0];let formattedAuthor;if(message.author_id){const author=this._getRecords('res.partner',[['id','=',message.author_id]],{active_test:false})[0];formattedAuthor=[author.id,author.display_name];}else{formattedAuthor=[0,message.email_from];}
const attachments=this._getRecords('ir.attachment',[['id','in',message.attachment_ids],]);const formattedAttachments=attachments.map(attachment=>{return Object.assign({'checksum':attachment.checksum,'id':attachment.id,'filename':attachment.name,'name':attachment.name,'mimetype':attachment.mimetype,'is_main':thread&&thread.message_main_attachment_id===attachment.id,'res_id':attachment.res_id||messages.res_id,'res_model':attachment.res_model||message.model,});});const allNotifications=this._getRecords('mail.notification',[['mail_message_id','=',message.id],]);const historyPartnerIds=allNotifications.filter(notification=>notification.is_read).map(notification=>notification.res_partner_id);const needactionPartnerIds=allNotifications.filter(notification=>!notification.is_read).map(notification=>notification.res_partner_id);let notifications=this._mockMailNotification_FilteredForWebClient(allNotifications.map(notification=>notification.id));notifications=this._mockMailNotification_NotificationFormat(notifications.map(notification=>notification.id));const trackingValueIds=this._getRecords('mail.tracking.value',[['id','in',message.tracking_value_ids],]);const partners=this._getRecords('res.partner',[['id','in',message.partner_ids]],);const response=Object.assign({},message,{attachment_ids:formattedAttachments,author_id:formattedAuthor,history_partner_ids:historyPartnerIds,needaction_partner_ids:needactionPartnerIds,notifications,recipients:partners.map(p=>({id:p.id,name:p.name})),tracking_value_ids:trackingValueIds,});if(message.subtype_id){const subtype=this._getRecords('mail.message.subtype',[['id','=',message.subtype_id],])[0];response.subtype_description=subtype.description;}
return response;});},_mockMailMessage_MessageNotificationFormat(ids){const messages=this._getRecords('mail.message',[['id','in',ids]]);return messages.map(message=>{let notifications=this._getRecords('mail.notification',[['mail_message_id','=',message.id],]);notifications=this._mockMailNotification_FilteredForWebClient(notifications.map(notification=>notification.id));notifications=this._mockMailNotification_NotificationFormat(notifications.map(notification=>notification.id));return{'date':message.date,'id':message.id,'message_type':message.message_type,'model':message.model,'notifications':notifications,'res_id':message.res_id,'res_model_name':message.res_model_name,};});},_mockMailMessageSetMessageDone(ids){const messages=this._getRecords('mail.message',[['id','in',ids]]);const notifications=this._getRecords('mail.notification',[['res_partner_id','=',this.currentPartnerId],['is_read','=',false],['mail_message_id','in',messages.map(messages=>messages.id)]]);this._mockWrite('mail.notification',[notifications.map(notification=>notification.id),{is_read:true},]);for(const message of messages){this._mockWrite('mail.message',[[message.id],{needaction:false,needaction_partner_ids:message.needaction_partner_ids.filter(partnerId=>partnerId!==this.currentPartnerId),},]);this._widget.call('bus_service','trigger','notification',[{type:'mail.message/mark_as_read',payload:{message_ids:[message.id],needaction_inbox_counter:this._mockResPartner_GetNeedactionCount(this.currentPartnerId),},}]);}},_mockMailMessageToggleMessageStarred(ids){const messages=this._getRecords('mail.message',[['id','in',ids]]);for(const message of messages){const wasStared=message.starred_partner_ids.includes(this.currentPartnerId);this._mockWrite('mail.message',[[message.id],{starred_partner_ids:[[wasStared?3:4,this.currentPartnerId]]}]);this._widget.call('bus_service','trigger','notification',[{type:'mail.message/toggle_star',payload:{message_ids:[message.id],starred:!wasStared,},}]);}},_mockMailMessageUnstarAll(){const messages=this._getRecords('mail.message',[['starred_partner_ids','in',this.currentPartnerId],]);this._mockWrite('mail.message',[messages.map(message=>message.id),{starred_partner_ids:[[3,this.currentPartnerId]]}]);this._widget.call('bus_service','trigger','notification',[{type:'mail.message/toggle_star',payload:{message_ids:messages.map(message=>message.id),starred:false,},}]);},_mockMailNotification_FilteredForWebClient(ids){const notifications=this._getRecords('mail.notification',[['id','in',ids],['notification_type','!=','inbox'],]);return notifications.filter(notification=>{const partner=this._getRecords('res.partner',[['id','=',notification.res_partner_id]])[0];return Boolean(['bounce','exception','canceled'].includes(notification.notification_status)||(partner&&partner.partner_share));});},_mockMailNotification_NotificationFormat(ids){const notifications=this._getRecords('mail.notification',[['id','in',ids]]);return notifications.map(notification=>{const partner=this._getRecords('res.partner',[['id','=',notification.res_partner_id]])[0];return{'id':notification.id,'notification_type':notification.notification_type,'notification_status':notification.notification_status,'failure_type':notification.failure_type,'res_partner_id':partner?[partner&&partner.id,partner&&partner.display_name]:undefined,};});},_MockMailThread_MessageComputeAuthor(model,ids,author_id,email_from,context={}){if(author_id===undefined){let user_id;if('mockedUserId'in context){user_id=context.mockedUserId?context.mockedUserId:this.publicUserId;}else{user_id=this.currentUserId;}
const user=this._getRecords('res.users',[['id','=',user_id]],{active_test:false},)[0];const author=this._getRecords('res.partner',[['id','=',user.partner_id]],{active_test:false},)[0];author_id=author.id;email_from=`${author.display_name} <${author.email}>`;}
if(email_from===undefined){if(author_id){const author=this._getRecords('res.partner',[['id','=',author_id]],{active_test:false},)[0];email_from=`${author.display_name} <${author.email}>`;}}
if(!email_from){throw Error("Unable to log message due to missing author email.");}
return[author_id,email_from];},_mockMailThread_MessageAddSuggestedRecipient(model,ids,result,{email,partner,reason=''}={}){const record=this._getRecords(model,[['id','in','ids']])[0];result[record.id].push([partner,email,reason]);return result;},_mockMailThread_MessageGetSuggestedRecipients(model,ids){const result=ids.reduce((result,id)=>result[id]=[],{});const records=this._getRecords(model,[['id','in',ids]]);for(const record in records){if(record.user_id){const user=this._getRecords('res.users',[['id','=',record.user_id]]);if(user.partner_id){const reason=this.data[model].fields['user_id'].string;this._mockMailThread_MessageAddSuggestedRecipient(result,user.partner_id,reason);}}}
return result;},_mockResFake_MessageGetSuggestedRecipients(model,ids){const result={};const records=this._getRecords(model,[['id','in',ids]]);for(const record of records){result[record.id]=[];if(record.email_cc){result[record.id].push([false,record.email_cc,'CC email',]);}
const partners=this._getRecords('res.partner',[['id','in',record.partner_ids]],);if(partners.length){for(const partner of partners){result[record.id].push([partner.id,partner.display_name,'Email partner',]);}}}
return result;},_mockMailThreadMessagePost(model,ids,kwargs,context){const id=ids[0];if(kwargs.attachment_ids){const attachments=this._getRecords('ir.attachment',[['id','in',kwargs.attachment_ids],['res_model','=','mail.compose.message'],['res_id','=',0],]);const attachmentIds=attachments.map(attachment=>attachment.id);this._mockWrite('ir.attachment',[attachmentIds,{res_id:id,res_model:model,},]);kwargs.attachment_ids=attachmentIds.map(attachmentId=>[4,attachmentId]);}
const subtype_xmlid=kwargs.subtype_xmlid||'mail.mt_note';const[author_id,email_from]=this._MockMailThread_MessageComputeAuthor(model,ids,kwargs.author_id,kwargs.email_from,context,);const values=Object.assign({},kwargs,{author_id,email_from,is_discussion:subtype_xmlid==='mail.mt_comment',is_note:subtype_xmlid==='mail.mt_note',model,res_id:id,});delete values.subtype_xmlid;const messageId=this._mockCreate('mail.message',values);this._mockMailThread_NotifyThread(model,ids,messageId);return this._mockMailMessageMessageFormat([messageId])[0];},_mockMailThreadMessageSubscribe(model,ids,partner_ids,subtype_ids){},_mockMailThread_NotifyThread(model,ids,messageId){const message=this._getRecords('mail.message',[['id','=',messageId]])[0];const messageFormat=this._mockMailMessageMessageFormat([messageId])[0];const notifications=[];const notificationData={type:'author',payload:{message:messageFormat,},};if(message.author_id){notifications.push([notificationData]);}
const channels=this._getRecords('mail.channel',[['id','=',message.res_id]]);for(const channel of channels){notifications.push({type:'mail.channel/new_message',payload:{id:channel.id,message:messageFormat,}});const now=datetime_to_str(new Date());this._mockWrite('mail.channel',[[channel.id],{last_interest_dt:now},]);notifications.push({type:'mail.channel/last_interest_dt_changed',payload:{id:channel.id,last_interest_dt:now,},});}
this._widget.call('bus_service','trigger','notification',notifications);},_mockMailThreadMessageUnsubscribe(model,ids,partner_ids){if(!partner_ids){return true;}
const followers=this._getRecords('mail.followers',[['res_model','=',model],['res_id','in',ids],['partner_id','in',partner_ids||[]],]);this._mockUnlink('mail.followers',[followers.map(follower=>follower.id)]);},_mockResPartner_GetChannelsAsMember(ids){const partner=this._getRecords('res.partner',[['id','in',ids]])[0];const channels=this._getRecords('mail.channel',[['channel_type','in',['channel','group']],['members','in',partner.id],]);const directMessages=this._getRecords('mail.channel',[['channel_type','=','chat'],['is_pinned','=',true],['members','in',partner.id],]);return[...channels,...directMessages,];},_mockResUsersSettings_FindOrCreateForUser(user_id){let settings=this._getRecords('res.users.settings',[['user_id','=',user_id]])[0];if(!settings){const settingsId=this._mockCreate('res.users.settings',{user_id:user_id});settings=this._getRecords('res.users.settings',[['id','=',settingsId]])[0];}
return settings;},_mockResUsersSettingsSetResUsersSettings(id,newSettings){const oldSettings=this._getRecords('res.users.settings',[['id','=',id]])[0];const changedSettings={};for(const setting in newSettings){if(setting in oldSettings&&newSettings[setting]!==oldSettings[setting]){changedSettings[setting]=newSettings[setting];}}
this._mockWrite('res.users.settings',[[id],changedSettings,]);this._widget.call('bus_service','trigger','notification',[{type:'res.users.settings/changed',payload:changedSettings,}]);},_mockResPartnerGetMentionSuggestions(args){const search=(args.args[0]||args.kwargs.search||'').toLowerCase();const limit=args.args[1]||args.kwargs.limit||8;const mentionSuggestionsFilter=(partners,search,limit)=>{const matchingPartners=[...this._mockResPartnerMailPartnerFormat(partners.filter(partner=>{if(!search){return true;}
if(partner.name&&partner.name.toLowerCase().includes(search)){return true;}
if(partner.email&&partner.email.toLowerCase().includes(search)){return true;}
return false;}).map(partner=>partner.id)).values()];matchingPartners.length=Math.min(matchingPartners.length,limit);return matchingPartners;};const partnersFromUsers=this._getRecords('res.users',[]).map(user=>this._getRecords('res.partner',[['id','=',user.partner_id]])[0]).filter(partner=>partner);const mainMatchingPartners=mentionSuggestionsFilter(partnersFromUsers,search,limit);let extraMatchingPartners=[];const remainingLimit=limit-mainMatchingPartners.length;if(mainMatchingPartners.length<limit){const partners=this._getRecords('res.partner',[['id','not in',mainMatchingPartners.map(partner=>partner.id)]]);extraMatchingPartners=mentionSuggestionsFilter(partners,search,remainingLimit);}
return mainMatchingPartners.concat(extraMatchingPartners);},_mockResPartner_GetNeedactionCount(id){const partner=this._getRecords('res.partner',[['id','=',id]])[0];return this._getRecords('mail.notification',[['res_partner_id','=',partner.id],['is_read','=',false],]).length;},_mockResPartnerImSearch(name='',limit=20){name=name.toLowerCase();const matchingPartners=this._getRecords('res.users',[]).filter(user=>{const partner=this._getRecords('res.partner',[['id','=',user.partner_id]])[0];if(!partner){return false;}
if(partner.id===this.currentPartnerId){return false;}
if(!name){return true;}
if(partner.name&&partner.name.toLowerCase().includes(name)){return true;}
return false;}).map(user=>{const partner=this._getRecords('res.partner',[['id','=',user.partner_id]])[0];return{id:partner.id,im_status:user.im_status||'offline',email:partner.email,name:partner.name,user_id:user.id,};}).sort((a,b)=>(a.name===b.name)?(a.id-b.id):(a.name>b.name)?1:-1);matchingPartners.length=Math.min(matchingPartners.length,limit);return matchingPartners;},_mockResPartnerMailPartnerFormat(ids){const partners=this._getRecords('res.partner',[['id','in',ids]],{active_test:false});return new Map(partners.map(partner=>{const users=this._getRecords('res.users',[['id','in',partner.user_ids]]);const internalUsers=users.filter(user=>!user.share);let mainUser;if(internalUsers.length>0){mainUser=internalUsers[0];}else if(users.length>0){mainUser=users[0];}else{mainUser=[];}
return[partner.id,{"active":partner.active,"display_name":partner.display_name,"email":partner.email,"id":partner.id,"im_status":partner.im_status,"name":partner.name,"user_id":mainUser.id,}];}));},_mockResPartnerSearchForChannelInvite(search_term,channel_id,limit=30){search_term=search_term.toLowerCase();const matchingPartners=[...this._mockResPartnerMailPartnerFormat(this._getRecords('res.users',[]).filter(user=>{const partner=this._getRecords('res.partner',[['id','=',user.partner_id]])[0];if(!partner){return false;}
if(partner.id===this.currentPartnerId){return false;}
if(!search_term){return true;}
if(partner.name&&partner.name.toLowerCase().includes(search_term)){return true;}
return false;}).map(user=>user.partner_id)).values()];const count=matchingPartners.length;matchingPartners.length=Math.min(count,limit);return{count,partners:matchingPartners};},_mockResPartner_MessageFetchFailed(id){const partner=this._getRecords('res.partner',[['id','=',id]])[0];const messages=this._getRecords('mail.message',[['author_id','=',partner.id],['res_id','!=',0],['model','!=',false],['message_type','!=','user_notification'],]).filter(message=>{const notifications=this._getRecords('mail.notification',[['mail_message_id','=',message.id],['notification_status','in',['bounce','exception']],]);return notifications.length>0;});return this._mockMailMessage_MessageNotificationFormat(messages.map(message=>message.id));},_mockResUsers_InitMessaging(ids){const user=this._getRecords('res.users',[['id','in',ids]])[0];return{channels:this._mockMailChannelChannelInfo(this._mockResPartner_GetChannelsAsMember(user.partner_id).map(channel=>channel.id)),current_partner:this._mockResPartnerMailPartnerFormat(user.partner_id).get(user.partner_id),current_user_id:this.currentUserId,current_user_settings:this._mockResUsersSettings_FindOrCreateForUser(user.id),mail_failures:[],menu_id:false,needaction_inbox_counter:this._mockResPartner_GetNeedactionCount(user.partner_id),partner_root:this._mockResPartnerMailPartnerFormat(this.partnerRootId).get(this.partnerRootId),public_partners:[...this._mockResPartnerMailPartnerFormat(this.publicPartnerId).values()],shortcodes:this._getRecords('mail.shortcode',[]),starred_counter:this._getRecords('mail.message',[['starred_partner_ids','in',user.partner_id]]).length,};},});return __exports;});;

/* /web_enterprise/static/tests/helpers.js defined in bundle 'web.tests_assets' */
odoo.define('@web_enterprise/../tests/helpers',async function(require){'use strict';let __exports={};const{createWebClient}=require("@web/../tests/webclient/helpers");const{registry}=require("@web/core/registry");const{legacyServiceProvider}=require("@web_enterprise/legacy/legacy_service_provider");const{WebClientEnterprise}=require("@web_enterprise/webclient/webclient");__exports.createEnterpriseWebClient=createEnterpriseWebClient;function createEnterpriseWebClient(params){params.WebClientClass=WebClientEnterprise;registry.category("services").add("enterprise_legacy_service_provider",legacyServiceProvider);return createWebClient(params);}
return __exports;});;

/* /web_enterprise/static/tests/mocks.js defined in bundle 'web.tests_assets' */
odoo.define('@web_enterprise/../tests/mocks',async function(require){'use strict';let __exports={};__exports.makeFakeEnterpriseService=makeFakeEnterpriseService;function makeFakeEnterpriseService(params={}){return{name:"enterprise",dependencies:[],start(){return{warning:"warning"in params?params.warning:false,expirationDate:"expirationDate"in params?params.expirationDate:false,expirationReason:"expirationReason"in params?params.expirationReason:false,isMailInstalled:"isMailInstalled"in params?params.isMailInstalled:false,};},};}
return __exports;});;

/* /web_mobile/static/tests/helpers/test_utils.js defined in bundle 'web.tests_assets' */
odoo.define('web_mobile.testUtils',function(){'use strict';function base64ToBlob(b64Data,contentType,sliceSize){contentType=contentType||'';sliceSize=sliceSize||512;const byteCharacters=atob(b64Data);let byteArrays=[];for(let offset=0;offset<byteCharacters.length;offset+=sliceSize){const slice=byteCharacters.slice(offset,offset+sliceSize);const byteNumbers=Array.from(slice).map((char)=>char.charCodeAt(0));byteArrays.push(new Uint8Array(byteNumbers));}
return new Blob(byteArrays,{type:contentType});}
return{base64ToBlob,};});;

/* /iap/static/tests/helpers/mock_server.js defined in bundle 'web.tests_assets' */
odoo.define('iap/static/tests/helpers/mock_server.js',function(require){"use strict";const MockServer=require('web.MockServer');MockServer.include({async _performRpc(route,args){if(args.model==='iap.account'&&args.method==='get_credits_url'){const service_name=args.args[0]||args.kwargs.service_name;const base_url=args.args[1]||args.kwargs.base_url;const credit=args.args[2]!==undefined?args.args[2]:args.kwargs.credit;const trial=args.args[3]!==undefined?args.args[3]:args.kwargs.trial;return this._mockIapAccountGetCreditsUrl(service_name,base_url,credit,trial);}
return this._super(...arguments);},_mockIapAccountGetCreditsUrl(service_name,base_url='',credit=0,trial=false){return base_url+'/random/url?service_name='+service_name;},});});;

/* /documents/static/tests/mock_server.js defined in bundle 'web.tests_assets' */
odoo.define('@documents/../tests/mock_server',async function(require){'use strict';let __exports={};const Domain=require('web.Domain');const MockServer=require('web.MockServer');MockServer.include({async _performRpc(route,args){if(route.indexOf('/documents/image')>=0||_.contains(['.png','.jpg'],route.substr(route.length-4))){return Promise.resolve();}
if(args.model==='documents.share'&&args.method==='check_access_rights'){return true;}
return this._super.apply(this,arguments);},_mockGetModels(model,domain){const notAFile=[];const notAttached=[];const models=[];const groups=this._mockReadGroup(model,{domain:domain,fields:['res_model'],groupby:['res_model'],});for(const group of groups){if(!group.res_model){notAFile.push({id:group.res_model,display_name:"Not a file",__count:group.res_model_count,});}else if(group.res_model==='documents.document'){notAttached.push({id:group.res_model,display_name:"Not attached",__count:group.res_model_count,});}else{const{res_model_name}=this.data['documents.document'].records.find(record=>record.res_model===group.res_model);models.push({id:group.res_model,display_name:res_model_name,__count:group.res_model_count,});}}
const sorted=models.sort(({display_name:a},{display_name:b})=>{return a>b?1:a<b?-1:0;});return[...sorted,...notAttached,...notAFile];},_mockSearchPanelSelectRange:function(model,[fieldName],kwargs){if(model==='documents.document'&&fieldName==='folder_id'){const enableCounters=kwargs.enable_counters||false;const fields=['display_name','description','parent_folder_id'];const records=this._mockSearchRead('documents.folder',[[],fields],{});let domainImage=new Map();if(enableCounters){const modelDomain=Domain.prototype.normalizeArray([...(kwargs.search_domain,[]),...(kwargs.category_domain,[]),...(kwargs.filter_domain,[]),[fieldName,'!=',false],]);domainImage=this._mockSearchPanelDomainImage(model,fieldName,modelDomain,enableCounters);}
const valuesRange=new Map();for(const record of records){if(enableCounters){record.__count=domainImage.get(record.id)?domainImage.get(record.id).__count:0;}
const value=record.parent_folder_id;record.parent_folder_id=value&&value[0];valuesRange.set(record.id,record);}
if(kwargs.enable_counters){this._mockSearchPanelGlobalCounters(valuesRange,'parent_folder_id');}
return{parent_field:'parent_folder_id',values:[...valuesRange.values()],};}
return this._super(...arguments);},_mockSearchPanelSelectMultiRange:function(model,[fieldName],kwargs){const searchDomain=kwargs.search_domain||[];const categoryDomain=kwargs.category_domain||[];const filterDomain=kwargs.filter_domain||[];if(model==='documents.document'){if(fieldName==='tag_ids'){const folderId=categoryDomain.length?categoryDomain[0][2]:false;if(folderId){const domain=Domain.prototype.normalizeArray([...searchDomain,...categoryDomain,...filterDomain,[fieldName,'!=',false],]);return{values:this.data['documents.tag'].get_tags(domain,folderId),};}else{return{values:[],};}}else if(fieldName==='res_model'){let domain=Domain.prototype.normalizeArray([...searchDomain,...categoryDomain]);const modelValues=this._mockGetModels(model,domain);if(filterDomain){domain=Domain.prototype.normalizeArray([...searchDomain,...categoryDomain,...filterDomain,]);const modelCount={};for(const{id,__count}of this._mockGetModels(model,domain)){modelCount[id]=__count;}
modelValues.forEach(m=>m.__count=modelCount[m.id]||0);}
return{values:modelValues,};}}
return this._super(...arguments);},});return __exports;});;

/* /approvals/static/tests/helpers/mock_server.js defined in bundle 'web.tests_assets' */
odoo.define('@approvals/../tests/helpers/mock_server',async function(require){'use strict';let __exports={};const MockServer=require('web.MockServer');MockServer.include({async _performRpc(route,args){if(args.model==='approval.approver'&&args.method==='action_approve'){const ids=args.args[0];return this._mockApprovalApproverActionApprove(ids);}
if(args.model==='approval.approver'&&args.method==='action_refuse'){const ids=args.args[0];return this._mockApprovalApproverActionApprove(ids);}
return this._super(...arguments);},_mockApprovalApproverActionApprove(ids){},_mockApprovalApproverActionRefuse(ids){},});return __exports;});;

/* /mail_bot/static/tests/helpers/mock_server.js defined in bundle 'web.tests_assets' */
odoo.define('@mail_bot/../tests/helpers/mock_server',async function(require){'use strict';let __exports={};const MockServer=require('web.MockServer');MockServer.include({async _performRpc(route,args){if(args.model==='mail.channel'&&args.method==='init_odoobot'){return this._mockMailChannelInitOdooBot();}
return this._super(...arguments);},_mockMailChannelInitOdooBot(){},});return __exports;});;

/* /partner_autocomplete/static/lib/jsvat.js defined in bundle 'web.tests_assets' */
var checkVATNumber=(function(){var vatexp=new Array();vatexp.push(/^(AT)U(\d{8})$/);vatexp.push(/^(BE)(\d{9,10})$/);vatexp.push(/^(BG)(\d{9,10})$/);vatexp.push(/^(CHE)(\d{9})(MWST|TVA|IVA)?$/);vatexp.push(/^(CY)([0-59]\d{7}[A-Z])$/);vatexp.push(/^(CZ)(\d{8,10})(\d{3})?$/);vatexp.push(/^(DE)([1-9]\d{8})$/);vatexp.push(/^(DK)(\d{8})$/);vatexp.push(/^(EE)(10\d{7})$/);vatexp.push(/^(EL)(\d{9})$/);vatexp.push(/^(ES)([A-Z]\d{8})$/);vatexp.push(/^(ES)([A-HN-SW]\d{7}[A-J])$/);vatexp.push(/^(ES)([0-9YZ]\d{7}[A-Z])$/);vatexp.push(/^(ES)([KLMX]\d{7}[A-Z])$/);vatexp.push(/^(EU)(\d{9})$/);vatexp.push(/^(FI)(\d{8})$/);vatexp.push(/^(FR)(\d{11})$/);vatexp.push(/^(FR)([A-HJ-NP-Z]\d{10})$/);vatexp.push(/^(FR)(\d[A-HJ-NP-Z]\d{9})$/);vatexp.push(/^(FR)([A-HJ-NP-Z]{2}\d{9})$/);vatexp.push(/^(GB|XI)(\d{9})$/);vatexp.push(/^(GB|XI)(\d{12})$/);vatexp.push(/^(GB)(GD\d{3})$/);vatexp.push(/^(GB)(HA\d{3})$/);vatexp.push(/^(HR)(\d{11})$/);vatexp.push(/^(HU)(\d{8})$/);vatexp.push(/^(IE)(\d{7}[A-W])$/);vatexp.push(/^(IE)([7-9][A-Z\*\+)]\d{5}[A-W])$/);vatexp.push(/^(IE)(\d{7}[A-W][AH])$/);vatexp.push(/^(IT)(\d{11})$/);vatexp.push(/^(LV)(\d{11})$/);vatexp.push(/^(LT)(\d{9}|\d{12})$/);vatexp.push(/^(LU)(\d{8})$/);vatexp.push(/^(MT)([1-9]\d{7})$/);vatexp.push(/^(NL)(\d{9})B\d{2}$/);vatexp.push(/^(NO)(\d{9})$/);vatexp.push(/^(PL)(\d{10})$/);vatexp.push(/^(PT)(\d{9})$/);vatexp.push(/^(RO)([1-9]\d{1,9})$/);vatexp.push(/^(RU)(\d{10}|\d{12})$/);vatexp.push(/^(RS)(\d{9})$/);vatexp.push(/^(SI)([1-9]\d{7})$/);vatexp.push(/^(SK)([1-9]\d[2346-9]\d{7})$/);vatexp.push(/^(SE)(\d{10}01)$/);function checkVATNumber(toCheck){var VATNumber=toCheck.toUpperCase();VATNumber=VATNumber.replace(/(\s|-|\.)+/g,'');var valid=false;for(var i=0;i<vatexp.length;i++){if(vatexp[i].test(VATNumber)){var cCode=RegExp.$1;var cNumber=RegExp.$2;if(eval(cCode+"VATCheckDigit ('"+cNumber+"')"))valid=VATNumber;break;}}
return valid;}
function ATVATCheckDigit(vatnumber){var total=0;var multipliers=[1,2,1,2,1,2,1];var temp=0;for(var i=0;i<7;i++){temp=Number(vatnumber.charAt(i))*multipliers[i];if(temp>9)
total+=Math.floor(temp/10)+temp%10;else
total+=temp;}
total=10-(total+4)%10;if(total==10)total=0;if(total==vatnumber.slice(7,8))
return true;else
return false;}
function BEVATCheckDigit(vatnumber){if(vatnumber.length==9)vatnumber="0"+vatnumber;if(97-vatnumber.slice(0,8)%97==vatnumber.slice(8,10))
return true;else
return false;}
function BGVATCheckDigit(vatnumber){var temp,total,multipliers,i;if(vatnumber.length==9){total=0;temp=0;for(i=0;i<8;i++)temp+=Number(vatnumber.charAt(i))*(i+1);total=temp%11;if(total!=10){if(total==vatnumber.slice(8))
return true;else
return false;}
temp=0;for(i=0;i<8;i++)temp+=Number(vatnumber.charAt(i))*(i+3);total=temp%11;if(total==10)total=0;if(total==vatnumber.slice(8))
return true;else
return false;}
if((/^\d\d[0-5]\d[0-3]\d\d{4}$/).test(vatnumber)){var month=Number(vatnumber.slice(2,4));if((month>0&&month<13)||(month>20&&month<33)||(month>40&&month<53)){multipliers=[2,4,8,5,10,9,7,3,6];total=0;for(i=0;i<9;i++)total+=Number(vatnumber.charAt(i))*multipliers[i];total=total%11;if(total==10)total=0;if(total==vatnumber.substr(9,1))return true;}}
multipliers=[21,19,17,13,11,9,7,3,1];total=0;for(i=0;i<9;i++)total+=Number(vatnumber.charAt(i))*multipliers[i];if(total%10==vatnumber.substr(9,1))return true;multipliers=[4,3,2,7,6,5,4,3,2];total=0;for(i=0;i<9;i++)total+=Number(vatnumber.charAt(i))*multipliers[i];total=11-total%11;if(total==10)return false;if(total==11)total=0;if(total==vatnumber.substr(9,1))
return true;else
return false;}
function CHEVATCheckDigit(vatnumber){var multipliers=[5,4,3,2,7,6,5,4];var total=0;for(var i=0;i<8;i++)total+=Number(vatnumber.charAt(i))*multipliers[i];total=11-total%11;if(total==10)return false;if(total==11)total=0;if(total==vatnumber.substr(8,1))
return true;else
return false;}
function CYVATCheckDigit(vatnumber){if(Number(vatnumber.slice(0,2)==12))return false;var total=0;for(var i=0;i<8;i++){var temp=Number(vatnumber.charAt(i));if(i%2==0){switch(temp){case 0:temp=1;break;case 1:temp=0;break;case 2:temp=5;break;case 3:temp=7;break;case 4:temp=9;break;default:temp=temp*2+3;}}
total+=temp;}
total=total%26;total=String.fromCharCode(total+65);if(total==vatnumber.substr(8,1))
return true;else
return false;}
function CZVATCheckDigit(vatnumber){var total=0;var multipliers=[8,7,6,5,4,3,2];var czexp=new Array();czexp[0]=(/^\d{8}$/);czexp[1]=(/^[0-5][0-9][0|1|5|6][0-9][0-3][0-9]\d{3}$/);czexp[2]=(/^6\d{8}$/);czexp[3]=(/^\d{2}[0-3|5-8][0-9][0-3][0-9]\d{4}$/);var i=0;var a;if(czexp[0].test(vatnumber)){for(i=0;i<7;i++)total+=Number(vatnumber.charAt(i))*multipliers[i];total=11-total%11;if(total==10)total=0;if(total==11)total=1;if(total==vatnumber.slice(7,8))
return true;else
return false;}
else if(czexp[1].test(vatnumber)){if(Number(vatnumber.slice(0,2))>62)return false;return true;}
else if(czexp[2].test(vatnumber)){for(i=0;i<7;i++)total+=Number(vatnumber.charAt(i+1))*multipliers[i];if(total%11==0)
a=total+11;else
a=Math.ceil(total/11)*11;var pointer=a-total;var lookup=[8,7,6,5,4,3,2,1,0,9,8];if(lookup[pointer-1]==vatnumber.slice(8,9))
return true;else
return false;}
else if(czexp[3].test(vatnumber)){var temp=Number(vatnumber.slice(0,2))+Number(vatnumber.slice(2,4))+Number(vatnumber.slice(4,6))+Number(vatnumber.slice(6,8))+Number(vatnumber.slice(8));if(temp%11==0&&Number(vatnumber)%11==0)
return true;else
return false;}
return false;}
function DEVATCheckDigit(vatnumber){var product=10;var sum=0;var checkdigit=0;for(var i=0;i<8;i++){sum=(Number(vatnumber.charAt(i))+product)%10;if(sum==0){sum=10;}
product=(2*sum)%11;}
if(11-product==10){checkdigit=0;}else{checkdigit=11-product;}
if(checkdigit==vatnumber.slice(8,9))
return true;else
return false;}
function DKVATCheckDigit(vatnumber){var total=0;var multipliers=[2,7,6,5,4,3,2,1];for(var i=0;i<8;i++)total+=Number(vatnumber.charAt(i))*multipliers[i];total=total%11;if(total==0)
return true;else
return false;}
function EEVATCheckDigit(vatnumber){var total=0;var multipliers=[3,7,1,3,7,1,3,7];for(var i=0;i<8;i++)total+=Number(vatnumber.charAt(i))*multipliers[i];total=10-total%10;if(total==10)total=0;if(total==vatnumber.slice(8,9))
return true;else
return false;}
function ELVATCheckDigit(vatnumber){var total=0;var multipliers=[256,128,64,32,16,8,4,2];if(vatnumber.length==8){vatnumber="0"+vatnumber;}
for(var i=0;i<8;i++)total+=Number(vatnumber.charAt(i))*multipliers[i];total=total%11;if(total>9){total=0;}
if(total==vatnumber.slice(8,9))
return true;else
return false;}
function ESVATCheckDigit(vatnumber){var total=0;var temp=0;var multipliers=[2,1,2,1,2,1,2];var esexp=new Array();esexp[0]=(/^[A-H|J|U|V]\d{8}$/);esexp[1]=(/^[A-H|N-S|W]\d{7}[A-J]$/);esexp[2]=(/^[0-9|Y|Z]\d{7}[A-Z]$/);esexp[3]=(/^[K|L|M|X]\d{7}[A-Z]$/);var i=0;if(esexp[0].test(vatnumber)){for(i=0;i<7;i++){temp=Number(vatnumber.charAt(i+1))*multipliers[i];if(temp>9)
total+=Math.floor(temp/10)+temp%10;else
total+=temp;}
total=10-total%10;if(total==10){total=0;}
if(total==vatnumber.slice(8,9))
return true;else
return false;}
else if(esexp[1].test(vatnumber)){for(i=0;i<7;i++){temp=Number(vatnumber.charAt(i+1))*multipliers[i];if(temp>9)
total+=Math.floor(temp/10)+temp%10;else
total+=temp;}
total=10-total%10;total=String.fromCharCode(total+64);if(total==vatnumber.slice(8,9))
return true;else
return false;}
else if(esexp[2].test(vatnumber)){var tempnumber=vatnumber;if(tempnumber.substring(0,1)=='Y')tempnumber=tempnumber.replace(/Y/,"1");if(tempnumber.substring(0,1)=='Z')tempnumber=tempnumber.replace(/Z/,"2");return tempnumber.charAt(8)=='TRWAGMYFPDXBNJZSQVHLCKE'.charAt(Number(tempnumber.substring(0,8))%23);}
else if(esexp[3].test(vatnumber)){return vatnumber.charAt(8)=='TRWAGMYFPDXBNJZSQVHLCKE'.charAt(Number(vatnumber.substring(1,8))%23);}
else return false;}
function EUVATCheckDigit(vatnumber){return true;}
function FIVATCheckDigit(vatnumber){var total=0;var multipliers=[7,9,10,5,8,4,2];for(var i=0;i<7;i++)total+=Number(vatnumber.charAt(i))*multipliers[i];total=11-total%11;if(total>9){total=0;}
if(total==vatnumber.slice(7,8))
return true;else
return false;}
function FRVATCheckDigit(vatnumber){if(!(/^\d{11}$/).test(vatnumber))return true;var total=vatnumber.substring(2);total=(total*100+12)%97;if(total==vatnumber.slice(0,2))
return true;else
return false;}
function GBVATCheckDigit(vatnumber){var multipliers=[8,7,6,5,4,3,2];if(vatnumber.substr(0,2)=='GD'){if(vatnumber.substr(2,3)<500)
return true;else
return false;}
if(vatnumber.substr(0,2)=='HA'){if(vatnumber.substr(2,3)>499)
return true;else
return false;}
var total=0;if(Number(vatnumber.slice(0))==0)return false;var no=Number(vatnumber.slice(0,7));for(var i=0;i<7;i++)total+=Number(vatnumber.charAt(i))*multipliers[i];var cd=total;while(cd>0){cd=cd-97;}
cd=Math.abs(cd);if(cd==vatnumber.slice(7,9)&&no<9990001&&(no<100000||no>999999)&&(no<9490001||no>9700000))return true;if(cd>=55)
cd=cd-55;else
cd=cd+42;if(cd==vatnumber.slice(7,9)&&no>1000000)
return true;else
return false;}
function HRVATCheckDigit(vatnumber){var product=10;var sum=0;var checkdigit=0;for(var i=0;i<10;i++){sum=(Number(vatnumber.charAt(i))+product)%10;if(sum==0){sum=10;}
product=(2*sum)%11;}
if((product+vatnumber.slice(10,11)*1)%10==1)
return true;else
return false;}
function HUVATCheckDigit(vatnumber){var total=0;var multipliers=[9,7,3,1,9,7,3];for(var i=0;i<7;i++)total+=Number(vatnumber.charAt(i))*multipliers[i];total=10-total%10;if(total==10)total=0;if(total==vatnumber.slice(7,8))
return true;else
return false;}
function IEVATCheckDigit(vatnumber){var total=0;var multipliers=[8,7,6,5,4,3,2];if(/^\d[A-Z\*\+]/.test(vatnumber))vatnumber="0"+vatnumber.substring(2,7)+vatnumber.substring(0,1)+vatnumber.substring(7,8);for(var i=0;i<7;i++)total+=Number(vatnumber.charAt(i))*multipliers[i];if(/^\d{7}[A-Z][AH]$/.test(vatnumber)){if(vatnumber.charAt(8)=='H')
total+=72;else
total+=9;}
total=total%23;if(total==0)
total="W";else
total=String.fromCharCode(total+64);if(total==vatnumber.slice(7,8))
return true;else
return false;}
function ITVATCheckDigit(vatnumber){var total=0;var multipliers=[1,2,1,2,1,2,1,2,1,2];var temp;if(Number(vatnumber.slice(0,7))==0)return false;temp=Number(vatnumber.slice(7,10));if((temp<1)||(temp>201)&&temp!=999&&temp!=888)return false;for(var i=0;i<10;i++){temp=Number(vatnumber.charAt(i))*multipliers[i];if(temp>9)
total+=Math.floor(temp/10)+temp%10;else
total+=temp;}
total=10-total%10;if(total>9){total=0;}
if(total==vatnumber.slice(10,11))
return true;else
return false;}
function LTVATCheckDigit(vatnumber){var total,multipliers,i;if(vatnumber.length==9){if(!(/^\d{7}1/).test(vatnumber))return false;total=0;for(i=0;i<8;i++)total+=Number(vatnumber.charAt(i))*(i+1);if(total%11==10){multipliers=[3,4,5,6,7,8,9,1];total=0;for(i=0;i<8;i++)total+=Number(vatnumber.charAt(i))*multipliers[i];}
total=total%11;if(total==10){total=0;}
if(total==vatnumber.slice(8,9))
return true;else
return false;}
else{if(!(/^\d{10}1/).test(vatnumber))return false;total=0;multipliers=[1,2,3,4,5,6,7,8,9,1,2];for(i=0;i<11;i++)total+=Number(vatnumber.charAt(i))*multipliers[i];if(total%11==10){multipliers=[3,4,5,6,7,8,9,1,2,3,4];total=0;for(i=0;i<11;i++)total+=Number(vatnumber.charAt(i))*multipliers[i];}
total=total%11;if(total==10){total=0;}
if(total==vatnumber.slice(11,12))
return true;else
return false;}}
function LUVATCheckDigit(vatnumber){if(vatnumber.slice(0,6)%89==vatnumber.slice(6,8))
return true;else
return false;}
function LVVATCheckDigit(vatnumber){if((/^[0-3]/).test(vatnumber)){if((/^[0-3][0-9][0-1][0-9]/).test(vatnumber))
return true;else
return false;}
else{var total=0;var multipliers=[9,1,4,8,3,10,2,5,7,6];for(var i=0;i<10;i++)total+=Number(vatnumber.charAt(i))*multipliers[i];if(total%11==4&&vatnumber[0]==9)total=total-45;if(total%11==4)
total=4-total%11;else if(total%11>4)
total=14-total%11;else if(total%11<4)
total=3-total%11;if(total==vatnumber.slice(10,11))
return true;else
return false;}}
function MTVATCheckDigit(vatnumber){var total=0;var multipliers=[3,4,6,7,8,9];for(var i=0;i<6;i++)total+=Number(vatnumber.charAt(i))*multipliers[i];total=37-total%37;if(total==vatnumber.slice(6,8)*1)
return true;else
return false;}
function NLVATCheckDigit(vatnumber){var total=0;var multipliers=[9,8,7,6,5,4,3,2];for(var i=0;i<8;i++)total+=Number(vatnumber.charAt(i))*multipliers[i];total=total%11;if(total>9){total=0;}
if(total==vatnumber.slice(8,9))
return true;else
return false;}
function NOVATCheckDigit(vatnumber){var total=0;var multipliers=[3,2,7,6,5,4,3,2];for(var i=0;i<8;i++)total+=Number(vatnumber.charAt(i))*multipliers[i];total=11-total%11;if(total==11){total=0;}
if(total<10){if(total==vatnumber.slice(8,9))
return true;else
return false;}}
function PLVATCheckDigit(vatnumber){var total=0;var multipliers=[6,5,7,2,3,4,5,6,7];for(var i=0;i<9;i++)total+=Number(vatnumber.charAt(i))*multipliers[i];total=total%11;if(total>9){total=0;}
if(total==vatnumber.slice(9,10))
return true;else
return false;}
function PTVATCheckDigit(vatnumber){var total=0;var multipliers=[9,8,7,6,5,4,3,2];for(var i=0;i<8;i++)total+=Number(vatnumber.charAt(i))*multipliers[i];total=11-total%11;if(total>9){total=0;}
if(total==vatnumber.slice(8,9))
return true;else
return false;}
function ROVATCheckDigit(vatnumber){var multipliers=[7,5,3,2,1,7,5,3,2];var VATlen=vatnumber.length;multipliers=multipliers.slice(10-VATlen);var total=0;for(var i=0;i<vatnumber.length-1;i++){total+=Number(vatnumber.charAt(i))*multipliers[i];}
total=(10*total)%11;if(total==10)total=0;if(total==vatnumber.slice(vatnumber.length-1,vatnumber.length))
return true;else
return false;}
function RSVATCheckDigit(vatnumber){var product=10;var sum=0;var checkdigit=0;for(var i=0;i<8;i++){sum=(Number(vatnumber.charAt(i))+product)%10;if(sum==0){sum=10;}
product=(2*sum)%11;}
if((product+vatnumber.slice(8,9)*1)%10==1)
return true;else
return false;}
function RUVATCheckDigit(vatnumber){var i;if(vatnumber.length==10){var total=0;var multipliers=[2,4,10,3,5,9,4,6,8,0];for(i=0;i<10;i++){total+=Number(vatnumber.charAt(i))*multipliers[i];}
total=total%11;if(total>9){total=total%10;}
if(total==vatnumber.slice(9,10))
return true;else
return false;}else if(vatnumber.length==12){var total1=0;var multipliers1=[7,2,4,10,3,5,9,4,6,8,0];var total2=0;var multipliers2=[3,7,2,4,10,3,5,9,4,6,8,0];for(i=0;i<11;i++)total1+=Number(vatnumber.charAt(i))*multipliers1[i];total1=total1%11;if(total1>9){total1=total1%10;}
for(i=0;i<11;i++)total2+=Number(vatnumber.charAt(i))*multipliers2[i];total2=total2%11;if(total2>9){total2=total2%10;}
if((total1==vatnumber.slice(10,11))&&(total2==vatnumber.slice(11,12)))
return true;else
return false;}}
function SEVATCheckDigit(vatnumber){var i;var R=0;var digit;for(i=0;i<9;i=i+2){digit=Number(vatnumber.charAt(i));R+=Math.floor(digit/5)+((digit*2)%10);}
var S=0;for(i=1;i<9;i=i+2)S+=Number(vatnumber.charAt(i));var cd=(10-(R+S)%10)%10;if(cd==vatnumber.slice(9,10))
return true;else
return false;}
function SIVATCheckDigit(vatnumber){var total=0;var multipliers=[8,7,6,5,4,3,2];for(var i=0;i<7;i++)total+=Number(vatnumber.charAt(i))*multipliers[i];total=11-total%11;if(total==10){total=0;}
if(total!=11&&total==vatnumber.slice(7,8))
return true;else
return false;}
function SKVATCheckDigit(vatnumber){if(Number(vatnumber%11)==0)
return true;else
return false;}
XIVATCheckDigit=GBVATCheckDigit;return checkVATNumber;})();;

/* /snailmail/static/tests/helpers/mock_models.js defined in bundle 'web.tests_assets' */
odoo.define('@snailmail/../tests/helpers/mock_models',async function(require){'use strict';let __exports={};const{MockModels}=require('@mail/../tests/helpers/mock_models');const{patch}=require('web.utils');patch(MockModels,'snailmail/static/tests/helpers/mock_models.js',{generateData(){const data=this._super(...arguments);Object.assign(data,{'snailmail.letter':{fields:{message_id:{string:'Snailmail Status Message',type:'many2one',relation:'mail.message'},},records:[],},});return data;},});return __exports;});;

/* /snailmail/static/tests/helpers/mock_server.js defined in bundle 'web.tests_assets' */
odoo.define('@snailmail/../tests/helpers/mock_server',async function(require){'use strict';let __exports={};const MockServer=require('web.MockServer');MockServer.include({async _performRpc(route,args){if(args.model==='mail.message'&&args.method==='cancel_letter'){const ids=args.args[0];return this._mockMailMessageCancelLetter(ids);}
if(args.model==='mail.message'&&args.method==='send_letter'){const ids=args.args[0];return this._mockMailMessageSendLetter(ids);}
return this._super(...arguments);},_mockMailMessageCancelLetter(ids){},_mockMailMessageSendLetter(ids){},});return __exports;});